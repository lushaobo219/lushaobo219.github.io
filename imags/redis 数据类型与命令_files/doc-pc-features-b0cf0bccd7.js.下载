(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{100:function(e,t,o){"use strict";o.d(t,"b",(function(){return r})),o.d(t,"a",(function(){return c}));var n,r,i=o(2),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});!function(e){e.FINISH_IMAGE_LOAD="finish_image_load"}(r||(r={}));var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t}(i.Notification)},103:function(e,t,o){e.exports={"mention-qq-component":"mention-qq-component--2USrP","mention-qq-component-disable":"mention-qq-component-disable--2_vtl"}},106:function(e,t,o){e.exports={"doc-link-container":"doc-link-container--2PobN","doc-link-container-none":"doc-link-container-none--2sAmC","doc-link-container-hover":"doc-link-container-hover--18yc3","doc-link-container-active":"doc-link-container-active--1jVY4","doc-link-default":"doc-link-default--7CyhL","doc-link-doc":"doc-link-doc--3lBV0","doc-link-sheet":"doc-link-sheet--3jh-o","doc-link-folder":"doc-link-folder--19_P-","doc-link-slide":"doc-link-slide--2Udf0","doc-link-pdf":"doc-link-pdf--1WXXH","doc-link-form":"doc-link-form--1OHqm"}},112:function(e,t,o){"use strict";o.d(t,"a",(function(){return l})),o.d(t,"b",(function(){return d}));var n=o(0),r=o(2),i=[n.StoryType.CodeblockStory],a=function(e,t){return!!t.get(e)},c=function(e,t){if(t instanceof n.IContentOperationBase){var o=e.currentRange().end()-t.param.range.begin(),r=n.OperationUtil.moveOffset(t.clone(),o);r&&e.addOperation(r)}},s=function(e,t,o){var r=e.get(t);r||(r={storyId:t,storyType:o,storyDelta:n.DeltaOption.createLocalDeltaOption(n.GCPRange.emptyRange()).buildDelta()},e.set(t,r));return r},l=function(e,t){void 0===t&&(t=i);var o=function(e){if(e&&e.operations.length>0)for(var t=0;t<e.operations.length;t++){var o=e.operations[t];if(o&&o instanceof n.InsertStoryBeginOperation)return o.param.range.begin()}return-1}(e);if(!e||o<0)return e;var l=function(e){var t=new Map;return e.forEach((function(e){t.get(e)||t.set(e,!0)})),t}(t),d=new Map,u=!1,p=null,f=null;e.opFilter((function(e){var t;if(e instanceof n.InsertStoryBeginOperation)return u=!0,f=e.param.storyProp.storyType,p=e.param.storyProp.storyId,(t=s(d,p,f))&&c(t.storyDelta,e),!1;if(u&&p&&f&&e instanceof n.InsertStoryEndOperation)return(t=s(d,p,f))&&c(t.storyDelta,e),u=!1,f=null,p=null,!1;if(u&&p&&f&&e instanceof n.InsertOperation)return(t=s(d,p,f))&&c(t.storyDelta,e),!1;if(e instanceof n.InsertParaOperation&&e.param.paraProperty instanceof n.NumberingProperty){var o=d.get(n.StoryID.ListTemplateId);if(!o){var r=n.DeltaOption.createLocalDeltaOption(new n.GCPRange(0,0)).buildDelta();o={storyId:n.StoryID.ListTemplateId,storyType:n.StoryType.ListTemplateStory,storyDelta:r},d.set(n.StoryID.ListTemplateId,o)}return c(o.storyDelta,e),!1}return!0}));var h=n.DeltaOption.createLocalDeltaOption(e.globalOpts.originRange).buildDelta();if(h.moveTo(new n.GCPRange(o,0)),d.forEach((function(e,t){if(!a(e.storyType,l)&&t!==n.StoryID.ListTemplateId){var o=d.get(t);o&&o.storyDelta.forEachOp((function(e){c(h,e)}))}})),d.get(n.StoryID.ListTemplateId)){var m=d.get(n.StoryID.ListTemplateId);m&&m.storyDelta.forEachOp((function(e){c(h,e)}))}return h.moveTo(e.globalOpts.originRange),e.forEachOp((function(e){if(e instanceof n.InsertOperation&&e.param.spanProperty.isStoryPlaceholder&&e.param.spanProperty.storyId){var t=e.param.spanProperty.storyId,o=d.get(t);o&&a(o.storyType,l)?o.storyDelta.forEachOp((function(e){e instanceof n.InsertStoryBeginOperation||e instanceof n.InsertStoryEndOperation||c(h,e)})):r.Logger.warn("[substory]story delta empty! storyId: "+t)}else c(h,e)})),h},d=function(e){return l(e)}},115:function(e,t,o){"use strict";o.d(t,"c",(function(){return c})),o.d(t,"a",(function(){return s})),o.d(t,"d",(function(){return l})),o.d(t,"b",(function(){return d}));var n=o(0),r=o(2),i=o(24),a=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};function c(e){return e.match(new RegExp("(?:http://|https://)?(?:\\w+.)?docs.qq.com/?(doc|sheet|slide|form|pdf)?/?(?:[/\\w+&@#/%=~_|$?!:,\\.-]*)(.*)","i"))}function s(e,t,o){var n=c(e);if(!n||0===n.length)return null;var a=i.a.UNKNOWN;if(n[1])switch(n[1]){case"doc":a=i.a.WORD;break;case"sheet":a=i.a.EXCEL;break;case"silde":a=i.a.SLIDE;break;case"form":a=i.a.FORM;break;case"pdf":a=i.a.PDF}return{fileUrl:Object(r.appendHttp)(n[0]),fileName:t,fileExt:(o?o.fileExt:void 0)||a,fileId:o?o.fileId:void 0}}function l(e){var t=e.fileName,o=a(e,["fileName"]),r=JSON.stringify(e),i=JSON.stringify(r);return{fieldCode:n.FieldType.DOC_LINK+" "+i,fieldResult:""+(t||o.fileUrl)}}function d(e){if(!e.instructions||!e.instructions[0])return null;try{var t=JSON.parse(JSON.parse('"'+e.instructions[0]+'"'));return Object(i.b)(t)?t:null}catch(e){return null}}},140:function(e,t,o){"use strict";o.d(t,"a",(function(){return k}));var n,r=o(69),i=o(5),a=o(1),c=o.n(a),s=o(43),l=o.n(s),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),u=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.previousZoomLevel=1,t.containerRef=c.a.createRef(),t}return d(t,e),t.prototype.componentDidMount=function(){var e=this;this.sub=this.workbench.listen("$sectionChanged",(function(){setTimeout((function(){e.forceUpdate()}),0)}))},t.prototype.componentWillUnmount=function(){this.sub.unsubscribe()},t.prototype.render=function(){var e,t=this.props,o=t.children,n=t.zoomLevel,r={width:"auto",height:"auto"},i=null!==(e=this.props.zoomableAlign.get(this.props.$surface))&&void 0!==e?e:"Center";if("Center"!==i&&(r["margin"+i]=0),this.containerRef.current){var a=this.containerRef.current.getBoundingClientRect(),s=a.width/this.previousZoomLevel*n,d=a.height/this.previousZoomLevel*n;s>50&&d>50&&(r.width=s,r.height=d),this.previousZoomLevel=n}return c.a.createElement("div",{className:l.a.zoomable,style:r},c.a.createElement("div",{className:l.a["zoomable-content"],style:{transform:"scale("+n+")"},ref:this.containerRef},o))},u([Object(i.l)(),p("design:type",i.B)],t.prototype,"workbench",void 0),t}(a.Component),h=Object(i.D)(["zoomLevel","zoomableAlign"])(f),m=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),g=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollable=c.a.createRef(),t.state={scrolled:!1},t.previousZoomLevel=1,t.destScrollTop=0,t}return m(t,e),t.prototype.handleScroll=function(){var e=this.scrollable.current;e&&(e.scrollTop>0?(this.context.store.update("scrolled",!0),this.setState({scrolled:!0})):(this.context.store.update("scrolled",!1),this.setState({scrolled:!1})))},t.prototype.componentDidMount=function(){var e=this.scrollable.current;e&&(this.scrollListener=this.handleScroll.bind(this),e.addEventListener("scroll",this.scrollListener),this.workbench.listen("$beforeMeloAttach",(function(t){t.view.setScrollRoot(e)})))},t.prototype.componentDidUpdate=function(){var e=this.scrollable.current,t=this.props.zoomLevel;e&&t!==this.previousZoomLevel&&!isNaN(t)&&(e.scrollTop=this.destScrollTop,this.previousZoomLevel=t,this.destScrollTop=0)},t.prototype.componentWillUnmount=function(){var e=this.scrollable.current;e&&e.removeEventListener("scroll",this.scrollListener)},t.prototype.render=function(){var e=this.props,t=e.children,o=e.zoomLevel,n=this.scrollable.current;if(n&&o!==this.previousZoomLevel){var r=n.scrollTop;this.destScrollTop=r/this.previousZoomLevel*o}return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"scroll-shadow",style:{opacity:this.state.scrolled?1:0}}),c.a.createElement("div",{className:l.a.scrollable,ref:this.scrollable},t))},t.contextType=i.h,g([Object(i.l)(),y("design:type",i.B)],t.prototype,"workbench",void 0),t}(a.Component),v=Object(i.D)(["zoomLevel"])(b),C={name:"zoomable",priority:100,requestInfo:!0,component:c.a.createElement(h,null)},w={name:"scrollable",priority:1e3,requestInfo:!0,component:c.a.createElement(v,null)},E=o(18),_=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},O=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},k=function(){function e(e,t,o){var n=this;this.widgetService=e,this.store=t,this.workbench=o,this.aligns=new Map,t.register("zoomableAlign",this.aligns),this.widgetService.wrap(C),this.widgetService.wrap(w),t.register("zoomLevel",1),t.register("scrolled",!1),this.workbench.listen("$requsetZoomableReset",(function(){var e=n.store.get("zoomLevel");e.next(e.getValue())}))}return e.prototype.setZoomLevel=function(e,t){void 0===t&&(t=!1);var o=Object(r.b)(e,2),n=this.store.get("zoomLevel");!t&&(o>2||o<.5)||n.next(o)},e.prototype.setAlign=function(e,t){this.aligns.set(e,t),this.store.update("zoomableAlign",this.aligns)},e.prototype.setPresentationEditorZoom=function(e,t,o,n){},e=_([Object(i.i)({name:E.a.ZoomBase,scope:1}),O("design:paramtypes",[i.A,i.x,i.B])],e)}()},143:function(e,t,o){e.exports={titlebar:"titlebar--1Z0Xo","menu-icon-button":"menu-icon-button--1jnM8","menu-icon-button-focus":"menu-icon-button-focus--fkP2N"}},145:function(e,t,o){"use strict";var n,r=o(1),i=o.n(r),a=(o(2),o(114)),c=(o(167),n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){return i.a.createElement(a.Loading,{style:{width:this.props.width,height:this.props.height},spinType:"light"})},t}(r.PureComponent);t.a=s},159:function(e,t,o){"use strict";o.d(t,"b",(function(){return Y})),o.d(t,"a",(function(){return ee}));var n,r=o(1),i=o.n(r),a=o(143),c=o.n(a),s=o(5),l=o(71),d=o.n(l),u=o(0),p=o(81),f=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),h=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},m=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(e){function t(t){var o=e.call(this,t)||this;return o.onBackClick=function(){u.ReportHelper.tdwReport({opername:"doc_menubar",module:"backto_list_button",action:"click"})},o.mouseEnterHandler=function(){o.setState({isHover:!0})},o.mouseLeaveHandler=function(){o.setState({isHover:!1})},o.state={isHover:!1},o}return f(t,e),t.prototype.render=function(){var e=this.props,t=e.hideBack,o=e.hideLogo,n=e.disableClick,r=void 0===n?t:n,a=[d.a.brand_container];return t&&a.push(d.a["no-back"]),i.a.createElement("div",{className:a.join(" "),onMouseEnter:this.mouseEnterHandler,onMouseLeave:this.mouseLeaveHandler,onClick:this.onBackClick},!t&&i.a.createElement("a",{className:d.a.brand_back,href:this.target},i.a.createElement("svg",{id:"brand-back",width:"17px",height:"17px",viewBox:"0 0 17 17",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("g",{id:"back",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",opacity:"0.400000006"},i.a.createElement("g",{id:"copy-2",fillRule:"nonzero",stroke:"#000000",strokeWidth:"2"},i.a.createElement("polyline",{id:"path",transform:"translate(10.818182, 8.500000) rotate(-45.000000) translate(-10.818182, -8.500000) ",points:"7.72727273 11.5909091 7.72727273 5.40909091 13.9090909 5.40909091"}))))),!o&&i.a.createElement("a",{href:this.target,className:d.a.brand_logo_new,style:t&&r?{pointerEvents:"none"}:{cursor:"pointer"}}))},h([Object(p.a)("feature.titlebar.logo_target","https://docs.qq.com/desktop/?_from=1"),m("design:type",String)],t.prototype,"target",void 0),t}(r.Component),y=o(87),b=o.n(y),v=o(30),C=o.n(v),w=o(35),E=o.n(w),_=o(68),O=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),k=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},R=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},S=/[\\/:*?"<>|]/g,L="文档名不能超过"+_.a.MAX_TITLE_LENGTH+"个字符。",D=function(e){function t(t){var o=e.call(this,t)||this;return o.isCompositing=!1,o.getTitleWidth=function(){var e=document.getElementById("text-measure");if(e){var t=o.props.docTitle.split("").reduce((function(e,t){return e+(" "===t?"&nbsp;":t)}),"");e.innerHTML=t;var n=Math.ceil(e.clientWidth)+5;return e.innerHTML="",n}return 18*(o.props.docTitle||"无标题文档").length+2},o.onChange=function(e){var t=o.filterIllegalInput(e.target.value);o.isCompositing||(t=o.filterOverLengthInput(t)),o.changeTitle(t)},o.focus=function(){var e=document.getElementById("melo-doc-title");e.focus(),e.setSelectionRange(0,e.value.length)},o.onBlur=function(e){var t=e.target.value;return S.test(t)?(o.showErrorTips('文档名不能包含下列任何字符：\\ / : * ? " < > |'),void o.focus()):t.length>_.a.MAX_TITLE_LENGTH?(o.showErrorTips(L),void o.focus()):(o.setTitle(t||"无标题文档"),void u.ReportHelper.tdwReport({opername:"doc_menubar",module:"title",action:"modify"}))},o.filterIllegalInput=function(e){var t=e;return S.test(t)&&(o.showErrorTips('文档名不能包含下列任何字符：\\ / : * ? " < > |'),t=t.replace(S,"")),t},o.filterOverLengthInput=function(e){var t=e;return t.length>_.a.MAX_TITLE_LENGTH&&(o.showErrorTips(L),t=t.substr(0,_.a.MAX_TITLE_LENGTH)),t},o.setTitle=function(e){o.workbench.emit("setTitle",e)},o.handleMouseOver=function(){o.setState({tooltipsVisible:!0})},o.handleMouseOut=function(){o.setState({tooltipsVisible:!1})},o.widgetService.float({name:"text-measure",component:i.a.createElement("div",{id:"text-measure"}),styles:{pointerEvents:"none"}}),o.state={tooltipsVisible:!1},o}return O(t,e),t.prototype.changeTitle=function(e){this.store.update("docTitle",e)},t.prototype.onCompositionStart=function(){this.isCompositing=!0},t.prototype.onCompositionUpdate=function(){this.isCompositing=!0},t.prototype.onCompositionEnd=function(){this.isCompositing=!1;var e=document.getElementById("melo-doc-title").value;e=this.filterIllegalInput(e),e=this.filterOverLengthInput(e),this.changeTitle(e)},t.prototype.showErrorTips=function(e){e&&C.a.show({message:e,type:"info",autoClose:!0,duration:5e3})},t.prototype.getTitle=function(e){return e&&e.length>15?i.a.createElement("span",null,e.substring(0,15),i.a.createElement("br",null),e.substring(15)):e},t.prototype.render=function(){var e=this.getTitleWidth();return this.props.canEditTitle?i.a.createElement(E.a,{visible:e>200&&this.state.tooltipsVisible,title:this.getTitle(this.props.docTitle),placement:"bottom",overlayStyle:{textAlign:"center",maxWidth:Math.max(Math.min(e,570)-100,200)}},i.a.createElement("input",{id:"melo-doc-title",className:b.a["melo-doc-title"],style:{width:e,maxWidth:570,minWidth:Math.min(e,241),color:"#000000"},autoComplete:"off",value:this.props.docTitle,onChange:this.onChange,onCompositionStart:this.onCompositionStart.bind(this),onCompositionUpdate:this.onCompositionUpdate.bind(this),onCompositionEnd:this.onCompositionEnd.bind(this),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onBlur:this.onBlur,onKeyPress:function(e){"Enter"===e.key&&e.currentTarget.blur()}})):i.a.createElement(E.a,{visible:e>200&&this.state.tooltipsVisible,title:this.getTitle(this.props.docTitle)||"无标题文档",placement:"bottom",overlayStyle:{textAlign:"center",lineHeight:"15px"}},i.a.createElement("div",{onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,className:b.a["melo-doc-title"]+" "+b.a["melo-doc-title-readonly"],style:{width:e,maxWidth:570,minWidth:Math.min(e,241),color:"#000000"}},this.props.docTitle||"无标题文档"))},k([Object(s.l)(),R("design:type",s.B)],t.prototype,"workbench",void 0),k([Object(s.l)(),R("design:type",s.x)],t.prototype,"store",void 0),k([Object(s.l)(),R("design:type",s.A)],t.prototype,"widgetService",void 0),t}(r.PureComponent),I=Object(s.D)(["docTitle","canEditTitle"])(D),T=function(){return(T=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},P=function(e){var t=e.style,o=void 0===t?{}:t;return i.a.createElement("div",{style:T({marginLeft:5,marginRight:5,height:20,width:1,opacity:.08,backgroundColor:"#000000",marginTop:6,marginBottom:6,verticalAlign:"top",display:"inline-block"},o)})},M=o(36),N=o.n(M),x=o(144),A=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),j=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},F=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLogin=function(){x.a.wechatAutoLogin()||(t.workbench.emit("$requestLogin"),u.ReportHelper.tdwReport({opername:"doc_login",module:"readonly",action:"login_exp_pc"}))},t}return A(t,e),t.prototype.componentWillUnmount=function(){this.workbench.emit("$loginBannerUnmount")},t.prototype.render=function(){return i.a.createElement("div",{style:{marginRight:34,fontSize:14}},i.a.createElement(N.a,{type:"primary",style:{marginTop:1,height:30},onClick:this.handleLogin},"立即登录"))},j([Object(s.l)(),F("design:type",s.B)],t.prototype,"workbench",void 0),t}(r.Component),U=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},i.a.createElement("defs",null,i.a.createElement("linearGradient",{id:"prefix__a",x1:"100%",x2:"0%",y1:"15.114%",y2:"84.886%"},i.a.createElement("stop",{offset:"0%",stopColor:"#81868F"}),i.a.createElement("stop",{offset:"100%",stopColor:"#464D5A"}))),i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("path",{d:"M0 0L24 0 24 24 0 24z"}),i.a.createElement("path",{fill:"url(#prefix__a)",fillRule:"nonzero",d:"M21 17v2.2H4V17h17zm0-6v2.2H4V11h17zm0-6v2.2H4V5h17z"})))},V=function(){return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",version:"1.1"},i.a.createElement("defs",null,i.a.createElement("linearGradient",{x1:"100%",y1:"22.603222%",x2:"0%",y2:"77.396778%",id:"linearGradient-1"},i.a.createElement("stop",{stopColor:"#81868F",offset:"0%"}),i.a.createElement("stop",{stopColor:"#464D5A",offset:"100%"}))),i.a.createElement("g",{id:"titlebar_file_menu",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{id:"文件备份-4",opacity:"0",fill:"#D8D8D8"},i.a.createElement("g",{id:"编组",opacity:"0.400000006"},i.a.createElement("rect",{id:"矩形备份-107",x:"0",y:"0",width:"24",height:"24"}))),i.a.createElement("path",{d:"M9.15012609,4 L9.87810595,5.999 L9.88010595,5.9993006 L10.6081059,7.9993006 L10.6061059,7.999\n        L11.6981059,10.999 L11.7001059,10.9993006 L12.4281059,12.9993006 L12.4261059,12.999 L14.9751059,20\n        L12.8471059,20 L11.3911261,15.9990536 L4.60812609,15.9990536 L3.15210595,20 L1.02510595,20 L6.84612609,4\n        L9.15012609,4 Z M22.6401059,16 L22.6401059,18 L17.4391059,17.9993006 L16.7121059,15.9993006\n        L22.6401059,16 Z M7.99912609,6.68105365 L5.33612609,13.9990536 L10.6631261,13.9990536\n        L7.99912609,6.68105365 Z M22.6401059,11 L22.6401059,13 L15.6201059,12.9993006 L14.8921059,10.9993006\n        L22.6401059,11 Z M22.6401059,6 L22.6401059,8 L13.8001059,7.9993006 L13.0721059,5.9993006\n        L22.6401059,6 Z",id:"形状",fill:"url(#linearGradient-1)",fillRule:"nonzero"})))},H=o(47),z=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),W=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},q=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Z={width:32,height:32,padding:4,boxSizing:"border-box",fontSize:0},K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleDropdownOpen=function(e){t.store.update("menuActive",!0),t.handleMouseEnter(e),t.context.editor instanceof u.MeloEditor&&t.context.editor.fire(new u.FocusBlurNotification(u.FocusBlurNotificationType.REQUEST_BLUR),!1)},t.handleDropdownClose=function(){t.store.update("menuActive",!1),t.store.update("menuHover","none")},t.handleMouseEnter=function(e){t.store.update("menuHover",e),t.store.update("menuLastHover",e)},t.handleMouseLeave=function(){t.store.update("menuHover","none")},t}return z(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.isLogin,n=t.isEditable,r=this.props,a=r.menuActive,c=r.menuHover,l=r.menuLastHover,d=this.configService.get("common.titlebar.fileMenu"),u=this.configService.get("common.titlebar.fileMenu");return i.a.createElement(i.a.Fragment,null,o&&d&&i.a.createElement(s.s,{align:"left",name:"file",contentStyle:Z,style:{margin:"0 8px"},animated:!1,show:a&&"file"===l,onDropdownOpen:function(){return e.handleDropdownOpen("file")},onDropdownClose:this.handleDropdownClose,onMouseEnter:function(){e.handleMouseEnter("file")},onMouseLeave:this.handleMouseLeave},i.a.createElement(E.a,{key:"titlebar-menu-file",title:"文档操作",visible:!a&&"file"===c},i.a.createElement(U,null))),o&&n&&u&&i.a.createElement(s.s,{align:"left",name:"more",contentStyle:Z,style:{margin:"0 8px"},animated:!1,show:a&&"more"===l,onDropdownOpen:function(){return e.handleDropdownOpen("more")},onDropdownClose:this.handleDropdownClose,onMouseEnter:function(){e.handleMouseEnter("more")},onMouseLeave:this.handleMouseLeave},i.a.createElement(E.a,{key:"titlebar-menu-more",title:"编辑功能",visible:!a&&"more"===c},i.a.createElement(V,null))))},t.contextType=s.h,W([Object(s.l)(),q("design:type",s.x)],t.prototype,"store",void 0),W([Object(s.l)(),q("design:type",H.a)],t.prototype,"configService",void 0),t}(r.PureComponent),$=Object(s.D)(["menuActive","menuHover","menuLastHover"])(K),G=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),J=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},X=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Q={height:0,overflow:"hidden",flexBasis:0},Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return G(t,e),t.prototype.config=function(e){return!!this.configService.get("common.titlebar."+e)},t.prototype.render=function(){var e=this.props,t=e.isLogin,o=e.isEditable,n=this.context,r=n.isPublish,a=n.clientVars;return i.a.createElement("div",{className:c.a.titlebar,id:"tdocs-titlebar",style:this.props.isTitlebarShowed?{}:Q},this.config("logo")&&i.a.createElement(g,{key:"tdocs-brand",hideBack:!this.config("back"),disableClick:!r}),this.config("title")&&a&&i.a.createElement(I,{key:"tdocs-title"}),i.a.createElement("div",{id:"titlebar-readonly-tips",key:"tdocs-readonly-tips"}),i.a.createElement("div",{id:"titlebar-move-to",key:"tdocs-move-to"}),i.a.createElement("div",{id:"titlebar-collab-status",key:"tdocs-collab-status"}),i.a.createElement("div",{style:{marginLeft:"auto"},key:"tdocs-pusher"}),i.a.createElement("div",{id:"titlebar-qqgroup-info"}),i.a.createElement($,{isLogin:t,isEditable:o}),i.a.createElement("div",{id:"titlebar-presentation-button"}),i.a.createElement("div",{id:"titlebar-policy-button"}),t&&o&&this.config("share")&&i.a.createElement(P,null),this.config("share")&&t&&i.a.createElement("div",{id:"titlebar-share-button",style:{marginLeft:10,marginRight:10}},i.a.createElement(N.a,{type:"primary",disabled:!0},"分享")),t&&this.config("account")&&i.a.createElement(P,null),t&&this.config("account")&&i.a.createElement("div",{style:{marginLeft:10,marginRight:10,fontSize:0},id:"titlebar-avatar"},i.a.createElement("div",{className:"shins-loading",style:{width:30,height:30,borderRadius:4}})),!t&&this.config("login")&&i.a.createElement(B,null))},t.contextType=s.h,t.flagMap={"tdocs-title":"title","titlebar-readonly-tips":"readonly","titlebar-collab-status":"collaborators","titlebar-qqgroup-info":"qq-group","titlebar-presentation-button":"presentation","titlebar-policy-button":"auth"},J([Object(s.l)(),X("design:type",H.a)],t.prototype,"configService",void 0),t}(r.Component),ee=Object(s.D)(["isTitlebarShowed","isLogin","isEditable"])(Y)},18:function(e,t,o){"use strict";var n;o.d(t,"a",(function(){return n})),function(e){e.AdMobile="ad_mobile",e.AppGuide="app_guide",e.AppGuidePc="app_guide_pc",e.Audio="audio",e.Codeblock="codeblock",e.CollabCaret="collab_caret",e.CollabStatus="collab_status",e.CollabStatusMobile="collab_status_mobile",e.Comment="comment",e.CommentMobile="comment_mobile",e.CommentPc="comment_pc",e.ContextmenuMobile="contextmenu_mobile",e.CoreEdit="core_edit",e.DocPreview="doc_preview",e.DocViewMobile="doc_view_mobile",e.FakeToolbar="fake_toolbar",e.FieldProcessor="field_processor",e.Fieldcode="fieldcode",e.FieldcodeDate="fieldcode_date",e.FieldcodeDocLink="fieldcode_doc_link",e.FieldcodeDoclinkRender="fieldcode_doclink_render",e.FieldcodeMention="fieldcode_mention",e.FieldcodeMentionRender="fieldcode_mention_render",e.FieldcodePage="fieldcode_page",e.FileBase="file_base",e.FileExport="file_export",e.FileMobile="file_mobile",e.FilePc="file_pc",e.Font="font",e.Fullscreen="fullscreen",e.HelpCenter="help_center",e.HelpCenterMobile="help_center_mobile",e.HomeMobile="home_mobile",e.Image="image",e.ImageMobile="image_mobile",e.ImagePc="image_pc",e.ImageReadonly="image_readonly",e.Link="link",e.List="list",e.ListReadonly="list_readonly",e.Location="location",e.Login="login",e.ManualOffline="manual_offline",e.Markdown="markdown",e.MobileHeader="mobile_header",e.MobileTips="mobile_tips",e.MobileView="mobile_view",e.MoveTo="move_to",e.MoveToMobile="move_to_mobile",e.NewpadInputTips="newpad_input_tips",e.Ocr="ocr",e.OcrPreview="ocr_preview",e.OfflineEdit="offline_edit",e.OfflineStatus="offline_status",e.Outline="outline",e.OutlineMobile="outline_mobile",e.Page="page",e.PageShade="page_shade",e.Paragraph="paragraph",e.PerformanceReport="performance_report",e.Presentation="presentation",e.Print="print",e.Publish="publish",e.ReadRecord="read_record",e.ReadonlyMobileToolbar="readonly_mobile_toolbar",e.ReadonlyTips="readonly_tips",e.ReadonlyToolbar="readonly_toolbar",e.RecoverDoc="recover_doc",e.ResizeAdapt="resize_adapt",e.RevisionRecord="revision_record",e.ScrollPosition="scroll_position",e.Search="search",e.Section="section",e.SelectivePaste="selective_paste",e.Share="share",e.ShareMobile="share_mobile",e.ShareQqBrowser="share_qq_browser",e.SnapScreenMobile="snap_screen_mobile",e.SnapScreenPc="snap_screen_pc",e.Spellcheck="spellcheck",e.Splitline="splitline",e.SplitlineReadonly="splitline_readonly",e.StarMobile="star_mobile",e.Table="table",e.TemplateInfo="template_info",e.TextFlow="text_flow",e.Title="title",e.TitleDefaultAdd="title_default_add",e.TitleMobile="title_mobile",e.Titlebar="titlebar",e.TitlebarMobile="titlebar_mobile",e.Translate="translate",e.UnreadNotify="unread_notify",e.UpdateNotice="update_notice",e.UserAvatar="user_avatar",e.Vip="vip",e.VoiceInput="voice_input",e.Watermark="watermark",e.WordCount="word_count",e.ZoomBase="zoom_base",e.ZoomMelo="zoom_melo",e.ZoomMobile="zoom_mobile",e.ZoomPc="zoom_pc",e.DocxDatabaseProxy="docx_database_proxy",e.DocxDocxDeferredRender="docx_docx_deferred_render",e.DocxDocxRender="docx_docx_render",e.DocxPages="docx_pages",e.DocxRightBar="docx_right_bar",e.DocxTools="docx_tools",e.TdocsTdocsDeferredRender="tdocs_tdocs_deferred_render",e.TdocsTdocsRender="tdocs_tdocs_render"}(n||(n={}))},237:function(e,t,o){"use strict";o.d(t,"a",(function(){return V}));var n,r=o(140),i=o(5),a=o(1),c=o.n(a),s=o(72),l=o.n(s),d=o(53),u=o.n(d),p=o(35),f=o.n(p),h=o(50),m=o.n(h),g=o(74),y=o.n(g),b=o(2),v=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),C=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},w=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.setZoomLevel=function(e){this.props.handler.setZoomLevel(e)},t.prototype.render=function(){var e,t,o=this,n=b.PlatformUtil.isMac()?"⌘":"Ctrl",r=this.props.zoomLevel;return c.a.createElement("div",{className:m.a["zoom-level-bar"]},c.a.createElement(f.a,{title:n+"+0 可恢复到 100%",placement:"top"},c.a.createElement("div",{className:y.a["statusbar-simple-button"],onClick:function(){o.setZoomLevel(r-.05)}},c.a.createElement("div",{className:m.a["zoom-button"]+" "+m.a["zoom-out-button"]}))),c.a.createElement(l.a,{dropContent:c.a.createElement(u.a,{style:{width:90,position:"relative",right:-20},onClick:function(e){o.setZoomLevel(parseFloat(e.replace("zoom-","")))},selectedIds:["zoom-"+r]},[.5,.75,1,1.25,1.5,2].map((function(e){return c.a.createElement(u.a.Item,{id:"zoom-"+e,key:"zoom-"+e},100*e,"%")}))),placement:"top",alignment:"right"},c.a.createElement("div",{className:y.a["statusbar-simple-text"]+" "+m.a["zoom-level-text"]},(e=100*r,void 0===t&&(t=0),Number(Math.round(Number(e+"e"+t))+"e-"+t)),"%")),c.a.createElement(f.a,{containerStyle:{width:160},title:n+"+0 可恢复到 100%",placement:"top",overlayClassName:m.a["edge-right-tooltip"]},c.a.createElement("div",{className:y.a["statusbar-simple-button"],onClick:function(){o.setZoomLevel(r+.05)}},c.a.createElement("div",{className:m.a["zoom-button"]+" "+m.a["zoom-in-button"]}))))},C([Object(i.l)(),w("design:type",i.x)],t.prototype,"store",void 0),t}(a.Component),_=Object(i.D)(["zoomLevel"])(E),O=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},k=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(O(arguments[t]));return e};var R=o(0),S=o(69),L=[{keyBindings:{mac:R.KeyAssist.COMMAND+R.KeyCode.NUM_0,win:[R.KeyAssist.CTRL_WIN+96,R.KeyAssist.CTRL_WIN+R.KeyCode.NUM_0]},callback:function(e,t){t.setZoomLevel(1)}},{keyBindings:{mac:R.KeyAssist.COMMAND+R.WheelCode.WHEEL_CLOCKWISE,win:R.KeyAssist.CTRL_WIN+R.WheelCode.WHEEL_CLOCKWISE},callback:function(e,t){var o=e.store.getValue("zoomLevel");t.enableWheelZoom&&t.setZoomLevel(o-S.a)}},{keyBindings:{mac:R.KeyAssist.COMMAND+R.WheelCode.WHEEL_ANTICLOCKWISE,win:R.KeyAssist.CTRL_WIN+R.WheelCode.WHEEL_ANTICLOCKWISE},callback:function(e,t){var o=e.store.getValue("zoomLevel");t.enableWheelZoom&&t.setZoomLevel(o+S.a)}},{keyBindings:{mac:R.KeyAssist.COMMAND+R.KeyCode.MINUS,win:R.KeyAssist.CTRL_WIN+R.KeyCode.MINUS},shouldPreventDefault:!0,callback:function(){}},{keyBindings:{mac:R.KeyAssist.COMMAND+R.KeyCode.NUM_PLUS,win:R.KeyAssist.CTRL_WIN+R.KeyCode.NUM_PLUS},shouldPreventDefault:!0,callback:function(){}},{keyBindings:{mac:R.KeyAssist.COMMAND+R.KeyCode.NUM_MINUS,win:R.KeyAssist.CTRL_WIN+R.KeyCode.NUM_MINUS},shouldPreventDefault:!0,callback:function(){}}],D=o(18),I=o(43),T=o.n(I),P=o(247),M=o(255),N=o(81),x=function(){return(x=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},A=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},j=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},F={menu:k([{name:"view-scale",content:"显示比例"}],[75,100,125,150,200].map((function(e){return{name:"view-scale-"+e,content:e+"%",onClick:function(t){t.store.update("zoomLevel",e/100)},shouldCheck:function(t){return t.store.getValue("zoomLevel")===e/100}}}))),statusBar:[{name:"zoom",content:c.a.createElement(_,null)}]},B=F.menu,U=F.statusBar,V=function(){function e(e,t,o,n){var r=this;this.zoomBaseHandler=e,this.drawerService=t,this.workbench=o,this.store=n,this.customWheelZoom=!0,this.handleDrawer=function(){var e=document.getElementsByClassName(T.a.zoomable);e&&setTimeout((function(){var t=0,o=0;Array.from(e).forEach((function(e){var n=e.getBoundingClientRect().width;n&&(t+=n,o+=1)}));var n=r.store.getValue(i.d.EditorZoneMarginRight)||0,a=(document.body.clientWidth-t-n)/2;a<276||o>1?r.updateLeftDrawerStyles(216,216,60):a<320?(r.updateLeftDrawerStyles(a-60,a-60),r.drawerService.setLeftDrawerMode("float")):(r.updateLeftDrawerStyles(260,a),r.drawerService.setLeftDrawerMode("float"))}),0)},this.workbench.listen("$leftDrawerWillOpen",this.handleDrawer),this.workbench.listen("$leftDrawerClosed",(function(){setTimeout((function(){return r.handleDrawer()}),0)})),this.drawerService.setLeftDrawerMode("float"),this.store.get("zoomLevel").subscribe((function(){setTimeout((function(){return r.handleDrawer()}),0)})),Object(P.a)(window,"resize").pipe(Object(M.a)(50)).subscribe((function(){return r.handleDrawer()}))}return e.prototype.setZoomLevel=function(e,t){void 0===t&&(t=!1),this.zoomBaseHandler.setZoomLevel(e,t)},e.prototype.setAlign=function(e,t){this.zoomBaseHandler.setAlign(e,t)},e.prototype.updateLeftDrawerStyles=function(e,t,o){void 0===o&&(o=0);var n=this.store.getValue(i.d.LeftDrawerInfo),r=this.store.getValue(i.d.LeftDrawerOpened),a=null==n?void 0:n.style,c=x(x({},a),{minWidth:Math.max(Math.min(e,280),216)+"px",maxWidth:Math.min(Math.max(t,216),280)+"px"});this.store.update(i.d.LeftDrawerInfo,x(x({},n),{style:c})),r&&o&&this.store.update(i.d.EditorZoneMarginLeft,o+t)},Object.defineProperty(e.prototype,"enableWheelZoom",{get:function(){return this._enableWheelZoom&&this.customWheelZoom},set:function(e){this.customWheelZoom=e},enumerable:!0,configurable:!0}),A([Object(N.a)("feature.zoom_pc.wheel",!0),j("design:type",Boolean)],e.prototype,"_enableWheelZoom",void 0),e=A([Object(i.i)({name:D.a.ZoomPc,scope:1,statusbarItems:U,menuItems:B,keymap:L}),j("design:paramtypes",[r.a,i.g,i.B,i.x])],e)}()},24:function(e,t,o){"use strict";var n,r;function i(e){return!!e&&e.fileUrl&&"string"==typeof e.fileUrl}o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return i})),function(e){e[e.FOLDER_SHARE=-1]="FOLDER_SHARE",e[e.WORD=0]="WORD",e[e.EXCEL=1]="EXCEL",e[e.FORM=2]="FORM",e[e.FOLDER=3]="FOLDER",e[e.SLIDE=4]="SLIDE",e[e.NOTE=5]="NOTE",e[e.PDF=6]="PDF",e[e.MINIPROGRAM=7]="MINIPROGRAM",e[e.UNKNOWN=10]="UNKNOWN"}(n||(n={})),function(e){e[e.PRIVATE=0]="PRIVATE",e[e.PARTIAL=1]="PARTIAL",e[e.ALL=2]="ALL"}(r||(r={}))},244:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(0);o(2);function r(){n.AdapterUtil.getClientSize().height}},248:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var n,r=o(5),i=o(18),a=o(232),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.initContainerRender=function(t){e.prototype.initContainerRender.call(this,t)},t.prototype.initDecoratorRender=function(t){e.prototype.initDecoratorRender.call(this,t)},t=s([Object(r.i)({name:i.a.TdocsTdocsRender,scope:0,for:["melo"]})],t)}(a.b)},250:function(e,t,o){"use strict";o.d(t,"a",(function(){return h}));var n=o(0);function r(e){var t=["〇","一","二","三","四","五","六","七","八","九"],o=["","十","百","千","万","十","百","千","亿","十","百","千","兆","十","百","千","京","十","百","千","垓"],n="",r=Math.floor(Math.abs(e));if(r<1)return(e<0?"负":"")+t[0];for(var i=o.slice();r>0;){var a=i.shift();n=t[r%10]+a+n,r=Math.floor(r/10)}var c=o[1]+o[2]+o[3],s=o[4]+o[8]+o[12]+o[16]+o[20],l=t[0];return(e<0?"负":"")+(n=n.replace(new RegExp("("+l+")["+c+"]","g"),"$1").replace(new RegExp("(["+s+"])[^"+c+"]+(["+s+"])","g"),"$1"+l).replace(new RegExp("(["+c+"])"+l+"+(["+s+"])","g"),"$1$2"+l).replace(new RegExp("("+t[0]+")+","g"),"$1").replace(new RegExp(l+"+$"),"").replace(new RegExp("^"+t[1]+o[1]),o[1]))}var i,a=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),c=function(e){function t(t){var o=e.call(this)||this;return o.editor=t,o.isAutoUpdate=!0,o.isInlineBlock=!1,o}return a(t,e),t.prototype.requiredContext=function(e){var t=[n.FieldcodeLayoutContextKey.PAGE,n.FieldcodeLayoutContextKey.SECTION,n.FieldcodeLayoutContextKey.PAGE_START];return e.switches&&"string"==typeof e.switches["@"]&&e.switches["@"].indexOf("$N")>=0&&t.push(n.FieldcodeLayoutContextKey.PAGE_COUNT),t},t.prototype.getPrefab=function(e){return this.parse(e,{page:999,pageCount:999})},t.prototype.getDropdownItems=function(e,t){var o,r=this,i=e.switches,a="",c=-1;switch((void 0===i?{}:i)["@"]){case"·$P·":o=/·(\d+)·/,c=1;break;case"-$P-":o=/-(\d+)-/,c=2;break;case"第$P页":o=/第([〇一二三四五六七八九十百千万]+)页/,c=3;break;case"$P/$N":o=/(\d+)\/(\d+)/,c=4;break;case"$P":default:c=0,a=t,o=/(\d+)/}if(""===a){var s=o.exec(t);if(null===s)return[];a=3===c?""+function(e){for(var t={"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},o={"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},n=0,r=0,i=0,a=e.split(""),c=0;c<a.length;c++){var s=t[a[c]];if(void 0!==s)i=s,c===a.length-1&&(r+=i);else{var l=o[a[c]].value;o[a[c]].secUnit?(n+=r=(r+i)*l,r=0):r+=i*l,i=0}}return n+r}(s[1]):s[1]}var l=parseInt(a,10);return["PAGE",'PAGE \\@ "·$P·"','PAGE \\@ "-$P-"','PAGE \\@ "第$P页" \\* TDW-CHINESE','PAGE \\@ "$P/$N"'].map((function(e,t){return{checked:t===c,content:r.parse(n.FieldcodeManager.getInstance().getFieldcodeInfo(e),{page:l,pageCount:r.editor.pageCount}),onClick:function(t){r.editor.onSelection().updateField(t,e,"1"),n.ReportHelper.tdwReport({opername:"doc_word_editor",module:"pagenumbers",action:"style_set",obj3:r.parse(n.FieldcodeManager.getInstance().getFieldcodeInfo(e),{page:1,pageCount:42})})}}}))},t.prototype.afterShowDropdown=function(){n.ReportHelper.tdwReport({opername:"doc_word_editor",module:"pagenumbers",action:"style_show"})},t.prototype.parse=function(e,t){var o,i,a=t.page,c=e.switches,s=void 0===c?{}:c;switch(a-=1-(void 0!==t.pageStart?t.pageStart:n.Defaults.section.pageStartAt),s["*"]){case"TDW-CHINESE":o=r(a),i=r(t.pageCount);break;case"Arabic":default:o=""+a,i=""+t.pageCount}var l=o;switch(s["@"]){case"·$P·":l="·"+o+"·";break;case"-$P-":l="-"+o+"-";break;case"第$P页":l="第"+o+"页";break;case"$P/$N":l=o+"/"+i;break;case"$P":default:l=o}return l},t}(n.FieldcodeProcessor),s=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!0,t.isInlineBlock=!0,t}return s(t,e),t.prototype.requiredContext=function(){return[n.FieldcodeLayoutContextKey.PAGE_COUNT]},t.prototype.parse=function(e,t){return"总页数："+t.pageCount},t}(n.FieldcodeProcessor),d=o(5),u=o(46),p=o(18),f=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},h=function(){function e(){}return e.prototype.$onInit=function(e){var t=n.FieldcodeManager.getInstance();t.addProcessor("PAGE",new c(e)),t.addProcessor("NUMPAGES",new l),e.addDecorator(n.DecoratorTypes.LineFragment,Object(u.b)(e))},e.prototype.$beforeDestroy=function(){var e=n.FieldcodeManager.getInstance();e.removeProcessor("PAGE"),e.removeProcessor("NUMPAGES")},e=f([Object(d.i)({name:p.a.FieldProcessor,scope:0,for:["melo"]})],e)}()},251:function(e,t,o){"use strict";o.d(t,"a",(function(){return b}));var n,r=o(5),i=o(0),a=o(46),c=o(1),s=o.n(c),l=o(12),d=o(103),u=o.n(d),p=(o(2),n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),f=function(e){function t(t){var o=e.call(this,t)||this;return o.getMentionField=function(){var e=o.props.fieldCode,t=e?e.field:null;return o.fieldRange=e?e.range:null,t},o.handleFieldClick=function(e){var t=o.props,n=t.editor,r=t.layoutBox;if(n.isEditable()){var a=o.getMentionField();if(a){var c=Object(l.c)().globalPadId;if(a.instructions[3]&&a.instructions[3]!==c)return;var s=i.FieldcodeManager.getInstance().getProcessor(a.fieldName);if(!s)return;s.handleFieldClick(a.instructions[0],r)}}},o.onTouchStart=function(e){e.stopPropagation()},o.rootRef=s.a.createRef(),o.state={showBackground:!1,isAutoUpdate:!1},o}return p(t,e),t.prototype.render=function(){var e=this,t=this.props.children,o=this.getMentionField(),n="",r=!1;if(o){n=o.instructions[0];var i=Object(l.c)().globalPadId;o.instructions[3]&&o.instructions[3]!==i&&(r=!0)}return s.a.createElement("span",{id:n,style:{background:this.state.showBackground?"#d1e6fc":void 0},onClick:function(t){return e.handleFieldClick(t)},onTouchEnd:function(t){return e.handleFieldClick(t)},onTouchStart:this.onTouchStart,className:""+(r?u.a["mention-qq-component-disable"]:u.a["mention-qq-component"]),ref:this.rootRef},t)},t}(c.Component),h=o(83),m=o(18),g=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(){function e(e){this.contextService=e,this.context=e.context}return e.prototype.$onInit=function(e){a.a.getInstance().registerDecorator(i.FieldType.MENTION_QQ,function(e){return function(t,o,n){return{component:s.a.createElement(f,{editor:e,layoutBox:o,fieldCode:n},t),overrideStyle:{lineHeight:"20px"}}}}(e)),i.FieldcodeManager.getInstance().addProcessor(i.FieldType.MENTION_QQ,new h.a)},e.prototype.$beforeDestroy=function(e){i.FieldcodeManager.getInstance().removeProcessor(i.FieldType.MENTION_QQ),a.a.getInstance().removeDecorator(i.FieldType.MENTION_QQ)},e=g([Object(r.i)({name:m.a.FieldcodeMentionRender,scope:0,for:["melo"]}),y("design:paramtypes",[r.f])],e)}()},252:function(e,t,o){"use strict";o.d(t,"a",(function(){return P}));var n,r,i=o(5),a=o(0),c=o(46),s=o(82),l=o(1),d=o.n(l),u=o(106),p=o.n(u),f=o(2),h=o(24),m=o(157),g=o(154),y=o(153),b=o(155),v=o(156),C=o(158),w=o(152),E=o(151),_=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),O=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};!function(e){e.None="doc-link-container-none",e.Hover="doc-link-container-hover",e.Active="doc-link-container-active"}(r||(r={}));var R=function(e){function t(t){var o=e.call(this,t)||this;return o.handleFieldClick=function(){var e=o.props.docLink;Object(f.openLinkWithCheck)(e.fileUrl,o.contextService.context.clientVars.globalPadId,o.contextService.context.clientVars.creatorId)},o.state={backgroundStats:r.None},o}return _(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.children,n=t.layoutBox,r=t.docLink,i=Object(f.twipsToPx)(n.edge.left)-6-4-4-6-6,a=this.getDocLinkStyle(r);return d.a.createElement("span",{className:p.a["doc-link-container"]+" "+p.a[this.state.backgroundStats],style:{paddingLeft:4,paddingRight:4,marginRight:6,marginLeft:6},onMouseOver:this.setBackgroundToHover.bind(this),onMouseOut:this.setBackgroundToNone.bind(this),onMouseUp:this.setBackgroundToNone.bind(this),onMouseDown:this.setBackgroundToActive.bind(this),onClick:this.handleFieldClick,onTouchStart:function(t){e.setBackgroundToActive.bind(e),t.stopPropagation(),t.preventDefault()},onTouchEnd:function(){e.setBackgroundToNone.bind(e),e.handleFieldClick()}},d.a.createElement("img",{src:a,style:{width:i,height:i,marginRight:6,alignSelf:"center"}}),o)},t.prototype.setBackgroundToHover=function(){this.setState({backgroundStats:r.Hover})},t.prototype.setBackgroundToActive=function(){this.setState({backgroundStats:r.Active})},t.prototype.setBackgroundToNone=function(){this.setState({backgroundStats:r.None})},t.prototype.getDocLinkStyle=function(e){var t=w.a;switch(e.fileExt){case h.a.WORD:t=y.a;break;case h.a.EXCEL:t=g.a;break;case h.a.FOLDER:t=b.a;break;case h.a.FOLDER_SHARE:t=E.a;break;case h.a.SLIDE:t=v.a;break;case h.a.FORM:t=m.a;break;case h.a.PDF:t=C.a}return t},O([Object(i.l)(),k("design:type",i.f)],t.prototype,"contextService",void 0),t}(l.Component),S=o(115),L=o(83),D=o(18),I=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},T=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(){function e(e){this.contextService=e}return e.prototype.$onInit=function(e){a.FieldcodeManager.getInstance().addProcessor(a.FieldType.DOC_LINK,new L.a),c.a.getInstance().registerDecorator(a.FieldType.DOC_LINK,function(e){return function(t,o,n){if(n&&n.field){var r=Object(S.b)(n.field);if(r)return{component:d.a.createElement(R,{editor:e,layoutBox:o,fieldCode:n,docLink:r,key:"field-trigger-"+o.uuid},t),overrideStyle:{paddingLeft:0,width:Object(f.twipsToPx)(o.edge.left)+Object(f.twipsToPx)(o.rect.width),textAlign:"start",height:"auto"}}}return{component:d.a.createElement(s.a,{editor:e,layoutBox:o,fieldCode:n,key:"field-trigger-"+o.uuid},t),overrideStyle:{}}}}(e))},e.prototype.$beforeDestroy=function(e){a.FieldcodeManager.getInstance().removeProcessor(a.FieldType.DOC_LINK),c.a.getInstance().removeDecorator(a.FieldType.DOC_LINK)},e=I([Object(i.i)({name:D.a.FieldcodeDoclinkRender,scope:0,for:["melo"]}),T("design:paramtypes",[i.f])],e)}()},253:function(e,t,o){"use strict";o.d(t,"a",(function(){return A}));var n,r=o(1),i=o.n(r),a=o(11),c=o.n(a),s=o(0),l=o(52),d=o(112),u=o(30),p=o.n(u),f=(o(51),o(63)),h=o.n(f),m=(o(165),o(17)),g=o(12),y=o(36),b=o.n(y),v=o(86),C=o(5),w=o(2),E=o(113),_=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),O=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e){function t(t){var o=e.call(this,t)||this;return o._permissionCode=["60007","60015"],o._docNoexistCode=["40001"],o.onClickRefresh=function(){window.location&&window.location.reload()},o.onClickRefreshAndFix=function(){var e=o.state.blockInfo?o.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{code:e}),document.dispatchEvent(t),setTimeout((function(){window.location&&window.location.reload()}),1e3)},o.onClick2Fix=function(){o.hideModal(),o.showConfirmModal()},o.onClickStartFix=function(){w.Logger.warn("clear offline data!!");var e=o.state.blockInfo?o.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{code:e}),document.dispatchEvent(t),setTimeout((function(){window.location&&window.location.reload()}),1e3)},o.onClickContact=function(){var e=o.state.blockInfo?o.state.blockInfo.errCode:"";o.workbench.emit("$requestFeedback",e)},o.onClickHow2Deal=function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("Melo_How2Deal_CopyAllData2Memory",!0,!0,{}),document.dispatchEvent(e),o.showModal()},o.onClickLearnMore=function(){window.open("https://docs.qq.com/doc/DWE9lbGhWTU9OV2VF?localnum=1&wxsdk=2.7.7")},o.doExport=function(){var e=o.contextService.context.editor;if(e&&e instanceof s.MeloEditor){var t=o.contextService.context.clientVars;o.workbench.emit("$requestExport",{editor:e,clientVars:t})}},o.showModal=function(){var e=o.state.blockInfo?o.state.blockInfo.errCode:"";e&&(-1!==o._docNoexistCode.indexOf(e)||o._permissionCode.indexOf(e));o._modal=h.a.confirm({title:"如何处理",content:o.renderContent(),footer:null})},o.hideModal=function(){o._modal&&o._modal.close()},o.showConfirmModal=function(){o._confirmModal=h.a.confirm({title:"提示",content:o.renderConfirmContent(),footer:null})},o.hideConfirmModal=function(){o._confirmModal&&o._confirmModal.close()},o._editor=o.props.editor,o.state={visible:!1},s.GlobalContext.once(v.f.BEFORE_REPLACE_URL,o.destory.bind(o),o),o}return _(t,e),t.prototype.destory=function(){s.GlobalContext.removeListener(v.f.BEFORE_REPLACE_URL,this),this._editor&&(this._editor.removeListener(m.b.ON_CHANGESET_COMMIT_REJECTED,this),this._editor.removeListener(m.b.ON_CHANGESET_CHECK_INVALID,this),this._editor.removeListener(m.b.ON_DISMISS_BLOCK_USER_EDIT,this),this._editor.removeListener(m.b.ON_DISMISS_BLOCK_OFFLINE_EDIT,this)),this.hideModal(),this.hideConfirmModal(),this.setState({visible:!1,blockInfo:void 0})},t.prototype.componentDidMount=function(){var e=this;this._editor&&(this._editor.on(m.b.ON_CHANGESET_COMMIT_REJECTED,(function(t){e.vipService.showVipToast({errorCode:t.blockInfo.errCode,nickName:Object(g.c)().userName})||e.setState({visible:!0,blockInfo:t.blockInfo}),l.a.getInstance().setPrivilege({isBlocked:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3)}),this),this._editor.on(m.b.ON_CHANGESET_CHECK_INVALID,(function(t){e.setState({visible:!0,blockInfo:t.blockInfo}),l.a.getInstance().setPrivilege({isBlocked:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3)}),this),this._editor.on(m.b.ON_DISMISS_BLOCK_USER_EDIT,(function(t){e.state.blockInfo&&e.state.blockInfo.errCode===t.target&&(e.setState({visible:!1}),Object(g.c)().isOverConNum=!1,l.a.getInstance().setPrivilege({isBlocked:!1}))}),this),this._editor.on(m.b.ON_DISMISS_BLOCK_OFFLINE_EDIT,(function(){e.setState({visible:!1}),l.a.getInstance().setPrivilege({isBlocked:!1})}),this))},t.prototype.componentWillUnmount=function(){s.GlobalContext.removeListener(v.f.BEFORE_REPLACE_URL,this),this._editor&&(this._editor.removeListener(m.b.ON_CHANGESET_COMMIT_REJECTED,this),this._editor.removeListener(m.b.ON_CHANGESET_CHECK_INVALID,this),this._editor.removeListener(m.b.ON_DISMISS_BLOCK_USER_EDIT,this),this._editor.removeListener(m.b.ON_DISMISS_BLOCK_OFFLINE_EDIT,this))},t.prototype.getNowFormatDate=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,n=e.getDate();return o>=1&&o<=9&&(o="0"+o),n>=0&&n<=9&&(n="0"+n),t+"-"+o+"-"+n},t.prototype.renderContent=function(){var e=this.state.blockInfo?this.state.blockInfo.errCode:"",t="为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。";return e&&-1!==this._permissionCode.indexOf(e)?t="编辑权限已被收回，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击刷新。":e&&-1!==this._docNoexistCode.indexOf(e)&&(t="文件已被创建者删除，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击刷新。"),!e||-1===this._docNoexistCode.indexOf(e)&&-1===this._permissionCode.indexOf(e)?i.a.createElement("div",{style:{width:"100%"}},i.a.createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},i.a.createElement("span",null,t)),i.a.createElement("div",{style:{marginTop:"5px"}},i.a.createElement("span",{style:{color:"darkgrey"}},e?"错误码:"+e+"  "+this.getNowFormatDate():"")),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},i.a.createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},"联系我们"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(b.a,{style:{marginRight:16},onClick:this.onClick2Fix},"修复"),i.a.createElement(b.a,{type:"primary",onClick:this.doExport},"导出文档")))):i.a.createElement("div",{style:{width:"100%"}},i.a.createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},i.a.createElement("span",null,t)),i.a.createElement("div",{style:{marginTop:"5px"}},i.a.createElement("span",{style:{color:"darkgrey"}},e?"错误码:"+e+"  "+this.getNowFormatDate():"")),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},i.a.createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},"联系我们"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(b.a,{style:{marginRight:16},onClick:this.onClickRefresh},"刷新"),i.a.createElement(b.a,{type:"primary",onClick:this.doExport},"导出文档"))))},t.prototype.renderConfirmContent=function(){return i.a.createElement("div",{style:{width:"100%"}},i.a.createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},i.a.createElement("span",null,"修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。")),i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},i.a.createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},"联系我们"),i.a.createElement("div",{style:{display:"flex"}},i.a.createElement(b.a,{type:"primary",style:{marginRight:16},onClick:this.onClickStartFix},"开始修复"))))},t.prototype.render=function(){var e=this.state.blockInfo?this.state.blockInfo.errMsg:"",t="";this.state.blockInfo&&this.state.blockInfo.action&&(t=this.state.blockInfo.action.join(","));var o={},n="info";-1!==t.indexOf(""+m.a.HOW2DEAL.toString())&&(o={background:"rgb(255, 125, 111)",color:"white",zIndex:9997},n="error");var r=[];-1!==t.indexOf(""+m.a.REFRESHANDFIX.toString())?r.push({text:"刷新",onClick:this.onClickRefreshAndFix}):-1!==t.indexOf(""+m.a.REFRESH.toString())&&r.push({text:"刷新",onClick:this.onClickRefresh}),-1!==t.indexOf(""+m.a.CONTACT.toString())&&r.push({text:"联系我们",onClick:this.onClickContact}),-1!==t.indexOf(""+m.a.LEARNMORE.toString())&&r.push({text:"了解详情",onClick:this.onClickLearnMore}),-1!==t.indexOf(""+m.a.HOW2DEAL.toString())&&r.push({text:"如何处理",onClick:this.onClickHow2Deal});var a=[i.a.createElement(p.a,{key:"block-user-edit-tips",style:o,action:r,type:n,visible:this.state.visible,closable:!1},e)];return i.a.createElement("div",null,a)},O([Object(C.l)(),k("design:type",C.k)],t.prototype,"featureService",void 0),O([Object(C.l)(),k("design:type",C.B)],t.prototype,"workbench",void 0),O([Object(C.l)(),k("design:type",C.f)],t.prototype,"contextService",void 0),O([Object(C.l)(),k("design:type",E.a)],t.prototype,"vipService",void 0),t}(i.a.Component);var S=o(18),L=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},D=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I={menu:[{name:"cut",content:"剪切",shortcut:{win:"Ctrl+X",mac:"⌘+X"},shouldDisabled:function(e){return!(!e.permission||e.permission.isEditable)||e.editor.isCaret()},onClick:function(e){e.editor.clipboardManager.cut()}},{name:"copy",content:"复制",shortcut:{win:"Ctrl+C",mac:"⌘+C"},shouldDisabled:function(e){return!(!e.permission||e.permission.isCopyable)||e.editor.isCaret()},onClick:function(e){e.editor.clipboardManager.copy()}},{name:"paste",content:"粘贴",shortcut:{win:"Ctrl+V",mac:"⌘+V"},shouldDisabled:function(){return!0},onClick:function(e){e.editor.clipboardManager.paste()}},{name:"select-all",content:"全选",shortcut:{win:"Ctrl+A",mac:"⌘+A"},onClick:function(e){e.editor.run("selectAll")}},{name:"undo",content:"撤销",shortcut:{win:"Ctrl+Z",mac:"⌘+Z"},shouldDisabled:function(e){return!(!e.permission||e.permission.isEditable)||!e.editor.run("isUndoAvailable")},onClick:function(e){e.editor.run("undo")}},{name:"redo",content:"重做",shortcut:{win:"Ctrl+Y",mac:"⌘+Y"},shouldDisabled:function(e){return!(!e.permission||e.permission.isEditable)||!e.editor.run("isRedoAvailable")},onClick:function(e){e.editor.run("redo")}}],contextMenu:[{name:"cut",content:"剪切",shortcut:{win:"Ctrl+X",mac:"⌘+X"},shouldDisabled:function(e){return!(!e.permission||e.permission.isEditable)||e.editor.isCaret()},shouldHide:function(e){return e.isPublish},onClick:function(e){e.editor.clipboardManager.cut()}},{name:"copy",content:"复制",shortcut:{win:"Ctrl+C",mac:"⌘+C"},shouldDisabled:function(e){return!(!e.permission||e.permission.isCopyable)||e.editor.isCaret()},onClick:function(e){e.editor.clipboardManager.copy()}},{name:"paste",content:"粘贴",shortcut:{win:"Ctrl+V",mac:"⌘+V"},shouldDisabled:function(){return!0},tooltip:function(){return"仅支持 "+(w.PlatformUtil.isMac()?"⌘":"Ctrl")+"+V 粘贴"},shouldHide:function(e){return e.isPublish},onClick:function(e){e.editor.clipboardManager.paste()}}],contextMenuMobile:[{name:"select",content:"选择",shouldHide:function(e){return!e.editor.isCaret()||e.editor.onSelection().isSelectionAtImage()||e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){var t=e.editor.service.getSelection().getStart();e.editor.surface.selectionHandler.selectWord(t)}},{name:"select_all",content:"全选",shouldHide:function(e){return e.editor.onSelection().isSelectionAtImage()||e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().range().equal(e.editor.onSelection().storyRange())||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){e.editor.surface.selectionHandler.selectAll()}},{name:"cut",content:"剪切",shouldHide:function(e){return!!e.isPublish||!(!e.permission||e.permission.isEditable)||e.editor.isCaret()||e.editor.onSelection().isSelectionAtImage()||e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){e.editor.clipboardManager.cut()}},{name:"copy",content:"复制",shouldHide:function(e){return!(!e.permission||e.permission.isCopyable)||e.editor.isCaret()||e.editor.onSelection().isSelectionAtImage()||e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){e.editor.clipboardManager.copy()}},{name:"paste",content:"粘贴",shouldHide:function(e){return!!e.isPublish||!(!e.permission||e.permission.isEditable)||e.editor.onSelection().isSelectionAtImage()||e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){e.editor.clipboardManager.paste()}},{name:"delete",content:"删除",shouldHide:function(e){return!!e.isPublish||!(!e.permission||e.permission.isEditable)||!e.editor.onSelection().isSelectionAtPlugin()||e.editor.onSelection().isSelectionAtMention()},onClick:function(e){e.editor.onSelection().delete()}}],toolbar:[{name:"undo",hasArrow:!1,preventFocus:!0,type:"icon",tooltip:"撤销",shortcut:{win:"Ctrl+Z",mac:"⌘+Z"},icon:i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("g",null,i.a.createElement("path",{stroke:"#464D5A",strokeWidth:"1.25",d:"M4 3.625h6c2.761 0 5 1.989 5 4.75s-2.239 5-5 5H3",transform:"translate(4 4.625)"}),i.a.createElement("path",{fill:"#464D5A",d:"M5 .747v5.528c0 .111-.09.2-.2.2-.036 0-.07-.009-.101-.027L.276 3.849c-.095-.056-.127-.178-.07-.274.014-.026.036-.048.061-.065L4.69.58c.092-.06.216-.035.277.057.021.033.033.071.033.11z",transform:"translate(4 4.625)"})))),onClick:function(e){e.editor.run("undo")},shouldDisabled:function(e){return!e.editor.run("isUndoAvailable")}},{name:"redo",hasArrow:!1,preventFocus:!0,type:"icon",tooltip:"重做",shortcut:{win:"Ctrl+Y",mac:"⌘+Y"},icon:i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("g",null,i.a.createElement("path",{stroke:"#464D5A",strokeWidth:"1.25",d:"M4 3.625h6c2.761 0 5 1.989 5 4.75s-2.239 5-5 5H3",transform:"matrix(-1 0 0 1 24 0) translate(4 4.625)"}),i.a.createElement("path",{fill:"#464D5A",d:"M5 .747v5.528c0 .111-.09.2-.2.2-.036 0-.07-.009-.101-.027L.276 3.849c-.095-.056-.127-.178-.07-.274.014-.026.036-.048.061-.065L4.69.58c.092-.06.216-.035.277.057.021.033.033.071.033.11z",transform:"matrix(-1 0 0 1 24 0) translate(4 4.625)"})))),onClick:function(e){e.editor.run("redo")},shouldDisabled:function(e){return!e.editor.run("isRedoAvailable")}}],mobileToolbar:[{name:"undo",iconClass:"mobile-toolbar-container-inner-undo",onClick:function(e,t){e.editor.run("undo"),t.updatePanel()},shouldDisabled:function(e){return!e.editor.run("isUndoAvailable")}},{name:"redo",iconClass:"mobile-toolbar-container-inner-redo",onClick:function(e,t){e.editor.run("redo"),t.updatePanel()},shouldDisabled:function(e){return!e.editor.run("isRedoAvailable")}}]},T=I.menu,P=I.contextMenu,M=I.contextMenuMobile,N=I.toolbar,x=I.mobileToolbar,A=function(){function e(e,t){this.store=t,this.editor=null,this.isNotFullySupportTipsOn=!1,this.context=e.context}return e.prototype.$onInit=function(e){this.editor=e,this.registerNotification();var t=document.createElement("div");t.id="block-user-edit-modal-container",document.body.appendChild(t),c.a.render(i.a.createElement(R,{editor:this.editor,context:this.context}),t),this.editor.clipboardManager.addPasteDstProcessor(s.PasteDstType.SubStory,d.b);var o=this.editor.view.getDom();o&&(o.addEventListener("copy",this.showCopyPermission),o.addEventListener("cut",this.showCopyPermission))},e.prototype.$beforeDestroy=function(){this.unregisterNotification(),this.isNotFullySupportTipsOn=!1,l.a.getInstance().setPrivilege({isBlocked:!1});var e=document.getElementById("block-user-edit-modal-container");e&&(c.a.unmountComponentAtNode(e),document.body.removeChild(e));var t=this.editor.view.getDom();t&&(t.removeEventListener("copy",this.showCopyPermission),t.removeEventListener("cut",this.showCopyPermission))},e.prototype.registerNotification=function(){var e=this;this.editor.on(s.StateNotification.DeleteContainer,(function(t){if(!t.fromServer){var o=t.anchorInfos,n=new Map;if(o){var r=e.editor.getContainerManager();r?o.forEach((function(e,t){var o=r.getAnchorRange(t,e);o&&o.isValid()?w.Logger.warn("delete story waring: unexpected story to be deleted! story id = "+t):n.set(t,e)})):w.Logger.warn("delete story waring: ContainerManager invalid!"),e.editor.service.getDocument().removeContainerStories(n)}}}),this),this.editor.on(s.ClipboardNotificationType.ON_COPY,(function(t){t&&(w.PlatformUtil.isIE()||w.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(s.ClipboardNotificationType.ON_CUT,(function(t){t&&(w.PlatformUtil.isIE()||w.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(s.ClipboardNotificationType.ON_PASTE,(function(t){t&&(w.PlatformUtil.isIE()||w.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor&&this.editor.on(s.StateNotification.ApplyDeltaCheck,(function(){e.showApplyDeltaCheckFailTips()}),this)},e.prototype.unregisterNotification=function(){this.editor.removeListener(s.StateNotification.DeleteContainer,this),this.editor.removeListener(s.ClipboardNotificationType.ON_COPY,this),this.editor.removeListener(s.ClipboardNotificationType.ON_CUT,this),this.editor.removeListener(s.ClipboardNotificationType.ON_PASTE,this),this.editor.removeListener(s.StateNotification.DeleteContainer,this),this.editor.removeListener(s.StateNotification.ApplyDeltaCheck,this)},e.prototype.showNotFullySupportTips=function(){var e=this;this.isNotFullySupportTipsOn||(p.a.show({message:"复制粘贴可能会有格式丢失，推荐使用Chrome浏览器或下载腾讯文档客户端。",type:"info",autoClose:!1,closable:!0,action:"立即下载",onClickAction:function(){window.open("https://qd.myapp.com/myapp/qqteam/TencentDocs/Down/TencentDocsSetup.exe")},onClose:function(){e.isNotFullySupportTipsOn=!1}}),this.isNotFullySupportTipsOn=!0)},e.prototype.showCopyPermission=function(){l.a.getInstance().canCopy||p.a.show({message:"文档作者限制了查看者的操作权限，无法复制内容。",autoClose:!0,duration:3e3})},e.prototype.updatePanel=function(){var e=this.store.get(C.d.MobilePanel);e.next(e.getValue())},e.prototype.showApplyDeltaCheckFailTips=function(){p.a.show({message:"本次操作内容过多，无法应用。建议删减后重试。",type:"info",autoClose:!0,closable:!1,duration:3e3}),s.ReportHelper.tdwReport&&s.ReportHelper.tdwReport({opername:"doc_core",module:"data",action:"verify"})},e=L([Object(C.i)({menuItems:T,contextMenuItems:P,contextMenuMobileItems:M,toolbarItems:N,mobileToolbarItems:x,name:S.a.CoreEdit,scope:0,for:["melo"]}),D("design:paramtypes",[C.f,C.x])],e)}()},254:function(e,t,o){"use strict";o.d(t,"a",(function(){return R}));var n,r=o(0),i="scriptEntries",a="USERAGENT",c="visibility",s="version",l={FirstPaint:"首次渲染时间",getClientVarsOnlineStart:"在线取数据开始",getClientVarsOnlineEnd:"在线取数据结束",getClientVarsOnlineCount:"在线取数据次数",getClientVarsOnlineCost:"在线取数据耗时",getClientVarsDBStart:"数据库取数据开始",getClientVarsDBEnd:"数据库取数据结束",getClientVarsDBCompose:"数据库取数据compose耗时",getClientVarsDBCost:"数据库取数据耗时",getClientVarsSource:"取数据来源",getClientVarsStart:"取数据开始",getClientVarsEnd:"取数据结束",getClientVarsCost:"取数据耗时",getOfflineDataCost:"读取未提交数据耗时",FirstContentPaint:"首次内容渲染时间",TimeToFirstByte:"TTFB",TimeToLasterByte:"TTLB",WorkbenchInit:"初始化workbench的耗时",PadEditorInit:"初始化padEditor耗时",FeaturesInitEnd:"所有feature加载完结束时间",FeaturesRenderInitEnd:"渲染feature加载完结束时间",FeaturesPublishInitEnd:"发布态feature加载完结束时间",FeaturesReadonlyInitEnd:"只读feature加载完结束时间",FeaturesEditInitEnd:"可编辑feature加载完结束时间",FirstLayoutStart:"首页排版&渲染开始",FirstLayoutCost:"首页排版&渲染耗时",FirstRender:"首屏渲染可见时间",FirstInteraction:"首次可编辑时间",TotalRender:"所有内容渲染完成",LoadComplete:"所有内容加载完成",Visibility:"是否处于可见状态",UserAgent:"浏览器UA",Version:"RAVEN版本",ScriptLoading:"script下载总时长",ScriptEntries:"script下载项"};!function(e){e.PERFORMANCE_KEY_FROM_OFFLINE="PERFORMANCE_KEY_FROM_OFFLINE"}(n||(n={}));var d=o(78),u=o(243),p=o(12),f=o(33),h=o(5),m=o(2),g=o(32),y=o(18),b=o(62),v=function(){return(v=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},C=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},w=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o},E=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a},_=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(E(arguments[t]));return e};var O=new Promise((function(e){var t,o,n,i,a=(t=window,o="load",n=function(){a(),e()},i=function(){n()},t instanceof r.MeloEditor?(t.on(o,i),function(){t.removeListener(o,i)}):(t.addEventListener(o,i),function(){t.removeEventListener(o,i)}))})),k=function(){function e(e){this.performance=window.performance,this.totalPromises=[],this.isReportedLargeDoc=!1,this.replaceUrlTime=0,this.meloUpCost=0,this.quickLookShowTime=0,this.isDestroyed=!1,this.renderFinishTimeStamp=0,this.editor=e,this.secretId=Object(d.a)(),this.init()}return e.prototype.init=function(){if(this.performance&&this.performance.timing){this.timing=this.performance.timing,this.reportData=this.createDefaultData(),this.reportDataBeacon=this.ceateDefaultDataBeacon();var e=u.a.getInstance(this.secretId).replaceUrlTime;this.replaceUrlTime=e,this.registPromises(),this.handleReport()}this.monitorLongTask()},e.prototype.destroy=function(){this.isDestroyed=!0,this.editor.removeListener(r.RenderNotificationTypes.FIRST_RENDER,this),r.GlobalContext.removeListener("feature_loaded",this),this.editor.removeListener(r.RenderNotificationTypes.RENDER_FINISH,this),this.editor.removeListener(r.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,this),this.stopObserveLargeDoc(),this.isReportedLargeDoc=!1,this.meloUpCost=0,this.replaceUrlTime=0},e.prototype.splitReportDataForTdw=function(){var e=this,t={},o={};return Object.keys(this.reportData).forEach((function(n){n===i||n===a?t[n]=e.reportData[n]:o[n]=e.reportData[n]})),{ver8:JSON.stringify(o),ver10:JSON.stringify(t)}},e.prototype.handleReport=function(){var e=this;this.totalPromises.forEach((function(t){t.then((function(t){Object.keys(t).forEach((function(o){var n=t[o],r=function(e){return l[e]}(o);e.reportData[o]=n,r&&m.Logger.info("Timing| "+r+": "+JSON.stringify(n))}))}))})),Promise.all(this.totalPromises).then((function(){m.PerfUtil.clearMarks();var t=JSON.stringify(e.reportData);if(window.loadPerfInfo=t,!Object(m.getUrlParameter)("prerender")&&!e.isDestroyed){if(t.FIRST_RENDER<=0||t.FIRST_INTERACTION<=0){m.Logger.info("PerformanceHandler handleReport NegativeError reportInfo = "+t);var o=t.FIRST_RENDER<=0?"Word_FirstRenderNegativeError":"Word_FirstInteractionNegativeError";e.reportToWeblog(o),r.ReportHelper.captureException(r.MonitorName.PERFORMANCE_REPORT_NEGATIVE_ERROR,{},new Error(o))}if(e.start<=0)m.Logger.info("PerformanceHandler handleReport start invalid!!!");else{var n=e.splitReportDataForTdw(),i=n.ver8,a=n.ver10;r.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cost",file_type:"1",ver7:JSON.stringify(e.statisticInfo||{}),ver8:i,ver9:JSON.stringify({offline_package:window.__isOfflinePkg?1:0,container:e.replaceUrlTime?1:0,replaceCount:u.a.replaceCount}),ver10:a}),e.handlePendingReportData(),e.beaconReport(),e.reportToAegis(),e.reportLargeDoc(),e.isReportedLargeDoc||e.startObserveLargeDoc(),e.startEditPerfReport()}}}))},e.prototype.reportOpenWebEvent=function(){var e=this,t=window.location.href;t=b.a.getInstance().recordAndStripPerformanceValueFromUrl(t);var o=b.a.getInstance().getReplaceUrlPerformanceMetrics(),n=o.createTS,r=o.templateId;b.a.getInstance().clearReplaceUrlPerformanceMetrics();var i=b.a.getInstance().getCSID();if(b.a.getInstance().clearCSID(),window.history.replaceState(null,"",t),n){var a=parseInt(n,10);this.reportOpenWebCost(!0,a,r)}else i&&window&&window.mqq.invoke("docx","getMetric",{csid:i},(function(t){if(t&&t.data){var o=t.data,n=o.doc_item_click_timestamp,r=o.doc_loadurl_timestamp,a=w(o,["doc_item_click_timestamp","doc_loadurl_timestamp"]),c=r-n,s=e.start-r;e.reportOpenWebCost(!1,n,void 0,{clickToLoadCost:c,loadToStartCost:s},a)}else m.Logger.error("getMetric for "+i+" failed "+t)}))},e.prototype.reportOpenWebCost=function(e,t,o,n,i){var a=e?1:0,c=Math.round(this.renderFinishTimeStamp-t),l=c;if(this.quickLookShowTime&&(c=Math.round(this.quickLookShowTime-t)),l<=0||c<=0)m.Logger.error("clickToEditCost or clickToShowCost is not legal: clickToEditCost:"+l+", clickToShowCost:"+c);else{var d=JSON.stringify(v({clickToEditCost:l,clickToShowCost:c},n)),p=JSON.stringify(v({offline_package:window.__isOfflinePkg?1:0,container:this.replaceUrlTime?1:0,replaceCount:u.a.replaceCount},i));r.ReportHelper.tdwReport({opername:"doc_core",module:"open",action:"open_web",file_type:"1",obj3:d,ver5:a,ver6:o,ver9:p,ver10:JSON.stringify({version:this.reportData[s]})})}},e.prototype.handlePendingReportData=function(){var e=this.reportData,t=this.reportDataBeacon;Object.getOwnPropertyNames(e).forEach((function(o){t.hasOwnProperty(o)&&(t[o]=e[o])})),this.replaceUrlTime>0&&(e.scriptLoading=0)},e.prototype.beaconReport=function(){var e=this.reportDataBeacon;e.usingOfflinePkg=window.__isOfflinePkg?1:0,e.usingContainer=this.replaceUrlTime?1:0,e.usingQuickLook=this.quickLookShowTime?1:0,e.isLargeDoc=this.statisticInfo&&this.statisticInfo.dom_num>=2e4?1:0;var t=JSON.parse(JSON.stringify(e)),o=["usingOfflinePkg","usingContainer","usingQuickLook","isDebugEnv"];Object.getOwnPropertyNames(t).forEach((function(e){t[e]||o.includes(e)||delete t[e]})),r.ReportHelper.onUserAction("melo_container_performance",t),Object(r.isDebugEnviroment)()&&(m.Logger.log("秒看："+(this.quickLookShowTime?"[有]":"[无]")+", 离线包: "+(window.__isOfflinePkg?"[开]":"[关]")+", 容器： "+(this.replaceUrlTime>0?"[开]":"[关]")),m.Logger.log("Beacon reportInfo = "+JSON.stringify(t)))},e.prototype.reportToWeblog=function(e,t){void 0===t&&(t=18e4);var o=Date.now(),n=o-t;window.log&&window.log.report(e,{query:{startTs:n,endTs:o}})},e.prototype.registPromises=function(){var e=this,t=new Promise((function(t){var o,n=e.timing;if(n){var r=n.responseEnd-n.requestStart,i=n.responseStart-n.requestStart;return t(((o={}).TimeToFirstByte=i,o.TimeToLasterByte=r,o))}return t({})})),o=new Promise((function(t){var o,n=e.timing;if(n){var r=n.responseEnd-e.start,i=e.firstPaint||r,a=e.firstContentPaint||r;e.replaceUrlTime>0&&(i=0,a=0),t(((o={}).FirstPaint=Math.round(i),o.FirstContentPaint=Math.round(a),o))}return t({})})),n=new Promise((function(t){e.editor.once(r.RenderNotificationTypes.FIRST_RENDER,(function(){var o=e.start,n=m.PerfUtil.now();e.renderFinishTimeStamp=n;var r={};window.getClientVarsCost&&(r.getClientVarsOnlineStart=window.getClientVarsCost.getClientVarsOnlineStart-e.start,r.getClientVarsOnlineEnd=window.getClientVarsCost.getClientVarsOnlineEnd-e.start,r.getClientVarsOnlineCount=window.getClientVarsCost.getClientVarsOnlineCount,r.getClientVarsOnlineCost=window.getClientVarsCost.getClientVarsOnlineCost,r.getClientVarsDBStart=window.getClientVarsCost.getClientVarsDBStart-e.start,r.getClientVarsDBEnd=window.getClientVarsCost.getClientVarsDBEnd-e.start,r.getClientVarsDBCompose=window.getClientVarsCost.getClientVarsDBCompose,r.getClientVarsDBCost=window.getClientVarsCost.getClientVarsDBCost,r.getClientVarsSource=window.getClientVarsCost.getClientVarsSource,r.getClientVarsStart=window.getClientVarsCost.getClientVarsStart-e.start,r.getClientVarsEnd=window.getClientVarsCost.getClientVarsEnd-e.start,r.getClientVarsCost=window.getClientVarsCost.getClientVarsCost);var i=m.PerfUtil.getMark("firstLayoutStart");i&&(r.firstLayoutStart=Math.round(i-o),r.firstLayoutCost=Math.round(n-i));var a=n-o,c=a,s=u.a.getInstance(e.secretId).quickLookShowTime;s&&(e.quickLookShowTime=s,a=s-e.start),(a<=0||c<=0)&&m.Logger.info("PerformanceHandler firstRenderPromise","start:"+o+" curTime:"+n+" quickLookShowTime:"+s+" replaceUrlTime:"+e.replaceUrlTime+" navigationStart:"+e.timing.navigationStart+" meloUpCost:"+e.meloUpCost),window.timeFirstShown=a,window.timeFirstEdit=c,r.FIRST_RENDER=Math.round(a),r.FIRST_INTERACTION=Math.round(c),t(r)}),e)})),a=n.then((function(){return O})).then((function(){var t,o=((t={}).loadComplete=Math.round(m.PerfUtil.now()-e.start),t),n=e.performance&&e.performance.getEntries&&e.performance.getEntries(),r=window.immeJs||[];if(n){var a=n.filter((function(e){if("resource"===e.entryType&&"script"===e.initiatorType){var t=e.name;return r.reduce((function(e,o){return e||t.indexOf(o)>=0}),!1)}return!1})),c=Math.max.apply(Math,_(a.map((function(e){return e.startTime+e.duration})),[0]))-Math.min.apply(Math,_(a.map((function(e){return e.startTime})),[0]));o.scriptLoading=Math.round(c),o[i]=a.map((function(e){var t=e.name.split("/");return{name:t[t.length-1],duration:Math.round(e.duration)}}))}return o})),s=n.then((function(){return new Promise((function(t){r.GlobalContext.once("feature_loaded",(function(){var o;t(((o={}).workbenchInitBegin=Math.round(m.PerfUtil.getMark("workbenchInitBegin")-e.start),o.padEditorInitBegin=Math.round(m.PerfUtil.getMark("padEditorInitBegin")-e.start),o.featuresInitBegin=Math.round(m.PerfUtil.getMark("featuresInitBegin")-e.start),o.workbenchInit=Math.round(m.PerfUtil.measure("workbenchInitBegin","workbenchInitEnd")),o.padEditorInit=Math.round(m.PerfUtil.measure("padEditorInitBegin","padEditorInitEnd")),o.featuresInit=Math.round(m.PerfUtil.measure("featuresInitBegin","featuresInitEnd")),o.featuresInitEnd=Math.round(m.PerfUtil.getMark("featuresInitEnd")-e.start),o.featuresRenderInitEnd=Math.round(m.PerfUtil.getMark("featuresRenderInitEnd")-e.start),o.featuresPublishInitEnd=Math.round(m.PerfUtil.getMark("featuresPublishInitEnd")-e.start),o.featuresReadonlyInitEnd=Math.round(m.PerfUtil.getMark("featuresReadonlyInitEnd")-e.start),o.featuresEditInitEnd=Math.round(m.PerfUtil.getMark("featuresEditInitEnd")-e.start),o))}),e)}))})),l=n.then((function(){return new Promise((function(t){e.editor.once(r.RenderNotificationTypes.RENDER_FINISH,(function(){var o=m.PerfUtil.now()-e.start,n={};window.timeTotalRendered=o,n.totalRender=Math.round(o),window.visibilitychangeStrForReport&&(n[c]=window.visibilitychangeStrForReport),e.statisticInfo=e.editor.statisticInfo,window.getClientVarsCost&&(n.getOfflineDataCost=window.getClientVarsCost.getOfflineDataCost),t(n)}),e)}))}));this.totalPromises=[t,o,n,s,l,a]},e.prototype.createDefaultBaseData=function(){return{TimeToFirstByte:0,TimeToLasterByte:0,FirstPaint:0,FirstContentPaint:0,getClientVarsOnlineStart:0,getClientVarsOnlineEnd:0,getClientVarsOnlineCount:0,getClientVarsOnlineCost:0,getClientVarsDBStart:0,getClientVarsDBEnd:0,getClientVarsDBCompose:0,getClientVarsDBCost:0,getClientVarsSource:"",getClientVarsStart:0,getClientVarsEnd:0,getClientVarsCost:0,getOfflineDataCost:0,workbenchInitBegin:0,workbenchInit:0,padEditorInitBegin:0,padEditorInit:0,featuresInitBegin:0,featuresInit:0,featuresInitEnd:0,featuresRenderInitEnd:0,featuresReadonlyInitEnd:0,featuresPublishInitEnd:0,featuresEditInitEnd:0,firstLayoutStart:0,firstLayoutCost:0,FIRST_RENDER:0,FIRST_INTERACTION:0,totalRender:0,totalRenderTable:0,loadComplete:0,scriptLoading:0}},e.prototype.createDefaultData=function(){return v(v({},this.createDefaultBaseData()),{scriptEntries:"",visibility:document.visibilityState,USERAGENT:navigator.userAgent,version:window.__globalReleaseVersion||""})},e.prototype.ceateDefaultDataBeacon=function(){return v(v({},this.createDefaultBaseData()),{usingOfflinePkg:0,usingContainer:0,usingQuickLook:0,isDebugEnv:Object(r.isDebugEnviroment)()?1:0,isLargeDoc:0,platformInfo:Object(g.getPlatform)()})},e.prototype.getPerformancePaintTiming=function(e){var t=this.performance&&this.performance.getEntriesByName&&this.performance.getEntriesByName(e);if(t&&t.length>0){var o=t[0];return o.startTime+o.duration}},Object.defineProperty(e.prototype,"firstPaint",{get:function(){return this.getPerformancePaintTiming("first-paint")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstContentPaint",{get:function(){return this.getPerformancePaintTiming("first-contentful-paint")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){var e=this.timing?this.timing.navigationStart:0;return 1===Object(p.c)().collab_client_vars.isMeloUp&&"number"==typeof Object(p.c)().collab_client_vars.meloUpCost&&(this.meloUpCost=Object(p.c)().collab_client_vars.meloUpCost||0,e+=Object(p.c)().collab_client_vars.meloUpCost||0),this.replaceUrlTime>0&&(e=this.replaceUrlTime),e},enumerable:!0,configurable:!0}),e.prototype.reportToAegis=function(){var e=this;if(window.aegis){var t=window.aegis,o=this.statisticInfo&&this.statisticInfo.dom_num>=2e4;Object.keys(this.reportData).forEach((function(n){if(!([c,a,s,i].indexOf(n)>=0)){var r=n+(o?"_large":""),l=e.reportData[n];l<=0||(f.a.isDevEvn()&&m.Logger.log("Timing|report key:"+r+",time:"+l),t.reportTime(r,l))}}))}},e.prototype.reportLargeDoc=function(){if(!this.isReportedLargeDoc&&this.statisticInfo&&this.statisticInfo.dom_num>=2e4){var e=localStorage&&localStorage.getItem("tdsourcetag");r.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page_large",source3:e||"",obj3:m.PlatformUtil.getBrowser(),ver5:1===Object(p.c)().collab_client_vars.dirty?"limited":"normal",ver7:"melo"}),this.isReportedLargeDoc=!0}},e.prototype.startObserveLargeDoc=function(){var e=this;this.largeDocObserver=new MutationObserver(Object(m.throttle)((function(){e.statisticInfo=e.editor.statisticInfo,e.reportLargeDoc(),e.isReportedLargeDoc&&e.stopObserveLargeDoc()}),5e3));var t=this.editor.getRoot(),o=t&&t.querySelector(".melo-page-view");o&&this.largeDocObserver.observe(o,{childList:!0,subtree:!0})},e.prototype.stopObserveLargeDoc=function(){this.largeDocObserver&&this.largeDocObserver.disconnect()},e.prototype.startEditPerfReport=function(){var e=this;this.editor.on(r.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,(function(){var t=e.editor.perfHandler,o=m.PerfUtil.now();if(!(o-t.lastTime<18e5)){t.lastTime=o;var n=JSON.stringify(e.statisticInfo||{}),i=e.editor.perfInfo,a=JSON.stringify(i);if(r.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"edit_time_cost",file_type:"1",ver7:n,ver8:a}),f.a.isDevEvn()&&m.Logger.log("Timing|"+a),window.aegis){var c=window.aegis,s=e.statisticInfo&&e.statisticInfo.dom_num>=2e4;Object.keys(i).forEach((function(e){var t=i[e];if(!(t<=0)){var o=e+(s?"_large":"");c.reportTime(o,t)}}))}}}),this)},e.prototype.monitorLongTask=function(){var e=this;if(f.a.isDevEvn()&&m.PlatformUtil.isChrome())try{new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if(t.duration>=500){var o=e.editor.perfInfo;m.Logger.warn("longTask|duration:"+t.duration+",perf:"+JSON.stringify(o))}}))})).observe({entryTypes:["longtask"]})}catch(e){}},e}(),R=function(){function e(){}return e.prototype.$onInit=function(e){this.performanceManager=new k(e)},e.prototype.$beforeDestroy=function(){this.performanceManager&&(this.performanceManager.destroy(),this.performanceManager=void 0)},e=C([Object(h.i)({name:y.a.PerformanceReport,scope:0,for:["melo"]})],e)}()},256:function(e,t,o){"use strict";o.d(t,"a",(function(){return g}));var n=o(5),r=o(11),i=o.n(r),a=o(1),c=o.n(a),s=[{keyBindings:{win:n.n.CTRL_WIN+n.o.F1,mac:n.n.COMMAND+n.o.F1},callback:function(e,t){t.toggleTitlebar()}}],l=[{name:"file",content:""},{name:"more",content:""},{name:"play",content:""},{name:"insert",content:""},{name:"smart-tools",content:""}],d=[{name:"toolbar-insert",type:"text",icon:c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("path",{fill:"#444D5B",fillRule:"nonzero",d:"M12 4.5c4.142 0 7.5 3.358 7.5 7.5 0 4.142-3.358\n            7.5-7.5 7.5-4.142 0-7.5-3.358-7.5-7.5 0-4.142 3.358-7.5 7.5-7.5zm0 1.25c-3.452 0-6.25 2.798-6.25\n            6.25s2.798 6.25 6.25 6.25 6.25-2.798 6.25-6.25S15.452 5.75 12 5.75zM12.61 8v3.369l3.39.001v1.25l-3.39-.001V16h-1.25v-3.381L8\n            12.62v-1.25l3.36-.001V8h1.25z"}))),text:"插入",tooltip:"图片/表格等",respectPermission:!1,dropDownContent:n.s,dropDownContentProps:function(){return{align:"left",name:"insert",mode:"menu"}}},{name:"smart-tools",type:"icon",tooltip:"智能工具",icon:c.a.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},c.a.createElement("g",{id:"toolbar/ai/tools",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c.a.createElement("rect",{id:"矩形备份",fill:"#E4E4E4",opacity:"0",x:"0",y:"0",width:"24",height:"24"}),c.a.createElement("path",{d:"M13.35,18.7 C13.7089851,18.7 14,18.9910149 14,19.35 C14,19.7089851 13.7089851,20 13.35,20\n            L10.65,20 C10.2910149,20 10,19.7089851 10,19.35 C10,18.9910149 10.2910149,18.7 10.65,18.7 L13.35,18.7\n            Z M12,3.7 C15.5898509,3.7 18.5,6.61014913 18.5,10.2 C18.5,12.7072927 17.0803787,14.8830151 15.0010736,15.9672297\n            L15,16.7 C15,17.2522847 14.5522847,17.7 14,17.7 L10,17.7 C9.44771525,17.7 9,17.2522847 9,16.7 L8.99992214,15.9677488\n            C6.92007453,14.8837097 5.5,12.7076929 5.5,10.2 C5.5,6.61014913 8.41014913,3.7 12,3.7 Z M12,5 C9.1281193,5 6.8,7.3281193\n            6.8,10.2 C6.8,12.1599837 7.89308955,13.9248725 9.60077919,14.8149388 C9.98744585,15.0164737 10.2443766,15.3964775\n            10.2919336,15.8236521 L10.2999221,15.9676106 L10.3,16.4 L13.7,16.4 L13.701075,15.9653251 C13.7017129,15.5299336\n            13.9198909,15.1272715 14.2762292,14.8880367 L14.4000168,14.8145239 C16.1072712,13.9243081 17.2,12.1596628\n            17.2,10.2 C17.2,7.3281193 14.8718807,5 12,5 Z M12.7706682,7 C12.7913111,7 12.805073,7.00719424 12.811954,7.02158273\n            L12.8274362,7.04766187 L12.8274362,7.04766187 L12.8325969,7.07913669 L12.5573583,9.74100719 L13.9335515,9.74100719\n            C13.9587862,9.74086739 13.9822622,9.75450338 13.9954802,9.77697842 C14.0000675,9.79136691 14.0015966,9.80895284\n            13.9980287,9.82547295 L13.9885992,9.84892086 L11.2293318,13.971223 L11.2043883,13.9910072 L11.2043883,13.9910072\n            L11.1742841,14 L11.1261173,14 C11.1054744,14 11.0848315,13.9928058 11.0710696,13.9784173 L11.0590279,13.9523381\n            L11.0590279,13.9523381 L11.0573076,13.9208633 L11.4219988,11.2086331 L10.0664485,11.2086331 C10.0389246,11.2086331\n            10.0182817,11.1942446 10.0045198,11.1726619 C9.99993248,11.1582734 9.99840338,11.1406875 10.0019713,11.1241673\n            L10.0114008,11.1007194 L12.6399299,7.02877698 L12.6648734,7.00899281 L12.6648734,7.00899281 L12.6949776,7\n            L12.7706682,7 Z",id:"形状",fill:"#464D5A",fillRule:"nonzero"}))),respectPermission:!1,dropDownContent:n.s,dropDownContentProps:function(){return{align:"left",name:"smart-tools",mode:"menu"}}},{name:"titlebar-toggle",type:"icon",respectPermission:!1,icon:function(e){var t=e.store.getValue("isTitlebarShowed");return c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{transform:"rotate("+(t?"0":"180")+"deg)"},width:"24",height:"24",viewBox:"0 0 24 24"},c.a.createElement("g",{fill:"none",fillRule:"evenodd"},c.a.createElement("path",{d:"M0 0H24V24H0z"}),c.a.createElement("path",{fillRule:"nonzero",stroke:"#464D5A",strokeWidth:"1.35",d:"M8 19L8 11 16 11",transform:"rotate(45 12 15)"})))},tooltip:function(e){return e.store.getValue("isTitlebarShowed")?"收起":"展开"},shortcut:{win:"Ctrl+F1",mac:"⌘+F1"},onClick:function(e,t){t.toggleTitlebar()}}],u=o(18),p=o(159),f=o(47),h=function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},m=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},g=function(){function e(e,t,o,n){var r=this;this.store=e,this.toolbarService=t,this.configService=n,this.store.register("isTitlebarShowed",!0),this.store.register("docTitle","腾讯文档"),this.store.register("isLogin",!0),this.store.register("isEditable",!0),this.store.register("canEditTitle",!1),this.store.register("menuActive",!1),this.store.register("menuHover","none"),this.store.register("menuLastHover","none"),o.listen("$onInjectContext",(function(e){"permission"===e.key&&(r.setEditable(e.value.isEditable),o.listen("$editableChanged",(function(e){r.setEditable(e)})))})),o.listen("$featureLoaded",(function(){r.setLoginStatus(o.context.clientVars.isLogin)}))}return e.prototype.setEditable=function(e){this.store.update("isEditable",e)},e.prototype.setTitleEditable=function(e){this.store.update("canEditTitle",e)},e.prototype.setLoginStatus=function(e){this.store.update("isLogin",e)},e.prototype.hydrate=function(e,t){var o=document.getElementById(e),n=p.b.flagMap[e],r=!0;n&&!this.configService.get("common.titlebar."+n)&&(r=!1),o&&r&&i.a.render(t,o)},e.prototype.toggleTitlebar=function(){var e=this.store.getValue("isTitlebarShowed");this.store.update("isTitlebarShowed",!e),this.toolbarService.$forceUpdate()},e=h([Object(n.i)({name:u.a.Titlebar,scope:1,keymap:s,toolbarItems:d,menuItems:l}),m("design:paramtypes",[n.x,n.z,n.B,f.a])],e)}()},43:function(e,t,o){e.exports={scrollable:"scrollable--19jDT",zoomable:"zoomable--3Agw7","zoomable-content":"zoomable-content--1lxUj"}},46:function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"b",(function(){return s}));var n=o(0),r=o(82),i=o(1),a=o.n(i),c=function(){function e(){this.fieldCodeRenderMap=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.getFieldcode=function(e,t){if(e){var o=e.getFieldEngine();if(o){var n=o.getFieldCode(t.begin());if(n)return n}}return""},e.getFieldInfo=function(t,o){var r=t.getRangeFromIndex(o.firstIndex,o.lastIndex),i=e.getFieldcode(t,r),a=n.FieldcodeManager.getInstance().getFieldcodeInfo(i);return i.length>0&&a?{field:a,range:r}:null},e.prototype.getRegisteredDecorator=function(e){return this.fieldCodeRenderMap.get(e)},e.prototype.registerDecorator=function(e,t){this.fieldCodeRenderMap.set(e,t)},e.prototype.removeDecorator=function(e){this.fieldCodeRenderMap.delete(e)},e}();function s(e){return function(t,o){var i,s=c.getFieldInfo(e,o)||void 0;return Object(n.isTextLineFragmentBox)(o)&&o.firstChild instanceof n.TextFieldCharBox&&(i=c.getInstance().getRegisteredDecorator(o.subType))?i(t,o,s):{component:a.a.createElement(r.a,{editor:e,layoutBox:o,fieldCode:s,key:"field-trigger-"+o.uuid},t),overrideStyle:{}}}}},50:function(e,t,o){e.exports={"zoom-level-bar":"zoom-level-bar--RogW0","zoom-level-text":"zoom-level-text--302pD","zoom-button":"zoom-button--3mpm5","zoom-out-button":"zoom-out-button--145p9","zoom-in-button":"zoom-in-button--19RFI","edge-right-tooltip":"edge-right-tooltip--ohlDp"}},56:function(e,t,o){e.exports={"fieldcode-component":"fieldcode-component--1jsDT","fieldcode-dropdown":"fieldcode-dropdown--15nt5","fieldcode-dropdown-button":"fieldcode-dropdown-button--JuEy1","fieldcode-mouse-link":"fieldcode-mouse-link--azssF","fieldcode-dropdown-backdrop":"fieldcode-dropdown-backdrop--1M8sA","toolbar-button-arrow":"toolbar-button-arrow--3Jyxs"}},69:function(e,t,o){"use strict";o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return r}));var n=.05,r=function(e,t){return void 0===t&&(t=0),Number(Math.round(Number(e+"e"+t))+"e-"+t)}},71:function(e,t,o){e.exports={brand_container:"brand_container--2iQZo","no-back":"no-back--3CjY9",brand_logo_new:"brand_logo_new--DxtbE",brand_back:"brand_back--3gn5f","keyframes-logo":"keyframes-logo--1whis"}},82:function(e,t,o){"use strict";o.d(t,"a",(function(){return g}));var n,r=o(1),i=o.n(r),a=o(0),c=o(111),s=o.n(c),l=o(72),d=o.n(l),u=o(53),p=o.n(u),f=o(56),h=o.n(f),m=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),g=function(e){function t(t){var o=e.call(this,t)||this;return o.onMouseEnter=function(){var e=o.props.layoutBox,t=o.getFieldInfo();if(t){var n=e.children[1].text,r=a.FieldcodeManager.getInstance().getProcessor(t.fieldName);if(!r)return;var i=r.getDropdownItems(t,n);(!r.isAutoUpdate||i.length>0)&&r.isShowDropdowns&&o.setState({showButton:!0,dropdowns:i,isAutoUpdate:r.isAutoUpdate}),r.isShowHover&&o.setState({showBackground:!0})}},o.onMouseLeave=function(){o.setState({showBackground:!1,showButton:!1,showDropdown:!1})},o.handleDropdownClick=function(){o.setState({showDropdown:!0});var e=o.getFieldInfo();if(e){var t=a.FieldcodeManager.getInstance().getProcessor(e.fieldName);if(!t)return;t.afterShowDropdown()}},o.hideDropdown=function(){o.setState({showDropdown:!1,showBackground:!1,showButton:!1})},o.handleMenuClick=function(e){if("update-field"!==e){var t=parseInt(e.replace("field-dropdown-",""),10);if(t>=0&&o.fieldRange){var n=o.state.dropdowns[t].onClick;n&&n(o.fieldRange)}o.hideDropdown()}else o.hideDropdown()},o.handleFieldClick=function(){var e=o.props.layoutBox,t=o.getFieldInfo();if(t){var n=a.FieldcodeManager.getInstance().getProcessor(t.fieldName);if(!n)return;n.handleFieldClick(t.instructions[0],e)}},o.rootRef=i.a.createRef(),o.state={showBackground:!1,showButton:!1,showDropdown:!1,dropdowns:[],isAutoUpdate:!1},o}return m(t,e),t.prototype.getFieldInfo=function(){var e=this.props.fieldCode,t=e?e.field:null;return this.fieldRange=e?e.range:null,t},t.prototype.render=function(){var e=this.props.children;return i.a.createElement("span",{style:{background:this.state.showBackground?"#d1e6fc":void 0},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.handleFieldClick,className:h.a["fieldcode-component"],ref:this.rootRef},this.state.showButton&&i.a.createElement(d.a,{dropContent:i.a.createElement(p.a,{style:{width:110,transform:"translate(-50%, 0)",position:"relative",left:7},onClick:this.handleMenuClick},!this.state.isAutoUpdate&&i.a.createElement(p.a.Item,{id:"update-field"},"更新域"),!this.state.isAutoUpdate&&this.state.dropdowns.length>0&&i.a.createElement(s.a,null),this.state.dropdowns.map((function(e,t){return i.a.createElement(p.a.Item,{className:e.checked?"checked":"",key:"field-dropdown-"+t,id:"field-dropdown-"+t},e.content)}))),visible:this.state.showDropdown,className:h.a["fieldcode-dropdown"]},i.a.createElement("button",{className:h.a["fieldcode-dropdown-button"]+" "+h.a["toolbar-button-arrow"],onClick:this.handleDropdownClick})),this.state.showButton&&i.a.createElement("div",{className:h.a["fieldcode-mouse-link"]}),this.state.showDropdown&&i.a.createElement("div",{className:h.a["fieldcode-dropdown-backdrop"],onClick:this.hideDropdown}),e)},t}(r.Component)},83:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n,r=o(0),i=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=function(e){function t(){var t=e.call(this)||this;return t.isAutoUpdate=!1,t.isInlineBlock=!0,t.isShowDropdowns=!1,t.isShowHover=!1,t}return i(t,e),t.prototype.parse=function(e,t){return""},t}(r.FieldcodeProcessor)},87:function(e,t,o){e.exports={"melo-doc-title":"melo-doc-title--HYO1b","melo-doc-title-readonly":"melo-doc-title-readonly--3gCqV"}}}]);
//# sourceMappingURL=doc-pc-features.js.map