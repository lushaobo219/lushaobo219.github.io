(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{19:function(t,e,r){"use strict";r.d(e,"a",(function(){return _t})),r.d(e,"b",(function(){return Rt})),r.d(e,"c",(function(){return Dt})),r.d(e,"d",(function(){return Ot})),r.d(e,"e",(function(){return It})),r.d(e,"f",(function(){return R})),r.d(e,"g",(function(){return D})),r.d(e,"h",(function(){return vt}));var a,o=r(4),n=r(0),i=r(2),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function p(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var a,o,n=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(t){o={error:t}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}a||(a={});var h,u,b=[];(u=h||(h={})).StoryId="flowid",u.StoryType="story-type",u.ShadingType="doc-pg-shading-type",u.ShadingValue="doc-pg-shading-value";var g,d=[h.StoryId,h.ShadingType,h.ShadingValue];!function(t){t.MarginTop="doc-pg-top",t.MarginRight="doc-pg-right",t.MarginBottom="doc-pg-bottom",t.MarginLeft="doc-pg-left",t.PageWidth="doc-pg-width",t.PageHeight="doc-pg-height",t.PageStartAt="doc-page-start-at",t.DefaultHeaderRefId="headerflow",t.DefaultFooterRefId="footerflow"}(g||(g={}));var y,f=[g.MarginTop,g.MarginRight,g.MarginBottom,g.MarginLeft,g.PageWidth,g.PageHeight,g.PageStartAt,g.DefaultHeaderRefId,g.DefaultFooterRefId];!function(t){t.textAlignment="textalign",t.outlineLevel="pap-outlineLevel",t.specialIndent="pap-specialIndent",t.firstIndent="pap-firstline-indent",t.hangingIndent="pap-hanging-indent",t.leftIndent="pap-left-indent",t.rightIndent="pap-right-indent",t.mirrorIndents="pap-mirrorIndents",t.autoAdjustRightIndent="pap-autoAdjustRightIndent",t.lineSpacing="pap-line",t.lineSpacingRule="pap-line-rule",t.spaceBefore="pap-spacing-before",t.spaceAfter="pap-spacing-after",t.disableLineHeightGrid="snapToGrid",t.keepWithNext="pap-keepWithNext",t.keepTogether="pap-keepTogether",t.pageBreakBefore="pap-pageBreakBefore",t.widowControl="pap-widowControl",t.suppressLineNumbers="pap-suppressLineNumbers",t.suppressAutoHyphens="pap-suppressAutoHyphens",t.farEastLineBreakControl="pap-farEastLineBreakControl",t.wordBreak="pap-wordBreak",t.hangingPunctuation="pap-hangingPunctuation",t.halfWidthPunctuationOnTopOfLine="pap-halfWidthPunctuationOnTopOfLine",t.addSpaceBetweenFarEastAndAlpha="pap-addSpaceBetweenFarEastAndAlpha",t.addSpaceBetweenFarEastAndDigit="pap-addSpaceBetweenFarEastAndDigit",t.baseLineAlignment="pap-baseLineAlignment",t.styleName="pap-stylesheet-name",t.DiffNo="diff-no",t.listId="pap-list-id",t.listLevel="pap-list-level",t.listTemplateId="pap-list-template-id",t.listTask="pap-list-task",t.borderType="pap-border-type"}(y||(y={}));var P,T=[y.textAlignment,y.outlineLevel,y.specialIndent,y.firstIndent,y.hangingIndent,y.leftIndent,y.rightIndent,y.mirrorIndents,y.rightIndent,y.autoAdjustRightIndent,y.lineSpacing,y.lineSpacingRule,y.spaceBefore,y.spaceAfter,y.disableLineHeightGrid,y.keepWithNext,y.keepTogether,y.pageBreakBefore,y.widowControl,y.suppressLineNumbers,y.suppressAutoHyphens,y.farEastLineBreakControl,y.wordBreak,y.hangingPunctuation,y.halfWidthPunctuationOnTopOfLine,y.addSpaceBetweenFarEastAndAlpha,y.addSpaceBetweenFarEastAndDigit,y.baseLineAlignment,y.styleName,y.DiffNo,y.listId,y.listLevel,y.listTemplateId,y.listTask,y.borderType];!function(t){t.Author="author",t.FontWeight="bold",t.Italic="italic",t.Underline="underline",t.StrikeThtough="strikethrough",t.SuperScript="superscript",t.SubScript="subscript",t.TextColor="color",t.FontFamily="font-family",t.FontSize="font-size",t.BackgroundColor="background-color",t.LetterSpacing="letter-spacing",t.Link="link",t.Comments="ch-comments",t.Quotes="ch-quotes",t.Diff="diff",t.DeleteFirst="del-first",t.StyleName="style-name"}(P||(P={}));var m;P.Author,P.FontWeight,P.Italic,P.Underline,P.StrikeThtough,P.SuperScript,P.SubScript,P.TextColor,P.FontFamily,P.FontSize,P.BackgroundColor,P.LetterSpacing,P.Link,P.Comments,P.Quotes,P.Diff,P.DeleteFirst;!function(t){t.ListStart="list-start",t.ListText="list-text",t.ListFormat="list-format"}(m||(m={}));var S,A,C=[m.ListStart,m.ListText,m.ListFormat];!function(t){t.Minus="minus",t.Plus="plus"}(S||(S={})),function(t){t.FieldCharType="field-char-type"}(A||(A={}));var _,v=[A.FieldCharType];!function(t){t.RowsHeight="rows-h",t.ColsWidth="cols-w",t.TableId="tableid",t.SubId="subid",t.PaddingLeft="tbl-pdl",t.PaddingRight="tbl-pdr"}(_||(_={}));var k,w=[_.RowsHeight,_.ColsWidth,_.TableId,_.SubId,_.PaddingLeft,_.PaddingRight];!function(t){t.CellColor="cell-bgc",t.BorderTopColor="cell-btc",t.BorderLeftColor="cell-blc",t.BorderBottomColor="cell-bbc",t.BorderRightColor="cell-brc",t.RowSpan="cell-rs",t.ColSpan="cell-cs",t.VerticalAlign="cell-va",t.HorizontalAlign="cell-ha"}(k||(k={}));var K,I=[k.CellColor,k.BorderTopColor,k.BorderLeftColor,k.BorderBottomColor,k.BorderRightColor,k.RowSpan,k.ColSpan,k.VerticalAlign,k.HorizontalAlign];K||(K={});var x;!function(t){t.Table="table",t.Row="row",t.Cell="cell"}(x||(x={}));var L;!function(t){t.drawingType="drawing-c-type",t.fillColor="drawing-c-fill-color"}(L||(L={}));var R,B=[L.drawingType,L.fillColor];!function(t){t.image="img",t.originWidth="image-width",t.originHeight="image-height",t.scaleWidth="image-scale-width",t.scaleHeight="image-scale-height",t.id="attachmentId",t.cropBottom="image-blipFill-srcRect-b",t.cropLeft="image-blipFill-srcRect-l",t.cropRight="image-blipFill-srcRect-r",t.cropTop="image-blipFill-srcRect-t"}(R||(R={}));var D,O=[R.image,R.originWidth,R.originHeight,R.scaleWidth,R.scaleHeight,R.id,R.cropBottom,R.cropLeft,R.cropRight,R.cropTop];!function(t){t.flag="splitline",t.type="splitline-type",t.color="splitline-color",t.marginLeft="splitline-margin-left",t.marginRight="splitline-margin-right"}(D||(D={}));var E,F=[D.flag,D.type,D.color,D.marginLeft,D.marginRight];!function(t){t.id="codeblock-id",t.language="codeblock-language",t.theme="codeblock-theme"}(E||(E={}));var N,H=[E.id,E.language,E.theme];!function(t){t.whiteSpaceType="white-space-type",t.textFrameType="textframe-type"}(N||(N={}));var U,M=[N.whiteSpaceType,N.textFrameType];!function(t){t.type="custom-box-type",t.data="custom-box-data"}(U||(U={}));var W,j=[U.type,U.data];!function(t){t.anchorId="container-anchor-id",t.containerType="container-type",t.posH="container-posH",t.posV="container-posV",t.width="container-width",t.height="container-height",t.wrapType="container-wrap-type",t.fitToParentWidth="container-fitToParentWidth",t.lockAspectRatio="container-lockAspectRatio"}(W||(W={}));var G,V=[W.anchorId,W.containerType,W.posH,W.posV,W.width,W.height,W.wrapType,W.fitToParentWidth,W.lockAspectRatio];!function(t){t.pluginType="plugin-c-type",t.pluginSrc="plugin-c-src",t.extraData="plugin-c-extra-data"}(G||(G={}));var J,z=[G.pluginType,G.pluginSrc,G.extraData];!function(t){t[t.None=0]="None",t[t.Common=1]="Common",t[t.Story=2]="Story",t[t.Section=4]="Section",t[t.Paragraph=8]="Paragraph",t[t.ListTemplate=16]="ListTemplate",t[t.TextSpan=32]="TextSpan",t[t.BaseContainer=128]="BaseContainer",t[t.PluginContainer=256]="PluginContainer",t[t.DrawingContainer=512]="DrawingContainer",t[t.ImageProperty=1024]="ImageProperty",t[t.SplitlineProperty=2048]="SplitlineProperty",t[t.TextframeProperty=4096]="TextframeProperty",t[t.CodeblockProperty=8192]="CodeblockProperty",t[t.FieldCharSpan=16384]="FieldCharSpan",t[t.EmbedCommentProperty=32768]="EmbedCommentProperty",t[t.TableProperty=65536]="TableProperty",t[t.TableRowProperty=131072]="TableRowProperty",t[t.TableCellProperty=262144]="TableCellProperty",t[t.Max=4294967295]="Max"}(J||(J={}));var q,X,Q,$,Y,Z=function(){function t(){}return t.parseAttribs=function(t,e){var r=this,a=J.None,n=[];return o.Changeset.eachAttribNumber(t,(function(t){var o=e.getAttrib(t);o&&(a=r._setAttribTypeFlags(o[0],a),n.push(o))})),{attribFlags:a,attribArr:n}},t.calcAttribFlags=function(t,e){var r=this,a=J.None;return o.Changeset.eachAttribNumber(t,(function(t){var o=e.getAttrib(t);o&&(a=r._setAttribTypeFlags(o[0],a))})),a},t._setAttribTypeFlags=function(t,e){var r=e;return b.indexOf(t)>=0&&(r|=J.Common),d.indexOf(t)>=0&&(r|=J.Story),f.indexOf(t)>=0&&(r|=J.Section),T.indexOf(t)>=0&&(r|=J.Paragraph),C.indexOf(t)>=0&&(r|=J.ListTemplate),V.indexOf(t)>=0&&(r|=J.BaseContainer),z.indexOf(t)>=0&&(r|=J.PluginContainer),B.indexOf(t)>=0&&(r|=J.DrawingContainer),O.indexOf(t)>=0&&(r|=J.ImageProperty),F.indexOf(t)>=0&&(r|=J.SplitlineProperty),M.indexOf(t)>=0&&(r|=J.TextframeProperty),H.indexOf(t)>=0&&(r|=J.CodeblockProperty),v.indexOf(t)>=0&&(r|=J.FieldCharSpan),w.indexOf(t)>=0&&(r|=J.TableProperty),I.indexOf(t)>=0&&(r|=J.TableCellProperty),j.indexOf(t)>=0&&(r|=J.EmbedCommentProperty),r|J.TextSpan},t._attribToCommonProp=function(t,e,r){return!1},t._storyTypeMap=new Map,t}(),tt=function(){function t(){}return t._basePropToAttribs=function(t,e){return""},t._numToAttrib=function(t){return"*"+o.Changeset.numToString(t)},t._hasPropKey=function(t,e,r){return!(e&&!(e.indexOf(r)>=0)||!t.has(r))},t}(),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.storyPropToAttribs=function(t,e,r){var a=-1,o="";if(o+=this._basePropToAttribs(t,r),this._hasPropKey(t,e,n.StoryPropKey.storyId)&&(a=r.putAttrib([h.StoryId,t.storyId]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.StoryPropKey.storyType)){switch(t.storyType){case n.StoryType.MainTextStory:a=r.putAttrib([h.StoryType,"main-text"]);break;case n.StoryType.PrimaryHeaderStory:a=r.putAttrib([h.StoryType,"primary-header"]);break;case n.StoryType.EvenPagesHeaderStory:a=r.putAttrib([h.StoryType,"even-pages-header"]);break;case n.StoryType.FirstPageHeaderStory:a=r.putAttrib([h.StoryType,"first-page-header"]);break;case n.StoryType.PrimaryFooterStory:a=r.putAttrib([h.StoryType,"primary-footer"]);break;case n.StoryType.EvenPagesFooterStory:a=r.putAttrib([h.StoryType,"even-pages-footer"]);break;case n.StoryType.FirstPageFooterStory:a=r.putAttrib([h.StoryType,"first-page-footer"]);break;case n.StoryType.TextFrameStory:a=r.putAttrib([h.StoryType,"text-frame"]);break;case n.StoryType.ListTemplateStory:a=r.putAttrib([h.StoryType,"list-template"]);break;case n.StoryType.CodeblockStory:a=r.putAttrib([h.StoryType,"code-block"])}o+=this._numToAttrib(a)}return this._hasPropKey(t,e,n.StoryPropKey.shadingType)&&(a=r.putAttrib([h.ShadingType,t.shadingType]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.StoryPropKey.shadingValue)&&(a=r.putAttrib([h.ShadingValue,t.shadingValue]),o+=this._numToAttrib(a)),o},e.clearStoryPropToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.StoryPropKey.shadingType:o+=this._numToAttrib(e.putAttrib([h.ShadingType,""]));break;case n.StoryPropKey.shadingValue:o+=this._numToAttrib(e.putAttrib([h.ShadingValue,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o},e}(tt),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.clearTextSpanPropToAttribs=function(t,e){return""+this.clearBaseSpanPropToAttribs(t,e)},e.clearFieldSpanPropToAttribs=function(t,e){return""+this.clearBaseSpanPropToAttribs(t,e)},e.clearBaseSpanPropToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.SpanPropKey.fontWeight:o+=this._numToAttrib(e.putAttrib([P.FontWeight,""]));break;case n.SpanPropKey.fontSize:o+=this._numToAttrib(e.putAttrib([P.FontSize,""]));break;case n.SpanPropKey.fontFamily:o+=this._numToAttrib(e.putAttrib([P.FontFamily,""]));break;case n.SpanPropKey.underline:o+=this._numToAttrib(e.putAttrib([P.Underline,""]));break;case n.SpanPropKey.strike:o+=this._numToAttrib(e.putAttrib([P.StrikeThtough,""]));break;case n.SpanPropKey.italic:o+=this._numToAttrib(e.putAttrib([P.Italic,""]));break;case n.SpanPropKey.textColor:o+=this._numToAttrib(e.putAttrib([P.TextColor,""]));break;case n.SpanPropKey.textBackground:o+=this._numToAttrib(e.putAttrib([P.BackgroundColor,""]));break;case n.SpanPropKey.link:o+=this._numToAttrib(e.putAttrib([P.Link,""]));break;case n.SpanPropKey.letterSpacing:o+=this._numToAttrib(e.putAttrib([P.LetterSpacing,""]));break;case n.SpanPropKey.superScript:o+=this._numToAttrib(e.putAttrib([P.SuperScript,""]));break;case n.SpanPropKey.subScript:o+=this._numToAttrib(e.putAttrib([P.SubScript,""]));break;case n.SpanPropKey.styleName:o+=this._numToAttrib(e.putAttrib([P.StyleName,""]));case n.CommentSpanPropKey.comments:o+=this._numToAttrib(e.putAttrib([P.Comments,""]));break;case n.CommentSpanPropKey.quotes:o+=this._numToAttrib(e.putAttrib([P.Quotes,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o},e.textSpanToAttribs=function(t,e,r){return""+this._baseSpanPropToAttribs(t,e,r)},e.fieldSpanToAttribs=function(t,e,r){var a="";if(this._hasPropKey(t,e,n.FieldCharSpanPropKey.fieldCharType)){var o=r.putAttrib([A.FieldCharType,t.fieldCharType]);a+=this._numToAttrib(o)}return a+this._baseSpanPropToAttribs(t,e,r)},e._baseSpanPropToAttribs=function(t,e,r){var a="";if(this._hasPropKey(t,e,n.SpanPropKey.author)){var o=r.putAttrib([P.Author,t.author]);a+=this._numToAttrib(o)}return this._hasPropKey(t,e,n.SpanPropKey.fontFamily)&&(o=r.putAttrib([P.FontFamily,t.fontFamily]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.fontSize)&&(o=r.putAttrib([P.FontSize,Object(i.twipsToPt)(t.fontSize)+"pt"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.fontWeight)&&(o=r.putAttrib([P.FontWeight,t.fontWeight===n.FontWeightType.bold?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.italic)&&(o=r.putAttrib([P.Italic,t.italic?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.textColor)&&(o=r.putAttrib([P.TextColor,t.textColor]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.textBackground)&&(o=r.putAttrib([P.BackgroundColor,t.textBackground]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.underline)&&(o=r.putAttrib([P.Underline,t.underline?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.strike)&&(o=r.putAttrib([P.StrikeThtough,t.strike?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.link)&&(o=r.putAttrib([P.Link,t.link]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.letterSpacing)&&(o=r.putAttrib([P.LetterSpacing,Object(i.twipsToPt)(t.letterSpacing)+"pt"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.superScript)&&(o=r.putAttrib([P.SuperScript,t.superScript?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.subScript)&&(o=r.putAttrib([P.SubScript,t.subScript?"true":"false"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.styleName)&&(o=r.putAttrib([P.StyleName,t.styleName]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.CommentSpanPropKey.comments)&&(o=r.putAttrib([P.Comments,t.comments.join(n.CommentSpanPropKey.commentsConnection)]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.CommentSpanPropKey.quotes)&&(o=r.putAttrib([P.Quotes,t.comments.join(n.CommentSpanPropKey.quotesConnection)]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.SpanPropKey.delFirst)&&(o=r.putAttrib([P.DeleteFirst,t.deleteFirst?"true":"false"]),a+=this._numToAttrib(o)),a+this._basePropToAttribs(t,r)},e}(tt),at=((q={})[n.TablePropKey.colWidths]=_.ColsWidth,q[n.TablePropKey.rowHeights]=_.RowsHeight,q[n.TablePropKey.paddingLeft]=_.PaddingLeft,q[n.TablePropKey.paddingRight]=_.PaddingRight,q[n.TablePropKey.subId]=_.SubId,q[n.TablePropKey.tableId]=_.TableId,q),ot=((X={})[n.TableCellPropKey.borderTopColor]=k.BorderTopColor,X[n.TableCellPropKey.borderBottomColor]=k.BorderBottomColor,X[n.TableCellPropKey.borderLeftColor]=k.BorderLeftColor,X[n.TableCellPropKey.borderRightColor]=k.BorderRightColor,X[n.TableCellPropKey.colSpan]=k.ColSpan,X[n.TableCellPropKey.cellcolor]=k.CellColor,X[n.TableCellPropKey.rowSpan]=k.RowSpan,X[n.TableCellPropKey.hAlign]=k.HorizontalAlign,X[n.TableCellPropKey.vAlign]=k.VerticalAlign,X),nt={},it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.tablePropToAttribs=function(t,e){var r=this,a="",o=t.getPropBag();return Object.keys(n.TablePropKey).forEach((function(s){var p=n.TablePropKey[s];if(t.has(p)){var l=at[p],c=void 0;if(l&&o.has(p)){switch(l){case _.RowsHeight:c=t.rowHeights.map(i.twipsToPx).join("|");break;case _.ColsWidth:c=t.colWidths.map(i.twipsToPx).join("|");break;case _.TableId:case _.SubId:c=o.get(p,"");break;case _.PaddingLeft:case _.PaddingRight:c=String(Object(i.twipsToPx)(o.get(p,0)));break;default:c=""}a+=r._numToAttrib(e.putAttrib([l,c]))}}})),a+=this._numToAttrib(e.putAttrib(["tbl-flag",x.Table]))},e.tableRowPropToAttribs=function(t,e){var r=this,a="",o=t.getPropBag();return Object.keys(n.TableRowPropKey).forEach((function(i){var s=n.TableRowPropKey[i];if(t.has(s)){var p=nt[s],l=void 0;p&&o.has(s)&&(l="",a+=r._numToAttrib(e.putAttrib([p,l])))}})),a+=this._numToAttrib(e.putAttrib(["tbl-flag",x.Row]))},e.tableCellPropToAttribs=function(t,e){var r=this,a="",o=t.getPropBag();return Object.keys(n.TableCellPropKey).forEach((function(i){var s=n.TableCellPropKey[i];if(t.has(s)){var p=ot[s];if(p&&o.has(s)){var l=void 0;switch(p){case k.ColSpan:case k.RowSpan:l=String(o.get(s,""));case k.BorderTopColor:case k.BorderRightColor:case k.BorderBottomColor:case k.BorderLeftColor:case k.CellColor:case k.HorizontalAlign:case k.VerticalAlign:l=o.get(s,"");break;default:l=""}a+=r._numToAttrib(e.putAttrib([p,l]))}}})),a+=this._numToAttrib(e.putAttrib(["tbl-flag",x.Cell]))},e}(tt),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.clearParaPropToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next()){var p=s.value;switch(p){case n.ParaPropKey.textAlignment:o+=this._numToAttrib(e.putAttrib([y.textAlignment,""]));break;case n.ParaPropKey.outlineLevel:o+=this._numToAttrib(e.putAttrib([y.outlineLevel,""]));break;case n.ParaPropKey.specialIndent:case n.ParaPropKey.characterUnitSpecialIndent:o+=this._numToAttrib(e.putAttrib([y.specialIndent,""]));break;case n.ParaPropKey.leftIndent:case n.ParaPropKey.characterUnitLeftIndent:o+=this._numToAttrib(e.putAttrib([y.leftIndent,""]));break;case n.ParaPropKey.rightIndent:case n.ParaPropKey.characterUnitRightIndent:o+=this._numToAttrib(e.putAttrib([y.rightIndent,""]));break;case n.ParaPropKey.autoAdjustRightIndent:o+=this._numToAttrib(e.putAttrib([y.autoAdjustRightIndent,""]));break;case n.ParaPropKey.lineSpacing:o+=this._numToAttrib(e.putAttrib([y.lineSpacing,""]));break;case n.ParaPropKey.lineSpacingRule:o+=this._numToAttrib(e.putAttrib([y.lineSpacingRule,""]));break;case n.ParaPropKey.spaceBefore:case n.ParaPropKey.lineUnitBefore:o+=this._numToAttrib(e.putAttrib([y.spaceBefore,""]));break;case n.ParaPropKey.spaceAfter:case n.ParaPropKey.lineUnitAfter:o+=this._numToAttrib(e.putAttrib([y.spaceAfter,""]));break;case n.ParaPropKey.disableLineHeightGrid:o+=this._numToAttrib(e.putAttrib([y.disableLineHeightGrid,""]));break;case n.ParaPropKey.styleName:o+=this._numToAttrib(e.putAttrib([y.styleName,""]));break;case n.ParaPropKey.listId:o+=this._numToAttrib(e.putAttrib([y.listId,""]));break;case n.ParaPropKey.listTemplateId:o+=this._numToAttrib(e.putAttrib([y.listTemplateId,""]));break;case n.ParaPropKey.listLevel:o+=this._numToAttrib(e.putAttrib([y.listLevel,""]));break;case n.ParaPropKey.taskState:o+=this._numToAttrib(e.putAttrib([y.listTask,""]));break;case n.ParaPropKey.borderType:o+=this._numToAttrib(e.putAttrib([y.borderType,""]));break;default:at[p]?o+=this._numToAttrib(e.putAttrib([at[p],""])):ot[p]?o+=this._numToAttrib(e.putAttrib([ot[p],""])):o+=this._numToAttrib(e.putAttrib([p,""]))}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o},e.paraPropToAttribs=function(t,e,r,a){var o="";return o+=this._basePropToAttribs(t,a),o+=t instanceof n.NumberingProperty?this._numberingPropToAttribs(t,r,a):this._baseParaPropToAttribs(t,r,a),e&&(o+=rt.textSpanToAttribs(e,null,a)),t instanceof n.TableProperty?o+=it.tablePropToAttribs(t,a):t instanceof n.TableRowProperty?o+=it.tableRowPropToAttribs(t,a):t instanceof n.TableCellProperty&&(o+=it.tableCellPropToAttribs(t,a)),o},e._numberingPropToAttribs=function(t,e,r){var a="",o=0;return this._hasPropKey(t,e,n.NumberingPropKey.start)&&(o=r.putAttrib([m.ListStart,t.start.toString()]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.NumberingPropKey.lvlText)&&(o=r.putAttrib([m.ListText,t.lvlText]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.NumberingPropKey.listFmt)&&(o=r.putAttrib([m.ListFormat,t.listFmt]),a+=this._numToAttrib(o)),a+this._baseParaPropToAttribs(t,e,r)},e._baseParaPropToAttribs=function(t,e,r){var a="",o=0;if(this._hasPropKey(t,e,n.ParaPropKey.textAlignment)){switch(o=-1,t.textAlignment){case n.TextAlignmentType.Left:o=r.putAttrib([y.textAlignment,"left"]);break;case n.TextAlignmentType.Center:o=r.putAttrib([y.textAlignment,"center"]);break;case n.TextAlignmentType.Right:o=r.putAttrib([y.textAlignment,"right"]);break;case n.TextAlignmentType.Justify:o=r.putAttrib([y.textAlignment,"justify"]);break;case n.TextAlignmentType.Distribute:o=r.putAttrib([y.textAlignment,"distribute"])}o>=0&&(a+=this._numToAttrib(o))}var s="";this._hasPropKey(t,e,n.ParaPropKey.leftIndent)&&(s=Object(i.twipsToPt)(t.leftIndent)+"pt"),!this._hasPropKey(t,e,n.ParaPropKey.characterUnitLeftIndent)||0===t.characterUnitLeftIndent&&0!==s.length||(s=t.characterUnitLeftIndent+"em"),s.length>0&&(o=r.putAttrib([y.leftIndent,s]),a+=this._numToAttrib(o));var p="";this._hasPropKey(t,e,n.ParaPropKey.rightIndent)&&(p=Object(i.twipsToPt)(t.rightIndent)+"pt"),!this._hasPropKey(t,e,n.ParaPropKey.characterUnitRightIndent)||0===t.characterUnitRightIndent&&0!==p.length||(p=t.characterUnitRightIndent+"em"),p.length>0&&(o=r.putAttrib([y.rightIndent,p]),a+=this._numToAttrib(o));var l="";if(this._hasPropKey(t,e,n.ParaPropKey.specialIndent)&&(l=Object(i.twipsToPt)(t.specialIndent)+"pt"),!this._hasPropKey(t,e,n.ParaPropKey.characterUnitSpecialIndent)||0===t.characterUnitSpecialIndent&&0!==l.length||(l=t.characterUnitSpecialIndent+"em"),l.length>0&&(o=r.putAttrib([y.specialIndent,l]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.lineSpacing)){var c="",h="";switch(t.lineSpacingRule){case n.LineSpacingType.Multiple:c="auto",h=String(t.lineSpacing);break;case n.LineSpacingType.Exactly:c="exact",h=Object(i.twipsToPt)(t.lineSpacing)+"pt";break;case n.LineSpacingType.AtLeast:c="atLeast",h=Object(i.twipsToPt)(t.lineSpacing)+"pt";break;default:c="auto",h=String(t.lineSpacing)}c.length>0&&h.length>0&&(o=r.putAttrib([y.lineSpacing,h]),a+=this._numToAttrib(o),o=r.putAttrib([y.lineSpacingRule,c]),a+=this._numToAttrib(o))}return this._hasPropKey(t,e,n.ParaPropKey.spaceBefore)&&(o=r.putAttrib([y.spaceBefore,Object(i.twipsToPt)(t.spaceBefore)+"pt"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.spaceAfter)&&(o=r.putAttrib([y.spaceAfter,Object(i.twipsToPt)(t.spaceAfter)+"pt"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.styleName)&&(o=r.putAttrib([y.styleName,t.styleName]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.disableLineHeightGrid)&&(o=r.putAttrib([y.disableLineHeightGrid,t.disableLineHeightGrid?"1":"0"]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.listId)&&(o=r.putAttrib([y.listId,t.listId]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.listLevel)&&(o=r.putAttrib([y.listLevel,t.listLevel.toString()]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.listTemplateId)&&(o=r.putAttrib([y.listTemplateId,t.listTemplateId]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.taskState)&&(o=r.putAttrib([y.listTask,t.taskState]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.ParaPropKey.borderType)&&(o=r.putAttrib([y.borderType,t.borderType.toString()]),a+=this._numToAttrib(o)),a},e}(tt),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.clearSecPropToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.SectPropKey.marginTop:o+=this._numToAttrib(e.putAttrib([g.MarginTop,""]));break;case n.SectPropKey.marginRight:o+=this._numToAttrib(e.putAttrib([g.MarginRight,""]));break;case n.SectPropKey.marginBottom:o+=this._numToAttrib(e.putAttrib([g.MarginBottom,""]));break;case n.SectPropKey.marginLeft:o+=this._numToAttrib(e.putAttrib([g.MarginLeft,""]));break;case n.SectPropKey.pageWidth:o+=this._numToAttrib(e.putAttrib([g.PageWidth,""]));break;case n.SectPropKey.pageHeight:o+=this._numToAttrib(e.putAttrib([g.PageHeight,""]));break;case n.SectPropKey.pageStartAt:o+=this._numToAttrib(e.putAttrib([g.PageStartAt,""]));break;case n.SectPropKey.defaultHeaderRefId:o+=this._numToAttrib(e.putAttrib([g.DefaultHeaderRefId,""]));break;case n.SectPropKey.defaultFooterRefId:o+=this._numToAttrib(e.putAttrib([g.DefaultFooterRefId,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o},e.sectPropToAttribs=function(t,e,r,a){var o=-1,s="";return s+=this._basePropToAttribs(t,a),this._hasPropKey(t,r,n.SectPropKey.marginTop)&&(o=a.putAttrib([g.MarginTop,Object(i.twipsToPt)(t.marginTop)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.marginRight)&&(o=a.putAttrib([g.MarginRight,Object(i.twipsToPt)(t.marginRight)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.marginBottom)&&(o=a.putAttrib([g.MarginBottom,Object(i.twipsToPt)(t.marginBottom)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.marginLeft)&&(o=a.putAttrib([g.MarginLeft,Object(i.twipsToPt)(t.marginLeft)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.pageWidth)&&(o=a.putAttrib([g.PageWidth,Object(i.twipsToPt)(t.pageWidth)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.pageHeight)&&(o=a.putAttrib([g.PageHeight,Object(i.twipsToPt)(t.pageHeight)+"pt"]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.pageStartAt)&&(o=a.putAttrib([g.PageStartAt,t.pageStartAt.toString()]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.defaultHeaderRefId)&&(o=a.putAttrib([g.DefaultHeaderRefId,t.defaultHeaderRefId]),s+=this._numToAttrib(o)),this._hasPropKey(t,r,n.SectPropKey.defaultFooterRefId)&&(o=a.putAttrib([g.DefaultFooterRefId,t.defaultFooterRefId]),s+=this._numToAttrib(o)),e&&(s+=rt.textSpanToAttribs(e,null,a)),s},e}(tt),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e._baseContainerPropToAttribs=function(t,e,r){var a=this,o="";if(this._hasPropKey(t,e,n.BaseContainerPropKey.anchorId)){var i=r.putAttrib([W.anchorId,t.anchorId]);o+=this._numToAttrib(i)}if(this._hasPropKey(t,e,n.BaseContainerPropKey.containerType)){switch(i=-1,t.containerType){case n.ContainerType.Drawing:i=r.putAttrib([W.containerType,"drawing"]);break;case n.ContainerType.Plugin:i=r.putAttrib([W.containerType,"plugin"])}i>=0&&(o+=this._numToAttrib(i))}if(this._hasPropKey(t,e,n.BaseContainerPropKey.posH)&&(i=r.putAttrib([W.posH,String(t.posH)]),o+=this._numToAttrib(i)),this._hasPropKey(t,e,n.BaseContainerPropKey.posV)&&(i=r.putAttrib([W.posV,String(t.posV)]),o+=this._numToAttrib(i)),this._hasPropKey(t,e,n.BaseContainerPropKey.width)&&t.width>0&&(i=r.putAttrib([W.width,String(t.width)]),o+=this._numToAttrib(i)),this._hasPropKey(t,e,n.BaseContainerPropKey.height)&&t.height>0&&(i=r.putAttrib([W.height,String(t.height)]),o+=this._numToAttrib(i)),this._hasPropKey(t,e,n.BaseContainerPropKey.wrapType)){switch(i=-1,t.wrapType){case n.WrapType.None:i=r.putAttrib([W.wrapType,"none"]);break;case n.WrapType.Square:i=r.putAttrib([W.wrapType,"square"]);break;case n.WrapType.Through:i=r.putAttrib([W.wrapType,"through"]);break;case n.WrapType.Tight:i=r.putAttrib([W.wrapType,"tight"]);break;case n.WrapType.TopAndBottom:i=r.putAttrib([W.wrapType,"topAndBottom"]);break;case n.WrapType.Behind:i=r.putAttrib([W.wrapType,"behind"]);break;case n.WrapType.Front:i=r.putAttrib([W.wrapType,"front"]);break;case n.WrapType.Inline:i=r.putAttrib([W.wrapType,"inline"])}i>=0&&(o+=this._numToAttrib(i))}return this._hasPropKey(t,e,n.BaseContainerPropKey.fitToParentWidth)&&(i=r.putAttrib([W.fitToParentWidth,t.fitToParentWidth?"true":"false"]),o+=this._numToAttrib(i)),this._hasPropKey(t,e,n.BaseContainerPropKey.lockAspectRatio)&&(i=r.putAttrib([W.lockAspectRatio,t.lockAspectRatio?"true":"false"]),o+=this._numToAttrib(i)),t.forEachExtraKey((function(n){if(a._hasPropKey(t,e,n)){var i=r.putAttrib([n,String(t.getExtra(n))]);o+=a._numToAttrib(i)}})),o+=this._baseSpanPropToAttribs(t,e,r)},e.clearContainerPropToAttribs=function(t,e){var r,a,o="";try{for(var n=l(t),i=n.next();!i.done;i=n.next())i.value}catch(t){r={error:t}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return o+this.clearBaseSpanPropToAttribs(t,e)},e}(rt),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.defaultDrawingToAttribs=function(t,e,r){return this._baseDrawingPropToAttribs(t,e,r)},e.imageSpanToAttribs=function(t,e,r){var a=0,o="";return this._hasPropKey(t,e,n.ImagePropKey.imgSrc)&&(a=r.putAttrib([R.image,t.imgSrc]),o=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.originWidth)&&(a=r.putAttrib([R.originWidth,String(Object(i.twipsToPx)(t.originWidth))+"px"]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.originHeight)&&(a=r.putAttrib([R.originHeight,String(Object(i.twipsToPx)(t.originHeight))+"px"]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.scaleWidth)&&(a=r.putAttrib([R.scaleWidth,String(Object(i.twipsToPx)(t.scaleWidth))+"px"]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.scaleHeight)&&(a=r.putAttrib([R.scaleHeight,String(Object(i.twipsToPx)(t.scaleHeight))+"px"]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.cropTop)&&(a=r.putAttrib([R.cropTop,String(t.cropTop)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.cropBottom)&&(a=r.putAttrib([R.cropBottom,String(t.cropBottom)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.cropLeft)&&(a=r.putAttrib([R.cropLeft,String(t.cropLeft)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.ImagePropKey.cropRight)&&(a=r.putAttrib([R.cropRight,String(t.cropRight)]),o+=this._numToAttrib(a)),o+this._baseDrawingPropToAttribs(t,e,r)},e.clearImageSpanToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.ImagePropKey.originWidth:o+=this._numToAttrib(e.putAttrib([R.originWidth,""]));break;case n.ImagePropKey.originHeight:o+=this._numToAttrib(e.putAttrib([R.originHeight,""]));break;case n.ImagePropKey.scaleHeight:o+=this._numToAttrib(e.putAttrib([R.scaleHeight,""]));break;case n.ImagePropKey.scaleWidth:o+=this._numToAttrib(e.putAttrib([R.scaleWidth,""]));break;case n.ImagePropKey.cropBottom:o+=this._numToAttrib(e.putAttrib([R.cropBottom,""]));break;case n.ImagePropKey.cropTop:o+=this._numToAttrib(e.putAttrib([R.cropTop,""]));break;case n.ImagePropKey.cropLeft:o+=this._numToAttrib(e.putAttrib([R.cropLeft,""]));break;case n.ImagePropKey.cropRight:o+=this._numToAttrib(e.putAttrib([R.cropRight,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o+this.clearDrawingPropToAttribs(t,e)},e.splitlinePropToAttribs=function(t,e,r){var a=0,o="";return this._hasPropKey(t,e,n.SplitlinePropKey.type)&&(a=r.putAttrib([D.type,String(t.type)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.SplitlinePropKey.marginLeft)&&(a=r.putAttrib([D.marginLeft,String(t.marginLeft)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.SplitlinePropKey.marginRight)&&(a=r.putAttrib([D.marginRight,String(t.marginRight)]),o+=this._numToAttrib(a)),o+this._baseDrawingPropToAttribs(t,e,r)},e.clearSplitlineToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.SplitlinePropKey.marginLeft:o+=this._numToAttrib(e.putAttrib([D.marginLeft,""]));break;case n.SplitlinePropKey.marginRight:o+=this._numToAttrib(e.putAttrib([D.marginRight,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o+this.clearDrawingPropToAttribs(t,e)},e.embedCommentPropToAttribs=function(t,e,r){var a=0,o="";return this._hasPropKey(t,e,n.EmbedCommentPropKey.type)&&(a=r.putAttrib([U.type,String(t.type)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.EmbedCommentPropKey.data)&&(a=r.putAttrib([U.data,String(t.data)]),o+=this._numToAttrib(a)),o+this._baseDrawingPropToAttribs(t,e,r)},e.clearEmbedCommentPropToAttribs=function(t,e){var r=this,a="";return t.forEach((function(t){switch(t){case n.EmbedCommentPropKey.type:a+=r._numToAttrib(e.putAttrib([U.type,""]));break;case n.EmbedCommentPropKey.data:a+=r._numToAttrib(e.putAttrib([U.data,""]))}})),a+=this.clearDrawingPropToAttribs(t,e)},e.textframePropToAttribs=function(t,e,r){var a=0,o="";if(this._hasPropKey(t,e,n.TextframePropKey.whiteSpaceType)&&(a=r.putAttrib([N.whiteSpaceType,String(t.whiteSpaceType)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.TextframePropKey.textframeType)){switch(a=-1,t.textframeType){case n.TextframeType.Codeblock:a=r.putAttrib([N.textFrameType,"codeblock"]);break;default:a=r.putAttrib([N.textFrameType,"normal"])}a>=0&&(o+=this._numToAttrib(a))}return o+this._baseDrawingPropToAttribs(t,e,r)},e.clearTextFrameToAttribs=function(t,e){var r,a,o="";try{for(var n=l(t),i=n.next();!i.done;i=n.next())i.value}catch(t){r={error:t}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return o+this.clearDrawingPropToAttribs(t,e)},e.codeblockPropToAttribs=function(t,e,r){var a=0,o="";return this._hasPropKey(t,e,n.CodeblockPropKey.language)&&(a=r.putAttrib([E.language,String(t.language)]),o+=this._numToAttrib(a)),this._hasPropKey(t,e,n.CodeblockPropKey.theme)&&(a=r.putAttrib([E.theme,String(t.theme)]),o+=this._numToAttrib(a)),o+this.textframePropToAttribs(t,e,r)},e.clearCodeBlockToAttribs=function(t,e){var r,a,o="";try{for(var n=l(t),i=n.next();!i.done;i=n.next())i.value}catch(t){r={error:t}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return o+this.clearTextFrameToAttribs(t,e)},e._baseDrawingPropToAttribs=function(t,e,r){var a="";if(this._hasPropKey(t,e,n.DrawingContainerPropKey.drawingType)){var o=r.putAttrib([L.drawingType,t.drawingType]);a+=this._numToAttrib(o)}return this._hasPropKey(t,e,n.DrawingContainerPropKey.fillColor)&&(o=r.putAttrib([L.fillColor,t.fillColor]),a+=this._numToAttrib(o)),a+this._baseContainerPropToAttribs(t,e,r)},e.clearDrawingPropToAttribs=function(t,e){var r,a,o="";try{for(var i=l(t),s=i.next();!s.done;s=i.next())switch(s.value){case n.DrawingContainerPropKey.fillColor:o+=this._numToAttrib(e.putAttrib([L.fillColor,""]))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return o+this.clearContainerPropToAttribs(t,e)},e}(lt),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.defaultPluginToAttribs=function(t,e,r){return this._basePluginPropToAttribs(t,e,r)},e._basePluginPropToAttribs=function(t,e,r){var a="";if(this._hasPropKey(t,e,n.PluginContainerPropKey.pluginType)){var o=r.putAttrib([G.pluginType,t.pluginType]);a+=this._numToAttrib(o)}return this._hasPropKey(t,e,n.PluginContainerPropKey.pluginSrc)&&(o=r.putAttrib([G.pluginSrc,t.pluginSrc]),a+=this._numToAttrib(o)),this._hasPropKey(t,e,n.PluginContainerPropKey.extraData)&&(o=r.putAttrib([G.extraData,t.extraData]),a+=this._numToAttrib(o)),a+this._baseContainerPropToAttribs(t,e,r)},e.clearPluginPropToAttribs=function(t,e){var r,a,o="";try{for(var n=l(t),i=n.next();!i.done;i=n.next())i.value}catch(t){r={error:t}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return o+this.clearContainerPropToAttribs(t,e)},e}(lt),ut=function(){function t(){}return t.applyToCSInfo=function(t,e,r,a){var i=this,s=[],p=a||0,l=r,c=null,h=!1;t.forEach((function(t,r,a){if(t instanceof n.IContentOperationBase){if(c||(c=o.Changeset.builder(t.oldLen>=0?t.oldLen:l)),void 0!==l&&(l+=t.changeLen),!h&&t.range.begin()+p>0&&c.keep(t.range.begin()+p),h=!1,t instanceof n.DeleteOperation)c.remove(t.range.length());else if(t instanceof n.InsertOperation){var u="";if(u=t instanceof n.InsertSectionOperation?pt.sectPropToAttribs(t.param.sectionProperty,t.param.spanProperty,null,e):t instanceof n.InsertParaOperation?st.paraPropToAttribs(t.param.paraProperty,t.param.spanProperty,null,e):i.spanPropToAttribs(t.param.spanProperty,null,e),c.insert(t.param.text,u,e),a.length>r+1){var b=a[r+1];b instanceof n.InsertOperation&&b.range.begin()===t.range.begin()+t.param.text.length&&(h=!0)}}else if(t instanceof n.IContentModifyOperationBase){var g=null,d=null;t.param.modifiedResult&&(g=t.param.modifiedResult.modifiedProps,d=t.param.modifiedResult.clearedProps),u="",t instanceof n.ModifyStoryOperation?(u=et.storyPropToAttribs(t.param.storyProperty,g,e),d&&d.length>0&&(u+=et.clearStoryPropToAttribs(d,e))):t instanceof n.ModifySectionOperation?(u=pt.sectPropToAttribs(t.param.sectionProperty,null,g,e),d&&d.length>0&&(u+=pt.clearSecPropToAttribs(d,e))):t instanceof n.ModifyParaOperation?(u=st.paraPropToAttribs(t.param.paraProperty,null,g,e),d&&d.length>0&&(u+=st.clearParaPropToAttribs(d,e))):t instanceof n.ModifySpanOperation?(u=i.spanPropToAttribs(t.param.spanProperty,g,e),d&&d.length>0&&(u+=i.clearSpanPropToAttribs(t.param.spanProperty,d,e))):t instanceof n.ClearStoryOperation?u=et.clearStoryPropToAttribs(t.param.clearStoryProps,e):t instanceof n.ClearSectionOperation?u=pt.clearSecPropToAttribs(t.param.clearSectionProps,e):t instanceof n.ClearParaOperation?u=st.clearParaPropToAttribs(t.param.clearParaProps,e):t instanceof n.ClearSpanOperation&&(u=rt.clearTextSpanPropToAttribs(t.param.clearSpanProps,e)),c.keep(t.range.length(),0,u,e)}else(t instanceof n.InsertStoryBeginOperation||t instanceof n.InsertStoryEndOperation)&&(u=et.storyPropToAttribs(t.param.storyProp,null,e),c.insert(t.param.placeholder,u,e));if(!h){var y=c.toString();s.push(y),c=null}}}));var u=this.composeCSArray(s,e);return u?o.Changeset.unpack(u):null},t.applyToAtext=function(e,r,a,o){var n=t.applyToCSInfo(e,r,a,o);return n?{attribs:n.opsStr,text:n.charBank}:null},t.spanPropToAttribs=function(t,e,r){var a="";return t instanceof n.ImageProperty?a+=ct.imageSpanToAttribs(t,e,r):t instanceof n.CodeblockProperty?a+=ct.codeblockPropToAttribs(t,e,r):t instanceof n.SplitlineProperty?a+=ct.splitlinePropToAttribs(t,e,r):t instanceof n.TextframeProperty?a+=ct.textframePropToAttribs(t,e,r):t instanceof n.EmbedCommentProperty?a+=ct.embedCommentPropToAttribs(t,e,r):t instanceof n.DefaultDrawingProperty?a+=ct.defaultDrawingToAttribs(t,e,r):t instanceof n.DefaultPluginProperty?a+=ht.defaultPluginToAttribs(t,e,r):t instanceof n.FieldCharSpan?a+=rt.fieldSpanToAttribs(t,e,r):t instanceof n.TextSpan&&(a+=rt.textSpanToAttribs(t,e,r)),a},t.clearSpanPropToAttribs=function(t,e,r){var a="";return t instanceof n.ImageProperty?a+=ct.clearImageSpanToAttribs(e,r):t instanceof n.CodeblockProperty?a+=ct.clearCodeBlockToAttribs(e,r):t instanceof n.SplitlineProperty?a+=ct.clearSplitlineToAttribs(e,r):t instanceof n.TextframeProperty?a+=ct.clearTextFrameToAttribs(e,r):t instanceof n.EmbedCommentProperty?a+=ct.clearEmbedCommentPropToAttribs(e,r):t instanceof n.DefaultDrawingProperty?a+=ct.clearDrawingPropToAttribs(e,r):t instanceof n.DefaultPluginProperty?a+=ht.clearPluginPropToAttribs(e,r):t instanceof n.FieldCharSpan?a+=rt.clearFieldSpanPropToAttribs(e,r):t instanceof n.TextSpan&&(a+=rt.clearTextSpanPropToAttribs(e,r)),a},t.composeCSArray=function(t,e){if(0===t.length)return null;if(1===t.length)return t[0];for(var r=t;r.length>1;){for(var a=[];r.length>0;){var n=r.shift(),i=r.shift();if(n&&i)n=o.Changeset.compose(n,i,e);else if(n){var s=a.pop();n=o.Changeset.compose(s,n,e)}a.push(n)}r=a}return r[0]},t}(),bt=function(){function t(t){this._deprecatedParaAttribs=["list","text-align","insertorder"],this._templateDelta=n.DeltaOption.createLocalDeltaOption(new n.GCPRange(0,0),!1).buildDelta(),this._oldListMap=new Map,this.addedListTemplates=[],this._apool=t,this._compatibleCs=""}return t.prototype.getCompatibleCs=function(){return this._compatibleCs},t.prototype.compatible=function(t,e){var r=this,a="",s=o.Changeset.unpack(t);if(s){for(var p,l=o.Changeset.builder(s.charBank.length),c=o.Changeset.opIterator(s.opsStr),h=o.Changeset.stringIterator(s.charBank),u=0,b="",g=!1,d=!0,y="",P="",T="",m=function(){var t=c.next();if("+"!==t.opcode)return o.ChangesetTool.assert(!1,"compatible cs error"),"break";var a=h.take(t.chars),i=!1;if(d&&!e){if(a===n.PlaceholderChar.ParagraphBreak){var s=!1;o.Changeset.eachAttribNumber(t.attribs,(function(t){var e=r._apool.getAttrib(t);e&&("doc-attrtype"===e[0]?s=!0:f.indexOf(e[0])>=0?y+="*"+o.Changeset.numToString(t):"doc-page-header-divider"===e[0]?p=e[1]:P+="*"+o.Changeset.numToString(t))})),s?(l.remove(1),i=!0):P=""}p="true"===p||void 0===p,d=!1}if("*"===a){var m=Z.parseAttribs(t.attribs,S._apool),A=(m.attribFlags&J.Paragraph)>0;A||m.attribArr.forEach((function(t){r._deprecatedParaAttribs.indexOf(t[0])>=0&&(A=!0)})),A&&(u>0&&(l.keep(u),u=0),b=t.attribs,l.remove(1),i=!0)}b&&a.indexOf("\n")>=0&&((u+=a.indexOf("\n"))>0&&(l.keep(u),u=0),b=S.changeOldListData(b),l.keep(1,0,b,S._apool),u=t.chars-a.indexOf("\n")-1,b="",i=!0),g||e||(a.indexOf(n.PlaceholderChar.SectionBreak)>=0?o.Changeset.eachAttribNumber(t.attribs,(function(t){var e=r._apool.getAttrib(t);e&&"headerflow"===e[0]&&(T=e[1])})):a===n.PlaceholderChar.StoryEnd&&Z.calcAttribFlags(t.attribs,S._apool)&J.Story&&(g=!0,P&&(u>0&&(l.keep(u),u=0),l.keep(1,0,P,S._apool),P="",i=!0))),i||(u+=t.chars)},S=this;c.hasNext()&&"break"!==m(););if(!g&&!e){u>0&&(l.keep(u),u=0),l.insert(n.PlaceholderChar.SectionBreak,y);var A=new n.StoryProperty;A.storyId=n.StoryID.MainDocId;var C=et.storyPropToAttribs(A,null,this._apool);P&&(C=o.Changeset.composeAttributes(C,P,!0,this._apool)),l.insert(n.PlaceholderChar.StoryEnd,C),l.insert(n.PlaceholderChar.ParagraphBreak)}this._compatibleCs=l.toString(),i.Logger.info("compatiblecs:"+this._compatibleCs),a=o.Changeset.compose(t,this._compatibleCs,this._apool),!e&&g&&(a=this._compose("section para cs",a,this._compatibleSectionBreak(a,y))),!e&&T&&p&&(a=this._compose("headerSeparator cs",a,this._compatibleHeaderSeparator(a,T))),e||(a=this._compose("comment cs",a,this._compatibleComment(a))),e||(a=this._compose("page num cs",a,this._compatiblePageNum(a))),a=this._compose("listCS",a,this.addListCs(a))}return i.Logger.info("total compatible cs:"+this._compatibleCs),a},t.prototype._compose=function(t,e,r){return r&&r.length>0?(i.Logger.info(t+":"+r),this._compatibleCs=o.Changeset.compose(this._compatibleCs,r,this._apool),o.Changeset.compose(e,r,this._apool)):e},t.prototype._compatibleSectionBreak=function(t,e){var r=this,a=o.Changeset.unpack(t);if(a){var i=a.charBank.indexOf("\n");if(i>=0){i+=2;for(var s=o.Changeset.builder(a.charBank.length),p=o.Changeset.opIterator(a.opsStr),l=o.Changeset.stringIterator(a.charBank),c=0;p.hasNext();){var h=p.next(),u=l.take(h.chars);if(i===c&&u===n.PlaceholderChar.StoryEnd){o.Changeset.eachAttribNumber(h.attribs,(function(t){var a=r._apool.getAttrib(t);a&&"flowid"===a[0]&&a[1]===n.StoryID.MainDocId&&(s.keep(c-2),s.keep(1,0,e),s.remove(1))}));break}c+=h.chars}return s.toString()}}return""},t.prototype._compatibleHeaderSeparator=function(t,e){var r=this,a=this._apool.attribToNum(["pap-border-type","4"]);if(void 0!==a&&a>=0)return"";var i=o.Changeset.unpack(t);if(i&&e){for(var s=o.Changeset.builder(i.charBank.length),p=o.Changeset.opIterator(i.opsStr),l=o.Changeset.stringIterator(i.charBank),c=0,h=function(){var t=p.next();if(l.take(t.chars)===n.PlaceholderChar.StoryEnd){var a=!1;if(o.Changeset.eachAttribNumber(t.attribs,(function(t){var o=r._apool.getAttrib(t);o&&"flowid"===o[0]&&o[1]===e&&(s.keep(c-1),s.keep(1,0,[["pap-border-type","4"]],r._apool),a=!0)})),a)return"break"}c+=t.chars};p.hasNext()&&"break"!==h(););return s.toString()}return""},t.prototype.changeOldListData=function(t){var e,r,a,i,s,p,l,c=this,h=-1,u=new n.NumberingProperty;if(o.Changeset.eachAttribNumber(t,(function(t){var e=c._apool.getAttrib(t);if(e){if("listid"===e[0]&&(p=e[1]),"list"===e[0]){var r=/([a-zA-Z]+)(\d)/.exec(e[1]);r&&(h=Number.parseInt(r[2],10)-1,"task"===r[1]||"taskdone"===r[1]?(i=n.ListFormat.Task,l="taskdone"===r[1]?n.TaskState.Done:n.TaskState.Todo,p||(p="taskId")):i=r[1],u.listLevel=h,u.listFmt=i)}"listtext"===e[0]&&(s=e[1],u.lvlText=s)}})),p&&!this._oldListMap.get(p)?(e=n.ListUtils.createId(),r=n.ListUtils.createId(),u.listTemplateId=r,this._oldListMap.set(p,{listId:e,abtractTemplateId:r})):this._oldListMap.get(p)&&p&&(e=this._oldListMap.get(p).listId,r=this._oldListMap.get(p).abtractTemplateId,u.listTemplateId=r),e&&h>=0&&r){var b=new n.ParaProperty;return b.listId=e,b.listTemplateId=r,b.listLevel=h,l&&(b.taskState=l),a=st.paraPropToAttribs(b,null,null,this._apool),this.addListTemplate(u),t+a}return t},t.prototype.addListTemplate=function(t){var e,r,a,o,i,s;try{for(var p=l(this.addedListTemplates),c=p.next();!c.done;c=p.next()){var h=c.value;try{for(var u=(a=void 0,l(h)),b=u.next();!b.done;b=u.next()){var g=b.value;if(g.listTemplateId===t.listTemplateId&&(i=h,g.listLevel===t.listLevel)){s=g;break}}}catch(t){a={error:t}}finally{try{b&&!b.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}if(t.listLevel>=0&&t.listTemplateId&&t.listFmt&&!s){if(0===this.addedListTemplates.length){var d=new n.StoryProperty;d.storyId=n.StoryID.ListTemplateId,d.storyType=n.StoryType.ListTemplateStory,this._templateDelta.insertStoryBegin(this._templateDelta.currentRange().end(),d,n.PlaceholderChar.StoryBegin)}i?i.push(t):i=[],i.push(t),this.addedListTemplates.push(i)}},t.prototype.addListCs=function(t){var e,r,a,s=this;if(0!==this._templateDelta.operations.length){try{for(var p=l(this.addedListTemplates),c=p.next();!c.done;c=p.next()){var h=c.value;if(0!==h.length){var u=h.find((function(t){return 0===t.listLevel}));if(!u){var b=h[0];if((u=new n.NumberingProperty).listLevel=0,u.listTemplateId=b.listTemplateId,u.start=0,u.characterUnitLeftIndent=0,u.characterUnitSpecialIndent=n.Defaults.listDefaultHanging,b.isBullet){var g=n.ListUtils.getDefaultBulletListText(0);u.lvlText=g,u.listFmt=n.ListFormat.Bullet}else if(b.isNumbered){var d=n.ListUtils.getDefaultNumberListStyle(0),y=d.listFormat;g=d.listText,u.listFmt=y,u.lvlText=g}h.push(u)}n.ListUtils.completeListTemplateParagraphs(u,h),h.forEach((function(t){if(t.isBullet&&""===t.lvlText){var e=n.ListUtils.getDefaultBulletListText(0);t.lvlText=e}s._templateDelta.insertParagraph(s._templateDelta.currentRange().end(),new n.ParaBreakSpan,t)}))}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}var f=new n.StoryProperty;f.storyId=n.StoryID.ListTemplateId,f.storyType=n.StoryType.ListTemplateStory,this._templateDelta.insertStoryEnd(this._templateDelta.currentRange().end(),f,n.PlaceholderChar.StoryEnd);var P=o.Changeset.unpack(t);if(!P)return i.Logger.info(" final compatcs is null"),null;if(!(a=ut.applyToCSInfo(this._templateDelta.operations,this._apool,P.oldLen)))return null;var T=o.Changeset.makeAText(""+a.charBank,""+a.opsStr),m=o.Changeset.builder(P.newLen);return P.charBank.endsWith(n.PlaceholderChar.ParagraphBreak)?m.keep(P.newLen-1):m.keep(P.newLen),m.insertAText(T),m.toString()}return null},t.prototype._compatibleComment=function(t){var e=this,r=!1;if(this._apool.eachAttrib((function(t,e){return!(!t.startsWith("tx-comment-")||"1"!==e||(r=!0,0))})),!r)return"";var a=o.Changeset.unpack(t);if(a){for(var n=o.Changeset.builder(a.charBank.length),i=o.Changeset.opIterator(a.opsStr),s=function(){var t=i.next();if("+"!==t.opcode)return o.ChangesetTool.assert(!1,"compatible cs error"),"break";var r=[],a="";o.Changeset.eachAttribNumber(t.attribs,(function(t){var n=e._apool.getAttrib(t);if(n&&n[0].startsWith("tx-comment-")&&"1"===n[1]){var i=n[0].split("-")[2];r.push(i),a+="*"+o.Changeset.numToString(e._apool.putAttrib([n[0],""]))}})),r.length>0&&(a+="*"+o.Changeset.numToString(p._apool.putAttrib([P.Comments,r.join(",")]))),a.length>0?n.keep(t.chars,0,a,p._apool):n.keep(t.chars)},p=this;i.hasNext()&&"break"!==s(););return n.toString()}return""},t.prototype._compatiblePageNum=function(t){var e=this,r=o.Changeset.unpack(t);if(r){for(var a=o.Changeset.builder(r.charBank.length),n=o.Changeset.opIterator(r.opsStr),i=o.Changeset.stringIterator(r.charBank),s=0,p=function(){var t=n.next();if("*"===i.take(t.chars)){var r,p="";o.Changeset.eachAttribNumber(t.attribs,(function(t){var a=e._apool.getAttrib(t);a&&("fieldcode"===a[0]?r=a[1]:"fieldcode-id"!==a[0]&&(p+="*"+o.Changeset.numToString(t)))})),r?(s>0&&(a.keep(s),s=0),a.remove(1),function(t,e,r,a){var n;switch(e){case"PAGE":n="PAGE";break;case"·PAGE·":n='PAGE \\@ "·$P·"';break;case"-PAGE-":n='PAGE \\@ "-$P-"';break;case"第PAGE \\* TDW-CHINESE页":n='PAGE \\@ "第$P页" \\* TDW-CHINESE';break;case"PAGE/NUMPAGES":n='PAGE \\@ "$P/$N"'}n&&(t.insert("","*"+o.Changeset.numToString(a.putAttrib(["field-char-type","begin"]))+r),t.insert(n,r),t.insert("","*"+o.Changeset.numToString(a.putAttrib(["field-char-type","separate"]))+r),t.insert("1",r),t.insert("","*"+o.Changeset.numToString(a.putAttrib(["field-char-type","end"]))+r))}(a,r,p,l._apool)):s+=t.chars}else s+=t.chars},l=this;n.hasNext();)p();return a.toString()}return""},t}(),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.getStoryType=function(t){var e=this._storyTypeMap.get(t);return e||(e=n.StoryType.CodeblockStory),e},e.attribsToStoryId=function(t,e){var r="";return o.Changeset.eachAttribNumber(t,(function(t){var a=e.getAttrib(t);a&&a[0]===h.StoryId&&(r=a[1])})),r},e.attribsToStoryProp=function(t){var e=this,r=new n.StoryProperty,a=[];return t.forEach((function(t){switch(t[0]){case h.StoryId:r.storyId=t[1];break;case h.StoryType:if(t[1].length>0)switch(t[1]){case"main-text":case"0":r.storyType=n.StoryType.MainTextStory;break;case"primary-header":case"1":r.storyType=n.StoryType.PrimaryHeaderStory;break;case"even-pages-header":case"2":r.storyType=n.StoryType.EvenPagesHeaderStory;break;case"first-page-header":case"3":r.storyType=n.StoryType.FirstPageHeaderStory;break;case"primary-footer":case"4":r.storyType=n.StoryType.PrimaryFooterStory;break;case"even-pages-footer":case"5":r.storyType=n.StoryType.EvenPagesFooterStory;break;case"first-page-footer":case"6":r.storyType=n.StoryType.FirstPageFooterStory;break;case"text-frame":case"7":r.storyType=n.StoryType.TextFrameStory;break;case"list-template":case"8":r.storyType=n.StoryType.ListTemplateStory;break;case"code-block":case"9":r.storyType=n.StoryType.CodeblockStory}else a.push(n.StoryPropKey.storyType);break;case h.ShadingType:t[1].length>0?r.shadingType=t[1]:a.push(n.StoryPropKey.shadingType);break;case h.ShadingValue:t[1].length>0?r.shadingValue=t[1]:a.push(n.StoryPropKey.shadingValue);break;default:e._attribToCommonProp(t[0],t[1],r)}})),{storyProp:r,clearStoryProps:a}},e}(Z),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToSectProp=function(t){var e=this,r=new n.SectionProperty,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSectProp(o,n,r,a)})),{sectProp:r,clearSectProps:a}},e._attribToBaseSectProp=function(t,e,r,a){switch(t){case g.MarginTop:e.length>0?r.marginTop=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.marginTop);break;case g.MarginRight:e.length>0?r.marginRight=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.marginRight);break;case g.MarginBottom:e.length>0?r.marginBottom=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.marginBottom);break;case g.MarginLeft:e.length>0?r.marginLeft=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.marginLeft);break;case g.PageWidth:e.length>0?r.pageWidth=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.pageWidth);break;case g.PageHeight:e.length>0?r.pageHeight=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SectPropKey.pageHeight);break;case g.PageStartAt:e.length>0?r.pageStartAt=Number(e):a.push(n.SectPropKey.pageStartAt);break;case g.DefaultHeaderRefId:e.length>0?(r.defaultHeaderRefId=e,this._storyTypeMap.set(e,n.StoryType.PrimaryHeaderStory)):a.push(n.SectPropKey.defaultHeaderRefId);break;case g.DefaultFooterRefId:e.length>0?(r.defaultFooterRefId=e,this._storyTypeMap.set(e,n.StoryType.PrimaryFooterStory)):a.push(n.SectPropKey.defaultFooterRefId);break;default:this._attribToCommonProp(t,e,r)}},e}(Z),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToNumberingProp=function(t){var e=this,r={hasSpecialIndent:!1,firstIndent:null,hangingIndent:null,lineSpacing:0,lineSpacingRule:""},a=new n.NumberingProperty,o=[];return t.forEach((function(t){var i=t[0],s=t[1];switch(i){case m.ListStart:s.length>0?a.start=Number.isNaN(Number.parseInt(s,10))||Number.parseInt(s,10)<0?0:Number.parseInt(s,10):o.push(n.NumberingPropKey.start);break;case m.ListText:s.length>0?a.lvlText=s:o.push(n.NumberingPropKey.lvlText);break;case m.ListFormat:s.length>0?a.listFmt=s:o.push(n.NumberingPropKey.listFmt);break;default:e._attribToBaseParaProp(i,s,a,o,r)}})),{paraProp:a,clearParaProps:o}},e.attribsToParaProp=function(t){var e=this,r={hasSpecialIndent:!1,firstIndent:null,hangingIndent:null,lineSpacing:0,lineSpacingRule:""},a=new n.ParaProperty,o=[];return t.forEach((function(t){var n=t[0],i=t[1];e._attribToBaseParaProp(n,i,a,o,r)})),{paraProp:a,clearParaProps:o}},e._attribToBaseParaProp=function(t,e,r,a,o){switch(t){case y.textAlignment:if(e.length>0)switch(e){case"left":r.textAlignment=n.TextAlignmentType.Left;break;case"center":r.textAlignment=n.TextAlignmentType.Center;break;case"right":r.textAlignment=n.TextAlignmentType.Right;break;case"justify":r.textAlignment=n.TextAlignmentType.Justify;break;case"distribute":r.textAlignment=n.TextAlignmentType.Distribute}else a.push(n.ParaPropKey.textAlignment);break;case y.leftIndent:e.length>0?((s=Number.parseFloat(e))===1/0&&(s=0),e.indexOf("em")<0?(r.leftIndent=Object(i.ptToTwips)(s),a.push(n.ParaPropKey.characterUnitLeftIndent)):r.characterUnitLeftIndent=s):(a.push(n.ParaPropKey.leftIndent),a.push(n.ParaPropKey.characterUnitLeftIndent));break;case y.rightIndent:var s;e.length>0?((s=Number.parseFloat(e))===1/0&&(s=0),e.indexOf("em")<0?(r.rightIndent=Object(i.ptToTwips)(s),a.push(n.ParaPropKey.characterUnitRightIndent)):r.characterUnitRightIndent=s):(a.push(n.ParaPropKey.rightIndent),a.push(n.ParaPropKey.characterUnitRightIndent));break;case y.specialIndent:o.hasSpecialIndent=!0,this._handleSpecialIndent(e,r,a,!1);break;case y.firstIndent:if(o.hasSpecialIndent)break;if(o.firstIndent=e,o.hangingIndent&&o.hangingIndent.length<=0&&e.length<=0)break;this._handleSpecialIndent(e,r,a,!1);break;case y.hangingIndent:if(o.hasSpecialIndent)break;if(o.hangingIndent=e,o.firstIndent&&(o.firstIndent.length<=0&&e.length<=0||o.firstIndent.length>0))break;this._handleSpecialIndent(e,r,a,!0);break;case y.lineSpacing:case y.lineSpacingRule:if(t===y.lineSpacing?e.length>0?o.lineSpacing=Number.parseFloat(e):a.push(n.ParaPropKey.lineSpacing):e.length>0?o.lineSpacingRule=e:a.push(n.ParaPropKey.lineSpacingRule),o.lineSpacing>0&&o.lineSpacingRule.length>0)switch(o.lineSpacingRule){case"auto":r.lineSpacing=o.lineSpacing,r.lineSpacingRule=n.LineSpacingType.Multiple;break;case"exact":r.lineSpacing=Object(i.ptToTwips)(o.lineSpacing),r.lineSpacingRule=n.LineSpacingType.Exactly;break;case"atLeast":r.lineSpacing=Object(i.ptToTwips)(o.lineSpacing),r.lineSpacingRule=n.LineSpacingType.AtLeast}break;case y.spaceBefore:e.length>0?r.spaceBefore=Object(i.ptToTwips)(Number.parseFloat(e)):(a.push(n.ParaPropKey.spaceBefore),a.push(n.ParaPropKey.lineUnitBefore));break;case y.spaceAfter:e.length>0?r.spaceAfter=Object(i.ptToTwips)(Number.parseFloat(e)):(a.push(n.ParaPropKey.spaceAfter),a.push(n.ParaPropKey.lineUnitAfter));break;case y.styleName:e.length>0?r.styleName=e:a.push(n.ParaPropKey.styleName);break;case y.disableLineHeightGrid:e.length>0?r.disableLineHeightGrid="1"===e:a.push(n.ParaPropKey.disableLineHeightGrid);break;case y.listId:e.length>0?r.listId=e:a.push(n.ParaPropKey.listId);break;case y.listLevel:e.length>0?r.listLevel=Number.isNaN(Number.parseInt(e,10))||Number.parseInt(e,10)<0?0:Number.parseInt(e,10):a.push(n.ParaPropKey.listLevel);break;case y.listTemplateId:e.length>0?r.listTemplateId=e:a.push(n.ParaPropKey.listTemplateId);break;case y.listTask:e.length>0?Object.values(n.TaskState).includes(e)&&(r.taskState=e):a.push(n.ParaPropKey.taskState);break;case y.borderType:e.length>0?r.borderType=Number.parseInt(e,10):a.push(n.ParaPropKey.borderType);break;default:this._attribToCommonProp(t,e,r)}},e._handleSpecialIndent=function(t,e,r,a){if(t.length>0){var o=r.indexOf(n.ParaPropKey.specialIndent);o>0&&r.splice(o,1),(o=r.indexOf(n.ParaPropKey.characterUnitSpecialIndent))>0&&r.splice(o,1);var s=Number.parseFloat(t);a&&(s=-s),t.indexOf("em")<0?(e.specialIndent=Object(i.ptToTwips)(s),r.push(n.ParaPropKey.characterUnitSpecialIndent)):(e.specialIndent=0,e.characterUnitSpecialIndent=s)}else r.push(n.ParaPropKey.specialIndent),r.push(n.ParaPropKey.characterUnitSpecialIndent)},e}(Z),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToTextSpan=function(t){var e=this,r=new n.TextSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSpanProp(o,n,r,a)})),{textSpan:r,clearSpanProps:a}},e.attribsToSectBreakSpan=function(t){var e=this,r=new n.SectBreakSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSpanProp(o,n,r,a)})),{sectBreakSpan:r,clearSpanProps:a}},e.attribsToParaBreakSpan=function(t){var e=this,r=new n.ParaBreakSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSpanProp(o,n,r,a)})),{paraBreakSpan:r,clearSpanProps:a}},e.attribsToTableCellBreakSpan=function(t){var e=this,r=new n.TableCellBreakSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSpanProp(o,n,r,a)})),{cellBreakSpan:r,clearSpanProps:a}},e.hasAttri=function(t,e,r){for(var a=0;a<t.length;a++){var o=t[a][0],n=t[a][1];if(o===e&&n===r)return!0}return!1},e.attribsToTableRowBreakSpan=function(t){var e=this,r=new n.TableRowBreakSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseSpanProp(o,n,r,a)})),{rowBreakSpan:r,clearSpanProps:a}},e.attribToFieldCharSpan=function(t){var e=this,r=new n.FieldCharSpan,a=[];return t.forEach((function(t){var o=t[0],n=t[1];switch(o){case A.FieldCharType:r.fieldCharType=n;break;default:e._attribToBaseSpanProp(o,n,r,a)}})),{fieldCharSpan:r,clearSpanProps:a}},e._attribToBaseSpanProp=function(t,e,r,a){var o=!0;switch(t){case P.Author:e.length>0?r.author=e:a.push(n.SpanPropKey.author);break;case P.FontFamily:e.length>0?r.fontFamily=e:a.push(n.SpanPropKey.fontFamily);break;case P.FontSize:e.length>0?r.fontSize=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SpanPropKey.fontSize);break;case P.FontWeight:e.length>0?r.fontWeight="true"===e?n.FontWeightType.bold:n.FontWeightType.normal:a.push(n.SpanPropKey.fontWeight);break;case P.Italic:e.length>0?r.italic="true"===e:a.push(n.SpanPropKey.italic);break;case P.TextColor:e.length>0?r.textColor=e:a.push(n.SpanPropKey.textColor);break;case P.BackgroundColor:e.length>0?r.textBackground=e:a.push(n.SpanPropKey.textBackground);break;case P.Underline:e.length>0?r.underline="true"===e:a.push(n.SpanPropKey.underline);break;case P.StrikeThtough:e.length>0?r.strike="true"===e:a.push(n.SpanPropKey.strike);break;case P.Link:e.length>0?r.link=e:a.push(n.SpanPropKey.link);break;case P.LetterSpacing:e.length>0?r.letterSpacing=Object(i.ptToTwips)(Number.parseFloat(e)):a.push(n.SpanPropKey.letterSpacing);break;case P.SuperScript:e.length>0?r.superScript="true"===e:a.push(n.SpanPropKey.superScript);break;case P.SubScript:e.length>0?r.subScript="true"===e:a.push(n.SpanPropKey.subScript);break;case P.Comments:e.length>0?r.comments=e.split(n.CommentSpanPropKey.commentsConnection):a.push(n.CommentSpanPropKey.comments);break;case P.Quotes:e.length>0?r.quotes=e.split(n.CommentSpanPropKey.quotesConnection):a.push(n.CommentSpanPropKey.quotes);break;case P.Diff:if(e.length>0)switch(e){case S.Minus:r.diff=n.DiffType.Minus;break;case S.Plus:r.diff=n.DiffType.Plus}else a.push(n.SpanPropKey.diff);break;case P.StyleName:e.length>0?r.styleName=e:a.push(n.SpanPropKey.styleName);break;case P.DeleteFirst:r.deleteFirst="true"===e;default:o=this._attribToCommonProp(t,e,r)}return o},e}(Z),Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToContainerProp=function(t){var e=this,r=new n.DefaultContainerProperty,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToBaseContainerProp(o,n,r,a)})),{containerProp:r,clearSpanProps:a}},e._attribToBaseContainerProp=function(t,e,r,a){var o=!0;switch(t){case W.anchorId:e.length>0?r.anchorId=e:a.push(n.BaseContainerPropKey.anchorId);break;case W.containerType:if(e.length>0)switch(e){case"drawing":r.containerType=n.ContainerType.Drawing;break;case"plugin":r.containerType=n.ContainerType.Plugin}else a.push(n.BaseContainerPropKey.containerType);break;case W.posH:e.length>0?r.posH=Number.parseFloat(e):a.push(n.BaseContainerPropKey.posH);break;case W.posV:e.length>0?r.posV=Number.parseFloat(e):a.push(n.BaseContainerPropKey.posV);break;case W.width:e.length>0?r.width=Number.parseFloat(e):a.push(n.BaseContainerPropKey.width);break;case W.height:e.length>0?r.height=Number.parseFloat(e):a.push(n.BaseContainerPropKey.height);break;case W.wrapType:if(e.length>0)switch(e){case"none":r.wrapType=n.WrapType.None;break;case"square":r.wrapType=n.WrapType.Square;break;case"through":r.wrapType=n.WrapType.Through;break;case"tight":r.wrapType=n.WrapType.Tight;break;case"topAndBottom":r.wrapType=n.WrapType.TopAndBottom;break;case"behind":r.wrapType=n.WrapType.Behind;break;case"front":r.wrapType=n.WrapType.Front;break;case"inline":r.wrapType=n.WrapType.Inline}else a.push(n.BaseContainerPropKey.wrapType);break;case W.fitToParentWidth:e.length>0?r.fitToParentWidth="true"===e:a.push(n.BaseContainerPropKey.fitToParentWidth);break;case W.lockAspectRatio:e.length>0?r.lockAspectRatio="true"===e:a.push(n.BaseContainerPropKey.lockAspectRatio);break;default:(o=this._attribToBaseSpanProp(t,e,r,a))||(e.length>0?r.setExtra(t,e):a.push(t),o=!0)}return o},e}(ft),Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToImageProp=function(t){var e=this,r=new n.ImageProperty,a=[];return t.forEach((function(t){var o=t[0],s=t[1];switch(o){case R.image:s.length>0?r.imgSrc=s:a.push(n.ImagePropKey.imgSrc);break;case R.id:s.length>0?r.has(n.BaseContainerPropKey.anchorId)||(r.anchorId=s):a.indexOf(n.BaseContainerPropKey.anchorId)<0&&a.push(n.BaseContainerPropKey.anchorId);break;case R.originWidth:s.length>0?r.originWidth=Object(i.pxToTwips)(Number.parseFloat(s)):a.push(n.ImagePropKey.originWidth);break;case R.originHeight:s.length>0?r.originHeight=Object(i.pxToTwips)(Number.parseFloat(s)):a.push(n.ImagePropKey.originHeight);break;case R.scaleWidth:s.length>0?r.scaleWidth=Object(i.pxToTwips)(Number.parseFloat(s)):a.push(n.ImagePropKey.scaleWidth);break;case R.scaleHeight:s.length>0?r.scaleHeight=Object(i.pxToTwips)(Number.parseFloat(s)):a.push(n.ImagePropKey.scaleHeight);break;case R.cropTop:s.length>0?r.cropTop=Number.parseFloat(s):a.push(n.ImagePropKey.cropTop);break;case R.cropBottom:s.length>0?r.cropBottom=Number.parseFloat(s):a.push(n.ImagePropKey.cropBottom);break;case R.cropLeft:s.length>0?r.cropLeft=Number.parseFloat(s):a.push(n.ImagePropKey.cropLeft);break;case R.cropRight:s.length>0?r.cropRight=Number.parseFloat(s):a.push(n.ImagePropKey.cropRight);break;default:e._attribToDrawingContainerProp(o,s,r,a)}})),{imageProp:r,clearSpanProps:a}},e.attribsToSplitlineProp=function(t){var e=this,r=new n.SplitlineProperty,a=[];return t.forEach((function(t){var o=t[0],i=t[1];switch(o){case D.color:i.length>0?r.has(n.DrawingContainerPropKey.fillColor)||(r.fillColor=i):a.indexOf(n.DrawingContainerPropKey.fillColor)<0&&a.push(n.DrawingContainerPropKey.fillColor);break;case D.type:i.length>0?r.type=i:a.push(n.SplitlinePropKey.type);break;case D.marginLeft:i.length>0?r.marginLeft=parseFloat(i):a.push(n.SplitlinePropKey.marginLeft);break;case D.marginRight:i.length>0?r.marginRight=parseFloat(i):a.push(n.SplitlinePropKey.marginRight);break;default:e._attribToDrawingContainerProp(o,i,r,a)}})),{splitlineProp:r,clearSpanProps:a}},e.attribsToEmbedCommentProp=function(t){var e=this,r=new n.EmbedCommentProperty,a=[];return t.forEach((function(t){var o=c(t,2),i=o[0],s=o[1];switch(i){case U.type:s.length>0?r.type=s:a.push(n.EmbedCommentPropKey.type);break;case U.data:s.length>0?r.data=s:a.push(n.EmbedCommentPropKey.data);break;default:e._attribToDrawingContainerProp(i,s,r,a)}})),{embedCommentProp:r,clearSpanProps:a}},e.attribsToCodeblockProp=function(t){var e=this,r=new n.CodeblockProperty,a=[];return t.forEach((function(t){var o=t[0],i=t[1];switch(o){case E.id:i.length>0?(r.has(n.BaseContainerPropKey.anchorId)||(r.anchorId=i),e._storyTypeMap.set(i,n.StoryType.CodeblockStory)):r.has(n.BaseContainerPropKey.anchorId)||a.push(n.BaseContainerPropKey.anchorId);break;case E.language:i.length>0?r.language=i:a.push(n.CodeblockPropKey.language);break;case E.theme:i.length>0?r.theme=i:a.push(n.CodeblockPropKey.theme);break;default:e._attribToTextframeProp(o,i,r,a)}})),{codeblockProp:r,clearSpanProps:a}},e.attribsToTextframeProp=function(t){var e=this,r=new n.TextframeProperty,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToTextframeProp(o,n,r,a)})),{textframeProp:r,clearSpanProps:a}},e._attribToTextframeProp=function(t,e,r,a){switch(t){case N.whiteSpaceType:e.length>0?r.whiteSpaceType=Number.parseFloat(e):a.push(n.TextframePropKey.whiteSpaceType);break;case N.textFrameType:if(e.length>0)switch(e){case"codeblock":r.textframeType=n.TextframeType.Codeblock;break;default:r.textframeType=n.TextframeType.Normal}else a.push(n.TextframePropKey.textframeType);break;default:this._attribToDrawingContainerProp(t,e,r,a)}},e.attribsToDrawingProp=function(t){var e=this,r=new n.DefaultDrawingProperty,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToDrawingContainerProp(o,n,r,a)})),{drawingProp:r,clearSpanProps:a}},e._attribToDrawingContainerProp=function(t,e,r,a){switch(t){case L.drawingType:e.length>0?r.drawingType=e:a.push(n.DrawingContainerPropKey.drawingType);break;case L.fillColor:e.length>0?r.fillColor=e:a.push(n.DrawingContainerPropKey.fillColor);break;default:this._attribToBaseContainerProp(t,e,r,a)}},e}(Pt),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToPluginProp=function(t){var e=this,r=new n.DefaultPluginProperty,a=[];return t.forEach((function(t){var o=t[0],n=t[1];e._attribToPluginContainerProp(o,n,r,a)})),{pluginProp:r,clearSpanProps:a}},e._attribToPluginContainerProp=function(t,e,r,a){switch(t){case G.pluginType:e.length>0?r.pluginType=e:a.push(n.PluginContainerPropKey.pluginType);break;case G.pluginSrc:e.length>0?r.pluginSrc=e:a.push(n.PluginContainerPropKey.pluginSrc);break;case G.extraData:e.length>0?r.extraData=e:a.push(n.PluginContainerPropKey.extraData);break;default:this._attribToBaseContainerProp(t,e,r,a)}},e}(Pt),St=((Q={})[n.PlaceholderChar.TableStart]=x.Table,Q[n.PlaceholderChar.TableEnd]=x.Table,Q[n.PlaceholderChar.TableRowStart]=x.Row,Q[n.PlaceholderChar.TableRowBreak]=x.Row,Q[n.PlaceholderChar.TableCellStart]=x.Cell,Q[n.PlaceholderChar.TableCellBreak]=x.Cell,Q),At=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.attribsToTableCellProp=function(t,e){return e.forEach((function(e){var r=e[0],a=e[1];switch(r){case k.ColSpan:t.colSpan=parseInt(a,10)||1;break;case k.RowSpan:t.rowSpan=parseInt(a,10)||1;break;case k.CellColor:t.cellcolor=a;break;case k.BorderTopColor:t.borderTopColor=a;break;case k.BorderRightColor:t.borderRightColor=a;break;case k.BorderBottomColor:t.borderBottomColor=a;break;case k.BorderLeftColor:t.borderLeftColor=a;break;case k.VerticalAlign:t.vAlign=a;break;case k.HorizontalAlign:t.hAlign=a}})),t},e.attribsToTableRowProp=function(t,e){return t},e.attribsToTableProp=function(t,e){return e.forEach((function(e){var r=e[0],a=e[1];switch(r){case _.TableId:t.tableId=a;break;case _.SubId:t.subId=a;break;case _.PaddingLeft:t.paddingLeft=Object(i.pxToTwips)(parseInt(a,10)||0);break;case _.PaddingRight:t.paddingRight=Object(i.pxToTwips)(parseInt(a,10)||0);break;case _.RowsHeight:t.rowHeights=a?a.split("|").map((function(t){return parseInt(t,10)})).map(i.pxToTwips):[];break;case _.ColsWidth:t.colWidths=a?a.split("|").map((function(t){return parseInt(t,10)})).map(i.pxToTwips):[]}})),t},e.handleCharBank=function(t,e,r,a){var o;if(o=a.attribFlags&J.ListTemplate?yt.attribsToNumberingProp(a.attribArr):yt.attribsToParaProp(a.attribArr),r===n.PlaceholderChar.TableStart)(i=new n.TableProperty(o.paraProp)).subId=n.DOC_ID,i=this.attribsToTableProp(i,a.attribArr),t.startCreateTable(e,i);else if(r===n.PlaceholderChar.TableEnd){var i;(i=new n.TableProperty(o.paraProp)).subId=n.DOC_ID,i=this.attribsToTableProp(i,a.attribArr),t.endCreateTable(e,i)}else if(r===n.PlaceholderChar.TableRowBreak){var s=new n.TableRowProperty(o.paraProp);s.tableDepth=1,s=this.attribsToTableRowProp(s,a.attribArr);var p=ft.attribsToTableRowBreakSpan(a.attribArr).rowBreakSpan;t.insertTableRowPara(e,p,s)}else if(r===n.PlaceholderChar.TableCellBreak){var l=new n.TableCellProperty(o.paraProp);l.tableDepth=1,l=this.attribsToTableCellProp(l,a.attribArr);var c=ft.attribsToTableCellBreakSpan(a.attribArr);t.insertTableCellPara(e,c.cellBreakSpan,l)}else r===n.PlaceholderChar.TableCellStart?t.insertTableCellStart(e,new n.TableCellStartSpan):r===n.PlaceholderChar.TableRowStart&&t.insertTableRowStart(e,new n.TableRowStartSpan);return!0},e.hasCellBreakStructFlag=function(t){for(var e=0;e<t.length;e++){var r=t[e][0],a=t[e][1];if(r===P.DeleteFirst||"tbl-flag"===r&&a===x.Cell||r===k.RowSpan||r===k.ColSpan)return!0}return!1},e.hasStructFlag=function(t,e){return t===n.PlaceholderChar.TableCellBreak?!!this.hasCellBreakStructFlag(e):!(!ft.hasAttri(e,"tbl-flag",St[t])&&!ft.hasAttri(e,P.DeleteFirst,"true"))},e}(Z),Ct=function(){function t(){}return t.applyToModel=function(t,e,r){var a=o.Changeset.opIterator(t.attribs);if(!a.hasNext())return!1;for(var i=o.Changeset.stringIterator(t.text);a.hasNext();){var s=a.next(),p="",l=Z.parseAttribs(s.attribs,e);switch(s.opcode){case"+":p=i.take(s.chars),this._handleAddCharBank(r,r.currentRange().end(),p,l);break;case"-":this._handleDeleteCharBank(r,new n.GCPRange(r.currentRange().end(),s.chars));break;case"=":s.attribs.length>0?this._handleSetAttribs(r,new n.GCPRange(r.currentRange().end(),s.chars),l):r.moveTo(new n.GCPRange(r.currentRange().end()+s.chars,0))}}return!0},t._handleAddCharBank=function(t,e,r,a){var o=e,i=0,s=0,p=null;function l(o){if(s>0){p||(p=ft.attribsToTextSpan(a.attribArr));var n=r.substr(i,s);t.insertText(e+i,n,p.textSpan)}s=0,i=o+1}for(var c=0;c<r.length;c++){var h=r[c];if(h===n.PlaceholderChar.StoryBegin)l(c),(u=gt.attribsToStoryProp(a.attribArr)).storyProp.has(n.StoryPropKey.storyType)?u.storyProp.storyType=u.storyProp.storyType:u.storyProp.storyType=gt.getStoryType(u.storyProp.storyId),t.insertStoryBegin(o,u.storyProp,n.PlaceholderChar.StoryBegin);else if(h===n.PlaceholderChar.StoryEnd){var u;l(c),(u=gt.attribsToStoryProp(a.attribArr)).storyProp.has(n.StoryPropKey.storyType)?u.storyProp.storyType=u.storyProp.storyType:u.storyProp.storyType=u.storyProp.storyId===n.StoryID.MainDocId?n.StoryType.MainTextStory:gt.getStoryType(u.storyProp.storyId),t.insertStoryEnd(o,u.storyProp,n.PlaceholderChar.StoryEnd)}else if(h===n.PlaceholderChar.SectionBreak){l(c);var b=dt.attribsToSectProp(a.attribArr),g=ft.attribsToSectBreakSpan(a.attribArr);t.insertSection(o,g.sectBreakSpan,b.sectProp)}else if(h===n.PlaceholderChar.PageBreak){l(c);var d=ft.attribsToTextSpan(a.attribArr);t.insertPageBreak(o,new n.PageBreakSpan(d.textSpan))}else if(h===n.PlaceholderChar.ParagraphBreak){l(c);var y;y=a.attribFlags&J.ListTemplate?yt.attribsToNumberingProp(a.attribArr):yt.attribsToParaProp(a.attribArr);var f=ft.attribsToParaBreakSpan(a.attribArr);t.insertParagraph(o,f.paraBreakSpan,y.paraProp)}else if(h===n.PlaceholderChar.TableStart||h===n.PlaceholderChar.TableEnd||h===n.PlaceholderChar.TableRowBreak||h===n.PlaceholderChar.TableCellBreak||h===n.PlaceholderChar.TableCellStart||h===n.PlaceholderChar.TableRowStart)l(c),At.handleCharBank(t,o,h,a);else if(a.attribFlags&J.FieldCharSpan){l(c);var P=Tt.attribToFieldCharSpan(a.attribArr);t.insertFieldChar(o,P.fieldCharSpan)}else if(a.attribFlags&J.PluginContainer){l(c);var T=mt.attribsToPluginProp(a.attribArr);t.insertPlugin(o,T.pluginProp)}else if(a.attribFlags&J.ImageProperty){l(c);var m=Tt.attribsToImageProp(a.attribArr);t.globalOpts.isInputDoc&&(m.imageProp.isFromInitLoad=!0),t.insertImage(o,m.imageProp)}else if(a.attribFlags&J.SplitlineProperty){l(c);var S=Tt.attribsToSplitlineProp(a.attribArr);t.insertSplitline(o,S.splitlineProp)}else if(a.attribFlags&J.CodeblockProperty){l(c);var A=Tt.attribsToCodeblockProp(a.attribArr);t.insertDrawing(o,A.codeblockProp)}else if(a.attribFlags&J.EmbedCommentProperty){l(c);var C=Tt.attribsToEmbedCommentProp(a.attribArr);t.insertDrawing(o,C.embedCommentProp)}else if(a.attribFlags&J.TextframeProperty){l(c);var _=Tt.attribsToTextframeProp(a.attribArr);switch(_.textframeProp.textframeType){case n.TextframeType.Codeblock:A=Tt.attribsToCodeblockProp(a.attribArr),t.insertDrawing(o,A.codeblockProp);break;default:t.insertDrawing(o,_.textframeProp)}}else s++;o++}l(0)},t._handleDeleteCharBank=function(t,e){t.deleteText(e)},t._handleSetAttribs=function(t,e,r){if(r.attribFlags&J.Story){var a=gt.attribsToStoryProp(r.attribArr);t.setGlobalProperty(e,a.storyProp),t.clearStoryProperty(e,a.clearStoryProps)}if(r.attribFlags&J.Section){var o=dt.attribsToSectProp(r.attribArr);t.setSectionProperty(e,o.sectProp),t.clearSectionProperty(e,o.clearSectProps)}if(r.attribFlags&J.ListTemplate){var i=yt.attribsToNumberingProp(r.attribArr);t.setParagraphProperty(e,i.paraProp),t.clearParaProperty(e,i.clearParaProps)}else r.attribFlags&J.Paragraph&&(i=yt.attribsToParaProp(r.attribArr),t.setParagraphProperty(e,i.paraProp),t.clearParaProperty(e,i.clearParaProps));if(r.attribFlags&J.PluginContainer){var s=mt.attribsToPluginProp(r.attribArr);t.setSpanProperty(e,s.pluginProp),t.clearSpanProperty(e,s.clearSpanProps)}else if(r.attribFlags&J.ImageProperty){var p=Tt.attribsToImageProp(r.attribArr);t.setSpanProperty(e,p.imageProp),t.clearSpanProperty(e,p.clearSpanProps)}else if(r.attribFlags&J.SplitlineProperty){var l=Tt.attribsToSplitlineProp(r.attribArr);t.setSpanProperty(e,l.splitlineProp),t.clearSpanProperty(e,l.clearSpanProps)}else if(r.attribFlags&J.CodeblockProperty){var c=Tt.attribsToCodeblockProp(r.attribArr);t.setSpanProperty(e,c.codeblockProp),t.clearSpanProperty(e,c.clearSpanProps)}else if(r.attribFlags&J.TextframeProperty){var h=Tt.attribsToTextframeProp(r.attribArr);t.setSpanProperty(e,h.textframeProp),t.clearSpanProperty(e,h.clearSpanProps)}else if(r.attribFlags&J.DrawingContainer){var u=Tt.attribsToDrawingProp(r.attribArr);t.setSpanProperty(e,u.drawingProp),t.clearSpanProperty(e,u.clearSpanProps)}else if(r.attribFlags&J.BaseContainer){var b=Pt.attribsToContainerProp(r.attribArr);t.setSpanProperty(e,b.containerProp),t.clearSpanProperty(e,b.clearSpanProps)}else if(r.attribFlags&J.FieldCharSpan){var g=ft.attribToFieldCharSpan(r.attribArr);t.setSpanProperty(e,g.fieldCharSpan),t.clearSpanProperty(e,g.clearSpanProps)}else if(r.attribFlags&J.TextSpan){var d=ft.attribsToTextSpan(r.attribArr);t.setSpanProperty(e,d.textSpan),t.clearSpanProperty(e,d.clearSpanProps)}if(r.attribFlags&J.TableProperty){var y=At.attribsToTableProp(new n.TableProperty,r.attribArr);t.setTableProperty(e,y)}else if(r.attribFlags&J.TableRowProperty){var f=At.attribsToTableRowProp(new n.TableRowProperty,r.attribArr);t.setParagraphProperty(e,f)}else if(r.attribFlags&J.TableCellProperty){var P=At.attribsToTableCellProp(new n.TableCellProperty,r.attribArr);t.setParagraphProperty(e,P)}},t}(),_t=function(){function t(){this._apool=new o.AttribPool,this._currentLength=0,this._compatibleCs=""}return t.prototype.getApoolJsonObj=function(t,e){for(var r=e||t.length,a={},o=0;o<r;o++){var n=t[o];a[o]=n}return{numToAttrib:a,nextNum:t.length}},t.prototype.setApoolJson=function(t){this._apool=o.AttribPool.fromJsonable(t)},t.prototype.getAttribPool=function(){return this._apool},t.prototype.setAttribPool=function(t){this._apool=t},t.prototype.setDocAText=function(t,e){var r=t.text.length,a=o.Changeset.pack({oldLen:0,newLen:r,opsStr:t.attribs,charBank:t.text});if(i.Logger.info("atext_input, needUpgrade:"+e),e){var n=new bt(this._apool);a=n.compatible(a),this._compatibleCs=n.getCompatibleCs()}return this._currentLength=o.Changeset.unpack(a).newLen,this._applyToModel(a)},t.prototype._applyToModel=function(t){var e=n.DeltaOption.createServerDeltaOption(n.GCPRange.emptyRange()).buildDelta();e.globalOpts.isInputDoc=!0;var r=new n.StoryProperty;r.storyId=n.StoryID.MainDocId,r.storyType=n.StoryType.MainTextStory,e.insertStoryBegin(0,r);var a=o.Changeset.unpack(t);if(a){var i={attribs:a.opsStr,text:a.charBank};if(Ct.applyToModel(i,this._apool,e))return e}},t.prototype.getCurrentLength=function(){return this._currentLength},t.prototype.getCompatibleCs=function(){return this._compatibleCs},t}();!function(t){t.TRANS_DELTA_TO_ATEXT_DATA="transDeltaToAtextData",t.TRANS_ATEXT_DATA_TO_DELTA="transAtextDataToDelta",t.UNDO="undo",t.REDO="redo",t.IS_UNDO_AVAILBALE="isUndoAvailable",t.IS_REDO_AVAILBALE="isRedoAvailable",t.CLEAR_UNDO_REDO_STACK="clearUndoRedoStack"}($||($={})),function(t){t.SERVER="undo_server",t.LOCAL="undo_local",t.INVALID="undo_invalid"}(Y||(Y={}));var vt,kt=function(){function t(t,e,r,a,o,n){void 0===n&&(n=""),this.changesets=[],this.inverseCs=[],this.isMergeUndoStackTop=!1,this.undoListeners=[],this.undoEventId="",this.source=r,this.changesets=t,this.inverseCs=e,this.timestamp=(new Date).getTime(),this.isMergeUndoStackTop=a,this.undoListeners=o,this.undoEventId=n}return t.prototype.clone=function(){return new t(this.changesets.slice(),this.inverseCs.slice(),this.source,this.isMergeUndoStackTop,this.undoListeners)},t}(),wt=function(){function t(){}return t.opcodeOccurrences=function(t,e){return this.charOccurrences(o.Changeset.unpack(t).opsStr,e)},t.mergeChangesets=function(t,e,r){return t?e?o.Changeset.compose(t,e,r):t:e},t.mergeChangesetsByPoint=function(t,e,r){if(!t)return e;if(!e)return t;var a=this.opcodeOccurrences(t,"+"),n=this.opcodeOccurrences(e,"+"),i=this.opcodeOccurrences(t,"-"),s=this.opcodeOccurrences(e,"-");if(1===a&&1===n&&0===i&&0===s){var p=o.Changeset.compose(t,e,r),l=this.opcodeOccurrences(p,"+"),c=this.opcodeOccurrences(p,"-");if(1===l&&0===c)return p}else if(0===a&&0===n&&1===i&&1===s&&(p=o.Changeset.compose(t,e,r),l=this.opcodeOccurrences(p,"+"),c=this.opcodeOccurrences(p,"-"),0===l&&1===c))return p;return null},t.charOccurrences=function(t,e){for(var r=0,a=0;r>=0&&r<t.length;)(r=t.indexOf(e,r))>=0&&(a++,r++);return a},t}(),Kt=function(){function t(t){this.undoStack=[],this.redoStack=[],this.mergeInterval=500,this.undoStack=[],this.redoStack=[],this.undoredo=t}return t.prototype.serverDo=function(t){this.undoStack.push(t),this.redoStack.push(t.clone())},t.prototype.localDo=function(t){this.checkLocalEventMerge(t)||this.undoStack.push(t),this.redoStack=[]},t.prototype.invalidDo=function(t){if(t.source===Y.INVALID&&t.undoEventId.length>0)for(var e=this.undoStack.length-1;e>=0;e--){var r=this.undoStack[e];if(r.source===Y.LOCAL&&r.undoEventId===t.undoEventId){var a=wt.mergeChangesets(t.inverseCs[0],r.inverseCs[0],this.undoredo.collab.getAttribPool()),o=wt.mergeChangesets(r.changesets[0],t.changesets[0],this.undoredo.collab.getAttribPool());o&&a&&(r.inverseCs[0]=a,r.changesets[0]=o);break}this.handleUndoConflict(t,r)}},t.prototype.checkLocalEventMerge=function(t){var e,r=this.undoStack[this.undoStack.length-1];if(r&&r.source===Y.LOCAL&&t.isMergeUndoStackTop){var a=wt.mergeChangesets(t.inverseCs[0],r.inverseCs[0],this.undoredo.collab.getAttribPool());return!(!(e=wt.mergeChangesets(r.changesets[0],t.changesets[0],this.undoredo.collab.getAttribPool()))||!a||(r.inverseCs[0]=a,r.changesets[0]=e,0))}return!(r&&r.source===Y.LOCAL&&t.timestamp-r.timestamp>this.mergeInterval)&&(!!(r&&r.source===Y.LOCAL&&r.changesets.length>0&&t.changesets.length>0)&&(a=wt.mergeChangesetsByPoint(t.inverseCs[0],r.inverseCs[0],this.undoredo.collab.getAttribPool()),!(!(e=wt.mergeChangesetsByPoint(r.changesets[0],t.changesets[0],this.undoredo.collab.getAttribPool()))||!a||(r.inverseCs[0]=a,r.changesets[0]=e,0))))},t.prototype.undoRedo=function(t){for(var e="undo"===t?this.undoStack:this.redoStack,r="undo"===t?this.redoStack:this.undoStack,a=e.length-1;a>=0;a--){var o=e[a];if(o.source===Y.LOCAL){var n=o,i=e.slice(a+1),s=this.invert(n,i);return s&&r.push(s),e.splice(a,1),s}}return null},t.prototype.invert=function(t,e){var r=this,a=new kt(t.inverseCs,t.changesets,Y.LOCAL,!1,t.undoListeners);return e.forEach((function(t){r.handleUndoConflict(a,t)})),a},t.prototype.handleUndoConflict=function(t,e){if(e.changesets.length>0&&t.changesets.length>0){var r=t.changesets[0],a=t.inverseCs[0];r=o.Changeset.follow(e.changesets[0],r,!1,this.undoredo.collab.getAttribPool(),!1),e.changesets[0]=o.Changeset.follow(t.changesets[0],e.changesets[0],!0,this.undoredo.collab.getAttribPool(),!1),a=o.Changeset.follow(e.changesets[0],a,!0,this.undoredo.collab.getAttribPool(),!1),t.changesets[0]=r,t.inverseCs[0]=a}},t.prototype.isUndoAvailable=function(){return this.undoStack.length>0},t.prototype.isRedoAvailable=function(){return this.redoStack.length>0},t.prototype.clear=function(){this.undoStack=[],this.redoStack=[]},t}();!function(t){t.Undo="Undo",t.Redo="Redo"}(vt||(vt={}));var It,xt=function(t){function e(e,r){var a=t.call(this,e)||this;return a.listeners=r,a}return p(e,t),e}(i.Notification),Lt=function(){function t(t,e){this._bufferEvents=[],this._undoIdArray=[],this.collab=t,this._editor=e,this._stack=new Kt(this)}return t.prototype.undo=function(){var t=this._stack.undoRedo("undo");t&&(this.collab.applyUndoRedoChange(t.changesets),t.undoListeners&&t.undoListeners.length>0&&this._editor.fire(new xt(vt.Undo,t.undoListeners)),n.ReportHelper.tdwReport({opername:"doc_word_editor",module:"doc_whole",action:"undo"}))},t.prototype.redo=function(){var t=this._stack.undoRedo("redo");t&&(this.collab.applyUndoRedoChange(t.changesets),n.ReportHelper.tdwReport({opername:"doc_word_editor",module:"doc_whole",action:"redo"}))},t.prototype.isUndoAvailable=function(){return this._stack.isUndoAvailable()},t.prototype.isRedoAvailable=function(){return this._stack.isRedoAvailable()},t.prototype.clearUndoRedo=function(){this._stack.clear()},t.prototype.clearUndoRedoStack=function(){this._stack.clear()},t.prototype.dispatchUndoRedoEvent=function(t,e,r,a,o,n){var i=this;void 0===n&&(n="");var s=Y.LOCAL;r&&n.length>0&&(this._undoIdArray.indexOf(n)>=0?s=Y.INVALID:this._undoIdArray.push(n)),r||(s=Y.SERVER);var p=new kt(t,e,s,a,o,n);this.addBufferEvents(p),this._mergeDeltaTimeout||(this._mergeDeltaTimeout=setTimeout((function(){i._bufferEvents.length>0&&(i._bufferEvents.forEach((function(t){i.dispatchEventToStack(t)})),i._bufferEvents=[]),i._mergeDeltaTimeout=null})))},t.prototype.canMergeEvent=function(t,e){return null!=t&&null!=e&&t.source===e.source&&1===t.changesets.length&&1===t.inverseCs.length&&1===e.changesets.length&&1===e.inverseCs.length},t.prototype.addBufferEvents=function(t){this._bufferEvents.length>0&&this.canMergeEvent(t,this._bufferEvents[this._bufferEvents.length-1])?this.mergeEventToBuffer(t):this._bufferEvents.push(t)},t.prototype.mergeEventToBuffer=function(t){var e,r=this._bufferEvents[this._bufferEvents.length-1];if(r){var a=wt.mergeChangesets(t.inverseCs[0],r.inverseCs[0],this.collab.getAttribPool()),o=wt.mergeChangesets(r.changesets[0],t.changesets[0],this.collab.getAttribPool());return o&&a?(r.inverseCs[0]=a,r.changesets[0]=o,t.undoListeners&&(r.undoListeners?(e=r.undoListeners).push.apply(e,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}(t.undoListeners)):r.undoListeners=t.undoListeners.slice()),!0):(this._bufferEvents.push(t),!1)}return!1},t.prototype.dispatchEventToStack=function(t){var e=t.changesets,r=t.inverseCs,a=t.source,n=t.isMergeUndoStackTop,i=t.undoListeners,s=a===Y.LOCAL,p=[],l=[];if(s&&e.length&&r.length){if(p[0]=e[0],l[0]=r[r.length-1],e.length>1)for(var c=1;c<=e.length-1;c++){if(!o.Changeset.canCompose(p[0],e[c]))return void this.undoError(e,r,s);p[0]=o.Changeset.compose(p[0],e[c],this.collab.getAttribPool())}if(r.length>1)for(c=r.length-2;c>=0;c--){if(!o.Changeset.canCompose(l[0],r[c]))return void this.undoError(e,r,s);l[0]=o.Changeset.compose(l[0],r[c],this.collab.getAttribPool())}if(!o.Changeset.isInverseCsPair(p[0],l[0]))return void this.undoError(e,r,s)}s||(p=e,l=r);var h=new kt(p,l,a,n,i,t.undoEventId);s?this._stack.localDo(h):h.source===Y.INVALID&&h.undoEventId.length>0?this._stack.invalidDo(h):this._stack.serverDo(h)},t.prototype.undoError=function(t,e,r){i.Logger.error("undo error changeset: "+t.toString()+" inverseCs: "+e.toString()+" isLocal: "+r),this._stack.clear()},t}();!function(t){t.LocalChange="LocalChange"}(It||(It={}));var Rt,Bt=function(t){function e(e,r){var a=t.call(this,It.LocalChange)||this;return a.changeset=e,a.apool=r,a}return p(e,t),e}(i.Notification);!function(t){t.push="pushChangesetLog",t.get="getChangsetLog",t.getFromStore="getChangesetLogFromStore",t.produceData="dataProduceAction",t.reportEdit="reportEdit"}(Rt||(Rt={}));var Dt=function(){function t(e,r){var a,o=this;this.getGlobalAndDomain=e,this.dirty=r,this._changesetLog=[],this.plugin=((a={})[Rt.push]=function(e,r,a){o._changesetLog.unshift(a),o._changesetLog.length>t.MAX_LOG_COUNT&&o._changesetLog.pop()},a[Rt.get]=function(){return o._changesetLog},a[Rt.getFromStore]=function(){var t=o.getGlobalAndDomain(),e=t.globalPadId,r=t.userDomain;return i.LocalStorageUtil.getItem(e+"_"+r+"_offline_changeset_log")||""},a[Rt.produceData]=function(t,e,r,a,o){if(void 0===o&&(o=1),n.ReportHelper.coreIndexReport({opername:"tech_doc_dataflow_melo",module:"data_produce",action:a,ver5:"0",obj3:o},r,{}),o>1)for(var s=1;s<o;s++)n.ReportHelper.monitor(r);i.Logger.debug("dataProduceAction | "+a+" "+o)},a[Rt.reportEdit]=function(){n.ReportHelper.tdwReport({opername:"doc_core",module:"edit",action:"edit_text",obj3:i.PlatformUtil.getBrowser(),ver5:1===o.dirty()?"limited":"normal"})},a),window.addEventListener("beforeunload",(function(){o.setChangesetLog2Store()}))}return t.prototype.registerPlugin=function(t){t.registerPlugin(this.plugin)},t.prototype.setChangesetLog2Store=function(){var t=this.getGlobalAndDomain(),e=t.globalPadId+"_"+t.userDomain+"_offline_changeset_log";this._changesetLog.length>0?i.LocalStorageUtil.setItem(e,JSON.stringify(this._changesetLog)):i.LocalStorageUtil.removeItem(e)},t.MAX_LOG_COUNT=10,t}(),Ot=function(){function t(t,e,r){var a=this;this._editor=t,this._apool=e,this.ignoreLineRev=r,this._offlineRestored=!1,this._currentLength=0,this._undoRedo=new Lt(this,this._editor),this._editor.on(n.StateNotification.CollabToServer,(function(t){var e=t;a.collaboration(e.delta)})),this._editor.registerPlugin(function(t,e){var r;return(r={})[$.TRANS_DELTA_TO_ATEXT_DATA]=function(e,r,a,n){var i=ut.applyToAtext(a.operations,t,n);if(i){var s=new o.AttribPool;i.attribs=o.Changeset.moveOpsToNewPool(i.attribs,t,s);var p={atext:i,apool:s.toJsonable()};return JSON.stringify(p)}return""},r[$.TRANS_ATEXT_DATA_TO_DELTA]=function(t,e,r,a){try{var n=JSON.parse(a),i=n.atext,s=n.apool;if(i&&"object"==typeof i&&i.attribs&&i.text&&s&&"object"==typeof s&&s.numToAttrib){var p=o.AttribPool.fromJsonable(s);return Ct.applyToModel(i,p,r)}return!1}catch(t){return!1}},r[$.UNDO]=function(){e.undo()},r[$.REDO]=function(){e.redo()},r[$.IS_UNDO_AVAILBALE]=function(){return e.isUndoAvailable()},r[$.IS_REDO_AVAILBALE]=function(){return e.isRedoAvailable()},r[$.CLEAR_UNDO_REDO_STACK]=function(){e.clearUndoRedoStack()},r}(this._apool,this._undoRedo))}return t.prototype.setChangesetManager=function(t){this._csManager=t},t.prototype.initPadRev=function(t){this.getPadRev=t},t.prototype.getUndoRedo=function(){return this._undoRedo},t.prototype.getAttribPool=function(){return this._apool},t.prototype.setOfflineRestored=function(t){this._offlineRestored=t},t.prototype.applyToModel=function(t){var e=n.DeltaOption.createServerDeltaOption(n.GCPRange.emptyRange()).buildDelta(),r=o.Changeset.unpack(t);if(r){this._currentLength=r.newLen;var a={attribs:r.opsStr,text:r.charBank};Ct.applyToModel(a,this._apool,e)&&(this._editor.applyDelta(e),this._offlineRestored&&this.verifyCurrentLength(e))}},t.prototype.collaboration=function(t){var e=[],r=[],a=t.globalOpts.undoOption.needInverse,s=this._preCollabDelta(t),p=s.operations,l=s.inverseOps;o.ChangesetTool.autoReport=!1;try{n.GlobalContext.run(Rt.push,{rev:this.getPadRev(),sub:"BB08J2",ops:t.getOpInfo(),msg:t.msg}),n.GlobalContext.run(Rt.produceData,n.MonitorName.DATA_PRODUCE,"cs_produce");var c=ut.applyToCSInfo(p,this._apool,this._currentLength);if(l.reverse(),!n.OperationUtil.checkOpsValid(p)||!n.OperationUtil.checkOpsValid(l))throw new Error("operations check failed.\n                    ops type:["+p.map((function(t){return t.operationType})).join(",")+"],\n                    inverseOps type:["+l.map((function(t){return t.operationType})).join(",")+"]");var h=c?ut.applyToCSInfo(l,this._apool,c.newLen):null;n.GlobalContext.run(Rt.produceData,n.MonitorName.DATA_TRANSFORM,"cs_transform"),this.collaborationDoc(c),n.GlobalContext.run(Rt.produceData,n.MonitorName.DATA_COMPOSE,"cs_compose"),a&&c&&h&&(e.push(o.Changeset.pack(c)),r.push(o.Changeset.pack(h)))}catch(t){i.Logger.error("collaboration | "+t),n.ReportHelper.monitor(n.MonitorName.DATA_PRODUCE_ERROR_FRONT),n.ReportHelper.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:n.EditorDocumentType.DOCUMENT,ver7:n.ChangesetDataType.EDIT_DATA,obj3:1}),n.ReportHelper.captureChangesetException(n.MonitorName.CHANGESET_ERROR_DELTA2CS,{option:{changesetDataType:n.ChangesetDataType.EDIT_DATA,editorDocumentType:n.EditorDocumentType.DOCUMENT}},t)}finally{o.ChangesetTool.autoReport=!0,this.reportRangeException(t)}this.verifyCurrentLength(t);var u=t.globalOpts.undoOption.undoListener;a&&e.length>0&&r.length>0&&this._undoRedo.dispatchUndoRedoEvent(e,r,!0,t.globalOpts.undoOption.needMergeUndoStackTop,u?[u]:void 0,t.globalOpts.undoOption.undoEventId)},t.prototype.collaborationDoc=function(t){if(!(this._currentLength<=0)&&t){this._currentLength=t.newLen;var e=o.Changeset.pack(t),r=new o.AttribPool,a=o.Changeset.moveOpsToNewPool(e,this._apool,r),n={apool:r.toJsonable(),changeset:a,keydata:!1,subId:"BB08J2",head:!1,oSubId:!1,baseRev:10};i.Logger.info("collaboration = "+JSON.stringify(n)),this._editor.fire(new Bt(a,r)),this._csManager.composeUserChangeset(e)}},t.prototype.applyUndoRedoChange=function(t){var e=this;t.length>0&&t.forEach((function(t){e.applyUndoDelta(t)}))},t.prototype.applyUndoDelta=function(t){var e=n.DeltaOption.createLocalDeltaOption(n.GCPRange.emptyRange(),!0,!0).buildDelta();e.globalOpts.undoOption.needInverse=!1,e.globalOpts.undoOption.fromUndo=!0;var r=o.Changeset.unpack(t),a=this._editor.service.getSelection().range();if(r){var i={attribs:r.opsStr,text:r.charBank},s=Ct.applyToModel(i,this._apool,e);a=new n.GCPRange(n.OperationUtil.getFixPos(e.operations,a.gcpBegin),a.len),s&&(e.moveTo(a),this._editor.applyDelta(e)),this._editor.setRangeTo(a,{forceFocus:!0})}},t.prototype.applyChangesToBase=function(t){this.applyToModel(t),this._undoRedo.dispatchUndoRedoEvent([t],[],!1,!1)},t.prototype.setBaseAttributedText=function(t){var e=new _t;e.setAttribPool(this._apool);var r=e.setDocAText(t,void 0===this.ignoreLineRev);return r&&this._editor.setContent(r),this._currentLength=e.getCurrentLength(),e.getCompatibleCs()},t.prototype._preCollabDelta=function(t){var e=[],r=[];function a(t){var a,o;e.push(t);try{for(var n=l(t.inverseOpArray),i=n.next();!i.done;i=n.next()){var s=i.value;r.push(s)}}catch(t){a={error:t}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}}}return t.forEachOp((function(t){t.replaceOpArray.length>0?t.replaceOpArray.forEach((function(t){t&&a(t)})):a(t)})),{operations:e,inverseOps:r}},t.prototype.verifyCurrentLength=function(t){var e=this._editor.service.getDocument().getDocLength(),r=this._editor.service.getDocument().getExceptionRanges();r.forEach((function(t){e-=t.length()})),e!==this._currentLength&&n.ReportHelper.captureChangesetException(n.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,{option:{}},new Error("len:"+e+"!="+this._currentLength+",excepts:"+JSON.stringify(r)+",origin:"+t.opInfo))},t.prototype.reportRangeException=function(t){t.operations.some((function(t){return t instanceof n.IContentOperationBase&&(t.param.range.gcpBegin<0||t.param.range.len<0)}))&&n.ReportHelper.captureException(n.MonitorName.CHANGESET_ERROR_EXCEPTION,{},new Error("origin: "+t.opInfo+", now: "+JSON.stringify(t.getOpInfo())))},t}()}}]);
//# sourceMappingURL=doc-pc-melo-plugins.js.map