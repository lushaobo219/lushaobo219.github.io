(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{108:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),o=n(15),i=n(49),a=n(9),s=n(20),c=function(e,t){this.DBisOK=e,t&&(this.data=t)},u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},d=function(){function e(){this.DataBaseInitTimeout=5e3,this.GetChangsetsFromDBTimeout=5e3}return e.prototype.getDataBaseStatusPromise=function(){var e=this,t=new Promise((function(t){setTimeout(t,e.DataBaseInitTimeout,o.b.InitException)}));return Promise.race([t,o.c.DBStatusPromise])},e.prototype.getChangsetsTimeoutPromise=function(){var e=this;return new Promise((function(t){e.dataBaseTimeoutID=setTimeout((function(){a.b.monitorReport(35156077),t(new c(!0,{error:"loadOfflineChangesFromIndexDB timeout! "}))}),e.GetChangsetsFromDBTimeout)}))},e.prototype.verifyOfflineChanges=function(e,t,n,r){var o=r,i=n,s=t;return o&&s&&0===i.length&&o.baseRev===s.baseRev&&o.changeset&&o.changeset===s.changeset&&(o=void 0,a.b.monitorOfflineMissFollowErr("EqualChangset")),{version:e,userChange:o,userChangeQuene:i,userChangeSubmitted:s}},e.prototype.loadOfflineChangesFromDataBase=function(e){return u(this,void 0,void 0,(function(){var t,n,a,u,d,f,p,h,g,v,w;return l(this,(function(l){switch(l.label){case 0:return t=+new Date,n=[r.OFFLINE_ITEM_TYPE.COMMITING,r.OFFLINE_ITEM_TYPE.QUEUE,r.OFFLINE_ITEM_TYPE.WATTING],a=i.a.get("uid"),u=r.QueryCondition.newInstance().addCondition("secretId",r.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",r.QUERY_CONDITION_TYPE.IN,n).addCondition("uid",r.QUERY_CONDITION_TYPE.ONLY,a),[4,o.c.getDataBase().getAll(r.TableName.OFFLINE_DATA,u)];case 1:return d=l.sent(),clearTimeout(this.dataBaseTimeoutID),f=+new Date-t,window.getClientVarsCost&&(window.getClientVarsCost.getOfflineDataCost=f),d.error?(s.a.roomLogError(JSON.stringify(d.error)),[2,new c(!0,{error:d.error})]):((p=d.data).sort((function(e,t){return e.type===t.type?e.createTime-t.createTime:n.indexOf(e.type)-n.indexOf(t.type)})),v=[],p.forEach((function(e){var t=e.data&&e.data.data;if(t){var n={apool:t.apool,baseRev:t.baseRev,changeset:t.changeset,commitId:t.taskId,firstCommitRev:t.baseRev,head:t.head,keydata:t.keyData,oSubId:t.oSubId,subId:t.subId};switch(h=t.baseRev,e.type){case r.OFFLINE_ITEM_TYPE.WATTING:g=n;break;case r.OFFLINE_ITEM_TYPE.QUEUE:v.push(n);break;case r.OFFLINE_ITEM_TYPE.COMMITING:w=n}}})),[2,new c(!0,this.verifyOfflineChanges(h,w,v,g))])}}))}))},e.prototype.loadOfflineChangesets=function(e){return u(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this.getDataBaseStatusPromise()];case 1:return t.sent()!==o.b.InitFinish?[2,new c(!1,{error:"DataBase init status !== IndexDBStatus.InitFinish"})]:[2,Promise.race([this.loadOfflineChangesFromDataBase(e),this.getChangsetsTimeoutPromise()])]}}))}))},e}(),f=n(78),p=function(){function e(){var e=this;this.mergeToBaseAtextCommitId=[],this.onReset=function(t){var n=t&&t.detail&&t.detail.newSecretId;e.loadingPromise=void 0,n&&e.loadOfflineChangesetsPromise(n)},this.offlineChangsets=new d,this.loadOfflineChangesetsPromise(Object(f.a)()),document.addEventListener("BeforeReplaceUrlNotification",this.onReset)}return e.prototype.mergeToBase=function(e){e&&this.mergeToBaseAtextCommitId.push(e)},e.prototype.isMergeToBase=function(e){return!!e&&this.mergeToBaseAtextCommitId.includes(e)},e.prototype.loadOfflineChangesetsPromise=function(e){var t=this;return this.loadingPromise||(this.loadingPromise=new Promise((function(n,r){t.offlineChangsets.loadOfflineChangesets(e).then((function(e){n(e)})).catch((function(e){r(e)}))}))),this.loadingPromise},e}(),h=window.offlineChangsetsManage;h||(h=new p,window.offlineChangsetsManage=h)},163:function(e,t,n){"use strict";function r(e,t){return t?e+t.slice(0,5):e}function o(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!==n?unescape(n[2]):null}function i(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}function a(e,t){var n=window.history;try{t?n.replaceState(null,"",e):n.pushState(null,"",e)}catch(n){window.location[t?"replace":"assign"](e)}}n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),window.__pushState=a},202:function(e,t,n){
/*!
 Copyright 2018 Google Inc. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
/*! lifecycle.es5.js v0.1.1 */
e.exports=function(){"use strict";var e=void 0;try{new EventTarget,e=!1}catch(t){e=!1}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},a=function(){function e(){n(this,e),this._registry={}}return r(e,[{key:"addEventListener",value:function(e,t){this._getRegistry(e).push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._getRegistry(e),r=n.indexOf(t);r>-1&&n.splice(r,1)}},{key:"dispatchEvent",value:function(e){return e.target=this,Object.freeze(e),this._getRegistry(e.type).forEach((function(t){return t(e)})),!0}},{key:"_getRegistry",value:function(e){return this._registry[e]=this._registry[e]||[]}}]),e}(),s=e?EventTarget:a,c=e?Event:function e(t){n(this,e),this.type=t},u=function(e){function t(e,r){n(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.newState=r.newState,o.oldState=r.oldState,o.originalEvent=r.originalEvent,o}return o(t,c),t}(),l="active",d="passive",f="hidden",p="frozen",h="terminated",g="object"===("undefined"==typeof safari?"undefined":t(safari))&&safari.pushNotification,v=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],w=function(e){return e.preventDefault(),e.returnValue="Are you sure?"},m=[[l,d,f,h],[l,d,f,p],[f,d,l],[p,f],[p,l],[p,d]].map((function(e){return e.reduce((function(e,t,n){return e[t]=n,e}),{})})),b=function(){return document.visibilityState===f?f:document.hasFocus()?l:d};return new(function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=b();return e._state=r,e._unsavedChanges=[],e._handleEvents=e._handleEvents.bind(e),v.forEach((function(t){return addEventListener(t,e._handleEvents,!0)})),g&&addEventListener("beforeunload",(function(t){e._safariBeforeUnloadTimeout=setTimeout((function(){t.defaultPrevented||t.returnValue.length>0||e._dispatchChangesIfNeeded(t,f)}),0)})),e}return o(t,s),r(t,[{key:"addUnsavedChanges",value:function(e){!this._unsavedChanges.indexOf(e)>-1&&(0===this._unsavedChanges.length&&addEventListener("beforeunload",w),this._unsavedChanges.push(e))}},{key:"removeUnsavedChanges",value:function(e){var t=this._unsavedChanges.indexOf(e);t>-1&&(this._unsavedChanges.splice(t,1),0===this._unsavedChanges.length&&removeEventListener("beforeunload",w))}},{key:"_dispatchChangesIfNeeded",value:function(e,t){if(t!==this._state)for(var n=function(e,t){for(var n,r=0;n=m[r];++r){var o=n[e],i=n[t];if(o>=0&&i>=0&&i>o)return Object.keys(n).slice(o,i+1)}return[]}(this._state,t),r=0;r<n.length-1;++r){var o=n[r],i=n[r+1];this._state=i,this.dispatchEvent(new u("statechange",{oldState:o,newState:i,originalEvent:e}))}}},{key:"_handleEvents",value:function(e){switch(g&&clearTimeout(this._safariBeforeUnloadTimeout),e.type){case"pageshow":case"resume":this._dispatchChangesIfNeeded(e,b());break;case"focus":this._dispatchChangesIfNeeded(e,l);break;case"blur":this._state===l&&this._dispatchChangesIfNeeded(e,b());break;case"pagehide":case"unload":this._dispatchChangesIfNeeded(e,e.persisted?p:h);break;case"visibilitychange":this._state!==p&&this._state!==h&&this._dispatchChangesIfNeeded(e,b());break;case"freeze":this._dispatchChangesIfNeeded(e,p)}}},{key:"state",get:function(){return this._state}},{key:"pageWasDiscarded",get:function(){return document.wasDiscarded||!1}}]),t}())}()},228:function(e,t,n){"use strict";function r(e,t){var n=e.split("?");if(n.length>=2){for(var r=encodeURIComponent(t)+"=",o=n[1].split(/[&;]/g),i=o.length;i>0;)-1!==o[i-=1].lastIndexOf(r,0)&&o.splice(i,1);return n[0]+(o.length>0?"?"+o.join("&"):"")}return e}function o(e){var t,n,r,o=window.location.search.substring(1);if(o)for(t=o.split("&"),n=0;n<t.length;n++)if((r=t[n].split("="))[0]===e)return r[1];return null}function i(){var e=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),t=window.location.pathname.split("/").pop();window.secretSessionId=t?t+"_"+e:""+e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}))},249:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(228),o=n(20),i=n(89);function a(e){for(var t=0,n=e||"",r=n.length,o={text:{type:"",value:null},attribs:{type:"",value:null},head:{type:"",value:null}};t<r;){var i=n.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],s=i[1],c=Number(i[2]);t+=i[0].length+i[1].length+i[2].length+3;var u=n.slice(t,t+c);t+=c+1,"text"===a?(o.text.type=s,o.text.value="json"===s?JSON.parse(u):u):"head"===a?(o.head.type=s,o.head.value="json"===s?JSON.parse(u):u):"attribs"===a&&(o.attribs.type=s,o.attribs.value="json"===s?JSON.parse(u):u)}return o}function s(e){var t=a(e);if(t){var n=t.head.value;if(t.text&&t.text.value){var r=n.needEscape?escape(t.text.value):t.text.value;n.clientVars.collab_client_vars.initialAttributedText.text=r,n.clientVars.collab_client_vars.initialAttributedText.attribs=t.attribs.value}return n.clientVars}}var c=n(3),u=n(8);function l(e){if(e&&e.collab_client_vars&&e.globalPadId&&e.padType&&(e.padType===u.b.Doc||e.padType===u.b.AIO)){var t=function(e){var t=e;return t.isMac=i.a.isMac(),t.isIPad=i.a.isIPad(),t.isMobile=!t.isIPad&&i.a.isMobile(),t.isIPhone=i.a.isIPhone(),t.isTimOnline=!0,t.cdn="",t.padStatus=t.padStatus||c.PadStatus.NORMAL,t}(e);return t=function(e){var t=e;return t.creatorDomain||(t.creatorDomain=t.domainId),t}(t)}return null}var d=n(15),f=n(49),p=n(4),h=function(){function e(e){this._baseAText=p.Changeset.makeAText("\n"),this._apool=new p.AttribPool,this.clientVarsOri=e;var t={text:unescape(e.collab_client_vars.initialAttributedText.text),attribs:e.collab_client_vars.initialAttributedText.attribs},n=e.collab_client_vars.apool;if(this._baseAText=p.Changeset.cloneAText(t),n){var r=p.AttribPool.fromJsonable(n);this._baseAText.attribs=p.Changeset.moveOpsToNewPool(this._baseAText.attribs,r,this._apool)}}return e.prototype.getClientvarsBaseAtext=function(){return p.Changeset.identity(this._baseAText.text.length)},e.prototype.compose=function(e){var t=this,n=this.clientVarsOri.collab_client_vars.rev,r=this.getClientvarsBaseAtext();return e&&e.length>0&&e.forEach((function(e){var o=e.changeset||"",i=e.apool,a=e.baseRev||n;if(i){var s=p.AttribPool.fromJsonable(i);o=p.Changeset.moveOpsToNewPool(o,s,t._apool)}"BB08J2"===e.subId&&o&&(r=p.Changeset.compose(r,o,t._apool)),a>n&&(n=a)})),this.composed=r,this._baseAText=p.Changeset.applyToAText(this.composed,this._baseAText,this._apool),n},e.prototype.getComposeClientVars=function(e){var t=this.clientVarsOri,n=new u.e,r=+new Date;try{p.ChangesetTool.autoReport=!1;var i=this.compose(e);t.collab_client_vars.rev=i,t.collab_client_vars.apool=this._apool.toJsonable(),t.collab_client_vars.initialAttributedText.text=escape(this._baseAText.text),t.collab_client_vars.initialAttributedText.attribs=this._baseAText.attribs,n.data=t}catch(e){n.error=e||"getClientVars: compose error:"+e,o.a.err("getClientVars: compose error:"+e)}finally{p.ChangesetTool.autoReport=!0}var a=+new Date-r;return window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsDBCompose=a),o.a.info("getComposeClientVars cost:"+a),n},e.LOG_Module="ClientVarsOfflineData ",e}(),g=n(108),v=n(48),w=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},m=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},b=function(){function e(){}return e.prototype.printChangesetsToWeblog=function(e,t,n){o.a.info("clientvars:"+e.getClientvarsBaseAtext()+" rev:"+(t&&t.collab_client_vars&&t.collab_client_vars.rev)+"}"),n.forEach((function(e){e&&o.a.info("changeset:"+e.changeset+" rev:"+e.baseRev)})),setTimeout((function(){Object(o.b)("Word_MeloGetComposeClientVarsError")}),2e3)},e.prototype.loadInitAndServerChanges=function(e){return w(this,void 0,void 0,(function(){var t,n;return m(this,(function(r){switch(r.label){case 0:return t=f.a.get("uid"),n=c.QueryCondition.newInstance().addCondition("uid",c.QUERY_CONDITION_TYPE.ONLY,t).addCondition("secretId",c.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",c.QUERY_CONDITION_TYPE.IN,[c.OFFLINE_ITEM_TYPE.INIT,c.OFFLINE_ITEM_TYPE.ACCEPTED,c.OFFLINE_ITEM_TYPE.MISS_CHANGE,c.OFFLINE_ITEM_TYPE.NEW_CHANGE]),[4,d.c.getDataBase().getAll(c.TableName.DOCUMENT_DATA,n)];case 1:return[2,r.sent()]}}))}))},e.prototype.sortServerChangsets=function(e){return e.sort((function(e,t){return e.version===t.version?e.data&&t.data&&e.data.baseVersion!==t.data.baseVersion?e.data.baseVersion-t.data.baseVersion:e.createTime-t.createTime:e.version-t.version})),e},e.prototype.convertOfflineDataToIUserChange=function(e,t){var n=[],r=t;return e.forEach((function(e){var o=e.data&&e.data.data;if(o){if(e.version<=t)return;e.version>t&&(r=e.version);var i={apool:o.apool,baseRev:o.baseRev||o.newVersion,changeset:o.changeset,commitId:o.taskId,firstCommitRev:o.baseRev,head:o.head,keydata:o.keyData,oSubId:o.oSubId,subId:o.subId};switch(e.type){case c.OFFLINE_ITEM_TYPE.NEW_CHANGE:case c.OFFLINE_ITEM_TYPE.MISS_CHANGE:case c.OFFLINE_ITEM_TYPE.ACCEPTED:n.push(i)}}})),{changsets:n,rev:r}},e.prototype.loadClientVarsAndChangsets=function(e){return w(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return m(this,(function(u){switch(u.label){case 0:return[4,this.loadInitAndServerChanges(e)];case 1:return(t=u.sent()).error?[2,new c.Result(t.error)]:(r=[],t.data.forEach((function(e){e&&(e.type===c.OFFLINE_ITEM_TYPE.INIT?(!n||n&&n.collab_client_vars&&n.collab_client_vars.rev<e.version)&&(n=e.data):r.push(e))})),n?n.padStatus!==c.PadStatus.LOCAL&&n.padStatus!==c.PadStatus.NEW?[3,3]:[4,g.a.loadOfflineChangesetsPromise(e)]:[2,new c.Result(new Error("DataBase has not clientVars."))]);case 2:return(o=u.sent())&&o.DBisOK&&(i=[],o.data)?(o.data.userChangeSubmitted&&i.push(o.data.userChangeSubmitted),o.data.userChangeQuene&&(i=i.concat(o.data.userChangeQuene)),o.data.userChange&&i.push(o.data.userChange),i.forEach((function(e){e.commitId&&g.a.mergeToBase(e.commitId)})),[2,new c.Result(void 0,{clientVars:n,changsets:i,rev:n.collab_client_vars.rev})]):[2,new c.Result(new Error("DB is not OK!"))];case 3:return a=this.sortServerChangsets(r),s=this.convertOfflineDataToIUserChange(a,n.collab_client_vars.rev||-1),[2,new c.Result(void 0,{clientVars:n,changsets:s.changsets,rev:s.rev})]}}))}))},e.prototype.getClientVarsFromDataBase=function(e){return w(this,void 0,void 0,(function(){var t,n,r,o,i,a;return m(this,(function(s){switch(s.label){case 0:return[4,this.loadClientVarsAndChangsets(e)];case 1:return(t=s.sent()).error?[2,t]:t.data?(n=t.data.clientVars,r=t.data.changsets,o=t.data.rev,i=new h(n),(a=i.getComposeClientVars(r)).error?(this.printChangesetsToWeblog(i,n,r),n&&(Object(v.c)(n.globalPadId),Object(v.d)(n.globalPadId)),[2,new c.Result(new Error(""+a.error))]):(a.data&&(n=a.data)&&n.collab_client_vars&&n.collab_client_vars.rev&&o>n.collab_client_vars.rev&&(n.collab_client_vars.rev=o),[2,{data:n}])):[2,new c.Result(new Error("getClientVarsFromDataBase fail"))]}}))}))},e}(),C=n(10),y=n.n(C),_=n(163),I=function(){function e(){}return e.setBlankpageData=function(e,t){var n=3===e&&t&&t.data&&t.data.errcode?t.data:{};localStorage.setItem("blankPageData",JSON.stringify(n)),window.DocJumpBlankPage=!0,location.replace(location.href.replace("/doc/","/blankpage/"))},e}(),O=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},T=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=function(){function e(e){this.secretId=e}return e.prototype.getDocDataFromServer=function(e,t,n){var c=location.search;c&&c.indexOf("?")>-1?((c+="&").indexOf("uid_key")>-1&&(c=Object(r.b)(c,"uid_key")),c.indexOf("uid")>-1&&(c=Object(r.b)(c,"uid"))):c+="?";var u="/dop-api/opendoc"+c+"normal=1&id="+e,l=Object(_.b)("preview_token");return l&&(u=u+"&preview_token="+l),o.a.info("Opendoc Url:"+u),y.a.ajax({type:"get",url:u,timeout:i.a.isMiniProgram()?3e4:2e4,cache:!0,xhrFields:{withCredentials:!0},success:function(e){var n=s(e);if(t)if(!0===n.isBlankPage){var r=a(e).head.value;r&&t(r)}else t(n)},error:function(e,t,r){o.a.info("Opendoc request>:"+JSON.stringify(e)+" textStatus>:"+JSON.stringify(t)+" err>:"+JSON.stringify(r)),n&&n()}})},e.prototype.getPubDocDataFromServer=function(e,t,n){var r="https://docpub1.docs.qq.com/"+e+".doc1";return o.a.info("getPubDocDataFromServer:"+r),y.a.ajax({type:"get",url:r,timeout:i.a.isMiniProgram()?3e4:2e4,cache:!0,success:function(e){var n=s(e);if(t)if(!0===n.isBlankPage){var r=a(e).head.value;r&&t(r)}else n.isPublish=!0,t(n)},error:function(e,t,r){o.a.info("T20:"+JSON.stringify(e)+", "+JSON.stringify(t)+", "+JSON.stringify(r)),n&&n({data:{errcode:u.d.ReleaseCGIDefaultCode},padType:"blankpage"})}})},e.prototype.pvcheckForPublish=function(e){var t="/pvcheck/publish?id="+e;return y.a.ajax({type:"get",url:t,timeout:i.a.isMiniProgram()?3e4:2e4,cache:!0,success:function(e){e&&e.data&&!1===e.data.isNormal&&I.setBlankpageData(u.c.PromiseRejectBlankPage,{errcode:u.d.ReleaseCGIPvCheckode})}})},e.prototype.getClientVarsFromServer=function(e){return O(this,void 0,void 0,(function(){var t=this;return T(this,(function(n){return[2,new Promise((function(n,r){location.search.indexOf("pub")>-1&&Object(_.a)("pub")?(t.getPubDocDataFromServer(e,(function(e){n(e)}),(function(e){n(e)})),t.pvcheckForPublish(e)):t.getDocDataFromServer(e,(function(e){n(e)}),(function(e){r(e)}))}))]}))}))},e.prototype.getClientVarsFromServerByMaxCnt=function(e){return O(this,void 0,void 0,(function(){var t=this;return T(this,(function(n){return[2,new Promise((function(n,r){var a=0,s=i.a.isMiniProgram()?0:3,l=+new Date,d=function(i){t.getClientVarsFromServer(e).then((function(e){if(e){var t=+new Date,s=t-l;window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsOnlineStart=l,window.getClientVarsCost.getClientVarsOnlineEnd=t,window.getClientVarsCost.getClientVarsOnlineCount=a+1,window.getClientVarsCost.getClientVarsOnlineCost=s),o.a.info("getClientVarsFromServerByMaxCnt: cost:"+s+" cnt:"+a+" reason:"+i),n(new c.Result(void 0,e))}else r(new c.Result(new Error(""+u.c.PromiseRejectFromServerParseFail)))})).catch((function(e){a<s?(a+=1,setTimeout((function(){d("getClientVarsFromServer fail"+JSON.stringify(e))}),10)):r(new c.Result(new Error(""+u.c.PromiseRejectFromServerFail)))}))};d("getClientVarsFromServerByMaxCnt "+e)}))]}))}))},e}();var E,D=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},R=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){e[e.Local=1]="Local",e[e.online=2]="online"}(E||(E={}));var S=function(){function e(){this.getDataFromDataBaseFail=!1,this.getDataFromOnlineFail=!1,this.serverResult=void 0,this.hasResolve=!1}return e.prototype.updatePadinfoTime=function(e){var t=e;return t&&(t.last_browse_ts=Date.now()/1e3,t.last_modify_ts=Date.now()/1e3),t},e.prototype.updatePadinfoStatus=function(e){if(!Object(r.a)("prerender")){var t=this.updatePadinfoTime(e);t.status===c.PadStatus.NEW&&(t.status=c.PadStatus.LOCAL),d.c.handleDataFromIndexDB({type:d.a.update,tableName:c.TableName.PAD_INFO,data:t})}},e.prototype.updatePadinfo=function(e){return D(this,void 0,void 0,(function(){var t,n,r,i,a;return R(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=f.a.get("uid"),n=c.QueryCondition.newInstance().addCondition("secretId",c.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",c.QUERY_CONDITION_TYPE.ONLY,t),[4,d.c.getDataBase().get(c.TableName.PAD_INFO,n)];case 1:if((r=s.sent()).error)throw o.a.info(JSON.stringify(r.error||"")),r.error;if(r&&r.data&&(i=r.data)&&i.status)switch(i.status){case c.PadStatus.NEW:this.updatePadinfoStatus(i);break;case c.PadStatus.LOCAL:case c.PadStatus.NORMAL:this.updatePadinfoStatus(i);break;case c.PadStatus.DELETED:}return[3,3];case 2:return a=s.sent(),o.a.err("updatePadinfo error"+a),[3,3];case 3:return[2]}}))}))},e.prototype.getDataFromOnline=function(e){return D(this,void 0,void 0,(function(){var t,n,r;return R(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,new P(e).getClientVarsFromServerByMaxCnt(e)];case 1:if((t=i.sent())&&t.data)return[2,new c.Result(void 0,t.data)];throw r=t.error&&Number(t.error.message)||u.c.PromiseRejectUnkownReason;case 2:return n=i.sent(),r=n.error&&Number(n.error.message)||u.c.PromiseRejectUnkownReason,o.a.warn("getDataFromOnline fail:"+r),[2,new c.Result(new Error(""+n))];case 3:return[2]}}))}))},e.prototype.getClientVarsFromIndexDB=function(e){return D(this,void 0,void 0,(function(){var t,n,r,i,a;return R(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),e?(t=+new Date,[4,(new b).getClientVarsFromDataBase(e)]):[3,2];case 1:if((n=s.sent()).error)throw u.c.PromiseRejectFromIndexDBResultError;if(n&&n.data)return(r=n.data).padStatus===c.PadStatus.NEW&&(r.padStatus=c.PadStatus.LOCAL),i=+new Date,window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsDBStart=t,window.getClientVarsCost.getClientVarsDBEnd=i,window.getClientVarsCost.getClientVarsDBCost=i-t),o.a.info("getClientVarsFromIndexDB cost:"+(i-t)),[2,new c.Result(void 0,r)];throw u.c.PromiseRejectFromIndexDBResultNone;case 2:throw u.c.PromiseRejectParamError;case 3:return[3,5];case 4:return a=s.sent(),o.a.warn("getClientVarsFromIndexDB fail:"+JSON.stringify(a)),[2,new c.Result(new Error(""+a))];case 5:return[2]}}))}))},e.prototype.getDataFromDataBase=function(e){return D(this,void 0,void 0,(function(){var t,n;return R(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,d.c.DBStatusPromise];case 1:return r.sent()!==d.b.InitFinish?[3,3]:[4,this.getClientVarsFromIndexDB(e)];case 2:if((t=r.sent()).error)throw t.error;if(t.data)return[2,new c.Result(void 0,t.data)];throw this.updatePadinfo(e),u.c.PromiseRejectFromIndexDBResultFail;case 3:throw u.c.PromiseRejectFromIndexDBInitFail;case 4:return[3,6];case 5:return n=r.sent(),[2,new c.Result(new Error(""+n))];case 6:return[2]}}))}))},e.prototype.checkNeedReturn=function(e,t){var n=u.c.PromiseRejectGetDataFailUnkown;if(t===E.online)if(window.clientVarsOnline=e,e){if("blankpage"!==e.padType)return this.hasResolve=!0,e;if("blankpage"===e.padType){if(this.serverResult=e,!e.clientVars||20!==e.clientVars.type)return this.hasResolve=!0,e;this.getDataFromOnlineFail=!0}}else this.getDataFromOnlineFail=!0,n=u.c.PromiseRejectFromServerFail;else if(t===E.Local){if(e)return window.getClientVarsCost&&!this.hasResolve&&(window.getClientVarsCost.getClientVarsSource="local"),e;this.getDataFromDataBaseFail=!0,n=u.c.PromiseRejectFromIndexDBResultNone}if(this.getDataFromDataBaseFail&&this.getDataFromOnlineFail){if(this.serverResult)return this.hasResolve=!0,this.serverResult;n=u.c.PromiseRejectOnLineAndDataBaseBothFail}return n},e.prototype.getData=function(e){return D(this,void 0,void 0,(function(){var t,n,o,i=this;return R(this,(function(a){switch(a.label){case 0:return Object(r.a)("prerender")&&Object(r.a)("pub")||d.c.mutexLock(e),t=new Promise((function(t,n){i.getDataFromDataBase(e).then((function(e){var r;(r=e.data?i.checkNeedReturn(e.data,E.Local):i.checkNeedReturn(null,E.Local))===u.c.PromiseRejectOnLineAndDataBaseBothFail?n(r):Object(u.f)(r)||t(r)}))})),n=new Promise((function(t,n){Object(r.a)("prerender")||i.getDataFromOnline(e).then((function(e){var r;(r=e.data?i.checkNeedReturn(e.data,E.online):i.checkNeedReturn(null,E.online))===u.c.PromiseRejectOnLineAndDataBaseBothFail?n(r):Object(u.f)(r)||t(r)}))})),o=new Promise((function(e,t){setTimeout((function(){t(u.c.PromiseRejectOnLineAndDataBaseBothFail)}),3e4)})),[4,Promise.race([t,n,o])];case 1:return[2,a.sent()]}}))}))},e.prototype.createDoc=function(e){var t,n,o=decodeURIComponent(Object(r.a)("title"));return function(e){var t=e.secretId,n=e.globalPadId,r=e.dver,o=e.title,a=f.a.get("uid"),s="string"==typeof n?n.split("$")[1]:"";return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{0:["author",""],1:["pap-stylesheet-name","title"],2:["textalign","left"],3:["flowid","BB08J2"],4:["flowid","LSTTMP"],5:["story-type","list-template"]},nextNum:6},bad:-1,client:{upid:t},dirty:-1,dver:r,globalPadId:n,gray:-1,header:[],initialAttributedText:{text:"%0A%0A%0F%03%02%0A%03%0A",attribs:"*0*1*2+1+2*3+1*4*5+1+1*4*5+1+1"},padId:s,padSubId:"BB08J2",padType:"doc",pollingAttemptNumber:-1,pos:1,pver:2,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:n,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:i.a.isIPad(),isIPhone:!1,isLocalDoc:!0,isLogin:!0,isMac:!1,isMobile:i.a.isMobile(),isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:s,newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:s,padTitle:o||"无标题文档",padType:"doc",padStatus:c.PadStatus.LOCAL,pagingFlag:"",policy:0,privilegeAttribute:{can_about:1,can_add_user:1,can_comment:1,can_copy:1,can_edit:1,can_edit_title:1,can_history:1,can_link_exp:1,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:1,is_auth:1},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:f.a.get("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:"p."+a,userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:""}}({globalPadId:Object(r.a)("globalPadId"),secretId:e,dver:null===(n=null===(t=window.App)||void 0===t?void 0:t.GlobalConfig)||void 0===n?void 0:n.globalCodeVersion,title:o})},e}(),A=n(78),N=n(243),F=n(231);var x=function(){function e(e,t){this.secretId="",this.padType=u.b.Doc,this.secretId=e,this.padType=t,this.getClientVarsCost=new u.a(+new Date),window.getClientVarsCost=this.getClientVarsCost,window.getClientVarsCost.getClientVarsSource="online",this.clientVarsOnline=new P(e),this.clientVarsOfflineEdit=new S}return e.prototype.getClientVarsPromise=function(){var e=this,t=new Promise((function(t,n){function i(e){e.padType||(e.padType=u.b.AIO);var r=l(e);r?t(r):"blankpage"===e.padType?n({error:u.c.PromiseRejectBlankPage,data:e}):"sheet"===e.padType?n({error:u.c.PromiseRejectSheet}):"slide"===e.padType?n({error:u.c.PromiseRejectSlide}):n({error:u.c.PromiseRejectDataErr})}window.App.GlobalConfig.IsSupportStore?Object(v.f)()?i(Object(v.e)()):Object(r.a)("new")?i(e.clientVarsOfflineEdit.createDoc(e.secretId)):e.clientVarsOfflineEdit.getData(e.secretId).then((function(e){i(e)})).catch((function(e){n({error:e}),o.a.err("getClientVarsFromgetData fail"+JSON.stringify(e)+".")})):e.clientVarsOnline.getClientVarsFromServerByMaxCnt(e.secretId).then((function(e){e.data&&i(e.data)})).catch((function(e){var t=e.error&&Number(e.error.message)||u.c.PromiseRejectUnkownReason;n({errCode:t})}))}));return t.then((function(t){var n=+new Date,r=n-e.getClientVarsCost.getClientVarsStart;window.getClientVarsCost&&(window.getClientVarsCost.getClientVarsCost=r,window.getClientVarsCost.getClientVarsEnd=n),e.getClientVarsCost.getClientVarsCost=r,e.getClientVarsCost.getClientVarsEnd=n,window.clientVars=t,N.a.getInstance(e.secretId).setClientVars(t),o.a.info("get clientvars success,cost:"+r+" rev:"+(window.clientVars&&window.clientVars.collab_client_vars.rev))})).catch((function(e){switch(e.error){case u.c.PromiseRejectBlankPage:I.setBlankpageData(u.c.PromiseRejectBlankPage,e.data);break;case u.c.PromiseRejectSheet:location.replace(location.href.replace("/doc/","/sheet/"));break;case u.c.PromiseRejectSlide:location.replace(location.href.replace("/doc/","/slide/"));break;case u.c.PromiseRejectFromServerParseFail:case u.c.PromiseRejectFromIndexDBResultError:case u.c.PromiseRejectFromIndexDBResultFail:case u.c.PromiseRejectFromIndexDBResultNone:case u.c.PromiseRejectFromIndexDBInitFail:case u.c.PromiseRejectGetDataFailUnkown:case u.c.PromiseRejectDataBaseComposeExp:default:Object(o.b)("Word_MeloOpenDocGetDataException"),function(){var e=Object(A.a)();if(N.a.getInstance(e).docRendered=!0,N.a.getInstance(e).docRenderFailed=!0,window.pad&&window.pad.collab&&window.pad.collab&&window.pad.collab.setData){var t=Object(v.e)();window.pad.collab.setData(t)}F.b.getInstance().hide()}(),window.ShowRefreshAllScreen&&window.ShowRefreshAllScreen()}o.a.info("get clientvars fail. "+JSON.stringify(e))})),t},e}()},32:function(e,t,n){console.log("腾讯文档上报组件的版本是2.0.2"),function(e,t){"use strict";function n(e){return void 0===e&&(e=window.navigator.userAgent),/(mobile)/i.test(e)}function r(e){return void 0===e&&(e=window.navigator.userAgent),/(ipad)/i.test(e)}function o(e){return void 0===e&&(e=window.navigator.userAgent),!n(e)&&/Mac OS X/i.test(e)}function i(e){return void 0===e&&(e=window.navigator.userAgent),/android|adr/i.test(e)}function a(e){return void 0===e&&(e=window.navigator.userAgent),/(iphone|ipad|ipod)/i.test(e)}function s(e){return void 0===e&&(e=window.navigator.userAgent),/MSAppHost/i.test(e)}function c(e){return void 0===e&&(e=window.navigator.userAgent),!n(e)&&/QQBrowser/i.test(e)&&!/QBCore/i.test(e)}function u(e){return void 0===e&&(e=window.navigator.userAgent),n(e)&&/MQQBrowser/i.test(e)&&!/TBS/i.test(e)}function l(e){return void 0===e&&(e=window.navigator.userAgent),n(e)?u(e):c(e)}function d(e){return void 0===e&&(e=window.navigator.userAgent),/TencentDocs/i.test(e)}t=t&&t.hasOwnProperty("default")?t.default:t;var f=d;function p(e){return void 0===e&&(e=window.navigator.userAgent),window.location.href.indexOf("__wxjs_environment=miniprogram")>-1||/MicroMessenger/i.test(e)&&/miniProgram/i.test(e)||"miniprogram"===window.__wxjs_environment&&!h()}function h(e){return void 0===e&&(e=window.navigator.userAgent),window.location.href.indexOf("__wxjs_environment=qqminiprogram")>-1||/QQ/i.test(e)&&/MiniApp/i.test(e)&&!/MiniAppEnable/i.test(e)||/QQ/i.test(e)&&/miniProgram/i.test(e)||"qqminiprogram"===window.__wxjs_environment}function g(e){return void 0===e&&(e=window.navigator.userAgent),p(e)||h(e)}function v(e){return void 0===e&&(e=window.navigator.userAgent),/(wxwork)/i.test(e)}var w=v;function m(e){return void 0===e&&(e=window.navigator.userAgent),/MicroMessenger/i.test(e)&&!v(e)&&!p(e)}var b=m;function C(e){return void 0===e&&(e=window.navigator.userAgent),/TIM/i.test(e)}function y(e){return void 0===e&&(e=window.navigator.userAgent),/QQ/i.test(e)&&!d(e)&&!v(e)&&!m(e)&&!l(e)&&!h(e)&&!C(e)&&!T()}function _(e){return void 0===e&&(e=window.navigator.userAgent),void 0===e&&(e=window.navigator.userAgent),/weiyun/i.test(e)}function I(e){return void 0===e&&(e=window.navigator.userAgent),C(e)||y(e)}var O=I;function T(e){return void 0===e&&(e=window.navigator.userAgent),/TxDocsPC/i.test(e)}function P(e){return void 0===e&&(e=window.navigator.userAgent),/TDAppDesktop/i.test(e)}var E,D=(E=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}({31:function(e,t,n){n.r(t);var r="undefined"!=typeof window&&window&&window.navigator?window:"undefined"!=typeof self&&self.navigator?self:null;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=window&&window.XMLHttpRequest&&window.XMLHttpRequest.prototype,a=i&&i.open,s=i&&i.send,c=window&&window.fetch,u=!1;function l(){return(new Date).getTime()}function d(e){var t,n=function(e){if(!e)return"";var t=r&&r.decodeURIComponent&&r.decodeURIComponent(e)||e,n=t.indexOf("?");return n>-1?t.slice(0,n):t}(e);return"//"===n.slice(0,2)?n=(window&&window.location.protocol||"")+n:"/"===n.slice(0,1)&&(n=(t=window&&window.location.protocol||"")+(t?"//":"")+(window&&window.location.host||"")+n),n}function f(e){var t="unknown";try{var n=JSON.parse(e);if("object"!==o(n)||!n)return t;var r=Object.getOwnPropertyNames(n).filter((function(e){return-1!==["ret","retcode"].indexOf(e.toLocaleLowerCase())}));r.length>0&&(t=n[r[0]])}catch(e){}return t}function p(e){var t=function(e){if(!e)return"";var t=r&&r.decodeURIComponent&&r.decodeURIComponent(e)||e;if("/"===t.slice(0,1))return r&&r.location&&r.location.hostname?r.location.hostname:"";var n=0;"//"===t.slice(0,2)?n=2:"https://"===t.slice(0,8)?n=8:"http://"===t.slice(0,7)&&(n=7);var o=t.slice(n),i=o.indexOf("/");return i>-1?o.slice(0,i):o}(e);return["report.url.cn","huatuo.qq.com","aegis.qq.com","report.idqqimg.com"].filter((function(e){return-1!==t.indexOf(e)})).length>0}function h(e){u?console.error("[AlloyReport]: 已经初始化过网络拦截器了"):(function(e){window&&"XMLHttpRequest"in window&&(i.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;return n.AlloyReportCGI={method:e[0]||"get",url:e[1]},a.apply(this,e)},i.send=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this,o=l();function i(){if(4===r.readyState){var t=r.AlloyReportCGI,n=t.method,i=t.url;if(!n||!i)return;if(p(i))return;var a=f(r.response);e({url:d(i),method:n,costTime:l()-o,status:r.status,retcode:a})}}if("onreadystatechange"in r&&"function"==typeof r.onreadystatechange){var a=r.onreadystatechange;r.onreadystatechange=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(),a.apply(r,e)}}else r.onreadystatechange=i;return s.apply(r,t)})}(e),function(e){window&&"fetch"in window&&(window.fetch=function(t,n){if(p(t))return c(t,n);var r=l(),o=c(t,n);return o.then((function(o){return o.clone().text().then((function(i){var a=f(i);e({url:d(t),method:n&&n.method||"get",costTime:l()-r,status:o.status,retcode:a})})),o})).catch((function(o){throw e({url:d(t),method:n&&n.method||"get",costTime:l()-r,status:"error",retcode:"unknown"}),o})),o})}(e),u=!0)}var g=["closeLog","openLog","reset","resetConfig","closeReport","openReport","enableMerge","disableMerge","disableWorker","jank","jank.stop","huatuo","huatuo.timeStart","huatuo.time","huatuo.timeEnd","monitor","performance","retcode","tdbank","tdw","tdw.setDefaultTable","tdw.setDefaultData","tdw.clearDefaultData","huatuoConfig","monitorConfig","retcodeConfig","tdbankConfig","tdwConfig"];t.default=new function(){var e=this;this.ALLOY_REPORT_TEMP="ALLOY_REPORT_NEXT",this.MONITORID={INLINE_LOAD:34980700,LOAD_FIRST_FAIL:34980703,LOAD_MIRNOR_FAIL:34980873},this.buildInfo="VV3.0.4-build.2020.7.1",this.cacheObj={},this.dataCache=[],this.storagePolyfill=function(){window&&window.localStorage||(window[e.ALLOY_REPORT_TEMP]={},e.cacheObj=window[e.ALLOY_REPORT_TEMP])},this.getFilePath=function(t){if((!t||t<3)&&e.inlineInitOptions.loadLatestSDK)return"https://alloyreport.cdn-go.cn/alloy-report-sdk/latest/alloyreport.sdk.js";var n="https://alloyreport.cdn-go.cn/alloy-report-sdk/v3.0.4/alloyreport.sdk.js";return t>2&&t<5&&(n="https://alloyreport.cdn-go.cn/alloy-report-sdk/v3.0/alloyreport.sdk.js"),n},this.getCacheObj=function(t){if(!window||!window.localStorage)return e.cacheObj[t];var n=window.localStorage.getItem(t);try{return n&&JSON.parse(n)}catch(e){return}},this.setCacheObj=function(t,n){n?window&&window.localStorage?window.localStorage.setItem(t,JSON.stringify(n)):e.cacheObj[t]=n:window&&window.localStorage?window.localStorage.removeItem(t):delete e.cacheObj[t]},this.saveData=function(t,n){var r=+new Date;if(clearTimeout(e.timeOutTmp),r-e.lastWriteTime<50)return t&&n&&e.dataCache.push({t:t,d:n}),void(e.timeOutTmp=setTimeout(e.saveData,10));e.lastWriteTime=r;var o=[];try{(o=e.getCacheObj(e.ALLOY_REPORT_TEMP))instanceof Array&&o||(o=[]),t&&n&&o.push({t:t,d:n}),o=o.concat(e.dataCache),e.dataCache=[],e.setCacheObj(e.ALLOY_REPORT_TEMP,o)}catch(e){console.error(e)}o.push({t:t,d:n})},this.initReport=function(){e.report||(e.report={}),"undefined"==typeof window&&"undefined"==typeof document||(window.AlloyReportNext||(window.AlloyReportNext=e.report),window.AlloyReport||(window.AlloyReport=e.report));for(var t=0;t<g.length;t++){var n=g[t],r=n.split("."),o=function(t){var n=!1;return function(){n||(n=!0,e.saveData(t,[null,{initedByInline:!0}]),h((function(n){e.loaded?e.report&&e.report.acgi&&e.report.acgi(n):e.saveData(t,[n])})))}}(n),i=function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];e.saveData(t,n)}}(n),a=r[0];r.length>1?(e.report[a]||(e.report[a]={}),e.report[a][r[1]]=i):e.report[a]="acgi"===a?o:i}},this.waitLoadSDKAfterDomLoaded=function(){if(window&&window.document&&window.document.readyState){var t=window.document.readyState;"complete"===t?e.loadMainScript(0):"loading"===t||"interactive"===t?(console.log("[AlloyReport]: 页面还没加载，等待页面加载完成再加载 SDK"),window.document.onreadystatechange=function(){"complete"===document.readyState&&e.loadMainScript(0)}):setTimeout((function(){console.log("[AlloyReport]: 页面状态未知，自主加载 SDK"),e.loadMainScript(0)}),1e4)}},this.loadMainScript=function(t){if(void 0===t&&(t=0),("undefined"!=typeof window||"undefined"!=typeof document)&&!window.AlloyReportNext.isMain&&t<5){var n=e.getFilePath(t),r=document.createElement("script");r.async=!0,r.setAttribute("src",n),r.onload=function(){e.loaded||"complete"!==window.document.readyState||(window.AlloyReportNext.isMain?e.loaded=!0:(e.loaded=!1,e.reportLoadError(t),e.loadMainScript(t+1)))},r.onerror=function(){e.reportLoadError(t),e.loadMainScript(t+1)},document.body?document.body.appendChild(r):document.head&&document.head.appendChild(r)}},this.reportLoadError=function(t){t?t>=4&&e.report.monitor(e.MONITORID.LOAD_MIRNOR_FAIL):e.report.monitor(e.MONITORID.LOAD_FIRST_FAIL)},this.doInlineLoadedReport=function(){e.report.monitor(e.MONITORID.INLINE_LOAD)},this.generateReportAndLoadSDK=function(){e.initReport(),e.doInlineLoadedReport(),e.waitLoadSDKAfterDomLoaded()},this.init=function(t){return void 0===t&&(t={}),t&&t.loadLatestSDK&&(e.inlineInitOptions.loadLatestSDK=!0),e.generateReportAndLoadSDK(),e.report},this.lastWriteTime=0,this.loaded=!1,this.inlineInitOptions={loadLatestSDK:!1},this.storagePolyfill(),console.log("AlloyReport-Inline-V3.0.4-build.2020.7.1")}}})})))&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E;function R(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),n="object"==typeof document&&document.cookie.match(t);return n?n[1]:""}var S="";function A(){if(S)return S;var e=R("p_luin")||R("p_uin");return e&&(S=e.replace(/^[o0]+/i,"")),S}var N="";function F(){if(N)return N;var e=R("uid");return e&&(N=e),N}function x(e){for(var t="",n=0;n<e;n++)t+=Math.random().toString(36).substr(2);return t}function M(){try{var e=window.localStorage&&window.localStorage.getItem("browserStr");return e||(e=x(5),window.localStorage&&window.localStorage.setItem("browserStr",e)),e}catch(e){return x(5)}}function j(e){var t=window.location.search.substring(1);if(t)for(var n=0,r=t.split("&");n<r.length;n++){var o=r[n].split("="),i=o[0],a=o[1];if(i===e)return a}}function B(e){void 0===e&&(e=window.navigator.userAgent);var t=e.split("TxDocsPC/")[1];return t?t.split("_")[1]:""}function L(e,t){void 0===t&&(t=window.navigator.userAgent);try{var n=new RegExp("\\b"+e+"\\/((\\d+\\.){1,3}\\d+)","i").exec(t);return n&&n.length>1&&n[1]||""}catch(e){return""}}function k(){return P()?L("TDAppDesktop"):T()?L("TxDocsPC"):d()?L("TencentDocs"):void 0}var V,Y=window.clientVars,U={qq:1,wx:2,guest:3,ww:5},Q=D.init({loadLatestSDK:!0});!function(e){e[e.NOT_START=-1]="NOT_START",e[e.PAUSE=0]="PAUSE",e[e.ACTIVE=1]="ACTIVE"}(V||(V={}));var G=0,W=V.NOT_START;function J(){var e=R("utype")||"guest";return Y?Y.userIsGuest?3:Y.uin?"wx"===e?2:"ww"===e?5:1:4:U[e]||4}var q={doc:1,sheet:2,form:3,slide:4,pdf:6};function H(e){void 0===e&&(e="");var t=Y&&Y.padType||e;return t&&q[t]||""}function K(e){return e?2&e?2:1&e?1:3:""}function X(){return n()?i()?2:a()?r()?6:3:4:o()?5:1}function z(){for(var e=[[T,10],[C,2],[p,3],[m,4],[d,6],[s,8],[l,5],[y,1],[w,9],[_,11],[h,12],[P,13]],t=0;t<e.length;t++){var n=e[t],r=n[0],o=n[1];if(r())return o}return 5}var $={};function Z(){Y=window.clientVars,Object.assign($,{table:"dc03111",third_appid:Y&&Y.collab_client_vars&&Y.collab_client_vars.apid&&Y.collab_client_vars.apid.apid,uin:A()||F(),uid:Y&&"string"==typeof Y.userId?Y.userId.replace(/^p\./,""):F()||"",user_mac:M(),uin_type:J(),platform:X(),appid:"",touin:Y&&Y.creatorDomain||"",toid:F(),isOwner:Y&&Y.isOwner||0,file_type:H(),id:Y&&Y.padId||"",source1:z(),source2:"",source3:j("from")||B(),obj1:K(Y&&Y.rightFlag),obj2:(Y&&Y.padTitle||"").replace(/\t/g,""),obj3:k(),ver1:Y&&Y.globalPadId||"",ver2:Y&&Y.creatorId||"",ver3:Y&&Y.domainId||"",ver4:Y&&Y.ownerId||""})}function ee(e,t){void 0===e&&(e={});var n=void 0===t?{}:t,r=n.showLog,o=void 0!==r&&r,i=n.immediate,a=Object.assign({},$);for(var s in e){var c=e[s];void 0!==c&&(a[s]=c)}return(o||window._tencent_doc_report_show_log)&&console.log("打点上传的参数是",a),Q.tdw(a,i)}function te(){return"active"===t.state||"passive"===t.state}function ne(){ee({opername:"doc_core",module:"heart_beat",action:"report"}),W!==V.PAUSE&&(G=window.setTimeout((function(){ne()}),6e4))}Z(),!0!==window.docReportHeartBeatFlag&&(g()||(te()&&(W=V.ACTIVE,window.docReportHeartBeatFlag=!0,ne()),t.addEventListener("statechange",(function(){var e=te();e&&W===V.PAUSE?(W=V.ACTIVE,ne()):e||W!==V.ACTIVE||(W=V.PAUSE,clearTimeout(G))})))),e.isMobile=n,e.isIPad=r,e.isMac=o,e.isAndroid=i,e.isIOS=a,e.isWindowStore=s,e.isPCQQBrowser=c,e.isMobileQQBrowser=u,e.isQQBrowser=l,e.isTencentDocApp=d,e.isTencentDocsApp=f,e.isWxMiniProgram=p,e.isQQMiniProgram=h,e.isMiniProgram=g,e.isWxWork=v,e.isWeWork=w,e.isWeChat=m,e.isWechat=b,e.isTim=C,e.isQQ=y,e.isWeiYunApp=_,e.isTimOrQQ=I,e.isTimQQ=O,e.isTimOrQQFamily=function(e){return void 0===e&&(e=window.navigator.userAgent),C()||/QQ/i.test(e)},e.isPCTim=function(e){return void 0===e&&(e=window.navigator.userAgent),/QBCore/i.test(e)&&/TIM2.0/i.test(e)},e.isQQFamily=function(e){return void 0===e&&(e=window.navigator.userAgent),/QQ/i.test(e)},e.isPCTencentDocApp=T,e.isElectronDocApp=P,e.AlloyReport=Q,e.getUinTypeForReport=J,e.getFileTypeForReport=H,e.getAuth=K,e.getPlatform=X,e.getSource1=z,e.resetDefaultTdwData=Z,e.tdw=ee,e.tdwSingle=function(e,t){void 0===e&&(e={});var n=Object.assign({},$);for(var r in e){var o=e[r];void 0!==o&&(n[r]=o)}n.table,t=t instanceof Array?t:[];var i={};for(var a in n)if(n.hasOwnProperty(a)){if(t.indexOf(a)>-1)continue;i[a]=n[a]}return Q.tdw(i)},e.isPageCouldBeSeen=te,e.getCookie=R,e.getCookieUin=A,e.getCookieUid=F,e.getBrowserStr=M,e.getUrlParameter=j,e.getSource3FromUserAgent=B,e.getVersionWithName=L,e.getDocsAppVersion=k,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(202))},48:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return w})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return C}));var r=n(3),o=n(89),i=n(163),a=n(49),s=n(228),c=n(20),u=n(15),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},f="D0000000000000000",p="300000000$A00000000000";function h(){return window.location.pathname.split("/").pop()===f}function g(){return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{0:["flowid","BB08J2"],1:["flowid","LSTTMP"],2:["story-type","list-template"]},nextNum:3},bad:-1,client:{upid:f,sid:"",sig:"",tid:0},dirty:-1,dver:window.App.GlobalConfig.globalCodeVersion,globalPadId:p,gray:-1,header:[],initialAttributedText:{text:"%0A%0F%03%02%0A%03%0A",attribs:"+2*0+1*1*2+1+1*1*2+1+1"},padId:"A00000000000",padSubId:"BB08J2",padType:"doc",pollingAttemptNumber:-1,pos:1,pver:2,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:p,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:o.a.isIPad(),isIPhone:o.a.isIPhone(),isLogin:!0,isMac:o.a.isMac(),isMobile:o.a.isMobile(),isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:"A00000000000",newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:"A00000000000",padStatus:r.PadStatus.LOCAL,padTitle:"无标题文档",padType:"doc",pagingFlag:"",policy:-1,privilegeAttribute:{can_about:1,can_add_user:0,can_comment:0,can_copy:1,can_copy_doc:1,can_edit:0,can_edit_title:0,can_history:0,can_link_exp:0,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:0,is_auth:0},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:Object(i.b)("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:Object(i.b)("uid"),userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:"",metaCreateTime:15489504e5,lastModifyTime:15489504e5,lastModifyUser:""}}function v(e,t){return l(this,void 0,void 0,(function(){var n,o,i;return d(this,(function(s){switch(s.label){case 0:return n=a.a.get("uid"),o=[r.OFFLINE_ITEM_TYPE.MISS_CHANGE,r.OFFLINE_ITEM_TYPE.ACCEPTED,r.OFFLINE_ITEM_TYPE.NEW_CHANGE],i=r.QueryCondition.newInstance().addCondition("globalPadId",r.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",r.QUERY_CONDITION_TYPE.IN,o).addCondition("uid",r.QUERY_CONDITION_TYPE.ONLY,n),void 0!==t&&i.addCondition("version",r.QUERY_CONDITION_TYPE.UPPER_BOUND,{upper:t,open:!1}),[4,u.c.getDataBase().delete(r.TableName.DOCUMENT_DATA,i)];case 1:return[2,s.sent()]}}))}))}function w(e,t){return l(this,void 0,void 0,(function(){var n,o,i;return d(this,(function(s){switch(s.label){case 0:return n=r.OFFLINE_ITEM_TYPE.INIT,o=a.a.get("uid"),i=r.QueryCondition.newInstance().addCondition("globalPadId",r.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",r.QUERY_CONDITION_TYPE.ONLY,n).addCondition("uid",r.QUERY_CONDITION_TYPE.ONLY,o),void 0!==t&&i.addCondition("version",r.QUERY_CONDITION_TYPE.UPPER_BOUND,{upper:t,open:!0}),[4,u.c.getDataBase().delete(r.TableName.DOCUMENT_DATA,i)];case 1:return[2,s.sent()]}}))}))}function m(e,t){return l(this,void 0,void 0,(function(){var n,o;return d(this,(function(i){switch(i.label){case 0:return n=a.a.get("uid"),o=(new r.QueryCondition).addCondition("globalPadId",r.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",r.QUERY_CONDITION_TYPE.ONLY,n),[4,u.c.getDataBase().updateField(r.TableName.PAD_INFO,o,t)];case 1:return[2,i.sent()]}}))}))}function b(){return l(this,void 0,void 0,(function(){var e,t,n,o,i;return d(this,(function(a){switch(a.label){case 0:return!window.App.GlobalConfig.IsSupportStore||Object(s.a)("prerender")?[2]:(e=window.clientVars)?[4,v(e.globalPadId,e.collab_client_vars.rev)]:[3,5];case 1:return(t=a.sent()).error&&c.a.err("saveClientVarsToDataBase-deleteServerResult "+JSON.stringify(t.error)),n=u.c.getHelper().clientVars2OfflineData(e.globalPadId,e),[4,u.c.getDataBase().update(r.TableName.DOCUMENT_DATA,n)];case 2:return(o=a.sent()).error?(c.a.err("saveClientVarsToDataBase "+JSON.stringify(o.error)),[3,5]):[3,3];case 3:return[4,m(e.globalPadId,{isOfflineCache:!0})];case 4:(i=a.sent()).error&&c.a.err("saveClientVarsToDataBase updatePadInfo "+JSON.stringify(i.error)),a.label=5;case 5:return[2]}}))}))}function C(e,t){return l(this,void 0,void 0,(function(){var n,o,i,s,c,l;return d(this,(function(d){switch(d.label){case 0:return n=a.a.get("uid"),o=r.QueryCondition.newInstance().addCondition("uid",r.QUERY_CONDITION_TYPE.ONLY,n).addCondition("secretId",r.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",r.QUERY_CONDITION_TYPE.IN,[r.OFFLINE_ITEM_TYPE.ACCEPTED,r.OFFLINE_ITEM_TYPE.MISS_CHANGE,r.OFFLINE_ITEM_TYPE.NEW_CHANGE]),t&&o.addCondition("version",r.QUERY_CONDITION_TYPE.LOWER_BOUND,{lower:t,open:!0}),[4,u.c.getDataBase().getAll(r.TableName.DOCUMENT_DATA,o)];case 1:return(i=d.sent()).error?(console.error(i.error),[2,{error:i.error}]):(s=-1,c=new Map,(l=i.data).sort((function(e,t){return e.version===t.version?e.data&&t.data&&e.data.baseVersion!==t.data.baseVersion?e.data.baseVersion-t.data.baseVersion:e.createTime-t.createTime:e.version-t.version})),l.forEach((function(e){var t=e.data&&e.data.data;if(t){var n={apool:t.apool,baseRev:t.baseRev||t.newVersion,changeset:t.changeset,commitId:t.taskId,firstCommitRev:t.baseRev,head:t.head,keydata:t.keyData,oSubId:t.oSubId,subId:t.subId};switch(e.version>s&&(s=e.version),e.type){case r.OFFLINE_ITEM_TYPE.NEW_CHANGE:case r.OFFLINE_ITEM_TYPE.MISS_CHANGE:case r.OFFLINE_ITEM_TYPE.ACCEPTED:c.set(n.commitId,n)}}})),[2,{error:i.error,version:s,data:c}])}}))}))}},8:function(e,t,n){"use strict";var r,o,i;function a(e){return"number"==typeof e&&e>=o.PromiseRejectSlide&&e<=o.PromiseRejectUnkownReason}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return c})),function(e){e.Doc="doc",e.Excel="sheet",e.PPt="slide",e.AIO="aio",e.BlankPage="blankpage"}(r||(r={})),function(e){e[e.PromiseRejectSlide=1]="PromiseRejectSlide",e[e.PromiseRejectSheet=2]="PromiseRejectSheet",e[e.PromiseRejectBlankPage=3]="PromiseRejectBlankPage",e[e.PromiseRejectDataErr=4]="PromiseRejectDataErr",e[e.PromiseRejectFromServerFail=5]="PromiseRejectFromServerFail",e[e.PromiseRejectFromServerParseFail=6]="PromiseRejectFromServerParseFail",e[e.PromiseRejectFromIndexDBResultError=7]="PromiseRejectFromIndexDBResultError",e[e.PromiseRejectFromIndexDBResultFail=8]="PromiseRejectFromIndexDBResultFail",e[e.PromiseRejectFromIndexDBResultNone=9]="PromiseRejectFromIndexDBResultNone",e[e.PromiseRejectFromIndexDBInitFail=10]="PromiseRejectFromIndexDBInitFail",e[e.PromiseRejectDataBaseComposeExp=11]="PromiseRejectDataBaseComposeExp",e[e.PromiseRejectOnLineAndDataBaseBothFail=12]="PromiseRejectOnLineAndDataBaseBothFail",e[e.PromiseRejectGetDataFailUnkown=13]="PromiseRejectGetDataFailUnkown",e[e.PromiseRejectParamError=14]="PromiseRejectParamError",e[e.PromiseRejectUnkownReason=99]="PromiseRejectUnkownReason"}(o||(o={})),function(e){e[e.ReleaseCGIDefaultCode=51]="ReleaseCGIDefaultCode",e[e.ReleaseCGIPvCheckode=52]="ReleaseCGIPvCheckode"}(i||(i={}));var s=function(e){this.getClientVarsOnlineStart=-1,this.getClientVarsOnlineEnd=-1,this.getClientVarsOnlineCount=-1,this.getClientVarsOnlineCost=-1,this.getClientVarsDBStart=-1,this.getClientVarsDBEnd=-1,this.getClientVarsDBCompose=-1,this.getClientVarsDBCost=-1,this.getClientVarsSource="",this.getClientVarsStart=-1,this.getClientVarsEnd=-1,this.getClientVarsCost=-1,this.getOfflineDataCost=-1,this.getClientVarsStart=e},c=function(e,t){void 0!==e&&(this.error=e),this.data=t}},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.isMobile=function(){return/(mobile)/i.test(window.navigator.userAgent)},e.isMac=function(){return!e.isMobile()&&/Mac OS X/i.test(window.navigator.userAgent)},e.isAndroid=function(){return/android|adr/i.test(window.navigator.userAgent)},e.isIOS=function(){return/(iphone|ipad|ipod)/i.test(window.navigator.userAgent)},e.isWindowStore=function(){return/MSAppHost/i.test(window.navigator.userAgent)},e.isIPad=function(){return/(ipad)/i.test(window.navigator.userAgent)},e.isIPhone=function(){return/(iphone)/i.test(window.navigator.userAgent)},e.isMiniProgram=function(){return/(miniProgram)/i.test(window.navigator.userAgent)},e}()},9:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r}));var r,o=n(32),i=new Map([[1e4,34928051],[10001,34928052],[4e4,34601781],[40001,34601782],[40002,34601783],[40003,34601784],[40005,34601785],[40006,34601786],[40020,34601787],[40021,34601788],[40022,34601789],[40023,34601790],[40026,34928053],[40027,34928055],[40028,34928056],[41001,34601791],[41002,34601792],[40029,34601793],[40030,34928057],[6e4,34601799],[60001,34601800],[60002,34601801],[60003,34601802],[60004,34601803],[60005,34601804],[60006,34601805],[60007,34601806],[60008,34601807],[60009,34601808],[60010,34601809],[60011,34601810],[60013,34601811],[60014,34601812],[60015,34601813],[60016,34601814],[60017,34601815],[60018,34601816],[60019,34601817],[60020,34601818],[60021,34601819],[60022,34601820],[7e4,34928058],[70001,34928059],[70002,34928060],[72005,34601851],[72999,34601852],[72007,34601853],[72008,34601854],[72009,34601855],[72106,34601856],[72107,34601857],[34601858,34601858],[4e4,34601781]]),a=new Map([["GetDataErrorByCGI",34773539],["FollwError",34773538]]),s=new Map([["Total",34814862],["IndexDBNotSupport",34814863],["HasData",34814864],["EqualChangset",35260517]]);!function(e){e.WordMeloCollabRoomShutDownErrorCode="Word_MeloCollabRoomShutDownErrorCode",e.WordMeloOfflineCSGetAndFollowError="Word_MeloOfflineCSGetAndFollowError",e.WordMeloOfflineCSGetAndFollowFail="Word_MeloOfflineCSGetAndFollowFail",e.WordMeloLocalVersionBiggerthanServer="Word_LocalVersionBiggerthanServer",e.WordMeloCollabRoomShutDownCSLengthError="Word_MeloCollabRoomShutDownErrorCode_40003",e.WordMeloCollabRoomShutDownCommonError="Word_MeloCollabRoomShutDownErrorCode_72999"}(r||(r={}));var c=new(function(){function e(){}return e.prototype.monitorCommitErr=function(e){e&&i.has(e)&&this.monitorReport(i.get(e))},e.prototype.monitorOfflineMissFollowErr=function(e){e&&a.has(e)&&this.monitorReport(a.get(e))},e.prototype.monitorOfflineModule=function(e){e&&s.has(e)&&this.monitorReport(s.get(e))},e.prototype.monitorReport=function(e){e&&e>0&&o.AlloyReport.monitor(e)},e.prototype.reportToWebLog=function(e,t){var n=["INACTIVE"];if(e&&-1!==["40001","60007","60015","70001","60006"].indexOf(e))return null;for(var o=0;o<n.length;o++)if(t&&n[o]&&t.indexOf(n[o])>=0)return null;var i=Date.now(),a=i-3e5,s=e?r.WordMeloCollabRoomShutDownErrorCode+"_"+e:r.WordMeloCollabRoomShutDownErrorCode;return window.log&&window.log.report(s,{query:{startTs:a,endTs:i}})},e.prototype.reportToWeblogWithKey=function(e,t){if(e&&t>0){var n=Date.now(),r=n-t;window.log&&window.log.report(e,{query:{startTs:r,endTs:n}})}},e}())}}]);
//# sourceMappingURL=firstloadlib-pc.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{10:function(o,n){o.exports=jQuery},227:function(o,n,e){"use strict";e.r(n);var t=e(10),d=e.n(t),a=e(85),i=e.n(a),r=e(249),s=e(78),c=e(8);var l=e(89);window.ClientVarsPromise=new r.a(Object(s.a)(),c.b.Doc).getClientVarsPromise(),window.addEventListener("load",(function o(){var n={};try{var e=performance.timing;if(e.loadEventEnd-e.loadEventStart<0)return void setTimeout((function(){o()}),200);n["重定向时间"]=e.redirectEnd-e.redirectStart,n["DNS解析时间"]=e.domainLookupEnd-e.domainLookupStart,n["TCP完成握手时间"]=e.connectEnd-e.connectStart,n["HTTP请求响应完成时间"]=e.responseEnd-e.requestStart,n["DOM开始加载前所花费时间"]=e.responseEnd-e.navigationStart,n["DOM加载完成时间"]=e.domComplete-e.domLoading,n["DOM结构解析完成时间"]=e.domInteractive-e.domLoading,n["脚本加载时间"]=e.domContentLoadedEventEnd-e.domContentLoadedEventStart,n["onload事件时间"]=e.loadEventEnd-e.loadEventStart,n.domContentLoaded=e.domContentLoadedEventEnd-e.navigationStart,n.load=e.loadEventEnd-e.navigationStart,window.showSnapshotEnd&&(n.snapshotShow=window.showSnapshotEnd-e.navigationStart),n["页面完全加载时间"]=n["重定向时间"]+n["DNS解析时间"]+n["TCP完成握手时间"]+n["HTTP请求响应完成时间"]+n["DOM结构解析完成时间"]+n["DOM加载完成时间"],Object.keys(n).forEach((function(o){console.log(o+":"+n[o]+"毫秒(ms)")})),console.log(e)}catch(o){console.error(o)}})),l.a.isMobile()&&document.getElementById("mobile-preload-header")?d()("#mobile-preload-header").before(i.a):!l.a.isMobile()&&document.getElementById("pc-preload-header")?d()("#pc-preload-header").before(i.a):d()(i.a).prependTo("body");window.FEATURE_FLAGS=function(){return!0}},4:function(o,n){o.exports=Easysync},85:function(o,n){o.exports='<div id="editor-mask"></div> <div id="app" style="height:100%;position:relative;z-index:0"> </div> '}},[[227,7,6,9]]]);
//# sourceMappingURL=firstload-pc.js.map