!function(e){function t(t){for(var n,o,c=t[0],l=t[1],p=t[2],d=0,s=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&s.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(u&&u(t);s.length;)s.shift()();return a.push.apply(a,p||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,o=1;o<r.length;o++){var l=r[o];0!==i[l]&&(n=!1)}n&&(a.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},o={7:0},i={7:0},a=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(e){var t=[];o[e]?t.push(o[e]):0!==o[e]&&{0:1,3:1,8:1,10:1,22:1,24:1,27:1}[e]&&t.push(o[e]=new Promise((function(t,r){for(var n="css/features-pc-"+({0:"publish-readonly-pc",1:"edit-pc-tlib",2:"publish-readonly-pc-tlib",3:"readonly-pc",4:"melo-ext",5:"publish-readonly-pc-lib",8:"edit-pc",10:"publish-edit-pc",11:"readonly-pc-tlib",20:"imageview-pc",21:"ocr-preview",22:"presentation",23:"presentation-tlib",24:"publish-pc",26:"readonly-pc-lib",27:"snap-pc",28:"snap-pc-tlib"}[e]||e)+"-"+{0:"6b4e4c32",1:"31d6cfe0",2:"31d6cfe0",3:"bd23486b",4:"31d6cfe0",5:"31d6cfe0",8:"a25fa49d",10:"0e9470f3",11:"31d6cfe0",20:"31d6cfe0",21:"31d6cfe0",22:"9393b677",23:"31d6cfe0",24:"c44ead77",26:"31d6cfe0",27:"aacfc0e4",28:"31d6cfe0"}[e]+".css",i=c.p+n,a=document.getElementsByTagName("link"),l=0;l<a.length;l++){var p=(u=a[l]).getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(p===n||p===i))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){var u;if((p=(u=d[l]).getAttribute("data-href"))===n||p===i)return t()}var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.onload=t,s.onerror=function(t){var n=t&&t.target&&t.target.src||i,a=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=n,delete o[e],s.parentNode.removeChild(s),r(a)},s.href=i,0!==s.href.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),document.getElementsByTagName("head")[0].appendChild(s)})).then((function(){o[e]=0})));var r=i[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=i[e]=[t,n]}));t.push(r[2]=n);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=function(e){return c.p+"js/features-pc-"+({0:"publish-readonly-pc",1:"edit-pc-tlib",2:"publish-readonly-pc-tlib",3:"readonly-pc",4:"melo-ext",5:"publish-readonly-pc-lib",8:"edit-pc",10:"publish-edit-pc",11:"readonly-pc-tlib",20:"imageview-pc",21:"ocr-preview",22:"presentation",23:"presentation-tlib",24:"publish-pc",26:"readonly-pc-lib",27:"snap-pc",28:"snap-pc-tlib"}[e]||e)+"-"+{0:"f128412c",1:"1e18e931",2:"483d431d",3:"c7bb01f9",4:"25401764",5:"25d12818",8:"0ca2edf3",10:"c51f4144",11:"79d25f5c",20:"9a2844e3",21:"871da6a2",22:"e9209a20",23:"d50a4ccd",24:"d4ad4195",26:"ba853ea9",27:"37552658",28:"a01370a1"}[e]+".js"}(e),0!==l.src.indexOf(window.location.origin+"/")&&(l.crossOrigin="anonymous");var p=new Error;a=function(t){l.onerror=l.onload=null,clearTimeout(d);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",p.name="ChunkLoadError",p.type=n,p.request=o,r[1](p)}i[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="//docs.idqqimg.com/tim/docs/static/",c.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],p=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=p;r()}([]);
//# sourceMappingURL=runtime-pc.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[6],[,,,function(e,t,o){"use strict";function r(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(o(14));var i=n(o(14));t.default=i.default;var a=o(45);t.TableName=a.TableName,t.PadIdType=a.PadIdType,t.DB_NAME=a.DB_NAME;var l=o(172);t.DocumentId=l.DocumentId;var s=o(57);t.OFFLINE_ITEM_TYPE=s.OFFLINE_ITEM_TYPE,t.OfflineData=s.OfflineData;var c=o(40);t.FILE_TYPE=c.FILE_TYPE,t.PadStatus=c.PadStatus,t.PadInfo=c.PadInfo,t.TYPE_DES=c.TYPE_DES,t.LIST_INFO_TYPE=c.LIST_INFO_TYPE,t.LIST_TYPE=c.LIST_TYPE;var d=o(92);t.UserInfo=d.UserInfo;var u=o(58);t.BaseBusinessHelper=u.BaseBusinessHelper;var p=o(174);t.ClientVarsHelper=p.ClientVarsHelper;var h=o(41);t.getCookie=h.getCookie,t.setCookie=h.setCookie,t.getXsrf=h.getXsrf,t.pushState=h.pushState,t.UserAgent=h.UserAgent,t.ChangesetPack=h.ChangesetPack,t.isSupportClientDB=h.isSupportClientDB,t.wordOfflineSwitch=h.wordOfflineSwitch,t.wordCodeVersion=h.wordCodeVersion,t.logSyncResult=h.logSyncResult,t.getFileType=h.getFileType,t.getFileTypeName=h.getFileTypeName;var f=o(66);t.CGI=f.CGI;var m=o(117);t.ClientMutexLock=m.ClientMutexLock;var y=o(118);t.MultiTabLock=y.MultiTabLock;var g=o(93);t.MutexLock=g.MutexLock;var v=o(119);t.OfflineDataManager=v.OfflineDataManager;var _=o(197);t.actionName=_.actionName,t.Change=_.Change;var b=o(198);t.ListType=b.ListType;var T=o(128);t.AppDocsListType=T.AppDocsListType;var S=o(58);t.Lock=S.Lock;var C=o(58);t.createLock=C.createLock;var w=o(39);t.Log=w.Log;var E=o(199);t.DebugUtils=E.DebugUtils;var I=o(200);t.OfflineAPI=I.OfflineAPI,t.DATA_TYPE=I.DATA_TYPE,r(o(201))},,,function(e,t,o){var r;window,r=function(){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var r=o(1);o.d(t,"emRoomState",(function(){return r.emRoomState})),o.d(t,"CollabRoomChannel",(function(){return r.CollabRoomChannel}));var n=o(11);o.d(t,"emRoomErrCode",(function(){return n.emRoomErrCode})),o.d(t,"TDWebsocketErrorCode",(function(){return n.TDWebsocketErrorCode}));var i=o(12);for(var a in i)["emRoomState","CollabRoomChannel","emRoomErrCode","TDWebsocketErrorCode","default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(a)},function(e,t,o){"use strict";o.r(t),o.d(t,"emRoomState",(function(){return r})),o.d(t,"CollabRoomChannel",(function(){return s}));var r,n=o(2),i=o(3),a=o(10),l=o(11);!function(e){e.INIT="INIT",e.CONNECTING="CONNECTING",e.OPENED="OPENED",e.RECONNECTING_In_CLOSED="RECONNECTING_In_CLOSED",e.SHUTDOWN="SHUTDOWN"}(r||(r={}));var s=function(){function e(e){this.collabRoomLogTag=" collab Room ",this.hasSocketReconnected=!1,this.callback=e.callback,this.collabRoomLogTag=" collab Room ",this.netWorkReporter=new n.WebSocketRoomReporter(e.moduleTag,e.callback),this.msgReporter=new n.MsgSenderReporter(e.moduleTag,e.callback),this.padId=e.serverVars.padId,this.globalPadId=e.serverVars.globalPadId,this.codeVer=e.serverVars.pver||0,this.gray=e.serverVars.gray,this.dver=e.serverVars.dver,this.appid=e.serverVars.apid,this.wmode=e.serverVars.wmode,this.padType=e.serverVars.padType||"",this.websocketReopenCount=e.serverVars.websocketReopenCount,this.pollingAttemptNumber=e.serverVars.pollingAttemptNumber,this.upid=e.serverVars.client&&e.serverVars.client.upid,this.sid=e.serverVars.client&&e.serverVars.client.sid,this.tid=e.serverVars.client&&e.serverVars.client.tid,this.sig=e.serverVars.client&&e.serverVars.client.sig,this.userId=e.userid,this.socketId="",this.socket=null,this.beatHeartTimer=0,this.beatHeartInterval=5e3,this.beatHeartCount=0,this.maxBeatHeartCount=3,this.loginCount=0,this.maxLoginCount=2,this.delayLoginTime=1500,this.delayLoginTimer=0,this.loginSeq=0,this.loginTimeout=0,this.reconnectTimes=[],this.liteReconnects=0,this.socketDisconnectTimer=0,this.reopenFuzzedDelayTimer=0,this.messageSenderTimer=0,this.messageQueue=[],this.finishQueue=[],this.defaultSendTimeout=3e3,this.roomState=r.INIT,this.bWebsocketDisconneted=!0,this.setupSocketTime=0,this.bFirstConnect=!0,this.caughtErrors=[],this.caughtErrorCatchers=[],this.caughtErrorTimes=[],this.loginTime=0,this.loginPostData=null}return e.prototype.getRoomState=function(){return this.roomState},e.prototype.open=function(){if(this.socket)a.NetworkUtils.roomLogWarn("socket open setUpSocket socket has exist");else if(this.getRoomState()!==r.SHUTDOWN){this.socketId=String(Math.floor(1e12*Math.random())),a.NetworkUtils.roomLogInfo("socket open setUpSocket socketId="+this.socketId);var e=a.Cookie.get("uid"),t=a.Cookie.get("uid_key"),o={id:this.socketId,tag:this.padId,gid:this.globalPadId,upid:this.upid,sig:this.sig,uid:e,uidKey:t,wmode:this.wmode,websocketReopenCount:this.websocketReopenCount,pollingAttemptNumber:this.pollingAttemptNumber};this.socket=new i.CollabRoomWebSocket(this,o),this.socket.connect(),this.setupSocketTime=(new Date).getTime(),this.getRoomState()===r.INIT?this.setRoomState(r.CONNECTING,null):this.setRoomState(r.RECONNECTING_In_CLOSED,null),this.netWorkReporter.reportNetWorkEvent("setupSocket socketId="+this.socketId,"")}else a.NetworkUtils.roomLogError("socket open setUpSocket socket error: the room state is shutdown")},e.prototype.reOpenAfterShutDown=function(){this.setRoomState(r.INIT,"reOpenCollabRoom"),this.reopen()},e.prototype.reopen=function(){a.NetworkUtils.roomLogInfo("socket  reopen "),this.closeSocket(),this.resetBeatHeart(),this.resetLogin(),this.open()},e.prototype.closeAndDelayReopen=function(e,t){var o=this;setTimeout((function(){e.reason=e.reason||"close by client",a.NetworkUtils.roomLogInfo("closeAndDelayReopen closeReason = "+e.reason+" delayOpenTime = "+t),o.closeSocket(),e.shutDown=!1,o.notifyRoomClosed(e,t)}),0)},e.prototype.shutDown=function(e){var t=this;setTimeout((function(){a.NetworkUtils.roomLogInfo("shutDown  closeReason = "+e.reason),e.reason=e.reason||"close by client",t.closeSocket(),e.shutDown=!0,t.notifyRoomClosed(e,0)}),0)},e.prototype.onReopenCount=function(){return this.liteReconnects},e.prototype.closeSocket=function(){this.socket&&this.socket.disconnect(""),this.socket=null},e.prototype.notifyRoomClosed=function(e,t){a.NetworkUtils.roomLogError("socket notifyRoomClosed, closeReason="+e.reason+", bShutDown="+e.shutDown+", delayOpenTime="+t+", time:"+new Date),this.socketDisconnectTimer&&(clearTimeout(this.socketDisconnectTimer),this.socketDisconnectTimer=0),this.bWebsocketDisconneted=!0;var o=this.getRoomState();this.resetBeatHeart(),this.resetLogin(),this.handleMessageByClose();var n=!0===e.shutDown;o!==r.RECONNECTING_In_CLOSED&&(n=!0);var i={closeReason:e.reason,bShutDown:e.shutDown,bNeedNotify:n,bFirstConnect:this.bFirstConnect};if(this.netWorkReporter.reportNetWorkEvent("close",i),this.bFirstConnect=!1,!0===e.shutDown)return this.reset(),this.setRoomState(r.SHUTDOWN,e.reason),void(o!==r.SHUTDOWN&&this.callback.handleOnRoomShutDown(e));this.setRoomState(r.RECONNECTING_In_CLOSED,e.reason),this.delayReopen(e.reason,t),o!==r.RECONNECTING_In_CLOSED&&this.callback.handleOnRoomClose(e)},e.prototype.onSocketOpenEvent=function(){this.liteReconnects=0,this.reconnectTimes=[],this.bWebsocketDisconneted=!1,this.hasSocketReconnected=!1,a.NetworkUtils.roomLogInfo("socket onSocketOpenEvent:"+new Date),this.socketDisconnectTimer&&(clearTimeout(this.socketDisconnectTimer),this.socketDisconnectTimer=0),this.reopenFuzzedDelayTimer&&(clearTimeout(this.reopenFuzzedDelayTimer),this.reopenFuzzedDelayTimer=0),this.netWorkReporter.reportNetWorkEvent("connect",null),this.resetBeatHeart(),this.resetLogin(),this.loginRoom()},e.prototype.onSocketClosedEvent=function(e){a.NetworkUtils.roomLogError("socket onSocketClosedEvent :"+new Date),this.socket=null,this.notifyRoomClosed({reason:e,shutDown:!1},0),this.hasSocketReconnected&&this.callback.onNetReconnectedFail()},e.prototype.onSocketStatusChanged=function(e,t){var o=this;if(e&&t&&t.event){var r=t.event;if("reconnecting"===r)a.NetworkUtils.roomLogInfo("socket onSocketStatusChanged receive reconnecting time: "+new Date),this.hasSocketReconnected=!0,this.netWorkReporter.reportNetWorkEvent(r,null);else if("connect_timeout"===r||"connect_error"===r){a.NetworkUtils.roomLogInfo("socket onSocketStatusChanged receive connect_timeout or connect_error time:"+new Date);var n={failReason:t.failReason};this.netWorkReporter.reportNetWorkEvent("connectfail",n)}else if("disconnect"===r){a.NetworkUtils.roomLogInfo("socket onSocketStatusChanged receive disconnect time:"+new Date),this.bWebsocketDisconneted=!0;var i="close by disconnect ";t.disconnectReason&&(i+=t.disconnectReason),this.socketDisconnectTimer||(this.resetLogin(),this.resetBeatHeart(),this.handleMsgBySocketDisconnect(),this.socketDisconnectTimer=setTimeout((function(){a.NetworkUtils.roomLogInfo("socket onSocketStatusChanged do disconnect time:"+new Date),o.closeSocket(),o.notifyRoomClosed({reason:i,shutDown:!1},0)}),15e3)),this.netWorkReporter.reportNetWorkEvent(r,null)}}},e.prototype.delayReopen=function(e,t){var o=this;if(!this.reopenFuzzedDelayTimer){this.reconnectTimes.push(+new Date),this.liteReconnects=this.liteReconnects+1;var r=t;if(!t){var n=Math.min(3e4,1e3*Math.pow(2,this.liteReconnects+1));r=this.generateFuzzyInterval(n,.4*n)}this.reopenFuzzedDelayTimer=setTimeout((function(){o.reopenFuzzedDelayTimer&&(clearTimeout(o.reopenFuzzedDelayTimer),o.reopenFuzzedDelayTimer=0),o.open()}),r)}},e.prototype.generateFuzzyInterval=function(e,t){return e+Math.floor(Math.random()*(2*t+1)-t)},e.prototype.reset=function(){this.socket=null,this.liteReconnects=0,this.reconnectTimes=[],this.reopenFuzzedDelayTimer&&(clearTimeout(this.reopenFuzzedDelayTimer),this.reopenFuzzedDelayTimer=0),this.socketDisconnectTimer&&(clearTimeout(this.socketDisconnectTimer),this.socketDisconnectTimer=0),this.resetLogin(),this.resetBeatHeart()},e.prototype.delayLogin=function(e){var t=this;this.delayLoginTimer=setTimeout((function(){t.loginRoom()}),e)},e.prototype.checkMsgType=function(e){if(e){var t=e.split("\n");if(t&&t.length>1){var o=JSON.parse(t[0]),r=JSON.parse(t[1]);if(o&&r&&o.type&&r.type&&o.type!==r.type){a.NetworkUtils.roomLogWarn(e);var n=Date.now(),i=n-18e4;setTimeout((function(){window.log&&window.log.report("Word_MeloCollabRoomMsgTypeNotSame",{query:{startTs:i,endTs:n}})}),1e3)}}}},e.prototype.loginRoom=function(){var e=this;if(a.NetworkUtils.roomLogInfo("loginRoom"),this.socket){this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0),this.loginCount=this.loginCount+1,this.loginSeq=this.createMessageSeq();var t={roomType:"padpage",roomName:"padpage/"+this.globalPadId,upid:this.upid,gid:this.globalPadId,sid:this.sid,tid:this.tid,sig:this.sig,data:{stats:this.getStats()}};a.NetworkUtils.roomLogWarn("CLIENT_READY:"+this.loginSeq),this.loginPostData=this.createMessageData("CLIENT_READY",this.loginSeq,JSON.stringify(t)),this.socket.postMessageForWebSocket(this.loginPostData),this.checkMsgType(this.loginPostData),this.loginTime=(new Date).getTime(),this.loginTimeout=setTimeout((function(){a.NetworkUtils.roomLogInfo("loginRoom loginTimeout seq ="+e.loginSeq);var t={errCode:l.emRoomErrCode.timeout,errMsg:"timeout error"};e.handleLoginResponse(e.loginSeq,"CLIENT_READY",t)}),3e3),this.netWorkReporter.reportNetWorkEvent("login",null)}else a.NetworkUtils.roomLogInfo("socket is null!")},e.prototype.handleLoginResponse=function(e,t,o){this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0);var r=(new Date).getTime(),n={cmd:"CLIENT_READY",seq:this.loginSeq,postData:this.loginPostData,retryCount:this.loginCount,lastSendTime:this.loginTime,onpostTime:r,firstSendTime:this.loginTime},i={errCode:0,event:"onpost",needRetry:!1,errMsg:""};this.loginSeq=0,0===o.errCode&&o.response&&o.response.onpost&&(0===o.response.onpost.result||o.response.onpost.result===l.TDWebsocketErrorCode.Socket_CollabRoom_AlreadyExist)?(this.notifyRoomOpened(o.response.onpost),i.errCode=o.response.onpost.result):this.handleLoginResponseFail(o,i),0!==i.errCode&&(i.errMsg=this.getErrMsg(i.errCode,"")),this.msgReporter.reportMsg(n,i)},e.prototype.handleLoginResponseFail=function(e,t){0!==e.errCode?(a.NetworkUtils.roomLogError("handleLoginResponse onpost fail, retry, client result ="+e.errCode),this.loginCount>=this.maxLoginCount?(a.NetworkUtils.roomLogError("handleLoginResponse login fail loginCount ="+this.loginCount+", errCode ="+e.errCode),this.resetLogin(),this.closeAndDelayReopen({reason:this.getErrMsg(e.errCode,"login fail"),shutDown:!1},0),t.needRetry=!1):(this.delayLogin(this.delayLoginTime),t.needRetry=!0),t.errCode=e.errCode,t.event="netStatusChange"):this.handleLoginResponseSvrFail(e,t)},e.prototype.handleLoginResponseSvrFail=function(e,t){var o=e.response.onpost.result;t.errCode=o,t.event="onpost",a.NetworkUtils.roomLogError("handleLoginResponse login fail loginCount ="+this.loginCount+", errCode ="+o),o===l.TDWebsocketErrorCode.Socket_CollabRoom_Timeout||o===l.TDWebsocketErrorCode.Socket_CollabServer_Timeout||o===l.TDWebsocketErrorCode.Socket_ServerStorage_Timeout||o===l.TDWebsocketErrorCode.Socket_ServerCGI_Timeout||o===l.TDWebsocketErrorCode.Socket_Frequency_Limit||o===l.TDWebsocketErrorCode.Socket_Auth_Timeout||o===l.TDWebsocketErrorCode.Socket_GetPrivilege_Timeout?this.handleLoginRetry(e,t):o===l.TDWebsocketErrorCode.Socket_Layer_Error||o===l.TDWebsocketErrorCode.Socket_ClientNotReady_Error?(this.closeAndDelayReopen({errCode:o,reason:this.getErrMsg(o,"login fail"),shutDown:!1},0),t.needRetry=!1):o===l.TDWebsocketErrorCode.Socket_ClientData_Error||o===l.TDWebsocketErrorCode.Socket_DocPrivilege_Failed||o===l.TDWebsocketErrorCode.Socket_PackageSize_TooLarge||o===l.TDWebsocketErrorCode.Socket_CollabRoom_MemberFull||o===l.TDWebsocketErrorCode.Socket_CollabRoom_Not_VIP_Full||o===l.TDWebsocketErrorCode.Socket_UserDoc_NoPrivilege||o===l.TDWebsocketErrorCode.Socket_Server_Error||o===l.TDWebsocketErrorCode.Socket_UserAuth_Failed?(this.shutDown({errCode:o,reason:this.getErrMsg(o,"login fail"),shutDown:!0}),t.needRetry=!1):o===l.TDWebsocketErrorCode.Socket_ClientVersion_TooOld?(this.shutDown({errCode:o,reason:this.getErrMsg(o,""),shutDown:!0}),t.needRetry=!1):(this.shutDown({errCode:o,reason:this.getErrMsg(o,"login fail"),shutDown:!0}),t.needRetry=!1)},e.prototype.handleLoginRetry=function(e,t){var o=e.response.onpost.result;if(this.loginCount>=this.maxLoginCount)this.resetLogin(),o===l.TDWebsocketErrorCode.Socket_Auth_Timeout||o===l.TDWebsocketErrorCode.Socket_GetPrivilege_Timeout?this.shutDown({reason:this.getErrMsg(o," login fail timeout"),shutDown:!0}):this.closeAndDelayReopen({reason:this.getErrMsg(o," login fail timeout"),shutDown:!1},0),t.needRetry=!1;else{a.NetworkUtils.roomLogError(this.collabRoomLogTag+"handleLoginResponse onpost fail, retry, server result ="+o);var r=this.delayLoginTime;e.response.onpost.retry_interval&&(r=e.response.onpost.retry_interval),this.delayLogin(r),t.needRetry=!0}},e.prototype.resetLogin=function(){this.loginCount=0,this.loginSeq=0,this.loginTimeout&&(clearTimeout(this.loginTimeout),this.loginTimeout=0),this.delayLoginTimer&&(clearTimeout(this.delayLoginTimer),this.delayLoginTimer=0)},e.prototype.notifyRoomOpened=function(e){var t=this;this.setRoomState(r.OPENED,null),this.resetLogin(),this.resetBeatHeart(),this.startBeatHeartOnTimer(e.heartbeat_interval),this.messageQueue.length&&setTimeout((function(){t.trySendPendingMessage()}),0);var o={bFirstConnect:this.bFirstConnect};this.netWorkReporter.reportNetWorkEvent("open",o),this.bFirstConnect=!1,setTimeout((function(){t.callback.handleOnRoomOpen()}),0)},e.prototype.sendMessage=function(e,t,o,r,n){return this.sendMessageWaitAcceptCmd(e,t,o,r,n,null)},e.prototype.sendMessageWaitAcceptCmd=function(e,t,o,n,i,s){return!s||n&&n.waitAcceptCmd&&"[object Array]"===Object.prototype.toString.call(n.waitAcceptCmd)?this.getRoomState()!==r.OPENED?(a.NetworkUtils.roomLogWarn(" send message before the room open, state ="+this.getRoomState()+", seq ="+t+", cmd="+e),!0===this.needReopen()&&(a.NetworkUtils.roomLogWarn("trySendPendingMessage can not send msg, socket needReopen"),this.reopen()),{errCode:l.emRoomErrCode.roomStateErr,errMsg:"room state can not send msg",cmd:e,seq:t}):this.sendMessageInternal(e,t,o,n,i,s):(a.NetworkUtils.roomLogError("checkParameter waitAcceptCmd invalid"),{errCode:l.emRoomErrCode.parameterErr,errMsg:"msg custom_param invalid",cmd:e,seq:t})},e.prototype.sendMessageInternal=function(e,t,o,r,n,i){var s=this,c=t;if(c)for(var d=0;d<this.messageQueue.length;d++)if(this.messageQueue[d].cmd===e&&this.messageQueue[d].messageSeq===t){var u={errCode:l.emRoomErrCode.exist,errMsg:"the msg has exist",cmd:e,seq:c};return a.NetworkUtils.roomLogWarn("sendMessageWaitAcceptCmd the message has exist seq ="+c+" cmd="+e),u}c||(c=this.createMessageSeq());var p=this.createMessageData(e,c,o,r),h=this.caculateSendTime(p.length);r&&r.timeout&&(r.maxRetryCount>3e4&&(r.maxRetryCount=3e4),h=r.timeout>h?r.timeout:h);var f,m=1;r&&r.maxRetryCount&&(r.maxRetryCount>5&&(r.maxRetryCount=5),m=r.maxRetryCount),r&&r.waitAcceptCmd&&(f=r.waitAcceptCmd);var y={cmd:e,seq:c,data:o,postData:p,timeout:h,maxRetryCount:m,waitAcceptCmd:f,onsend:n,onsendAccept:i,retryCount:0,lastSendTime:0,onpostTime:0,firstSendTime:0,state:"waiting"};return this.messageQueue.push(y),setTimeout((function(){s.trySendPendingMessage()}),10),this.startMessageTimer(),{errCode:l.emRoomErrCode.suc,errMsg:"",cmd:e,seq:c}},e.prototype.createMessageData=function(e,t,o,r){var n=0;0===this.userId.indexOf("g")&&(n=1);var i=this.userId.replace("p.","").replace("g.",""),l=a.Cookie.get("wl"),s={apid:this.appid||"",type:e,task_id:t,docid:this.globalPadId,uid:i,cookie:this.getLoinCookie(),base_rev:this.getPadRev(),code_ver:this.codeVer,session_type:n,gray:this.gray||0,dver:this.dver,wl:l,generalpacket:this.callback.getHeaderGeneralPacket()};"slide"===this.padType&&(s.docs_type=this.padType,r&&r.pageId&&(s.pageid=r.pageId));var c=JSON.stringify(s)+"\n";return o&&(c+=o),c},e.prototype.createMessageSeq=function(){return Math.ceil(0x4189374bc6a7f0*Math.random())},e.prototype.cancelMessageBySeq=function(e){for(var t=this,o=0;o<this.messageQueue.length;o++)if(this.messageQueue[o].seq===e){a.NetworkUtils.roomLogInfo("cancelMessageBySeq seq = "+e);var r=this.messageQueue[o].state;this.finishQueue.push(this.messageQueue[o]),this.messageQueue.splice(o,1),this.messageQueue.length&&"sending"===r&&setTimeout((function(){t.trySendPendingMessage()}),10);break}},e.prototype.trySendPendingMessage=function(){if(!0!==this.needReopen()){if(!1!==this.checkCanSend()&&this.socket)for(var e=0;e<this.messageQueue.length;e++)if("waiting"===this.messageQueue[e].state){0!==this.messageQueue[e].retryCount&&this.messageQueue[e].firstSendTime||(this.messageQueue[e].firstSendTime=(new Date).getTime()),this.messageQueue[e].retryCount=this.messageQueue[e].retryCount+1,this.messageQueue[e].lastSendTime=(new Date).getTime(),this.messageQueue[e].onpostTime=0,this.messageQueue[e].state="sending",this.socket.postMessageForWebSocket(this.messageQueue[e].postData),this.startMessageTimer(),this.checkMsgType(this.messageQueue[e].postData);break}}else this.reopen()},e.prototype.checkCanSend=function(){if(this.messageQueue.length<=0)return a.NetworkUtils.roomLogInfo("Can't sendMessage messageQueue.length = 0"),!1;if(this.getRoomState()!==r.OPENED||!1!==this.bWebsocketDisconneted)return a.NetworkUtils.roomLogError("Can't sendMessage the room state not open, state = "+this.getRoomState()+" bWebsocketDisconneted = "+this.bWebsocketDisconneted),!1;for(var e=0;e<this.messageQueue.length;e++)if("sending"===this.messageQueue[e].state)return a.NetworkUtils.roomLogInfo("Can't sendMessage there is a sending message, seq = "+this.messageQueue[e].seq+" cmd="+this.messageQueue[e].cmd),!1;return!0},e.prototype.needReopen=function(){if(this.getRoomState()===r.CONNECTING||this.getRoomState()===r.RECONNECTING_In_CLOSED||this.getRoomState()===r.RECONNECTING_In_CLOSED){var e=(new Date).getTime();if(this.setupSocketTime&&e>this.setupSocketTime&&e-this.setupSocketTime>5e4)return!0}return!1},e.prototype.onPostFromServer=function(e){var t=this;try{var o=e.split("\n");if(o.length<2)return void a.NetworkUtils.roomLogError(" onPostFromServer error： msg is not right");var r=JSON.parse(o[0]);if("HEART_BEAT"===r.type){var n=JSON.parse(o[1]);return void this.handleHeartBeartResponse(r,n)}if("CLIENT_READY"===r.type&&r.task_id===this.loginSeq){n=JSON.parse(o[1]);var i={errCode:l.emRoomErrCode.suc,errMsg:"",response:n};return void this.handleLoginResponse(r.task_id,r.type,i)}for(var s=!1,c=function(e){if(d.messageQueue[e].seq===r.task_id&&d.messageQueue[e].cmd===r.type){s=!0,d.messageQueue[e].onpostTime=(new Date).getTime();var n=d.messageQueue[e],i=JSON.parse(o[1]),c=i.onpost.result,u=(i.onpost.retry_times,i.onpost.retry_interval);if(0!==c&&a.NetworkUtils.roomLogError("onPostFromServer end to parse  errcode = "+i.onpost.result),!d.messageQueue[e].waitAcceptCmd||0!==c){var p="suc";0!==c&&(p=d.getErrMsg(c,""));var h={errCode:c,errMsg:p,event:"onpost",response:i,needRetry:!1};d.msgReporter.reportMsg(n,h)}if(c===l.TDWebsocketErrorCode.Socket_Server_Error||c===l.TDWebsocketErrorCode.Socket_UserAuth_Failed)return d.shutDown({errCode:c,reason:d.getErrMsg(c,""),shutDown:!0}),{value:void 0};if(c===l.TDWebsocketErrorCode.Socket_Layer_Error)return d.closeAndDelayReopen({errCode:c,reason:d.getErrMsg(c,""),shutDown:!1},u),{value:void 0};var f={errCode:l.emRoomErrCode.suc,errMsg:"",response:i};return n.onsend&&(m=f,y=n,setTimeout((function(){y.onsend(y.seq,y.cmd,y.data,m)}),10)),d.messageQueue[e].waitAcceptCmd&&0===c?d.messageQueue[e].state="waitAccept":(d.finishQueue.push(d.messageQueue[e]),d.messageQueue.splice(e,1)),d.messageQueue.length&&setTimeout((function(){t.trySendPendingMessage()}),10),"break"}var m,y},d=this,u=0;u<this.messageQueue.length;u++){var p=c(u);if("object"==typeof p)return p.value;if("break"===p)break}var h=!1;if(!1===s)for(u=0;u<this.finishQueue.length;u++)if(this.finishQueue[u].seq===r.task_id&&this.finishQueue[u].cmd===r.type){h=!0;break}!1===h&&!1===s&&a.NetworkUtils.roomLogWarn("the onPostFromServer not found： seq="+r.task_id+" cmd = "+r.type),this.finishQueue.length>50&&this.finishQueue.splice(0,this.finishQueue.length-50)}catch(e){a.NetworkUtils.roomLogError(this.collabRoomLogTag+" onPostFromServer error parse msg exception = "+e)}},e.prototype.getPadRev=function(){return this.callback.getPadRev()},e.prototype.getStats=function(){return{screen:""}},e.prototype.setRoomState=function(e,t){var o=this,r="Channel state being set to "+e;e!==this.roomState&&(this.roomState=e,setTimeout((function(){o.callback.handleOnRoomStateChange(o.roomState,t)}),0),this.netWorkReporter.reportRoomState(this.roomState),a.NetworkUtils.roomLogInfo(r))},e.prototype.startBeatHeartOnTimer=function(e){var t=this;if(e&&(this.beatHeartInterval=e),!this.beatHeartTimer){var o=this.caculateBeatHeartInterval();a.NetworkUtils.roomLogInfo("startBeatHeartOnTimer interval = "+o),this.beatHeartTimer=setTimeout((function(){t.sendBeatHeart()}),o)}},e.prototype.sendBeatHeart=function(){if(this.beatHeartTimer&&(clearTimeout(this.beatHeartTimer),this.beatHeartTimer=0),this.getRoomState()===r.OPENED&&this.socket){if(this.beatHeartCount>0&&a.NetworkUtils.roomLogWarn("sendBeatHeartOnTimer fail count over 1, the fail beatHeartCount = "+this.beatHeartCount),this.beatHeartCount>=this.maxBeatHeartCount)return a.NetworkUtils.roomLogError("sendBeatHeartOnTimer  reach to max BeatHeartCount closeAndDelayReopen"),void this.closeAndDelayReopen({reason:"close by beatHeart fail",shutDown:!1},0);this.beatHeartCount=this.beatHeartCount+1;var e=this.createMessageSeq(),t=this.userId.replace("p.","").replace("g.",""),o={type:"HEART_BEAT",task_id:e,docid:this.globalPadId,uid:t},n=JSON.stringify(o)+"\n";this.socket.postMessageForWebSocket(n),this.startBeatHeartOnTimer(0)}else a.NetworkUtils.roomLogError("sendBeatHeartOnTimer the room state not open state = "+this.getRoomState())},e.prototype.handleHeartBeartResponse=function(e,t){var o;this.beatHeartCount=0,t&&t.onpost&&t.onpost.heartbeat_interval&&(o=t.onpost.heartbeat_interval),this.startBeatHeartOnTimer(o)},e.prototype.resetBeatHeart=function(){this.beatHeartTimer&&(clearTimeout(this.beatHeartTimer),this.beatHeartTimer=0),this.beatHeartCount=0,this.beatHeartInterval=5e3},e.prototype.onGetMessageFromServer=function(e){try{var t=e.split("\r\n");if("[object Array]"!==Object.prototype.toString.call(t))return void a.NetworkUtils.roomLogError("===== onGetMessageFromServer  parse msg error， is not Array =====");for(var o=0;o<t.length;o++){var r=t[o].split("\n");if(r.length<2)return void a.NetworkUtils.roomLogError(this.collabRoomLogTag+" onGetMessageFromServer error： msg is not right");var n=JSON.parse(r[0]),i=void 0;if(r[1]&&(i=JSON.parse(r[1])),"QUIT_NOTICE"!==n.type||"INACTIVE"!==i.notice.quit_type)if(this.messageQueue.length<=0){for(var l=!1,s=0;s<this.finishQueue.length;s++)if(this.finishQueue[s].seq===n.task_id){l=!0;break}!1===l&&this.receiveMessageFromServer(n,i)}else{var c=!1,d=function(e){if(n.task_id===u.messageQueue[e].seq){var t=u.messageQueue[e];if(c=!0,u.messageQueue[e].waitAcceptCmd&&u.messageQueue[e].waitAcceptCmd.indexOf(n.type)>=0){var o=n.type,r={errCode:0,errMsg:"",response:{new_rev:n.new_rev,body:i}};t.onsendAccept&&(s=t,d=o,p=r,setTimeout((function(){s.onsendAccept(s.seq,s.cmd,s.data,d,p)}),10)),u.finishQueue.push(u.messageQueue[e]),u.messageQueue.splice(e,1);var l={waitAcceptCmd:o,event:"onsendAccept",response:i,needRetry:!1};return u.msgReporter.reportMsg(t,l),"break"}return a.NetworkUtils.roomLogError("===== onGetMessageFromServer the msg found in messageQueue, but waitcmd not equal (error) =====\n                                    the seq = "+n.task_id+"\n                                    the msg cmd = "+u.messageQueue[e].cmd+"\n                                    the server wait cmd = "+n.type+"\n                                "),"break"}var s,d,p},u=this;for(s=0;s<this.messageQueue.length&&"break"!==d(s);s++);var p=!1;if(!1===c)for(s=0;s<this.finishQueue.length;s++)if(this.finishQueue[s].seq===n.task_id&&this.finishQueue[s].waitAcceptCmd&&this.finishQueue[s].waitAcceptCmd.indexOf(n.type)>=0){p=!0;break}!1===c&&!1===p&&this.receiveMessageFromServer(n,i)}else this.handleInactive()}}catch(e){a.NetworkUtils.roomLogError("onGetMessageFromServer error parse msg exception = "+e)}},e.prototype.receiveMessageFromServer=function(e,t){var o=this,r={head:e,new_rev:e.new_rev,body:t,socketId:this.socketId,ts:e.ts};setTimeout((function(){o.callback.handleOnReceivMsgFromServer(e.type,r)}),10)},e.prototype.startMessageTimer=function(){var e=this;this.messageSenderTimer||(this.messageSenderTimer=setTimeout((function(){e.handleMessageTimer()}),1e3))},e.prototype.handleMessageTimer=function(){var e=this;this.messageSenderTimer&&(clearTimeout(this.messageSenderTimer),this.messageSenderTimer=0);for(var t,o=!1,r=!1,n=!1,i=function(e){var i,c,d=(new Date).getTime();if(("sending"===s.messageQueue[e].state||"waitAccept"===s.messageQueue[e].state)&&d>s.messageQueue[e].lastSendTime&&d-s.messageQueue[e].lastSendTime>s.messageQueue[e].timeout){o=!0;var u=!1,p=s.messageQueue[e];s.messageQueue[e].retryCount<s.messageQueue[e].maxRetryCount?(a.NetworkUtils.roomLogError("handleMessageTimer the msg timeout error, try again, the seq = "+s.messageQueue[e].seq+"\n                            the msg cmd = "+s.messageQueue[e].cmd+"\n                            messageQueue[i].retryCount = "+s.messageQueue[e].retryCount+"\n                            maxRetryCount = "+s.messageQueue[e].maxRetryCount+"\n                            state = "+s.messageQueue[e].state+"\n                        "),s.messageQueue[e].state="waiting",u=!0,e++):(a.NetworkUtils.roomLogError("handleMessageTimer the msg timeout error, the seq = "+s.messageQueue[e].seq+" the msg cmd ="+s.messageQueue[e].cmd),u=!1,i={errCode:l.emRoomErrCode.timeout,errMsg:"timeout error"},(c=p).onsend&&setTimeout((function(){c.onsend(c.seq,c.cmd,c.data,i)}),10),c.onsendAccept&&c.waitAcceptCmd&&setTimeout((function(){c.onsendAccept(c.seq,c.cmd,c.data,null,i)}),10),s.finishQueue.push(s.messageQueue[e]),s.messageQueue.splice(e,1));var h={errCode:l.emRoomErrCode.timeout,errMsg:"timeout error",event:"netStatusChange",needRetry:u};s.msgReporter.reportMsg(p,h)}else"sending"===s.messageQueue[e].state&&(r=!0),"waiting"===s.messageQueue[e].state&&(n=!0),e++;t=e},s=this,c=0;c<this.messageQueue.length;)i(c),c=t;this.finishQueue.length>50&&this.finishQueue.splice(0,this.finishQueue.length-50),!1===r&&!0===n&&(o=!0),this.messageQueue.length&&!0===o&&setTimeout((function(){e.trySendPendingMessage()}),10),this.messageQueue.length&&this.startMessageTimer()},e.prototype.handleMessageByClose=function(){for(var e=function(e){var o,r,n=t.messageQueue[e];o=n,r={errCode:l.emRoomErrCode.roomClose,errMsg:"room close"},o.onsendAccept&&o.waitAcceptCmd?setTimeout((function(){o.onsendAccept(o.seq,o.cmd,o.data,null,r)}),10):o.onsend&&setTimeout((function(){o.onsend(o.seq,o.cmd,o.data,r)}),10);var i={errCode:l.emRoomErrCode.roomClose,errMsg:"room close",event:"netStatusChange",needRetry:!1};t.msgReporter.reportMsg(n,i)},t=this,o=0;o<this.messageQueue.length;o++)e(o);this.messageQueue=[],this.messageSenderTimer&&(clearTimeout(this.messageSenderTimer),this.messageSenderTimer=0)},e.prototype.handleMsgBySocketDisconnect=function(){for(var e,t=function(t){if(("sending"===o.messageQueue[t].state||"waitAccept"===o.messageQueue[t].state)&&o.messageQueue[t].retryCount>=o.messageQueue[t].maxRetryCount){var r=o.messageQueue[t];a=r,s={errCode:l.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect"},a.onsendAccept&&a.waitAcceptCmd?setTimeout((function(){a.onsendAccept(a.seq,a.cmd,a.data,null,s)}),10):a.onsend&&setTimeout((function(){a.onsend(a.seq,a.cmd,a.data,s)}),10),o.finishQueue.push(o.messageQueue[t]),o.messageQueue.splice(t,1);var n={errCode:l.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect",event:"netStatusChange",needRetry:!1};return o.msgReporter.reportMsg(r,n),e=t,"continue"}if("sending"===o.messageQueue[t].state||"waitAccept"===o.messageQueue[t].state){var i=o.messageQueue[t];o.messageQueue[t].state="waiting",n={errCode:l.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect",event:"netStatusChange",needRetry:!0},o.msgReporter.reportMsg(i,n)}var a,s;t++,e=t},o=this,r=0;r<this.messageQueue.length;)t(r),r=e},e.prototype.caculateBeatHeartInterval=function(){for(var e=0,t=0;t<this.messageQueue.length;t++)"sending"===this.messageQueue[t].state&&(e=this.messageQueue[t].postData.length,this.messageQueue[t].lastSendTime);if(e>2097152){var o=this.caculateSendTime(e)/2;return o>this.beatHeartInterval?o:this.beatHeartInterval}return this.beatHeartInterval},e.prototype.getErrMsg=function(e,t){var o=" errMsg, code "+e;switch(e){case l.TDWebsocketErrorCode.Socket_Server_Error:o="Server Internal Error code "+e;break;case l.TDWebsocketErrorCode.Socket_Layer_Error:o="Connection Not Exist code "+e;break;case l.TDWebsocketErrorCode.Socket_UserAuth_Failed:o="TX-LOGIN-PSKEY-EXPIRED code "+e;break;case l.TDWebsocketErrorCode.Socket_ClientData_Error:case l.TDWebsocketErrorCode.Socket_CollabRoom_Timeout:case l.TDWebsocketErrorCode.Socket_CollabServer_Timeout:case l.TDWebsocketErrorCode.Socket_ServerStorage_Timeout:case l.TDWebsocketErrorCode.Socket_ServerCGI_Timeout:o="TimeOut code "+e;break;case l.TDWebsocketErrorCode.Socket_DocPrivilege_Failed:case l.TDWebsocketErrorCode.Socket_UserDoc_NoPrivilege:o="UnAuth code "+e;break;case l.TDWebsocketErrorCode.Socket_PackageSize_TooLarge:o="BigData code "+e;break;case l.TDWebsocketErrorCode.Socket_CollabRoom_MemberFull:case l.TDWebsocketErrorCode.Socket_CollabRoom_Not_VIP_Full:o="MemberFull code "+e;break;case l.TDWebsocketErrorCode.Socket_Frequency_Limit:o="Frequently code "+e;break;case l.TDWebsocketErrorCode.Socket_Auth_Timeout:o="TX-LOGIN-PSKEY-EXPIRED TIMEOUT "+e;break;case l.TDWebsocketErrorCode.Socket_GetPrivilege_Timeout:o="UnAuth TIMEOUT code "+e}return t&&(o=t+"  "+o),o},e.prototype.handleInactive=function(){this.messageQueue.length>0||this.shutDown({reason:"close by server INACTIVE",shutDown:!0})},e.prototype.getLoinCookie=function(){var e="";return a.Cookie.get("p_luin")&&(e=e+" p_luin="+a.Cookie.get("p_luin")+";"),a.Cookie.get("p_lskey")&&(e=e+" p_lskey="+a.Cookie.get("p_lskey")+";"),a.Cookie.get("p_skey")&&(e=e+" p_skey="+a.Cookie.get("p_skey")+";"),a.Cookie.get("p_uin")&&(e=e+" p_uin="+a.Cookie.get("p_uin")+";"),a.Cookie.get("uid")&&(e=e+" uid="+a.Cookie.get("uid")+";"),a.Cookie.get("uid_key")&&(e=e+" uid_key="+a.Cookie.get("uid_key")+";"),a.Cookie.get("ww_utoken")&&(e=e+" ww_utoken="+a.Cookie.get("ww_utoken")+";"),e},e.prototype.caculateSendTime=function(e){return this.defaultSendTimeout,!e||e<5120?this.defaultSendTimeout:e<1048576||e<2097152?1e4:e<4194304?15e3:e<6291456?2e4:25e3},e}()},function(e,t,o){"use strict";o.r(t),o.d(t,"WebSocketRoomReporter",(function(){return r})),o.d(t,"MsgSenderReporter",(function(){return n}));var r=function(){function e(e,t){this.startOpenTime=0,this.endOpenTime=0,this.lastEndTime=0,this.bConnecting=!1,this.startConnectingTime=0,this.connectedTime=0,this.reconnectCount=0,this.closeReason="unknow",this.loginCount=0,this.bShutDown=0,this.bNeedNotify=0,this.bFirstConnect=0,this.roomState="unknow",this.moduleTag=e||"unknow",this.reportCallback=t}return e.prototype.reset=function(){this.startOpenTime=0,this.endOpenTime=0,this.lastEndTime=0,this.startConnectingTime=0,this.connectedTime=0,this.reconnectCount=0,this.closeReason="unknow",this.loginCount=0,this.roomState="unknow",this.bConnecting=!1,this.bShutDown=0,this.bNeedNotify=0},e.prototype.reportRoomConnectInfo=function(){var e={module:this.moduleTag,type:"room_open",closeReason:"unknow",roomState:this.roomState,startOpenTime:0,endOpenTime:0,openTotalTime:0,connectTime:0,loginTime:0,delayOpenTime:0,reconnectCount:0,loginCount:0,bShutDown:0,bNeedNotify:0,bFirstConnect:0};e.bShutDown=this.bShutDown,e.bNeedNotify=this.bNeedNotify,e.bFirstConnect=this.bFirstConnect,this.closeReason&&(e.closeReason=this.closeReason),e.startOpenTime=this.startOpenTime,e.endOpenTime=this.endOpenTime,this.endOpenTime&&this.startOpenTime&&this.endOpenTime-this.startOpenTime>0&&(e.openTotalTime=this.endOpenTime-this.startOpenTime),this.connectedTime&&this.startOpenTime&&this.connectedTime-this.startOpenTime>0&&(e.connectTime=this.connectedTime-this.startOpenTime),this.connectedTime&&this.endOpenTime&&this.endOpenTime-this.connectedTime>0&&(e.loginTime=this.endOpenTime-this.connectedTime),this.lastEndTime&&this.startOpenTime&&this.startOpenTime>this.lastEndTime&&(e.delayOpenTime=this.startOpenTime-this.lastEndTime),e.reconnectCount=this.reconnectCount,e.loginCount=this.loginCount;var t={opername:"tech_doc_websocket",module:"websocket_collab",action:"room_connect",table:"dc03111",ver6:e.module+"TDSP"+e.type+"TDSP"+e.closeReason+"TDSP"+e.roomState+"TDSP"+e.startOpenTime+"TDSP"+e.endOpenTime+"TDSP"+e.openTotalTime+"TDSP"+e.connectTime+"TDSP"+e.loginTime+"TDSP"+e.delayOpenTime+"TDSP"+e.reconnectCount+"TDSP"+e.loginCount+"TDSP"+e.bShutDown+"TDSP"+e.bNeedNotify+"TDSP"+e.bFirstConnect+"TDSP"};this.reportCallback.report(t)},e.prototype.reportSocketConnectInfo=function(e,t){var o={module:this.moduleTag,type:"socket_connect",roomState:this.roomState,closeReason:"unkown",startConnectTime:0,endConnectTime:0,connecTotalTime:0,connectNum:0},r=(new Date).getTime();o.startConnectTime=this.startConnectingTime,o.endConnectTime=r,o.connecTotalTime=o.endConnectTime-o.startConnectTime,o.connectNum=this.reconnectCount,!0===e?o.closeReason="suc":(o.closeReason="unkown",t&&(o.closeReason=t));var n={opername:"tech_doc_websocket",module:"websocket_collab",action:"socket_connect",table:"dc03111",ver6:o.module+"TDSP"+o.type+"TDSP"+o.roomState+"TDSP"+o.closeReason+"TDSP"+o.startConnectTime+"TDSP"+o.endConnectTime+"TDSP"+o.connecTotalTime+"TDSP"+o.connectNum+"TDSP"};this.reportCallback.report(n)},e.prototype.reportRoomState=function(e){this.roomState=e},e.prototype.reportNetWorkEvent=function(e,t){"setupSocket"===e?(this.reset(),this.reconnectCount=1,this.startOpenTime=(new Date).getTime(),this.startConnectingTime=(new Date).getTime(),this.bConnecting=!0):"connectfail"===e?(this.reportSocketConnectInfo(!1,t.reason),this.bConnecting=!1,this.startConnectingTime=0):"reconnecting"===e?(!0===this.bConnecting&&this.reportSocketConnectInfo(!1,"reconnecting unknow"),this.reconnectCount=this.reconnectCount+1,this.startConnectingTime=(new Date).getTime(),this.bConnecting=!0,0===this.startOpenTime&&(this.reset(),this.reconnectCount=1,this.startOpenTime=(new Date).getTime(),this.startConnectingTime=(new Date).getTime(),this.bConnecting=!0)):"connect"===e?(this.connectedTime=(new Date).getTime(),this.reportSocketConnectInfo(!0,""),this.startConnectingTime=0,this.bConnecting=!1):"open"===e?(this.endOpenTime=(new Date).getTime(),this.closeReason="suc",this.bNeedNotify=1,this.bFirstConnect=!0===t.bFirstConnect?1:0,this.reportRoomConnectInfo(),this.reset()):"close"===e?(!0===this.bConnecting&&t.closeReason&&t.closeReason.indexOf("Timeout connecting")>=0&&this.reportSocketConnectInfo(!1,t.closeReason),this.endOpenTime=(new Date).getTime(),this.closeReason=t.closeReason,this.bShutDown=!0===t.bShutDown?1:0,this.bNeedNotify=!0===t.bNeedNotify?1:0,this.bFirstConnect=!0===t.bFirstConnect?1:0,this.reportRoomConnectInfo(),this.reset(),this.lastEndTime=(new Date).getTime()):"login"===e&&(this.loginCount=this.loginCount+1)},e}(),n=function(){function e(e,t){this.msgReportInfo=[],this.moduleTag=e||"unkown",this.reportCallback=t}return e.prototype.packReportInfo=function(e,t){var o={seq:0,cmd:"null",errCode:0,errMsg:"",retryCount:0,dataSize:0,postTime:0,waitAcceptTime:0,totoalTime:0,allTotoalTime:0,waitAcceptCmd:"null",bFinish:1,module:this.moduleTag};o.seq=e.seq,o.cmd=e.cmd,o.retryCount=e.retryCount,o.dataSize=e.postData.length,o.bFinish=t.needRetry?0:1,e.postTime&&e.lastSendTime&&e.postTime>e.lastSendTime&&(o.postTime=e.postTime-e.lastSendTime);var r=(new Date).getTime();if(e.lastSendTime&&r>e.lastSendTime&&(o.totoalTime=r-e.lastSendTime),o.waitAcceptTime=o.totoalTime-o.postTime,e.firstSendTime&&r>e.firstSendTime&&(o.allTotoalTime=r-e.firstSendTime),t.waitAcceptCmd&&(o.waitAcceptCmd=t.waitAcceptCmd),"netStatusChange"===t.event&&(o.errCode=t.errCode,o.errMsg=t.errMsg),"onpost"===t.event&&(o.errCode=t.errCode,0===t.errCode?o.errMsg="suc":t.errMsg&&0!==t.errMsg.length?o.errMsg=t.errMsg:o.errMsg="onpost error"),"onsendAccept"===t.event)if("ACCEPT_COMMIT"===t.waitAcceptCmd)o.errCode=0,o.errMsg="suc";else if("COMMIT_ERROR"===t.waitAcceptCmd){var n=t.response.data;o.errCode=n.reason,n.msg&&(o.errMsg=n.msg)}else"TASK_DUPLICATE"===t.waitAcceptCmd&&(o.errCode=0,o.errMsg="suc");return o},e.prototype.packReportData=function(e,t){var o={opername:"tech_doc_websocket",module:"websocket_collab",action:"sendMsg",table:"dc03111",ver6:e.module+"TDSP"+e.seq+"TDSP"+e.cmd+"TDSP"+e.errCode+"TDSP"+e.errMsg+"TDSP"+e.retryCount+"TDSP"+e.dataSize+"TDSP"+e.postTime+"TDSP"+e.waitAcceptTime+"TDSP"+e.totoalTime+"TDSP"+e.allTotoalTime+"TDSP"+e.waitAcceptCmd+"TDSP"+e.bFinish+"TDSP"};if(t.postData&&t.postData.indexOf("changeSetCount")>0&&t.postData.indexOf("\n")>0)for(var r=t.postData.split("\n"),n=0;n<r.length;n++){var i=r[n];"object"==typeof JSON.parse(i)&&(JSON.parse(i).hasOwnProperty("changeSetCount")&&(o.obj3=JSON.parse(i).changeSetCount),JSON.parse(i).hasOwnProperty("offlineMsg")&&(o.ver5=JSON.parse(i).offlineMsg))}return"USER_CHANGES"===t.cmd&&(o.ver3="USER_CHANGES",o.ver4=e.errCode,o.ver8=window.__globalReleaseVersion),o},e.prototype.reportMsg=function(e,t){var o=this.packReportInfo(e,t),r=this.packReportData(o,e);this.reportCallback.report(r)},e}()},function(e,t,o){"use strict";o.r(t),o.d(t,"CollabRoomWebSocket",(function(){return a}));var r=o(4),n=o.n(r),i=o(10),a=function(){function e(e,t){this.socketChannel=null,this.socketAttempts=-1,this.cbCls=e,this.params=t,this.name="socketing",this.reconnectMaxTimes=3,this.connectTimeout=5e3,this.reconnectionDelay=3e3,this.reconnectionDelayMax=5e3,this.randomizationFactor=1,this.socketChannel=null,this.disconnectReason="",this.hasWebSocketClosed=!1,this.timeouts={},this.timeoutNoop={}}return e.prototype.clearIt=function(e,t){e[t]&&(e[t](),e[t]=this.timeoutNoop)},e.prototype.timeout=function(e,t,o,r){var n=this,i=setTimeout((function(){n.clearIt(e,t),r()}),o),a=function(){clearTimeout(i)};return this.clearIt(e,t),e[t]=a,a},e.prototype.getSocketConnectCount=function(){return{socketConnectCnt:this.socketAttempts}},e.prototype.connect=function(){var e=this;this.timeout(this.timeouts,"connect",3e4,(function(){e.disconnectInternal("Timeout connecting to server:")}));var t="wss://"+window.location.host,o=this.params.mode||{w:["websocket"],l:["polling"],b:["polling","websocket"]},r=this.params.wmode||"ww",a=o[r.charAt(0)]||o.w,l=o[r.charAt(1)]||o.b,s=this.params.websocketReopenCount||2,c=this.params.pollingAttemptNumber||3,d=n()(t,{query:{tag:this.params.tag,gtag:this.params.gid,utag:this.params.upid,sig:this.params.sig,uid:this.params.uid,uid_key:this.params.uidKey},transports:a,reconnection:!0,reconnectionAttempts:this.reconnectMaxTimes,reconnectionDelay:this.reconnectionDelay,reconnectionDelayMax:this.reconnectionDelayMax,randomizationFactor:this.randomizationFactor,timeout:this.connectTimeout,path:"/websocket"});i.NetworkUtils.roomLogInfo("connecting channel io transports: "+d.io.opts.transports+",\n            pollingReopenCount = "+s+", pollingAttemptNumber="+c),this.socketChannel=d,d.on("reconnect_attempt",(function(){i.NetworkUtils.roomLogInfo("socket io reconnect_attempt time= "+new Date),d.io.opts.transports=l})),d.on("connect_error",(function(t){var o=e.getSocketChannelInfo();o||(o={}),o.event="connect_error",o.failReason="io connect_error unknown",t&&t.type&&(o.failReason=t.type),e.cbCls.onSocketStatusChanged(d.io.readyState,o)})),d.on("connect_timeout",(function(){var t=e.getSocketChannelInfo();t||(t={}),t.event="connect_timeout",t.failReason="connect_timeout",e.cbCls.onSocketStatusChanged(d.io.readyState,t)})),d.on("get",(function(t){e.cbCls.onGetMessageFromServer(t)})),d.on("post",(function(t){e.cbCls.onPostFromServer(t)})),d.on("connect",(function(t){e.timeouts.socketing&&e.timeouts.socketing(),e.hasWebSocketClosed=!1,i.NetworkUtils.roomLogInfo("socket io connect readyState: "+d.io.readyState),e.timeouts.connect&&e.timeouts.connect(),e.cbCls.onSocketOpenEvent()})),d.on("reconnect",(function(t){var o=new Date;i.NetworkUtils.roomLogInfo("socket io reconnect number: "+t+", time: "+o+" channel.readyState: "+d.io.readyState),e.socketAttempts=0})),d.on("reconnecting",(function(t){var o=new Date;e.socketAttempts=t,d.io.opts.transports=a,i.NetworkUtils.roomLogInfo("socket io reconnecting number:"+t+" time: "+o+" channel.readyState: "+d.io.readyState),e.cbCls.onReopenCount()>=s&&t>=c&&(d.io.opts.transports=l),i.NetworkUtils.roomLogInfo("reconnecting channel io transports:"+d.io.opts.transports+"\n                pollingReopenCount = "+s+", pollingAttemptNumber= "+c);var r=e.getSocketChannelInfo();r||(r={}),r.event="reconnecting",e.cbCls.onSocketStatusChanged(d.io.readyState,r)})),d.on("retry",(function(t){"ok"!==t&&t.length;var o=new Date;i.NetworkUtils.roomLogInfo("socket io retry time: "+o),e.disconnectInternal("Server restarted or socket timed out on server. serverRetry offlineEdit")})),d.on("disconnect",(function(t){var o=new Date;i.NetworkUtils.roomLogInfo("socket io disconnect, msg: "+JSON.stringify(t)+" time: "+o+" channel.readyState: "+d.io.readyState);var r=e.getSocketChannelInfo();r||(r={}),r.event="disconnect",e.disconnectReason||(e.disconnectReason=JSON.stringify(t)+" ClosedByOthers. WS disconnect offlineEdit"),r.disconnectReason=JSON.stringify(t)+" "+e.disconnectReason,e.cbCls.onSocketStatusChanged(d.io.readyState,r),e.socketAttempts=0})),d.on("connect_failed",(function(t){i.NetworkUtils.roomLogInfo("socket io connect_failed"),e.timeout(e.timeouts,"socketing",500,(function(){e.disconnectInternal(JSON.stringify(t)+"  connect_failed Closed by client. WS connect_failed offlineEdit")})),e.socketAttempts=0})),d.on("error",(function(t){i.NetworkUtils.roomLogInfo("socket io error"),e.timeout(e.timeouts,"socketing",500,(function(){e.disconnectInternal(JSON.stringify(t)+" socket io error Closed by client. WS error offlineEdit")}))})),d.on("reconnect_failed",(function(t){i.NetworkUtils.roomLogInfo("socket io reconnect_failed"),e.disconnectInternal(JSON.stringify(t)+" reconnect_failed Closed by client. WS reconnect_failed offlineEdit"),e.socketAttempts=0}))},e.prototype.disconnect=function(e){this.doDisconnect(e||"Closed by client. forceClosed "),this.hasWebSocketClosed=!0},e.prototype.disconnectInternal=function(e){this.doDisconnect(e||"Closed by socket internal. forceClosed "),!1===this.hasWebSocketClosed&&(this.cbCls.onSocketClosedEvent(e),this.hasWebSocketClosed=!0)},e.prototype.doDisconnect=function(e){i.NetworkUtils.roomLogInfo("doDisconnect id ="+this.params.id+" reason: "+e+",hasWebSocketClosed: "+this.hasWebSocketClosed),this.socketChannel&&(e&&(this.disconnectReason=e),this.socketChannel.disconnect(),this.socketChannel=null)},e.prototype.postMessageForWebSocket=function(e){new Date,this.socketChannel&&this.socketChannel.emit("post",e)},e.prototype.getSocketChannelInfo=function(){var e={};return this.socketChannel&&(e.connected=this.socketChannel.connected,e.disconnected=this.socketChannel.disconnected,this.socketChannel.io&&(e.readyState=this.socketChannel.io.readyState,e.reconnecting=this.socketChannel.io.reconnecting)),e},e.prototype.describe=function(){return this.name},e}()},function(e,t,o){(function(t){
/*!
 * Socket.IO v2.2.0
 * (c) 2014-2018 Guillermo Rauch
 * Released under the MIT License.
 */
e.exports=function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function r(e,t){"object"===(void 0===e?"undefined":n(e))&&(t=e,e=void 0),t=t||{};var o,r=i(e),a=r.source,d=r.id,u=r.path,p=c[d]&&u in c[d].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||p?(s("ignoring socket cache for %s",a),o=l(a,t)):(c[d]||(s("new io instance for %s",a),c[d]=l(a,t)),o=c[d]),r.query&&!t.query&&(t.query=r.query),o.socket(r.path,t)}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(1),a=o(7),l=o(12),s=o(3)("socket.io-client");e.exports=t=r;var c=t.managers={};t.protocol=a.protocol,t.connect=r,t.Manager=o(12),t.Socket=o(36)},function(e,t,o){"use strict";var r=o(2),n=o(3)("socket.io-client:url");e.exports=function(e,t){var o=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(n("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),n("parse %s",e),o=r(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";var i=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+i+":"+o.port,o.href=o.protocol+"://"+i+(t&&t.port===o.port?"":":"+o.port),o}},function(e,t){var o=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,n=e.indexOf("["),i=e.indexOf("]");-1!=n&&-1!=i&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=o.exec(e||""),l={},s=14;s--;)l[r[s]]=a[s]||"";return-1!=n&&-1!=i&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l}},function(e,t,o){(function(r){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=o(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var o=this.useColors;if(e[0]=(o?"%c":"")+this.namespace+(o?" %c":" ")+e[0]+(o?"%c ":" ")+"+"+t.humanize(this.diff),o){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())}).call(t,o(4))},function(e,t){function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function n(e){if(c===setTimeout)return setTimeout(e,0);if((c===o||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(){f&&p&&(f=!1,p.length?h=p.concat(h):m=-1,h.length&&a())}function a(){if(!f){var e=n(i);f=!0;for(var t=h.length;t;){for(p=h,h=[];++m<t;)p&&p[m].run();m=-1,t=h.length}p=null,f=!1,function(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}(e)}}function l(e,t){this.fun=e,this.array=t}function s(){}var c,d,u=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:o}catch(e){c=o}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var p,h=[],f=!1,m=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];h.push(new l(e,t)),1!==h.length||f||n(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.prependListener=s,u.prependOnceListener=s,u.listeners=function(e){return[]},u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,o){function r(e){function o(){if(o.enabled){var e=o,n=+new Date,i=n-(r||n);e.diff=i,e.prev=r,e.curr=n,r=n;for(var a=new Array(arguments.length),l=0;l<a.length;l++)a[l]=arguments[l];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var s=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(o,r){if("%%"===o)return o;s++;var n=t.formatters[r];if("function"==typeof n){var i=a[s];o=n.call(e,i),a.splice(s,1),s--}return o})),t.formatArgs.call(e,a);var c=o.log||t.log||console.log.bind(console);c.apply(e,a)}}var r;return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var o,r=0;for(o in e)r=(r<<5)-r+e.charCodeAt(o),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),o.destroy=n,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function n(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var o,r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(o=0;o<n;o++)r[o]&&("-"===(e=r[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(o=0;o<t.instances.length;o++){var i=t.instances[o];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var o,r;for(o=0,r=t.skips.length;o<r;o++)if(t.skips[o].test(e))return!1;for(o=0,r=t.names.length;o<r;o++)if(t.names[o].test(e))return!0;return!1},t.humanize=o(6),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function o(e){return r(e,l,"day")||r(e,a,"hour")||r(e,i,"minute")||r(e,n,"second")||e+" ms"}function r(e,t,o){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+o:Math.ceil(e/t)+" "+o+"s"}var n=1e3,i=60*n,a=60*i,l=24*a,s=365.25*l;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*s;case"days":case"day":case"d":return o*l;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===r&&!1===isNaN(e))return t.long?o(e):function(e){return e>=l?Math.round(e/l)+"d":e>=a?Math.round(e/a)+"h":e>=i?Math.round(e/i)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,o){function r(){}function n(e){var o=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(o+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(o+=e.nsp+","),null!=e.id&&(o+=e.id),null!=e.data){var r=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===r)return f;o+=r}return c("encoded %j as %s",e,o),o}function i(){this.reconstructor=null}function a(e){var o=0,r={type:Number(e.charAt(0))};if(null==t.types[r.type])return s("unknown packet type "+r.type);if(t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type){for(var n="";"-"!==e.charAt(++o)&&(n+=e.charAt(o),o!=e.length););if(n!=Number(n)||"-"!==e.charAt(o))throw new Error("Illegal attachments");r.attachments=Number(n)}if("/"===e.charAt(o+1))for(r.nsp="";++o&&","!==(a=e.charAt(o))&&(r.nsp+=a,o!==e.length););else r.nsp="/";var i=e.charAt(o+1);if(""!==i&&Number(i)==i){for(r.id="";++o;){var a;if(null==(a=e.charAt(o))||Number(a)!=a){--o;break}if(r.id+=e.charAt(o),o===e.length)break}r.id=Number(r.id)}if(e.charAt(++o)){var l=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(o));if(!1===l||r.type!==t.ERROR&&!p(l))return s("invalid payload");r.data=l}return c("decoded %s as %j",e,r),r}function l(e){this.reconPack=e,this.buffers=[]}function s(e){return{type:t.ERROR,data:"parser error: "+e}}var c=o(3)("socket.io-parser"),d=o(8),u=o(9),p=o(10),h=o(11);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=i;var f=t.ERROR+'"encode error"';r.prototype.encode=function(e,o){c("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){u.removeBlobs(e,(function(e){var o=u.deconstructPacket(e),r=n(o.packet),i=o.buffers;i.unshift(r),t(i)}))}(e,o):o([n(e)])},d(i.prototype),i.prototype.add=function(e){var o;if("string"==typeof e)o=a(e),t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type?(this.reconstructor=new l(o),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",o)):this.emit("decoded",o);else{if(!h(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(o=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",o))}},i.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=u.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,o){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function o(){this.off(e,o),t.apply(this,arguments)}return o.fn=t,this.on(e,o),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var o=this._callbacks["$"+e];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,n=0;n<o.length;n++)if((r=o[n])===t||r.fn===t){o.splice(n,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),o=this._callbacks["$"+e];if(o)for(var r=0,n=(o=o.slice(0)).length;r<n;++r)o[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,o){var r=o(10),n=o(11),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.deconstructPacket=function(e){var t=[],o=e.data,i=e;return i.data=function e(t,o){if(!t)return t;if(n(t)){var i={_placeholder:!0,num:o.length};return o.push(t),i}if(r(t)){for(var a=new Array(t.length),l=0;l<t.length;l++)a[l]=e(t[l],o);return a}if("object"==typeof t&&!(t instanceof Date)){for(var s in a={},t)a[s]=e(t[s],o);return a}return t}(o,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,o){if(!t)return t;if(t&&t._placeholder)return o[t.num];if(r(t))for(var n=0;n<t.length;n++)t[n]=e(t[n],o);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],o);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var o=0,i=e;(function e(s,c,d){if(!s)return s;if(a&&s instanceof Blob||l&&s instanceof File){o++;var u=new FileReader;u.onload=function(){d?d[c]=this.result:i=this.result,--o||t(i)},u.readAsArrayBuffer(s)}else if(r(s))for(var p=0;p<s.length;p++)e(s[p],p,s);else if("object"==typeof s&&!n(s))for(var h in s)e(s[h],h,s)})(i),o||t(i)}},function(e,t){var o={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==o.call(e)}},function(e,o){e.exports=function(e){return r&&t.isBuffer(e)||n&&(e instanceof ArrayBuffer||i(e))};var r="function"==typeof t&&"function"==typeof t.isBuffer,n="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,o){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);e&&"object"===(void 0===e?"undefined":n(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var o=t.parser||s;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(13),a=o(36),l=o(8),s=o(7),c=o(38),d=o(39),u=o(3)("socket.io-client:manager"),p=o(35),h=o(40),f=Object.prototype.hasOwnProperty;e.exports=r,r.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},r.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},r.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},l(r.prototype),r.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},r.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},r.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},r.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},r.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},r.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},r.prototype.open=r.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=i(this.uri,this.opts);var o=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var n=c(o,"open",(function(){r.onopen(),e&&e()})),a=c(o,"error",(function(t){if(u("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var o=new Error("Connection error");o.data=t,e(o)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var l=this._timeout;u("connect attempt will timeout after %d",l);var s=setTimeout((function(){u("connect attempt timed out after %d",l),n.destroy(),o.close(),o.emit("error","timeout"),r.emitAll("connect_timeout",l)}),l);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(n),this.subs.push(a),this},r.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",d(this,"ondata"))),this.subs.push(c(e,"ping",d(this,"onping"))),this.subs.push(c(e,"pong",d(this,"onpong"))),this.subs.push(c(e,"error",d(this,"onerror"))),this.subs.push(c(e,"close",d(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",d(this,"ondecoded")))},r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},r.prototype.ondata=function(e){this.decoder.add(e)},r.prototype.ondecoded=function(e){this.emit("packet",e)},r.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},r.prototype.socket=function(e,t){function o(){~p(n.connecting,r)||n.connecting.push(r)}var r=this.nsps[e];if(!r){r=new a(this,e,t),this.nsps[e]=r;var n=this;r.on("connecting",o),r.on("connect",(function(){r.id=n.generateId(e)})),this.autoConnect&&o()}return r},r.prototype.destroy=function(e){var t=p(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},r.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(o){for(var r=0;r<o.length;r++)t.engine.write(o[r],e.options);t.encoding=!1,t.processPacketQueue()})))},r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},r.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},r.prototype.close=r.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},r.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var o=setTimeout((function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(o)}})}},r.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,o){e.exports=o(14),e.exports.parser=o(21)},function(e,t,o){function r(e,t){return this instanceof r?(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,void this.open()):new r(e,t)}var n=o(15),i=o(8),a=o(3)("engine.io-client:socket"),l=o(35),s=o(21),c=o(2),d=o(29);e.exports=r,r.priorWebsocketSuccess=!1,i(r.prototype),r.protocol=s.protocol,r.Socket=r,r.Transport=o(20),r.transports=o(15),r.parser=o(21),r.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=function(e){var t={};for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var o=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new n[e]({query:t,socket:this,agent:o.agent||this.agent,hostname:o.hostname||this.hostname,port:o.port||this.port,secure:o.secure||this.secure,path:o.path||this.path,forceJSONP:o.forceJSONP||this.forceJSONP,jsonp:o.jsonp||this.jsonp,forceBase64:o.forceBase64||this.forceBase64,enablesXDR:o.enablesXDR||this.enablesXDR,timestampRequests:o.timestampRequests||this.timestampRequests,timestampParam:o.timestampParam||this.timestampParam,policyPort:o.policyPort||this.policyPort,pfx:o.pfx||this.pfx,key:o.key||this.key,passphrase:o.passphrase||this.passphrase,cert:o.cert||this.cert,ca:o.ca||this.ca,ciphers:o.ciphers||this.ciphers,rejectUnauthorized:o.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:o.perMessageDeflate||this.perMessageDeflate,extraHeaders:o.extraHeaders||this.extraHeaders,forceNode:o.forceNode||this.forceNode,localAddress:o.localAddress||this.localAddress,requestTimeout:o.requestTimeout||this.requestTimeout,protocols:o.protocols||void 0,isReactNative:this.isReactNative})},r.prototype.open=function(){var e;if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},r.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;u=u||t}u||(a('probe transport "%s" opened',e),d.send([{type:"ping",data:"probe"}]),d.once("packet",(function(t){if(!u)if("pong"===t.type&&"probe"===t.data){if(a('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",d),!d)return;r.priorWebsocketSuccess="websocket"===d.name,a('pausing current transport "%s"',p.transport.name),p.transport.pause((function(){u||"closed"!==p.readyState&&(a("changing transport and sending upgrade packet"),c(),p.setTransport(d),d.send([{type:"upgrade"}]),p.emit("upgrade",d),d=null,p.upgrading=!1,p.flush())}))}else{a('probe transport "%s" failed',e);var o=new Error("probe error");o.transport=d.name,p.emit("upgradeError",o)}})))}function o(){u||(u=!0,c(),d.close(),d=null)}function n(t){var r=new Error("probe error: "+t);r.transport=d.name,o(),a('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function i(){n("transport closed")}function l(){n("socket closed")}function s(e){d&&e.name!==d.name&&(a('"%s" works - aborting "%s"',e.name,d.name),o())}function c(){d.removeListener("open",t),d.removeListener("error",n),d.removeListener("close",i),p.removeListener("close",l),p.removeListener("upgrading",s)}a('probing transport "%s"',e);var d=this.createTransport(e,{probe:1}),u=!1,p=this;r.priorWebsocketSuccess=!1,d.once("open",t),d.once("error",n),d.once("close",i),this.once("close",l),this.once("upgrading",s),d.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,o){return this.sendPacket("message",e,t,o),this},r.prototype.sendPacket=function(e,t,o,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof o&&(r=o,o=null),"closing"!==this.readyState&&"closed"!==this.readyState){(o=o||{}).compress=!1!==o.compress;var n={type:e,data:t,options:o};this.emit("packetCreate",n),this.writeBuffer.push(n),r&&this.once("flush",r),this.flush()}},r.prototype.close=function(){function e(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function o(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?o():e()})):this.upgrading?o():e()}return this},r.prototype.onError=function(e){a("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(a('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},r.prototype.filterUpgrades=function(e){for(var t=[],o=0,r=e.length;o<r;o++)~l(this.transports,e[o])&&t.push(e[o]);return t}},function(e,t,o){var r=o(16),n=o(18),i=o(32),a=o(33);t.polling=function(e){var t=!1,o=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var l="https:"===location.protocol,s=location.port;s||(s=l?443:80),t=e.hostname!==location.hostname||s!==e.port,o=e.secure!==l}if(e.xdomain=t,e.xscheme=o,"open"in new r(e)&&!e.forceJSONP)return new n(e);if(!a)throw new Error("JSONP disabled");return new i(e)},t.websocket=a},function(e,t,o){var r=o(17);e.exports=function(e){var t=e.xdomain,o=e.xscheme,n=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!o&&n)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,o){function r(){}function n(e){if(s.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,o=location.port;o||(o=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||o!==e.port,this.xs=e.secure!==t}}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var l=o(16),s=o(19),c=o(8),d=o(30),u=o(3)("engine.io-client:polling-xhr");if(e.exports=n,e.exports.Request=i,d(n,s),n.prototype.supportsBinary=!0,n.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new i(e)},n.prototype.doWrite=function(e,t){var o="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:o}),n=this;r.on("success",t),r.on("error",(function(e){n.onError("xhr post error",e)})),this.sendXhr=r},n.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},c(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new l(e),o=this;try{u("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){o.onLoad()},t.onerror=function(){o.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");o.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?o.onLoad():setTimeout((function(){o.onError(t.status)}),0))},u("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){o.onError(e)}),0)}"undefined"!=typeof document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",a);else if("function"==typeof addEventListener){var p="onpagehide"in self?"pagehide":"unload";addEventListener(p,a,!1)}},function(e,t,o){function r(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),n.call(this,e)}var n=o(20),i=o(29),a=o(21),l=o(30),s=o(31),c=o(3)("engine.io-client:polling");e.exports=r;var d=null!=new(o(16))({xdomain:!1}).responseType;l(r,n),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){c("paused"),o.readyState="paused",e()}var o=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||t()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||t()})))}else t()},r.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;c("polling got data %s",e),a.decodePayload(e,this.socket.binaryType,(function(e,o,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){c("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var o=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,o)}))},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",o="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(o=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+o+this.path+e}},function(e,t,o){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var n=o(21),i=o(8);e.exports=r,i(r.prototype),r.prototype.onError=function(e,t){var o=new Error(e);return o.type="TransportError",o.description=t,this.emit("error",o),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,o){function r(e,o){return o("b"+t.packets[e.type]+e.data.data)}function n(e,o,r){if(!o)return t.encodeBase64Packet(e,r);var n=e.data,i=new Uint8Array(n),a=new Uint8Array(1+n.byteLength);a[0]=y[e.type];for(var l=0;l<i.length;l++)a[l+1]=i[l];return r(a.buffer)}function i(e,o,r){if(!o)return t.encodeBase64Packet(e,r);if(m)return function(e,o,r){if(!o)return t.encodeBase64Packet(e,r);var n=new FileReader;return n.onload=function(){t.encodePacket({type:e.type,data:n.result},o,!0,r)},n.readAsArrayBuffer(e.data)}(e,o,r);var n=new Uint8Array(1);return n[0]=y[e.type],r(new _([n.buffer,e.data]))}function a(e,t,o){for(var r=new Array(e.length),n=u(e.length,o),i=function(e,o,n){t(o,(function(t,o){r[e]=o,n(t,r)}))},a=0;a<e.length;a++)i(a,e[a],n)}var l,s=o(22),c=o(23),d=o(24),u=o(25),p=o(26);"undefined"!=typeof ArrayBuffer&&(l=o(27));var h="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),m=h||f;t.protocol=3;var y=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},g=s(y),v={type:"error",data:"parser error"},_=o(28);t.encodePacket=function(e,t,o,a){"function"==typeof t&&(a=t,t=!1),"function"==typeof o&&(a=o,o=null);var l=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&l instanceof ArrayBuffer)return n(e,t,a);if(void 0!==_&&l instanceof _)return i(e,t,a);if(l&&l.base64)return r(e,a);var s=y[e.type];return void 0!==e.data&&(s+=o?p.encode(String(e.data),{strict:!1}):String(e.data)),a(""+s)},t.encodeBase64Packet=function(e,o){var r,n="b"+t.packets[e.type];if(void 0!==_&&e.data instanceof _){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];o(n+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),l=new Array(a.length),s=0;s<a.length;s++)l[s]=a[s];r=String.fromCharCode.apply(null,l)}return n+=btoa(r),o(n)},t.decodePacket=function(e,o,r){if(void 0===e)return v;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),o);if(r&&!1===(e=function(e){try{e=p.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return v;var n=e.charAt(0);return Number(n)==n&&g[n]?e.length>1?{type:g[n],data:e.substring(1)}:{type:g[n]}:v}n=new Uint8Array(e)[0];var i=d(e,1);return _&&"blob"===o&&(i=new _([i])),{type:g[n],data:i}},t.decodeBase64Packet=function(e,t){var o=g[e.charAt(0)];if(!l)return{type:o,data:{base64:!0,data:e.substr(1)}};var r=l.decode(e.substr(1));return"blob"===t&&_&&(r=new _([r])),{type:o,data:r}},t.encodePayload=function(e,o,r){"function"==typeof o&&(r=o,o=null);var n=c(e);return o&&n?_&&!m?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void a(e,(function(e,r){t.encodePacket(e,!!n&&o,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))})):r("0:")},t.decodePayload=function(e,o,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,o,r);var n;if("function"==typeof o&&(r=o,o=null),""===e)return r(v,0,1);for(var i,a,l="",s=0,c=e.length;s<c;s++){var d=e.charAt(s);if(":"===d){if(""===l||l!=(i=Number(l)))return r(v,0,1);if(l!=(a=e.substr(s+1,i)).length)return r(v,0,1);if(a.length){if(n=t.decodePacket(a,o,!1),v.type===n.type&&v.data===n.data)return r(v,0,1);if(!1===r(n,s+i,c))return}s+=i,l=""}else l+=d}return""!==l?r(v,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,o){return e.length?void a(e,(function(e,o){t.encodePacket(e,!0,!0,(function(e){return o(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var o;return e+(o="string"==typeof t?t.length:t.byteLength).toString().length+o+2}),0),n=new Uint8Array(r),i=0;return t.forEach((function(e){var t="string"==typeof e,o=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);o=r.buffer}n[i++]=t?0:1;var l=o.byteLength.toString();for(a=0;a<l.length;a++)n[i++]=parseInt(l[a]);for(n[i++]=255,r=new Uint8Array(o),a=0;a<r.length;a++)n[i++]=r[a]})),o(n.buffer)})):o(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,o){a(e,(function(e,o){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(n=0;n<i.length;n++)a[n]=parseInt(i[n]);if(a[i.length]=255,_){var l=new _([t.buffer,a.buffer,e]);o(null,l)}}))}),(function(e,t){return o(new _(t))}))},t.decodePayloadAsBinary=function(e,o,r){"function"==typeof o&&(r=o,o=null);for(var n=e,i=[];n.byteLength>0;){for(var a=new Uint8Array(n),l=0===a[0],s="",c=1;255!==a[c];c++){if(s.length>310)return r(v,0,1);s+=a[c]}n=d(n,2+s.length),s=parseInt(s);var u=d(n,0,s);if(l)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var p=new Uint8Array(u);for(u="",c=0;c<p.length;c++)u+=String.fromCharCode(p[c])}i.push(u),n=d(n,s)}var h=i.length;i.forEach((function(e,n){r(t.decodePacket(e,o,!0),n,h)}))}},function(e,t){e.exports=Object.keys||function(e){var t=[],o=Object.prototype.hasOwnProperty;for(var r in e)o.call(e,r)&&t.push(r);return t}},function(e,o,r){var n=r(10),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(o){if(!o||"object"!=typeof o)return!1;if(n(o)){for(var r=0,i=o.length;r<i;r++)if(e(o[r]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(o)||"function"==typeof ArrayBuffer&&o instanceof ArrayBuffer||a&&o instanceof Blob||l&&o instanceof File)return!0;if(o.toJSON&&"function"==typeof o.toJSON&&1===arguments.length)return e(o.toJSON(),!0);for(var s in o)if(Object.prototype.hasOwnProperty.call(o,s)&&e(o[s]))return!0;return!1}},function(e,t){e.exports=function(e,t,o){var r=e.byteLength;if(t=t||0,o=o||r,e.slice)return e.slice(t,o);if(t<0&&(t+=r),o<0&&(o+=r),o>r&&(o=r),t>=r||t>=o||0===r)return new ArrayBuffer(0);for(var n=new Uint8Array(e),i=new Uint8Array(o-t),a=t,l=0;a<o;a++,l++)i[l]=n[a];return i.buffer}},function(e,t){function o(){}e.exports=function(e,t,r){function n(e,o){if(n.count<=0)throw new Error("after called too many times");--n.count,e?(i=!0,t(e),t=r):0!==n.count||i||t(null,o)}var i=!1;return r=r||o,n.count=e,0===e?t():n}},function(e,t){function o(e){for(var t,o,r=[],n=0,i=e.length;n<i;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<i?56320==(64512&(o=e.charCodeAt(n++)))?r.push(((1023&t)<<10)+(1023&o)+65536):(r.push(t),n--):r.push(t);return r}function r(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function n(e,t){return u(e>>t&63|128)}function i(e,t){if(0==(4294967168&e))return u(e);var o="";return 0==(4294965248&e)?o=u(e>>6&31|192):0==(4294901760&e)?(r(e,t)||(e=65533),o=u(e>>12&15|224),o+=n(e,6)):0==(4292870144&e)&&(o=u(e>>18&7|240),o+=n(e,12),o+=n(e,6)),o+u(63&e|128)}function a(){if(d>=c)throw Error("Invalid byte index");var e=255&s[d];if(d++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,o;if(d>c)throw Error("Invalid byte index");if(d==c)return!1;if(t=255&s[d],d++,0==(128&t))return t;if(192==(224&t)){if((o=(31&t)<<6|a())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if((o=(15&t)<<12|a()<<6|a())>=2048)return r(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(o=(7&t)<<18|a()<<12|a()<<6|a())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}/*! https://mths.be/utf8js v2.1.2 by @mathias */
var s,c,d,u=String.fromCharCode;e.exports={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=o(e),a=n.length,l=-1,s="";++l<a;)s+=i(n[l],r);return s},decode:function(e,t){var r=!1!==(t=t||{}).strict;s=o(e),c=s.length,d=0;for(var n,i=[];!1!==(n=l(r));)i.push(n);return function(e){for(var t,o=e.length,r=-1,n="";++r<o;)(t=e[r])>65535&&(n+=u((t-=65536)>>>10&1023|55296),t=56320|1023&t),n+=u(t);return n}(i)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=new Uint8Array(256),r=0;r<e.length;r++)o[e.charCodeAt(r)]=r;t.encode=function(t){var o,r=new Uint8Array(t),n=r.length,i="";for(o=0;o<n;o+=3)i+=e[r[o]>>2],i+=e[(3&r[o])<<4|r[o+1]>>4],i+=e[(15&r[o+1])<<2|r[o+2]>>6],i+=e[63&r[o+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,n,i,a,l=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(l--,"="===e[e.length-2]&&l--);var d=new ArrayBuffer(l),u=new Uint8Array(d);for(t=0;t<s;t+=4)r=o[e.charCodeAt(t)],n=o[e.charCodeAt(t+1)],i=o[e.charCodeAt(t+2)],a=o[e.charCodeAt(t+3)],u[c++]=r<<2|n>>4,u[c++]=(15&n)<<4|i>>2,u[c++]=(3&i)<<6|63&a;return d}}()},function(e,t){function o(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var o=new Uint8Array(e.byteLength);o.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=o.buffer}return t}return e}))}function r(e,t){t=t||{};var r=new i;return o(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function n(e,t){return new Blob(o(e),t||{})}var i=void 0!==i?i:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,a=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),l=a&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),s=i&&i.prototype.append&&i.prototype.getBlob;"undefined"!=typeof Blob&&(r.prototype=Blob.prototype,n.prototype=Blob.prototype),e.exports=a?l?Blob:n:s?r:void 0},function(e,t){t.encode=function(e){var t="";for(var o in e)e.hasOwnProperty(o)&&(t.length&&(t+="&"),t+=encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t},t.decode=function(e){for(var t={},o=e.split("&"),r=0,n=o.length;r<n;r++){var i=o[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}},function(e,t){"use strict";function o(e){var t="";do{t=i[e%a]+t,e=Math.floor(e/a)}while(e>0);return t}function r(){var e=o(+new Date);return e!==n?(s=0,n=e):e+"."+o(s++)}for(var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,l={},s=0,c=0;c<a;c++)l[i[c]]=c;r.encode=o,r.decode=function(e){var t=0;for(c=0;c<e.length;c++)t=t*a+l[e.charAt(c)];return t},e.exports=r},function(e,t,o){(function(t){function r(){}function n(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function i(e){if(a.call(this,e),this.query=this.query||{},!s){var t=n();s=t.___eio=t.___eio||[]}this.index=s.length;var o=this;s.push((function(e){o.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){o.script&&(o.script.onerror=r)}),!1)}var a=o(19),l=o(30);e.exports=i;var s,c=/\n/g,d=/\\n/g;l(i,a),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),a.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var o=document.getElementsByTagName("script")[0];o?o.parentNode.insertBefore(t,o):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},i.prototype.doWrite=function(e,t){function o(){r(),t()}function r(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}var n=this;if(!this.form){var i,a=document.createElement("form"),l=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=s,a.method="POST",a.setAttribute("accept-charset","utf-8"),l.name="d",a.appendChild(l),document.body.appendChild(a),this.form=a,this.area=l}this.form.action=this.uri(),r(),e=e.replace(d,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&o()}:this.iframe.onload=o}}).call(t,function(){return this}())},function(e,o,r){function n(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=i&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=a),l.call(this,e)}var i,a,l=r(20),s=r(21),c=r(29),d=r(30),u=r(31),p=r(3)("engine.io-client:websocket");if("undefined"==typeof self)try{a=r(34)}catch(e){}else i=self.WebSocket||self.MozWebSocket;var h=i||a;e.exports=n,d(n,l),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,o={agent:this.agent,perMessageDeflate:this.perMessageDeflate};o.pfx=this.pfx,o.key=this.key,o.passphrase=this.passphrase,o.cert=this.cert,o.ca=this.ca,o.ciphers=this.ciphers,o.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(o.headers=this.extraHeaders),this.localAddress&&(o.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,o)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},n.prototype.write=function(e){var o=this;this.writable=!1;for(var r=e.length,n=0,i=r;n<i;n++)!function(e){s.encodePacket(e,o.supportsBinary,(function(n){if(!o.usingBrowserWebSocket){var i={};e.options&&(i.compress=e.options.compress),o.perMessageDeflate&&("string"==typeof n?t.byteLength(n):n.length)<o.perMessageDeflate.threshold&&(i.compress=!1)}try{o.usingBrowserWebSocket?o.ws.send(n):o.ws.send(n,i)}catch(e){p("websocket closed before onclose event")}--r||(o.emit("flush"),setTimeout((function(){o.writable=!0,o.emit("drain")}),0))}))}(e[n])},n.prototype.onClose=function(){l.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",o="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(o=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=c.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+o+this.path+e},n.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===n.prototype.name)}},function(e,t){},function(e,t){var o=[].indexOf;e.exports=function(e,t){if(o)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,o){"use strict";function r(e,t,o){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},o&&o.query&&(this.query=o.query),this.io.autoConnect&&this.open()}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(7),a=o(8),l=o(37),s=o(38),c=o(39),d=o(3)("socket.io-client:socket"),u=o(29),p=o(23);e.exports=r;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=a.prototype.emit;a(r.prototype),r.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},r.prototype.open=r.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},r.prototype.send=function(){var e=l(arguments);return e.unshift("message"),this.emit.apply(this,e),this},r.prototype.emit=function(e){if(h.hasOwnProperty(e))return f.apply(this,arguments),this;var t=l(arguments),o={type:(void 0!==this.flags.binary?this.flags.binary:p(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return o.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(d("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),this.flags={},this},r.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},r.prototype.onopen=function(){if(d("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===n(this.query)?u.encode(this.query):this.query;d("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},r.prototype.onclose=function(e){d("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},r.prototype.onpacket=function(e){var t=e.nsp===this.nsp,o=e.type===i.ERROR&&"/"===e.nsp;if(t||o)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},r.prototype.onevent=function(e){var t=e.data||[];d("emitting event %j",t),null!=e.id&&(d("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},r.prototype.ack=function(e){var t=this,o=!1;return function(){if(!o){o=!0;var r=l(arguments);d("sending ack %j",r),t.packet({type:p(r)?i.BINARY_ACK:i.ACK,id:e,data:r})}}},r.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(d("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):d("bad ack %s",e.id)},r.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},r.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},r.prototype.ondisconnect=function(){d("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},r.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},r.prototype.close=r.prototype.disconnect=function(){return this.connected&&(d("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},r.prototype.compress=function(e){return this.flags.compress=e,this},r.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var o=[],r=(t=t||0)||0;r<e.length;r++)o[r-t]=e[r];return o}},function(e,t){"use strict";e.exports=function(e,t,o){return e.on(t,o),{destroy:function(){e.removeListener(t,o)}}}},function(e,t){var o=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=o.call(arguments,2);return function(){return t.apply(e,r.concat(o.call(arguments)))}}},function(e,t){function o(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=o,o.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),o=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-o:e+o}return 0|Math.min(e,this.max)},o.prototype.reset=function(){this.attempts=0},o.prototype.setMin=function(e){this.ms=e},o.prototype.setMax=function(e){this.max=e},o.prototype.setJitter=function(e){this.jitter=e}}])}).call(this,o(5).Buffer)},function(e,t,o){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=o(7),n=o(8),i=o(9);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function l(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,o){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,o);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,o)}function c(e,t,o,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,o,r){if(t.byteLength,o<0||t.byteLength<o)throw new RangeError("'offset' is out of bounds");if(t.byteLength<o+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===o&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,o):new Uint8Array(t,o,r),s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=p(e,t),e}(e,t,o,r):"string"==typeof t?function(e,t,o){if("string"==typeof o&&""!==o||(o="utf8"),!s.isEncoding(o))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,o),n=(e=l(e,r)).write(t,o);return n!==r&&(e=e.slice(0,n)),e}(e,t,o):function(e,t){if(s.isBuffer(t)){var o=0|h(t.length);return 0===(e=l(e,o)).length||t.copy(e,0,0,o),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?l(e,0):p(e,t);if("Buffer"===t.type&&i(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=l(e,t<0?0:0|h(t)),!s.TYPED_ARRAY_SUPPORT)for(var o=0;o<t;++o)e[o]=0;return e}function p(e,t){var o=t.length<0?0:0|h(t.length);e=l(e,o);for(var r=0;r<o;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var o=e.length;if(0===o)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return M(e).length;default:if(r)return B(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,o){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===o||o>this.length)&&(o=this.length),o<=0)return"";if((o>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,o);case"utf8":case"utf-8":return I(this,t,o);case"ascii":return x(this,t,o);case"latin1":case"binary":return R(this,t,o);case"base64":return E(this,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,o);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,o){var r=e[t];e[t]=e[o],e[o]=r}function g(e,t,o,r,n){if(0===e.length)return-1;if("string"==typeof o?(r=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,isNaN(o)&&(o=n?0:e.length-1),o<0&&(o=e.length+o),o>=e.length){if(n)return-1;o=e.length-1}else if(o<0){if(!n)return-1;o=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:v(e,t,o,r,n);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,o):Uint8Array.prototype.lastIndexOf.call(e,t,o):v(e,[t],o,r,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,o,r,n){var i,a=1,l=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,l/=2,s/=2,o/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n){var d=-1;for(i=o;i<l;i++)if(c(e,i)===c(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===s)return d*a}else-1!==d&&(i-=i-d),d=-1}else for(o+s>l&&(o=l-s),i=o;i>=0;i--){for(var u=!0,p=0;p<s;p++)if(c(e,i+p)!==c(t,p)){u=!1;break}if(u)return i}return-1}function _(e,t,o,r){o=Number(o)||0;var n=e.length-o;r?(r=Number(r))>n&&(r=n):r=n;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var l=parseInt(t.substr(2*a,2),16);if(isNaN(l))return a;e[o+a]=l}return a}function b(e,t,o,r){return U(B(t,e.length-o),e,o,r)}function T(e,t,o,r){return U(function(e){for(var t=[],o=0;o<e.length;++o)t.push(255&e.charCodeAt(o));return t}(t),e,o,r)}function S(e,t,o,r){return T(e,t,o,r)}function C(e,t,o,r){return U(M(t),e,o,r)}function w(e,t,o,r){return U(function(e,t){for(var o,r,n,i=[],a=0;a<e.length&&!((t-=2)<0);++a)o=e.charCodeAt(a),r=o>>8,n=o%256,i.push(n),i.push(r);return i}(t,e.length-o),e,o,r)}function E(e,t,o){return 0===t&&o===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,o))}function I(e,t,o){o=Math.min(e.length,o);for(var r=[],n=t;n<o;){var i,a,l,s,c=e[n],d=null,u=c>239?4:c>223?3:c>191?2:1;if(n+u<=o)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(i=e[n+1]))&&(s=(31&c)<<6|63&i)>127&&(d=s);break;case 3:i=e[n+1],a=e[n+2],128==(192&i)&&128==(192&a)&&(s=(15&c)<<12|(63&i)<<6|63&a)>2047&&(s<55296||s>57343)&&(d=s);break;case 4:i=e[n+1],a=e[n+2],l=e[n+3],128==(192&i)&&128==(192&a)&&128==(192&l)&&(s=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&l)>65535&&s<1114112&&(d=s)}null===d?(d=65533,u=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),n+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var o="",r=0;r<t;)o+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return o}(r)}function x(e,t,o){var r="";o=Math.min(e.length,o);for(var n=t;n<o;++n)r+=String.fromCharCode(127&e[n]);return r}function R(e,t,o){var r="";o=Math.min(e.length,o);for(var n=t;n<o;++n)r+=String.fromCharCode(e[n]);return r}function O(e,t,o){var r,n=e.length;(!t||t<0)&&(t=0),(!o||o<0||o>n)&&(o=n);for(var i="",a=t;a<o;++a)i+=(r=e[a])<16?"0"+r.toString(16):r.toString(16);return i}function P(e,t,o){for(var r=e.slice(t,o),n="",i=0;i<r.length;i+=2)n+=String.fromCharCode(r[i]+256*r[i+1]);return n}function D(e,t,o){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>o)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,o,r,n,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<i)throw new RangeError('"value" argument is out of bounds');if(o+r>e.length)throw new RangeError("Index out of range")}function k(e,t,o,r){t<0&&(t=65535+t+1);for(var n=0,i=Math.min(e.length-o,2);n<i;++n)e[o+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function L(e,t,o,r){t<0&&(t=4294967295+t+1);for(var n=0,i=Math.min(e.length-o,4);n<i;++n)e[o+n]=t>>>8*(r?n:3-n)&255}function F(e,t,o,r,n,i){if(o+r>e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function A(e,t,o,r,i){return i||F(e,0,o,4),n.write(e,t,o,r,23,4),o+4}function V(e,t,o,r,i){return i||F(e,0,o,8),n.write(e,t,o,r,52,8),o+8}t.Buffer=s,t.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,o){return c(null,e,t,o)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,o){return function(e,t,o,r){return d(t),t<=0?l(e,t):void 0!==o?"string"==typeof r?l(e,t).fill(o,r):l(e,t).fill(o):l(e,t)}(null,e,t,o)},s.allocUnsafe=function(e){return u(null,e)},s.allocUnsafeSlow=function(e){return u(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var o=e.length,r=t.length,n=0,i=Math.min(o,r);n<i;++n)if(e[n]!==t[n]){o=e[n],r=t[n];break}return o<r?-1:r<o?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var o;if(void 0===t)for(t=0,o=0;o<e.length;++o)t+=e[o].length;var r=s.allocUnsafe(t),n=0;for(o=0;o<e.length;++o){var a=e[o];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,n),n+=a.length}return r},s.byteLength=f,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",o=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,o).match(/.{2}/g).join(" "),this.length>o&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,o,r,n){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===o&&(o=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||o>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&t>=o)return 0;if(r>=n)return-1;if(t>=o)return 1;if(this===e)return 0;for(var i=(n>>>=0)-(r>>>=0),a=(o>>>=0)-(t>>>=0),l=Math.min(i,a),c=this.slice(r,n),d=e.slice(t,o),u=0;u<l;++u)if(c[u]!==d[u]){i=c[u],a=d[u];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,o){return-1!==this.indexOf(e,t,o)},s.prototype.indexOf=function(e,t,o){return g(this,e,t,o,!0)},s.prototype.lastIndexOf=function(e,t,o){return g(this,e,t,o,!1)},s.prototype.write=function(e,t,o,r){if(void 0===t)r="utf8",o=this.length,t=0;else if(void 0===o&&"string"==typeof t)r=t,o=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(o)?(o|=0,void 0===r&&(r="utf8")):(r=o,o=void 0)}var n=this.length-t;if((void 0===o||o>n)&&(o=n),e.length>0&&(o<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,o);case"utf8":case"utf-8":return b(this,e,t,o);case"ascii":return T(this,e,t,o);case"latin1":case"binary":return S(this,e,t,o);case"base64":return C(this,e,t,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,o);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){var o,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(o=this.subarray(e,t)).__proto__=s.prototype;else{var n=t-e;o=new s(n,void 0);for(var i=0;i<n;++i)o[i]=this[i+e]}return o},s.prototype.readUIntLE=function(e,t,o){e|=0,t|=0,o||D(e,t,this.length);for(var r=this[e],n=1,i=0;++i<t&&(n*=256);)r+=this[e+i]*n;return r},s.prototype.readUIntBE=function(e,t,o){e|=0,t|=0,o||D(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},s.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,o){e|=0,t|=0,o||D(e,t,this.length);for(var r=this[e],n=1,i=0;++i<t&&(n*=256);)r+=this[e+i]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,o){e|=0,t|=0,o||D(e,t,this.length);for(var r=t,n=1,i=this[e+--r];r>0&&(n*=256);)i+=this[e+--r]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var o=this[e]|this[e+1]<<8;return 32768&o?4294901760|o:o},s.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var o=this[e+1]|this[e]<<8;return 32768&o?4294901760|o:o},s.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,o,r){e=+e,t|=0,o|=0,r||N(this,e,t,o,Math.pow(2,8*o)-1,0);var n=1,i=0;for(this[t]=255&e;++i<o&&(n*=256);)this[t+i]=e/n&255;return t+o},s.prototype.writeUIntBE=function(e,t,o,r){e=+e,t|=0,o|=0,r||N(this,e,t,o,Math.pow(2,8*o)-1,0);var n=o-1,i=1;for(this[t+n]=255&e;--n>=0&&(i*=256);)this[t+n]=e/i&255;return t+o},s.prototype.writeUInt8=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,o,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*o-1);N(this,e,t,o,n-1,-n)}var i=0,a=1,l=0;for(this[t]=255&e;++i<o&&(a*=256);)e<0&&0===l&&0!==this[t+i-1]&&(l=1),this[t+i]=(e/a>>0)-l&255;return t+o},s.prototype.writeIntBE=function(e,t,o,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*o-1);N(this,e,t,o,n-1,-n)}var i=o-1,a=1,l=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===l&&0!==this[t+i+1]&&(l=1),this[t+i]=(e/a>>0)-l&255;return t+o},s.prototype.writeInt8=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):k(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):k(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,o){return e=+e,t|=0,o||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,o){return A(this,e,t,!0,o)},s.prototype.writeFloatBE=function(e,t,o){return A(this,e,t,!1,o)},s.prototype.writeDoubleLE=function(e,t,o){return V(this,e,t,!0,o)},s.prototype.writeDoubleBE=function(e,t,o){return V(this,e,t,!1,o)},s.prototype.copy=function(e,t,o,r){if(o||(o=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<o&&(r=o),r===o)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(o<0||o>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-o&&(r=e.length-t+o);var n,i=r-o;if(this===e&&o<t&&t<r)for(n=i-1;n>=0;--n)e[n+t]=this[n+o];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(n=0;n<i;++n)e[n+t]=this[n+o];else Uint8Array.prototype.set.call(e,this.subarray(o,o+i),t);return i},s.prototype.fill=function(e,t,o,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,o=this.length):"string"==typeof o&&(r=o,o=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<o)throw new RangeError("Out of range index");if(o<=t)return this;var i;if(t>>>=0,o=void 0===o?this.length:o>>>0,e||(e=0),"number"==typeof e)for(i=t;i<o;++i)this[i]=e;else{var a=s.isBuffer(e)?e:B(new s(e,r).toString()),l=a.length;for(i=0;i<o-t;++i)this[i+t]=a[i%l]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function B(e,t){var o;t=t||1/0;for(var r=e.length,n=null,i=[],a=0;a<r;++a){if((o=e.charCodeAt(a))>55295&&o<57344){if(!n){if(o>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}n=o;continue}if(o<56320){(t-=3)>-1&&i.push(239,191,189),n=o;continue}o=65536+(n-55296<<10|o-56320)}else n&&(t-=3)>-1&&i.push(239,191,189);if(n=null,o<128){if((t-=1)<0)break;i.push(o)}else if(o<2048){if((t-=2)<0)break;i.push(o>>6|192,63&o|128)}else if(o<65536){if((t-=3)<0)break;i.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return i}function M(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,o,r){for(var n=0;n<r&&!(n+o>=t.length||n>=e.length);++n)t[n+o]=e[n];return n}}).call(this,o(6))},function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t,o){"use strict";t.byteLength=function(e){var t=c(e),o=t[0],r=t[1];return 3*(o+r)/4-r},t.toByteArray=function(e){var t,o,r=c(e),a=r[0],l=r[1],s=new i(function(e,t,o){return 3*(t+o)/4-o}(0,a,l)),d=0,u=l>0?a-4:a;for(o=0;o<u;o+=4)t=n[e.charCodeAt(o)]<<18|n[e.charCodeAt(o+1)]<<12|n[e.charCodeAt(o+2)]<<6|n[e.charCodeAt(o+3)],s[d++]=t>>16&255,s[d++]=t>>8&255,s[d++]=255&t;return 2===l&&(t=n[e.charCodeAt(o)]<<2|n[e.charCodeAt(o+1)]>>4,s[d++]=255&t),1===l&&(t=n[e.charCodeAt(o)]<<10|n[e.charCodeAt(o+1)]<<4|n[e.charCodeAt(o+2)]>>2,s[d++]=t>>8&255,s[d++]=255&t),s},t.fromByteArray=function(e){for(var t,o=e.length,n=o%3,i=[],a=0,l=o-n;a<l;a+=16383)i.push(d(e,a,a+16383>l?l:a+16383));return 1===n?(t=e[o-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[o-2]<<8)+e[o-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,s=a.length;l<s;++l)r[l]=a[l],n[a.charCodeAt(l)]=l;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=e.indexOf("=");return-1===o&&(o=t),[o,o===t?0:4-o%4]}function d(e,t,o){for(var n,i,a=[],l=t;l<o;l+=3)n=(e[l]<<16&16711680)+(e[l+1]<<8&65280)+(255&e[l+2]),a.push(r[(i=n)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,o,r,n){var i,a,l=8*n-r-1,s=(1<<l)-1,c=s>>1,d=-7,u=o?n-1:0,p=o?-1:1,h=e[t+u];for(u+=p,i=h&(1<<-d)-1,h>>=-d,d+=l;d>0;i=256*i+e[t+u],u+=p,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=256*a+e[t+u],u+=p,d-=8);if(0===i)i=1-c;else{if(i===s)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=c}return(h?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,o,r,n,i){var a,l,s,c=8*i-n-1,d=(1<<c)-1,u=d>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+u>=1?p/s:p*Math.pow(2,1-u))*s>=2&&(a++,s/=2),a+u>=d?(l=0,a=d):a+u>=1?(l=(t*s-1)*Math.pow(2,n),a+=u):(l=t*Math.pow(2,u-1)*Math.pow(2,n),a=0));n>=8;e[o+h]=255&l,h+=f,l/=256,n-=8);for(a=a<<n|l,c+=n;c>0;e[o+h]=255&a,h+=f,a/=256,c-=8);e[o+h-f]|=128*m}},function(e,t){var o={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==o.call(e)}},function(e,t,o){"use strict";o.r(t),o.d(t,"NetworkUtils",(function(){return r})),o.d(t,"Cookie",(function(){return n}));var r=function(){function e(){}return e.needSaveLog=function(){return e.liteReconnects<5},e.roomLogDebug=function(t){e.needSaveLog()&&(window.log?window.log&&window.log.debug(e.collabRoomLogTag+t):console.debug(e.collabRoomLogTag+t))},e.roomLogInfo=function(t){e.needSaveLog()&&(window.log?window.log&&window.log.info(e.collabRoomLogTag+t):console.log(e.collabRoomLogTag+t))},e.roomLogWarn=function(t){e.needSaveLog()&&(window.log?window.log&&window.log.warn(e.collabRoomLogTag+t):console.warn(e.collabRoomLogTag+t))},e.roomLogError=function(t){e.needSaveLog()&&(window.log?window.log&&window.log.error(e.collabRoomLogTag+t):console.error(e.collabRoomLogTag+t))},e.collabRoomLogTag=" collab Room ",e.liteReconnects=0,e}(),n=function(){function e(){}return e.get=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""},e}()},function(e,t,o){"use strict";var r,n;o.r(t),o.d(t,"emRoomErrCode",(function(){return r})),o.d(t,"TDWebsocketErrorCode",(function(){return n})),function(e){e[e.suc=0]="suc",e[e.timeout=101]="timeout",e[e.parameterErr=102]="parameterErr",e[e.exist=103]="exist",e[e.roomDisconnect=104]="roomDisconnect",e[e.roomClose=105]="roomClose",e[e.roomStateErr=106]="roomStateErr"}(r||(r={})),function(e){e[e.Socket_Data_ServerUnkownErr=1e4]="Socket_Data_ServerUnkownErr",e[e.Socket_Data_ProtocolFieldLack=10001]="Socket_Data_ProtocolFieldLack",e[e.Socket_Data_Server_Error=4e4]="Socket_Data_Server_Error",e[e.Socket_Data_Doc_NoExist=40001]="Socket_Data_Doc_NoExist",e[e.Socket_Data_Subid_Error=40002]="Socket_Data_Subid_Error",e[e.Socket_Data_Action_Length=40003]="Socket_Data_Action_Length",e[e.Socket_Data_Changeset_Easysync=40005]="Socket_Data_Changeset_Easysync",e[e.Socket_Data_Save_Fail=40006]="Socket_Data_Save_Fail",e[e.Socket_Data_Read_Fail=40020]="Socket_Data_Read_Fail",e[e.Socket_Data_Baserev_Error=40021]="Socket_Data_Baserev_Error",e[e.Socket_Data_NoSupportType=40022]="Socket_Data_NoSupportType",e[e.Socket_Data_NoSupportProto=40023]="Socket_Data_NoSupportProto",e[e.Socket_Data_ContentLimit=40026]="Socket_Data_ContentLimit",e[e.Socket_Data_RevDiffUpperTen=40027]="Socket_Data_RevDiffUpperTen",e[e.Socket_Data_EasysyncTimeout=40028]="Socket_Data_EasysyncTimeout",e[e.Socket_ClientVersion_TooOld=40029]="Socket_ClientVersion_TooOld",e[e.Socket_JS_TooOld=40030]="Socket_JS_TooOld",e[e.Socket_Data_DocId_Error=41001]="Socket_Data_DocId_Error",e[e.Socket_Data_ProtocolType_Error=41002]="Socket_Data_ProtocolType_Error",e[e.Socket_Server_Error=6e4]="Socket_Server_Error",e[e.Socket_Layer_Error=60001]="Socket_Layer_Error",e[e.Socket_ClientNotReady_Error=60002]="Socket_ClientNotReady_Error",e[e.Socket_ClientData_Error=60003]="Socket_ClientData_Error",e[e.Socket_CollabRoom_Timeout=60004]="Socket_CollabRoom_Timeout",e[e.Socket_CollabServer_Timeout=60005]="Socket_CollabServer_Timeout",e[e.Socket_UserAuth_Failed=60006]="Socket_UserAuth_Failed",e[e.Socket_DocPrivilege_Failed=60007]="Socket_DocPrivilege_Failed",e[e.Socket_PackageSize_TooLarge=60008]="Socket_PackageSize_TooLarge",e[e.Socket_CollabRoom_AlreadyExist=60009]="Socket_CollabRoom_AlreadyExist",e[e.Socket_CollabRoom_MemberFull=60010]="Socket_CollabRoom_MemberFull",e[e.Socket_ServerStorage_Timeout=60011]="Socket_ServerStorage_Timeout",e[e.Socket_ServerCGI_Timeout=60013]="Socket_ServerCGI_Timeout",e[e.Socket_Frequency_Limit=60014]="Socket_Frequency_Limit",e[e.Socket_UserDoc_NoPrivilege=60015]="Socket_UserDoc_NoPrivilege",e[e.Socket_UserChange_ParamError=60016]="Socket_UserChange_ParamError",e[e.Socket_Command_Unsupport=60017]="Socket_Command_Unsupport",e[e.Socket_Hackpad_Timeout=60018]="Socket_Hackpad_Timeout",e[e.Socket_ServerWaitting_TooMuch=60019]="Socket_ServerWaitting_TooMuch",e[e.Socket_ServerWaitting_Timeout=60020]="Socket_ServerWaitting_Timeout",e[e.Socket_Auth_Timeout=60021]="Socket_Auth_Timeout",e[e.Socket_GetPrivilege_Timeout=60022]="Socket_GetPrivilege_Timeout",e[e.Socket_Unknown_Error=-1]="Socket_Unknown_Error",e[e.Socket_CollabRoom_Get_VIP_Fail=7e4]="Socket_CollabRoom_Get_VIP_Fail",e[e.Socket_CollabRoom_Not_VIP_Full=70001]="Socket_CollabRoom_Not_VIP_Full",e[e.Socket_CollabRoom_DocDeleted=70002]="Socket_CollabRoom_DocDeleted"}(n||(n={}))},function(e,t){}])},e.exports=r()},,,,,,function(e,t,o){"use strict";var r;o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return i})),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(r||(r={}));var n={accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{},bad:-1,client:{sid:"",upid:"",sig:"",tid:-1},dirty:-1,dver:"2.0.0",globalPadId:"",gray:-1,header:[],initialAttributedText:{text:"",attribs:""},padId:"",padSubId:"",padType:"",pollingAttemptNumber:-1,pos:-1,pver:-1,rev:-1,ver:-1,websocket:!1,websocketReopenCount:-1,wmode:""},colorPalette:[],creatorDomain:"",creatorId:"",disableFB:!1,docStatus:-1,domainId:"",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:"",initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:!1,isIPhone:!1,isLogin:!1,isMac:!1,isMobile:!1,isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOverUpdateConNum:!1,isOwner:!1,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:"",newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:"",pub:-1,padStatus:r.NORMAL,padTitle:"",padType:"",pagingFlag:"",policy:-1,privilegeAttribute:{can_edit:0,can_read:1},privilegeExpire:-1,proTitle:"",rightFlag:-1,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:"",useFbChat:!1,userColor:-1,userDomain:"",userId:"",userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:"",metaCreateTime:15489504e5,lastModifyTime:15489504e5,lastModifyUser:""};function i(){return window.clientVars?window.clientVars:n}},,function(e,t,o){"use strict";var r,n,i;o.r(t),o.d(t,"DEBUG",(function(){return Q})),o.d(t,"switchDebug",(function(){return K})),o.d(t,"BaseDatabase",(function(){return g})),o.d(t,"IndexedDatabase",(function(){return W})),o.d(t,"ClientDatabase",(function(){return B})),o.d(t,"QueryCondition",(function(){return a})),o.d(t,"QUERY_CONDITION_TYPE",(function(){return n})),o.d(t,"IorderType",(function(){return i})),o.d(t,"Result",(function(){return p})),o.d(t,"DBError",(function(){return U})),o.d(t,"DBErrorType",(function(){return D})),o.d(t,"BaseError",(function(){return d})),o.d(t,"ArgumentError",(function(){return $})),o.d(t,"ArgumentErrorType",(function(){return J})),o.d(t,"HttpError",(function(){return ee})),o.d(t,"isNoResultError",(function(){return x})),o.d(t,"isALowerB",(function(){return P})),o.d(t,"JSApi",(function(){return C})),o.d(t,"DataErrorType",(function(){return s})),o.d(t,"DBDriver",(function(){return r})),function(e){e[e.ClientDB=0]="ClientDB",e[e.IndexDB=1]="IndexDB"}(r||(r={})),function(e){e[e.IN=0]="IN",e[e.LOWER_BOUND=1]="LOWER_BOUND",e[e.UPPER_BOUND=2]="UPPER_BOUND",e[e.BOUND=3]="BOUND",e[e.ONLY=4]="ONLY",e[e.NOT_IN=5]="NOT_IN"}(n||(n={})),function(e){e[e.INCREASE=0]="INCREASE",e[e.DECREASE=1]="DECREASE",e[e.INCREASE_BY_TEXT=2]="INCREASE_BY_TEXT",e[e.DECREASE_BY_TEXT=3]="DECREASE_BY_TEXT"}(i||(i={}));var a=function(){function e(){this._conditions=new Array,this._limitCount=Number.MAX_VALUE,this._offsetCount=0,this._orders=[]}return e.newInstance=function(){return new e},e.prototype.addCondition=function(e,t,o){var r=o;if(t===n.LOWER_BOUND)(i=o).open=void 0===i.open||i.open,r=i;else if(t===n.UPPER_BOUND){(i=o).open=void 0===i.open||i.open,r=i}else if(t===n.BOUND){var i;(i=o).lowerOpen=void 0===i.lowerOpen||i.lowerOpen,i.upperOpen=void 0===i.upperOpen||i.upperOpen,r=i}return this._conditions.push({type:t,column:e,value:r}),this},e.prototype.index=function(e){this._index=e},e.prototype.getIndexKey=function(){return this._index},e.prototype.limit=function(e,t){if(void 0===t?this._limitCount=e:(this._limitCount=t,this._offsetCount=e),this._limitCount<=0)throw new Error("limit size must be opposite value.");return this},e.prototype.offset=function(e){if(e<0)throw new Error("offset size must be opposite value or zero.");return this._offsetCount=e,this},e.prototype.orderby=function(e,t){return this._orders.push({key:e,type:t}),this},e.prototype.hasOrder=function(){return this._orders.length>0},e.prototype.getOrders=function(){return this._orders},e.prototype.hasIndex=function(){return void 0!==this._index},e.prototype.limitSize=function(){return this._limitCount},e.prototype.offsetCount=function(){return this._offsetCount},Object.defineProperty(e.prototype,"conditions",{get:function(){return this._conditions},enumerable:!0,configurable:!0}),e}();window.QueryCondition=a,window.QUERY_CONDITION_TYPE=n;var l,s,c=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),d=function(e){function t(t){var o=e.call(this,t)||this;return o.errorType="BaseError",o}return c(t,e),t.copyFrom=function(e){var o=new t(e.message);return o.name=e.name,o.stack=e.stack,o},t}(Error),u=d,p=function(e,t){void 0!==e&&(void 0===e.errorType?this.error=u.copyFrom(e):this.error=e),void 0!==t&&(this.data=t)},h=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();!function(e){e.NO_RESULT_ERROR="noResultError"}(s||(s={}));var f=function(e){function t(t,o){var r=e.call(this,o)||this;return r.name="DataError",r.errorType=t,r}return h(t,e),t}(u),m=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},y=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},g=function(){function e(e){this._canAutoResume=!0,this._dbName=e.databaseName,this._dbVersion=e.version,this._tables=e.tables}return e.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},e.prototype.disConnect=function(e){return void 0===e&&(e=!0),m(this,void 0,void 0,(function(){return y(this,(function(e){return[2,Promise.resolve(new p(void 0,!0))]}))}))},e}(),v=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},_=window,b=function(){function e(){}return e.debug=function(){for(var t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];try{_.log?(t=_.log).debug.apply(t,o):console.debug.apply(console,o)}catch(t){e.error("日志发生错误","debug",o)}},e.log=function(){for(var t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];try{_.log?(t=_.log).info.apply(t,o):console.log.apply(console,o)}catch(t){e.error("日志发生错误","log",o)}},e.warn=function(){for(var t,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];try{_.log?(t=_.log).warn.apply(t,o):console.warn.apply(console,o)}catch(t){e.error("日志发生错误","warn",o)}},e.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{_.log?(e=_.log).error.apply(e,t):console.error.apply(console,t)}catch(e){console.error("日志发生错误","error",t)}},e.time=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r={time:Date.now(),options:t};this.sTimeLableMap.set(e,r)},e.timeEnd=function(t){var o=Date.now(),r=e.sTimeLableMap.get(t);if(void 0!==r){var n=o-r.time,i="";r.options&&3===r.options.length&&"clientDatabaseRequest"===r.options[1]&&(i=r.options[2]),e.log.apply(e,v(["label: "+t+": "+n+"ms."],r.options)),e.speedReport(n,i),this.sTimeLableMap.delete(t)}},e.speedReport=function(e,t){t&&_.dbjsApiSpeedReport&&_.dbjsApiSpeedReport(e,t)},e.sTimeLableMap=new Map,e}(),T=b,S=function(){function e(){this.canUseNativeAndroid=window.mqq&&window.mqq.android&&window._mqqWebViewJSInterface&&window._mqqWebViewJSInterface.invoke,this.currentSeqId=0,this.reqCallbacks=new Map}return e.prototype.JSApiCallback=function(e){var t=this.reqCallbacks.get(e.callbackId),o=t.callback,r=t.command,n=t.startTime;o&&(T.debug("callback invokeNative-"+e.callbackId+"-"+r+"-"+(Date.now()-n)+"ms",this.canUseNativeAndroid,"response="+JSON.stringify(e)),o(e))},e.prototype.createReqSeq=function(){return this.currentSeqId++},e.prototype.invokeNative=function(e,t,o,r){var n=this.createReqSeq(),i=o.command;this.reqCallbacks.set(n,{callback:r,command:i,startTime:Date.now()}),T.debug("start call invokeNative-"+n+"-"+i,e,t,i,this.canUseNativeAndroid,"request="+JSON.stringify(o)),o.callbackId=n,this.canUseNativeAndroid?this.invokeNativeAndroid(e,t,o):window.mqq&&window.mqq.invoke(e,t,o)},e.prototype.invokeNativeAndroid=function(e,t,o){var r="jsbridge://"+encodeURIComponent(e)+"/"+encodeURIComponent(t);r+="?p="+encodeURIComponent(JSON.stringify(o)),window._mqqWebViewJSInterface.invoke(r)},e.prototype.defaultOfflineCodeVersion=function(e,t){T.debug("defaultOfflineCodeVersion-"+e),window.mqq&&window.mqq.invoke("docx","defaultOfflineCodeVersion",{type:e},(function(o){T.debug("defaultOfflineCodeVersion-"+e),t&&t(o)}))},e}(),C=window.jsApi;window.jsApi||(C=new S,window.jsApi=C,window.JSApiCallback||(window.JSApiCallback=C.JSApiCallback.bind(C)));var w,E,I;window;function x(e){return e.errorType===s.NO_RESULT_ERROR}function R(e,t){return Array.isArray(e)?e.map((function(e){return new t.prototype.constructor(e)})):new t.prototype.constructor(e)}function O(e,t){return function(o,r,n){var i=n.value;n.value=function(){var o=i.apply(this,arguments);return arguments[0]===t?o.then((function(t){return t.error||(t.data=R(t.data,e)),t})):o}}}function P(e,t,o){return void 0===o&&(o=!0),o?e<t:e<=t}!function(e){e[e.EXCEL=1]="EXCEL",e[e.WORD=0]="WORD"}(w||(w={})),function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(E||(E={})),function(e){e.INIT="init",e.DOCUMENT="document",e.WORKBOOK="workbook",e.CHUNK="chunk",e.ACCEPTED="accepted",e.MISS_CHANGE="misschange",e.NEW_CHANGE="newchange",e.COMMITING="commiting",e.WATTING="watting",e.QUEUE="queue"}(I||(I={}));var D,N=function(){function e(t){this.chunkId=0,this.default=!1,t.taskId||(t.taskId=e.createMessageSeq()),t.key||(t.chunkId=t.chunkId||0,t.type===I.INIT?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid:t.type===I.DOCUMENT?t.key=t.globalPadId+"_"+t.uid+"_version_"+t.version:t.type===I.WORKBOOK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_version_"+t.version:t.type===I.CHUNK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.chunkId+"_"+t.uid+"_version_"+t.version:t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_taskId_"+t.taskId),t.default=t.default||!1,this.key=t.key,this.uid=t.uid,this.globalPadId=t.globalPadId,this.secretId=t.secretId,this.subSheetId=t.subSheetId,this.chunkId=t.chunkId,this.type=t.type,this.docType=t.docType,this.padStatus=t.padStatus,this.taskId=t.taskId,this.version=t.version,this.data=t.data||t._data,this.default=t.default,this.createTime=t.createTime,this.dver=t.dver}return e.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},e.prototype.disableConvert=function(){return this.docType===w.WORD&&"BB08J2"!==this.subSheetId},Object.defineProperty(e.prototype,"data",{get:function(){if("string"==typeof this._data&&!this.disableConvert()){var e=this._data;try{e=JSON.parse(this._data)}catch(e){b.error(e)}return e}return this._data},set:function(e){this._data="string"!=typeof e?JSON.stringify(e):e},enumerable:!0,configurable:!0}),e}(),k=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),L=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},F=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},A=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},V=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},j="client_data_base_performance",B=function(e){function t(t){return e.call(this,t)||this}return k(t,e),t.isValidResponse=function(e){return"object"==typeof e},t.prototype.init=function(){var e=this;return new Promise((function(t,o){var r=Date.now(),n={command:"init",table:e._tables,dbName:e._dbName};C.invokeNative("docx","clientDatabaseRequest",n,(function(o){if(o.err_msg||o.err_code){var i=new Error(o.err_msg||o.err_code);t(new p(i))}else t(new p(void 0,void 0));e.reportBeacon(j,r,n,o)}))}))},t.prototype.set=function(e,t){var o=this;return new Promise((function(r,n){var i=Date.now(),a={command:"set",tableName:e,data:t,dbName:o._dbName};C.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));o.reportBeacon(j,i,a,e)}))}))},t.prototype.update=function(e,t){var o=this;return new Promise((function(r,n){var i=Date.now(),a={command:"update",tableName:e,data:t,dbName:o._dbName};C.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));o.reportBeacon(j,i,a,e)}))}))},t.prototype.updateField=function(e,t,o){var r=this;return new Promise((function(n,i){var a=Date.now(),l={command:"updateField",tableName:e,where:t,toBeUpdated:o,dbName:r._dbName};C.invokeNative("docx","clientDatabaseRequest",l,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new p(t))}else n(new p(void 0,e.result));r.reportBeacon(j,a,l,e)}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return new Promise((function(o,r){var n=Date.now(),i={command:"updateMultiTableData",multiData:e,dbName:t._dbName};C.invokeNative("docx","clientDatabaseRequest",i,(function(e){if(e.err_msg||e.err_code){var r=new Error(e.err_msg||e.err_code);o(new p(r))}else o(new p(void 0,e.result));t.reportBeacon(j,n,i,e)}))}))},t.prototype.delete=function(e,t){var o=this;return new Promise((function(r,n){var i=Date.now(),a={command:"delete",tableName:e,where:t,dbName:o._dbName};C.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result));o.reportBeacon(j,i,a,e)}))}))},t.prototype.deleteAndWrite=function(e,t,o){var r=this;return new Promise((function(n,i){var a=Date.now(),l={command:"deleteAndWrite",tableName:e,where:t,newData:o,dbName:r._dbName};C.invokeNative("docx","clientDatabaseRequest",l,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);n(new p(t))}else n(new p(void 0,e.result));r.reportBeacon(j,a,l,e)}))}))},t.prototype.get=function(e,t){return A(this,void 0,void 0,(function(){var o=this;return V(this,(function(r){return[2,new Promise((function(r,n){var i=Date.now(),a={command:"get",tableName:e,where:t,dbName:o._dbName};C.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else e.result?r(new p(void 0,e.result)):r(new p(new f(s.NO_RESULT_ERROR,"没有找到符合条件的内容")));o.reportBeacon(j,i,a,e)}))}))]}))}))},t.prototype.getAll=function(e,t){var o=this;return new Promise((function(r,n){var i=Date.now(),a={command:"getAll",tableName:e,where:t,dbName:o._dbName};C.invokeNative("docx","clientDatabaseRequest",a,(function(e){if(e.err_msg||e.err_code){var t=new Error(e.err_msg||e.err_code);r(new p(t))}else r(new p(void 0,e.result||[]));o.reportBeacon(j,i,a,e)}))}))},t.prototype.reportBeacon=function(e,t,o,r){try{window.beaconHandler&&window.beaconHandler.onUserAction(e,{tableName:o.tableName||"",command:o.command||"",dbName:o.dbName||"",error_msg:r.err_msg||"",consume_time:Date.now()-t,event_result:r.err_code||0,cost:Date.now()-t,resultCode:r.err_code||0})}catch(e){b.error(e)}},L([O(N,"OfflineData"),O(N,"DocumentData"),F("design:type",Function),F("design:paramtypes",[String,a]),F("design:returntype",Promise)],t.prototype,"get",null),L([O(N,"OfflineData"),O(N,"DocumentData"),F("design:type",Function),F("design:paramtypes",[String,a]),F("design:returntype",void 0)],t.prototype,"getAll",null),t}(g),M=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();!function(e){e.NOT_SUPPORT_INDEXEDDB="notSupportIndexedDB",e.OPEN_FAIL="openFail",e.TRANSACTION_FAIL="transactionFail",e.DB_BLOCKED="DBBlocked",e.CHECK_FAIL="checkFail",e.REQUEST_ERROR="requestError"}(D||(D={}));var U=function(e){function t(t,o){var r=e.call(this,o)||this;return r.name="DBError",r.errorType=t,r}return M(t,e),t}(u),H=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),Y=function(e,t,o,r){var n,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,r);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(a=(i<3?n(a):i>3?n(t,o,a):n(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a},z=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},q=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},G=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},W=function(e){function t(t){var o=e.call(this,t)||this;return o.openErrorCount=0,o}return H(t,e),t.prototype.init=function(e){return q(this,void 0,void 0,(function(){var t=this;return G(this,(function(o){return[2,new Promise((function(o,r){return q(t,void 0,void 0,(function(){var t,r,n,i;return G(this,(function(a){switch(a.label){case 0:return T.time("IndexedDatabaseInit"),(t=this)._indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,t._indexedDB?e?[4,this.deleteDB()]:[3,2]:(T.error("IndexedDatabase","NOT_SUPPORT_INDEXEDDB"),t.database=null,r=new U(D.NOT_SUPPORT_INDEXEDDB),o(new p(r)),[2]);case 1:(n=a.sent()).error&&T.error(n.error),a.label=2;case 2:try{i=t._indexedDB.open(t._dbName,t._dbVersion)}catch(e){return T.error("IndexedDatabase","open() error",e),t.database=null,r=new U(D.OPEN_FAIL,e.name||e.message||""),o(new p(r)),[2]}return i.onerror=function(e){return q(this,void 0,void 0,(function(){var n,a,l,s;return G(this,(function(c){switch(c.label){case 0:return t.openErrorCount++,i.error&&"InvalidStateError"===i.error.name&&e.preventDefault(),T.error("IndexedDatabase","init() onerror()",e),t.database=null,t.openErrorCount<2&&e&&e.target&&e.target.error&&"VersionError"===e.target.error.name?(n=t._dbVersion+1,a=e.target.error.message,(l=/\((\d+)\).*\((\d+)\)/.exec(a))&&(n=Number(l[2])),t._dbVersion=n,[4,t.init()]):[3,2];case 1:return s=c.sent(),o(s),[2];case 2:return r=new U(D.REQUEST_ERROR,e),o(new p(r)),[2]}}))}))},i.onsuccess=function(e){T.timeEnd("IndexedDatabaseInit"),t.database=i.result,t.database.onversionchange=function(){window.dispatchEvent(new Event("OnTencentDocsDBVersionChanged"))},o(new p(void 0,i.result))},i.onblocked=function(e){T.error("IndexedDatabase","init() onblocked()",e),t.database=null,r=new U(D.DB_BLOCKED),o(new p(r,e))},i.onupgradeneeded=function(e){T.warn("IndexedDatabase","init() onupgradeneeded()",e);var o=e.target.result;o.objectStoreNames&&t._tables.forEach((function(e){var t;o.objectStoreNames.contains(e.tableName)||(t=e.keyName?o.createObjectStore(e.tableName,{keyPath:e.keyName}):o.createObjectStore(e.tableName,{autoIncrement:!0}),e.indexs&&e.indexs.forEach((function(e){t.createIndex(e,e,{unique:!1})})))}))},[2]}}))}))}))]}))}))},t.prototype.deleteDB=function(){return q(this,void 0,void 0,(function(){var e=this;return G(this,(function(t){return[2,new Promise((function(t){var o,r=e._indexedDB.deleteDatabase(e._dbName);r.onsuccess=function(){t(new p(o,!0))},r.onerror=function(e){o=new U(D.REQUEST_ERROR,e),t(new p(o))}}))]}))}))},t.prototype.bindCommonEvent=function(e,t,o,r){t.onabort=function(){T.error("IndexedDatabase","bindCommonEvent() onabort","TransactionAbortError");var e=new Error("TransactionAbortError");window.dispatchEvent(new Event("OnDBTransactionAbort")),o(new p(e))},t.onerror=function(){T.error("IndexedDatabase","bindCommonEvent() onerror","UnKnownTransactionError");var e=new Error("UnKnownTransactionError");window.dispatchEvent(new Event("OnDBTransactionError")),o(new p(e))}},t.prototype.getDBConnection=function(e,t,o,r,i){var a,l,s;try{if(s=(l=this.database.transaction([e],o)).objectStore(e),t&&t.hasIndex()){var c=t.getIndexKey(),d=s.index(c),u=void 0,h=-1;if(t)for(var f=0;f<t.conditions.length;f++){var m=t.conditions[f];if(m.column===c){switch(m.type){case n.ONLY:u=IDBKeyRange.only(m.value),h=f;break;case n.LOWER_BOUND:var y=m.value;u=IDBKeyRange.lowerBound(y.lower,y.open),h=f;break;case n.UPPER_BOUND:var g=m.value;u=IDBKeyRange.upperBound(g.upper,g.open),h=f;break;case n.BOUND:var v=m.value;u=IDBKeyRange.bound(v.lower,v.upper,v.lowerOpen,v.upperOpen),h=f}if(-1!==h){t.conditions.splice(h,1);break}}}a=d.openCursor(u)}else a=s.openCursor();this.bindCommonEvent(a,l,r,1e4)}catch(e){return T.error("IndexedDatabase","getDBConnection() error",e),new p(e)}return T.debug("IndexedDatabase","getDBConnection() done."),new p(void 0,{request:a,transaction:l,objectStore:s})},t.prototype.set=function(e,t){return T.time("IndexedDatabaseSet",e,t),this.setOrUpdate("Set",e,t)},t.prototype.update=function(e,t){return T.time("IndexedDatabaseUpdate",e,t),this.setOrUpdate("Update",e,t)},t.prototype.setOrUpdate=function(e,t,o){return q(this,void 0,void 0,(function(){var r=this;return G(this,(function(n){return[2,new Promise((function(n,i){return q(r,void 0,void 0,(function(){var r,a,l,s,c;return G(this,(function(d){switch(d.label){case 0:return[4,this.checkAndOpenTable(t)];case 1:if(d.sent().error)return r=new U(D.CHECK_FAIL),n(new p(r)),[2];if((a=this.getDBConnection(t,void 0,"readwrite",n,i)).error)return n(new p(a.error)),[2];if(l=a.data.objectStore,s=a.data.transaction,"set"===e)c=l.add(o);else try{c=l.put(o,o.__primaryKey)}catch(e){c=l.put(o)}return c.onerror=function(e){r=new U(D.REQUEST_ERROR,e)},s.oncomplete=function(){T.timeEnd("IndexedDatabase"+e),n(new p(r,!0))},[2]}}))}))}))]}))}))},t.prototype.updateField=function(e,t,o){var r=this;return T.time("IndexedDatabaseUpdateField",e,t,o),new Promise((function(n,i){return q(r,void 0,void 0,(function(){var r,a,l,s,c,d;return G(this,(function(u){switch(u.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return u.sent().error?(a=new U(D.CHECK_FAIL),n(new p(a)),[2]):(l=this.getDBConnection(e,t,"readwrite",n,i)).error?(n(new p(l.error)),[2]):(s=l.data.request,c=l.data.transaction,s.onerror=function(e){a=new U(D.REQUEST_ERROR,e)},d=new Array,s.onsuccess=function(e){var n=e.target.result;if(n){var i=n.value;if(r.checkCondition(i,t)){var l=Object.assign(i,o);n.update(l).onerror=function(e){a=new U(D.REQUEST_ERROR,e)},d.push(l)}n.continue()}},c.oncomplete=function(){T.timeEnd("IndexedDatabaseUpdateField"),n(new p(a,d))},[2])}}))}))}))},t.prototype.updateMultiTableData=function(e){var t=this;return T.time("IndexedDatabaseUpdateMultiTableData",e),new Promise((function(o,r){return q(t,void 0,void 0,(function(){var t,r,n,i,a,l,s,c,d,u=this;return G(this,(function(h){switch(h.label){case 0:r=0,n=e,h.label=1;case 1:return r<n.length?(i=n[r],[4,this.checkAndOpenTable(i.tableName)]):[3,4];case 2:if(h.sent().error)return t=new U(D.CHECK_FAIL),o(new p(t)),[2];h.label=3;case 3:return r++,[3,1];case 4:a=e.map((function(e){return e.tableName}));try{l=this.database.transaction(a,"readwrite"),s=e.length,c=0,d=0,e.forEach((function(e){var t,r=l.objectStore(e.tableName);try{t=r.put(e.data,e.data.__primaryKey)}catch(o){t=r.put(e.data)}t.onsuccess=function(e){c++},t.onerror=function(e){d++,T.error(e)},u.bindCommonEvent(t,l,o,1e4)})),l.oncomplete=function(){T.timeEnd("IndexedDatabaseUpdateMultiTableData"),d>0?(T.error("IndexedDatabaseUpdateMultiTableData","errorCount=",d),t=new U(D.REQUEST_ERROR),o(new p(t,{totalCount:s,successCount:c,errorCount:d}))):o(new p(void 0,{totalCount:s,successCount:c,errorCount:d}))}}catch(e){return T.error("IndexedDatabase","updateMultiTableData() onError",e),o(new p(e)),[2]}return[2]}}))}))}))},t.prototype.delete=function(e,t){var o=this;return T.time("IndexedDatabaseDelete",e,t),new Promise((function(r,n){return q(o,void 0,void 0,(function(){var o,i,a,l,s,c;return G(this,(function(d){switch(d.label){case 0:return o=this,[4,this.checkAndOpenTable(e)];case 1:return d.sent().error?(i=new U(D.CHECK_FAIL),r(new p(i)),[2]):(a=this.getDBConnection(e,t,"readwrite",r,n)).error?(r(new p(a.error)),[2]):(l=a.data.request,s=a.data.transaction,l.onerror=function(e){i=new U(D.REQUEST_ERROR,e)},c=new Array,l.onsuccess=function(e){var r=e.target.result;if(r){var n=r.value;o.checkCondition(n,t)&&(r.delete(),c.push(n)),r.continue()}},s.oncomplete=function(){T.timeEnd("IndexedDatabaseDelete"),r(new p(i,c))},[2])}}))}))}))},t.prototype.deleteAndWrite=function(e,t,o){var r=this;return T.time("IndexedDatabaseDeleteAndWrite",e,t),new Promise((function(n,i){return q(r,void 0,void 0,(function(){var r,a,l,s,c,d,u,h;return G(this,(function(f){switch(f.label){case 0:return r=this,[4,this.checkAndOpenTable(e)];case 1:return f.sent().error?(a=new U(D.CHECK_FAIL),n(new p(a)),[2]):(l=this.getDBConnection(e,t,"readwrite",n,i)).error?(n(new p(l.error)),[2]):(s=l.data.request,c=l.data.objectStore,d=l.data.transaction,s.onerror=function(e){a=new U(D.REQUEST_ERROR,e)},u=0,h=0,s.onsuccess=function(e){var n=e.target.result;if(n){var i=n.value;r.checkCondition(i,t)&&(n.delete(),u++),n.continue()}else o.forEach((function(e){c.put(e).onsuccess=function(e){h++}}))},d.oncomplete=function(){T.timeEnd("IndexedDatabaseDeleteAndWrite"),T.log("IndexedDatabaseDeleteAndWrite",u,h),n(new p(a,{deleteCount:u,writeCount:h}))},[2])}}))}))}))},t.prototype.get=function(e,t){return q(this,void 0,void 0,(function(){var o,r;return G(this,(function(n){switch(n.label){case 0:return t.limit(1),[4,this.getAll(e,t)];case 1:return(o=n.sent()).error?[2,new p(o.error)]:0===(r=o.data).length?[2,new p(new f(s.NO_RESULT_ERROR,"没有找到符合条件的内容"))]:[2,new p(void 0,r[0])]}}))}))},t.prototype.getAll=function(e,t){var o=this;return T.time("IndexedDatabaseGetAll",e,t),new Promise((function(r,n){return q(o,void 0,void 0,(function(){var o,i,a,l,s,c;return G(this,(function(d){switch(d.label){case 0:return o=this,[4,this.checkAndOpenTable(e)];case 1:return d.sent().error?(i=new U(D.CHECK_FAIL),r(new p(i)),[2]):(a=this.getDBConnection(e,t,"readonly",r,n)).error?(r(new p(a.error)),[2]):(l=a.data.request,s=a.data.transaction,l.onerror=function(e){i=new U(D.REQUEST_ERROR,e)},c=new Array,l.onsuccess=function(e){var r=e.target.result;if(r){var n=r.value;if(o.checkCondition(n,t)&&(n.__primaryKey=r.primaryKey,c.push(n)),!t.hasOrder()&&c.length>=t.limitSize()+t.offsetCount())return;r.continue()}},s.oncomplete=function(){c.length>0&&t.hasOrder()&&(c=o.sortResult(c,t.getOrders()));var e=t.offsetCount(),n=e+t.limitSize();c=c.slice(e,n),T.timeEnd("IndexedDatabaseGetAll"),r(new p(i,c))},[2])}}))}))}))},t.prototype.sortResult=function(e,t){return t.reverse().forEach((function(t,o){e.sort((function(e,o){var r=0;switch(t.type){case i.INCREASE:r=e[t.key]>o[t.key]?1:e[t.key]===o[t.key]?0:-1;break;case i.DECREASE:r=e[t.key]>o[t.key]?-1:e[t.key]===o[t.key]?0:1;break;case i.INCREASE_BY_TEXT:r=e[t.key].localeCompare(o[t.key]);break;case i.DECREASE_BY_TEXT:r=o[t.key].localeCompare(e[t.key])}return r}))})),e},t.prototype.checkCondition=function(e,t){for(var o=!0,r=0;r<t.conditions.length;r++){var i=t.conditions[r];switch(i.type){case n.ONLY:e[i.column]!==i.value&&(o=!1);break;case n.LOWER_BOUND:var a=i.value;P(e[i.column],a.lower,!a.open)&&(o=!1);break;case n.UPPER_BOUND:var l=i.value;P(l.upper,e[i.column],!l.open)&&(o=!1);break;case n.IN:-1===i.value.indexOf(e[i.column])&&(o=!1);break;case n.BOUND:var s=i.value;(P(e[i.column],s.lower,!s.lowerOpen)||P(s.upper,e[i.column],!s.upperOpen))&&(o=!1);break;case n.NOT_IN:-1!==i.value.indexOf(e[i.column])&&(o=!1)}if(!o)break}return o},t.prototype.checkAndOpenTable=function(e){return q(this,void 0,void 0,(function(){var t,o,r;return G(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),(t=this).database||!t._canAutoResume?[3,2]:[4,this.init()];case 1:if((o=n.sent()).error)return T.error("IndexedDatabase","checkAndOpenTable()",e,o.error),[2,new p(new U(D.CHECK_FAIL,"database is not available."))];n.label=2;case 2:return t.database?t.database.objectStoreNames.contains(e)?[2,new p(void 0,!0)]:(T.error("IndexedDatabase","checkAndOpenTable()",e,"table "+e+" is not available."),[2,new p(new U(D.CHECK_FAIL,"table "+e+" is not available."))]):(T.error("IndexedDatabase","checkAndOpenTable()",e,"database is not available."),[2,new p(new U(D.CHECK_FAIL,"database is not available."))]);case 3:return r=n.sent(),T.error("IndexedDatabase","checkAndOpenTable()",e,"UnknownError"),[2,new p(r,!1)];case 4:return[2]}}))}))},t.prototype.setAutoResume=function(e){void 0===e&&(e=!0),this._canAutoResume=e},t.prototype.disConnect=function(e){return void 0===e&&(e=!0),q(this,void 0,void 0,(function(){var t;return G(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),T.log("IndexedDatabase","disConnect()",e,this.database),this._canAutoResume=e,this.database?[4,this.database.close()]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.database=void 0,[2,Promise.resolve(new p(void 0,!0))];case 3:return t=o.sent(),T.error("IndexedDatabase","disConnect() Error.",t),[2,Promise.resolve(new p(void 0,!1))];case 4:return[2]}}))}))},t._uuid=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(),Y([O(N,"OfflineData"),O(N,"DocumentData"),z("design:type",Function),z("design:paramtypes",[String,a]),z("design:returntype",void 0)],t.prototype,"getAll",null),t}(g),Q="undefined"!=typeof localStorage&&"true"===localStorage.getItem("isOfflineModuleDebug")||!1;function K(e){"undefined"!=typeof localStorage&&(localStorage.setItem("isOfflineModuleDebug",String(e)),Q=e)}var J,X=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();!function(e){e.ILLEGAL_ARGUMENT="IllegalArgument"}(J||(J={}));var $=function(e){function t(t,o){var r=e.call(this,o)||this;return r.name="ArgumentError",r.errorType=t,r}return X(t,e),t}(u),Z=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),ee=function(e){function t(t,o,r){var n=e.call(this,r)||this;return n.name="HttpError",n.errorType="HttpError",n.statusCode=t,n.errorCode=o,n}return Z(t,e),t}(u),te=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},oe=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},re=function(){function e(e,t,o,n){void 0===o&&(o=r.IndexDB),void 0===n&&(n=1),o===r.ClientDB?this.database=new B({databaseName:e,version:n,tables:t}):this.database=new W({databaseName:e,version:n,tables:t})}return e.prototype.init=function(){return te(this,void 0,void 0,(function(){var e;return oe(this,(function(t){switch(t.label){case 0:return[4,this.database.init(!1)];case 1:return(e=t.sent()).error?[2,e]:[2,new p(void 0,!0)]}}))}))},e}();t.default=re},function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return p}));var r,n,i=o(3),a=o(20),l=o(49),s=o(12),c=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},d=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};!function(e){e[e.set=1]="set",e[e.update=2]="update",e[e.delete=3]="delete",e[e.get=4]="get",e[e.getAll=5]="getAll"}(r||(r={})),function(e){e[e.InitUnlaunch=0]="InitUnlaunch",e[e.Initing=1]="Initing",e[e.InitException=2]="InitException",e[e.InitFinish=3]="InitFinish",e[e.InitTimeout=4]="InitTimeout"}(n||(n={}));var u=function(){function e(){var e=this;this.mutexTabLockReason=void 0,this.DBstatus=n.InitUnlaunch,this.onReset=function(){e.deteckLockTimeoutID&&clearTimeout(e.deteckLockTimeoutID),e.mutexTabLock.release("offline_"+e.secretId),e.mutexTabLockReason=void 0},this.dataManager=new i.OfflineDataManager({businessType:i.FILE_TYPE.WORD,user:new i.UserInfo({uid:Object(i.getCookie)("uid"),uin:Object(i.getCookie)("uin")})}),Object(i.isSupportClientDB)()?this.mutexTabLock=new i.ClientMutexLock:this.mutexTabLock=new i.MultiTabLock,window.addEventListener("beforeunload",(function(){e.disConnectDBAndReleaseLock()})),document.addEventListener("BeforeReplaceUrlNotification",this.onReset),window.onbeforeclosetab=this.disConnectDBAndReleaseLock}return e.prototype.disConnectDBAndReleaseLock=function(){this.getDataBase().disConnect(),this.mutexTabLock.release("offline_"+this.secretId)},e.prototype.detectLockAndRefresh=function(){return c(this,void 0,void 0,(function(){var e;return d(this,(function(t){switch(t.label){case 0:return[4,this.mutexTabLock.detectKey("offline_"+this.secretId)];case 1:return(e=t.sent())&&e.error?(a.a.info("Melo deteckLockAndRefresh error:"+e.error+"."),[2]):e&&!e.data&&window.location&&window.location.reload?(a.a.info("Melo deteckLockAndRefresh reload."),setTimeout((function(){window.location.reload()}),500),[2]):[2]}}))}))},e.prototype.detectLock=function(){var e=this;this.deteckLockTimeoutID=setTimeout((function(){e.detectLockAndRefresh(),e.detectLock()}),200)},e.prototype.mutexLock=function(e){return c(this,void 0,void 0,(function(){var t,o;return d(this,(function(r){switch(r.label){case 0:return this.secretId=e,[4,this.mutexTabLock.lock("offline_"+e,{source:"edit"})];case 1:return t=r.sent(),a.a.info("竞争锁结果："+JSON.stringify(t)),t.isSuccess||(o=t.data,this.mutexTabLockReason=o,o&&this.detectLock()),[2]}}))}))},e.prototype.dataManageInit=function(){var e=this;this.DBStatusPromise=new Promise((function(t){var o=+new Date;e.DBstatus=n.Initing,e.dataManager.init().then((function(r){r.error?(a.a.err("IndexDB init fail. reason: "+r.error),e.DBstatus=n.InitException):e.DBstatus=n.InitFinish,t(e.DBstatus),a.a.info("IndexDB init cost "+(+new Date-o)+" status:"+(e.DBstatus===n.InitFinish?"success":e.DBstatus))}))}))},e.prototype.getDataBase=function(){return this.dataManager.getDatabase()},e.prototype.getHelper=function(){return this.dataManager.getHelper()},e.prototype.handleDataFromIndexDB=function(e){return c(this,void 0,void 0,(function(){var t,o;return d(this,(function(n){if(t=new i.Result(void 0,void 0),o="",!e.type||!e.tableName)return o="oprate or tableName is undefine.",a.a.info(""+o),t.error=new i.BaseError(o),[2,t];if(Object(i.wordOfflineSwitch)()&&(e.type===r.set||e.type===r.update||e.type===r.delete)&&this.mutexTabLockReason)return o="has not mutexLock, can not write indexDB ",a.a.info(""+o),t.error=new i.BaseError(o),[2,t];switch(e.type){case r.set:return[2,this.getDataBase().set(e.tableName,e.data)];case r.update:return[2,this.getDataBase().update(e.tableName,e.data)];case r.delete:if(e.where)return[2,this.getDataBase().delete(e.tableName,e.where)];break;case r.get:if(e.where)return[2,this.getDataBase().get(e.tableName,e.where)]}return[2,t]}))}))},e.prototype.handleOfflineTitleChange=function(e,t){return c(this,void 0,void 0,(function(){var o,n,l,s,c;return d(this,(function(d){switch(d.label){case 0:if(!e||!t)return[2,!1];o=Object(i.getCookie)("uid")||t.userInfo.uid||"",n=i.QueryCondition.newInstance().addCondition("uid",i.QUERY_CONDITION_TYPE.ONLY,o).addCondition("globalPadId",i.QUERY_CONDITION_TYPE.ONLY,t.globalPadId),d.label=1;case 1:return d.trys.push([1,4,,5]),[4,this.handleDataFromIndexDB({type:r.get,tableName:i.TableName.PAD_INFO,where:n})];case 2:return(l=d.sent()).error?(a.a.err("PadInfo not found where id = "+t.globalPadId),[2,!1]):((s=l.data).title=e,s.lastModifyTime=Date.now(),n=i.QueryCondition.newInstance().addCondition("uid",i.QUERY_CONDITION_TYPE.ONLY,o).addCondition("globalPadId",i.QUERY_CONDITION_TYPE.ONLY,t.globalPadId),[4,this.getDataBase().updateField(i.TableName.PAD_INFO,n,{title:e,lastModifyTime:Date.now()})]);case 3:return d.sent(),[3,5];case 4:return c=d.sent(),a.a.info("update title to padinfo table failed: "+c),[2,!1];case 5:return[2,!0]}}))}))},e.prototype.updateClientVars=function(e){return c(this,void 0,void 0,(function(){var t,o;return d(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this.getHelper().clientVars2OfflineData(e.globalPadId,e),[4,this.handleDataFromIndexDB({type:r.update,tableName:i.TableName.DOCUMENT_DATA,data:t})];case 1:return n.sent(),[3,3];case 2:return o=n.sent(),a.a.err("updateClientVarsInNative fail: "+o),[2,!1];case 3:return[2,!0]}}))}))},e.prototype.isDeletedDoc=function(){return c(this,void 0,void 0,(function(){var e,t,o,r,n;return d(this,(function(c){switch(c.label){case 0:return e=l.a.get("uid"),t=Object(s.c)(),o=""+e+t.domainId+"$"+t.padId,r=i.QueryCondition.newInstance().addCondition("key",i.QUERY_CONDITION_TYPE.ONLY,o),[4,this.dataManager.database.get(i.TableName.PAD_INFO,r)];case 1:return(n=c.sent())&&n.data&&n.data.isDelete?[2,!!n.data.isDelete]:(n.error&&a.a.info("check isDeletedDoc fail, by:"+n.error),[2,!1])}}))}))},e.prototype.recoverDocUpdateClientVars=function(e,t){return c(this,void 0,void 0,(function(){var o,r,n,l,s;return d(this,(function(c){switch(c.label){case 0:return o=i.QueryCondition.newInstance().addCondition("uid",i.QUERY_CONDITION_TYPE.ONLY,e).addCondition("globalPadId",i.QUERY_CONDITION_TYPE.ONLY,t.globalPadId).addCondition("type",i.QUERY_CONDITION_TYPE.ONLY,i.OFFLINE_ITEM_TYPE.INIT),[4,this.dataManager.database.get(i.TableName.DOCUMENT_DATA,o)];case 1:return(r=c.sent())&&r.data?((n=r.data.data).docStatus=0,l=this.dataManager.getHelper().clientVars2OfflineData(n.globalPadId,n),[4,this.dataManager.database.update(i.TableName.DOCUMENT_DATA,l)]):[3,3];case 2:(s=c.sent()).error&&a.a.err("recoverDocUpdateClientVars fail, by:"+s.error),c.label=3;case 3:return[2]}}))}))},e.prototype.recoverDocUpdatePadinfo=function(e,t,o){return c(this,void 0,void 0,(function(){var r,n,l;return d(this,(function(s){switch(s.label){case 0:return r=""+t+o.domainId+"$"+o.padId,n=i.QueryCondition.newInstance().addCondition("key",i.QUERY_CONDITION_TYPE.ONLY,r),[4,this.dataManager.database.updateField(i.TableName.PAD_INFO,n,{folder:e,isDelete:!1,isMydoc:!0,isMyCreated:!0})];case 1:return(l=s.sent()).error&&a.a.err("recoverDocUpdatePadinfo fail, by:"+l.error),[2]}}))}))},e.prototype.recoverDoc=function(e){var t=l.a.get("uid"),o=Object(s.c)();this.recoverDocUpdateClientVars(t,o),this.recoverDocUpdatePadinfo(e,t,o)},e}(),p=window.offlineDataHelperInstance;p||(p=new u,window.offlineDataHelperInstance=p,window.offlineDataHelperInstance.dataManageInit())},,,,,function(e,t,o){"use strict";o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return n}));var r=function(){function e(){}return e.dateFormatContainMillisecond=function(e){return e instanceof Date?[e.getFullYear(),"-",e.getMonth()+1,"-",e.getDate()," ",e.getHours()>9?e.getHours():"0"+e.getHours(),":",e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes(),":",e.getSeconds()>9?e.getSeconds():"0"+e.getSeconds(),":",e.getMilliseconds()>9?e.getMilliseconds()>99?e.getMilliseconds():"0"+e.getMilliseconds():"00"+e.getMilliseconds()].join(""):""},e.needSaveLog=function(){return!!window.App.GlobalConfig.IsSupportStore||e.liteReconnects<e.liteReconnectsMax},e.roomLogConsole=function(t){console.log(e.collabRoomLogTag+t)},e.roomLogDebug=function(t){e.needSaveLog()&&(window.log,window.log.debug(e.collabRoomLogTag+t))},e.roomLogInfo=function(t){e.needSaveLog()&&(window.log,window.log.info(e.collabRoomLogTag+t))},e.roomLogWarn=function(t){e.needSaveLog()&&(window.log,window.log.warn(e.collabRoomLogTag+t))},e.roomLogError=function(t){e.needSaveLog()&&(window.log,window.log.error(e.collabRoomLogTag+t))},e.freakout=function(t){e.dmesg(t),e.offlineLog(t)},e.dmesg=function(t){e.offlineLog(t)},e.offlineLog=function(t){var o=e.offlineLogPre+t;window.log,window.log.info(o)},e.info=function(t){window.log&&window.log.info?window.log.info(e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t):console.log("%c"+e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t,"color:#FF00FF")},e.warn=function(t){window.log&&window.log.warn?window.log.warn(e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t):console.warn("%c"+e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t,"color:#FF00FF")},e.err=function(t){window.log&&window.log.error?window.log.error(e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t):console.error("%c"+e.lauchLogPre+e.dateFormatContainMillisecond(new Date)+" "+t,"color:#FF00FF")},e.collabRoomLogTag="collab Room ",e.offlineLogPre="offlineLog collab_client ",e.lauchLogPre="Melo ",e.liteReconnects=0,e.liteReconnectsMax=5,e}();function n(e){if(e){var t=Date.now(),o=t-18e4;window.log&&window.log.report(e,{query:{startTs:o,endTs:t}})}}},,,,,,,,,,,function(e,t,o){"use strict";var r=o(120),n=Object.prototype.toString;function i(e){return"[object Array]"===n.call(e)}function a(e){return void 0===e}function l(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===n.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var o=0,r=e.length;o<r;o++)t.call(null,e[o],o,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:l,isUndefined:a,isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:s,isStream:function(e){return l(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function e(){var t={};function o(o,r){"object"==typeof t[r]&&"object"==typeof o?t[r]=e(t[r],o):t[r]=o}for(var r=0,n=arguments.length;r<n;r++)c(arguments[r],o);return t},deepMerge:function e(){var t={};function o(o,r){"object"==typeof t[r]&&"object"==typeof o?t[r]=e(t[r],o):t[r]="object"==typeof o?e({},o):o}for(var r=0,n=arguments.length;r<n;r++)c(arguments[r],o);return t},extend:function(e,t,o){return c(t,(function(t,n){e[n]=o&&"function"==typeof t?r(t,o):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=window,n=function(){function e(){}return e.debug=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];try{r.log?(t=r.log).debug.apply(t,o):console.debug.apply(console,o)}catch(t){e.error("日志发生错误","debug",o)}},e.log=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];try{r.log?(t=r.log).info.apply(t,o):console.log.apply(console,o)}catch(t){e.error("日志发生错误","log",o)}},e.info=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];try{r.log?(t=r.log).info.apply(t,o):console.info.apply(console,o)}catch(t){e.error("日志发生错误","info",o)}},e.warn=function(){for(var t,o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];try{r.log?(t=r.log).warn.apply(t,o):console.warn.apply(console,o)}catch(t){e.error("日志发生错误","warn",o)}},e.error=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];try{r.log?(e=r.log).error.apply(e,t):console.error.apply(console,t)}catch(e){console.error("日志发生错误","error",t)}},e.time=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r={time:Date.now(),options:t};this.sTimeLableMap.set(e,r)},e.timeEnd=function(t){var o=Date.now(),r=e.sTimeLableMap.get(t);if(void 0!==r){var n=r.time,i=r.options&&r.options.map((function(e){return JSON.stringify(e)})).join("-")||"";e.debug("label: "+t+": "+(o-n)+"ms. "+i),this.sTimeLableMap.delete(t)}},e.sTimeLableMap=new Map,e}();t.Log=n,t.default=n},function(e,t,o){"use strict";var r,n,i,a,l,s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.WORD=0]="WORD",e[e.EXCEL=1]="EXCEL",e[e.SLIDE=4]="SLIDE"}(n||(n={})),t.FILE_TYPE=n,function(e){e.NEW="new",e.LOCAL="local",e.DELETED="deleted",e.NORMAL="normal"}(i||(i={})),t.PadStatus=i,function(e){e.SHEET="sheet",e.WORD="doc",e.FORM="form",e.SLIDE="slide"}(a=t.TYPE_DES||(t.TYPE_DES={})),t.typeMap=((r={})[n.EXCEL]=a.SHEET,r[n.WORD]=a.WORD,r[n.SLIDE]=a.SLIDE,r),function(e){e[e.MY_DOC=5]="MY_DOC",e[e.RECENT=6]="RECENT",e[e.SHARE=4]="SHARE",e[e.STAR=7]="STAR",e[e.TRASH=3]="TRASH"}(l=t.LIST_TYPE||(t.LIST_TYPE={})),function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER"}(s=t.LIST_INFO_TYPE||(t.LIST_INFO_TYPE={}));var c=function(e,t,o){this.folder_id="",this.attribute=null,this.parents=[],this.isOfflineCache=!1,this.isSnapShot=!1,this.doc_policy=0,this.folder_policy=0,this.doc_privilege=null,this.folder_privilege=null,this.is_added_my=0,this.is_collected=0,this.is_owner=1,this.is_pinned=0,this.is_shortcut=0,this.isManualOffline=!1,this.add_list_ts=0,this.last_collect_ts=0,this.last_delete_ts=0,this.last_pinned_ts=null;var r=(new Date).getTime()/1e3;this.last_browse_ts=r,this.last_modify_ts=r,this.create_ts=r,this.list_type=l.MY_DOC,this.list_info_type=s.FILE,this.owner_uid=e.getUserId(),this.owner_nick=e.getUserId(),this.uid=e.getUserId(),this.last_modify_nick=e.getUserId(),this.last_modify_uid=e.getUserId(),void 0!==t&&(this.isMydoc=t),void 0!==o&&(this.isRencent=o)};t.PadInfo=c},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(40),n=window;function i(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}t.getCookie=i,t.setCookie=function(e,t,o,r,n){var i=new Date;i.setTime(i.getTime()+(n?36e5*n:2592e6)),document.cookie=e+"="+t+"; expires="+i.toUTCString()+"; path="+(r||"/")+"; "+(o?"domain="+o+";":"")},t.getXsrf=function(){return i("TOK")||""},t.pushState=function(e,t){var o=window.history;try{t?o.replaceState(null,"",e):o.pushState(null,"",e)}catch(o){window.location[t?"replace":"assign"](e)}};var a,l,s=(a=navigator.userAgent.toLowerCase(),{isPad:l=/(ipad)/i.test(a),isMobile:/(mobile)/i.test(a)&&!l,isDesktop:/(TDAppDesktop)/.test(navigator.userAgent)});function c(e){return e.toString(36).toLowerCase()}function d(e){return"string"==typeof e?d(JSON.parse(e)):e}function u(e){var t=[];if(e.v>=5){var o=e.c;("IMAGE"===o[0]||"string"==typeof o[2]&&-1!==o[2].indexOf("attachment-"))&&t.push(e.c[3])}return t}function p(e){var t,o=[];return"string"==typeof e&&(t=JSON.parse(e)),Array.isArray(t)&&t.forEach((function(e){e&&e.v&&(o=o.concat(u(e)))})),o}t.UserAgent=s,t.ChangesetPack=function(e){var t=e.newLen-e.oldLen,o=t>=0?">"+c(t):"<"+c(-t);return"Z:"+c(e.oldLen)+o+e.opsStr+"$"+e.charBank},t.isSupportClientDB=function(){if("0"===localStorage.getItem("OFFLINE_DB_SWITCH"))return!1;var e=navigator.userAgent.match(/_tdocFlag\/(\d+)/);return!(!e||!e[1])&&2&parseInt(e[1])},t.checkDebugOffline=function(){var e,t;return"1"===(e="offline-debug",(t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)")))?decodeURIComponent(t[2]):"")},t.wordOfflineSwitch=function(){return!!(n.App&&n.App.GlobalConfig&&n.App.GlobalConfig.IsSupportStore)},t.wordCodeVersion=function(){return n.App&&n.App.GlobalConfig&&n.App.GlobalConfig.globalCodeVersion?n.App.GlobalConfig.globalCodeVersion:""},t.wrapResult=function(e,t){var o,r;return e.data=(o=e.data,r=t,Array.isArray(o)?o.map((function(e){return new r.prototype.constructor(e)})):new r.prototype.constructor(o)),e},t.getCollabMutations=p,t.k2sConverter=function(e){for(var t=[],o=0,r=e.length;o<r;o++)for(var n=d(e[o]),i=0,a=n.length;i<a;i++){var l=n[i];t=l.v?t.concat(u(l)):t.concat(p(l))}return t};t.getFileType=function(e){var t=r.FILE_TYPE.UNKNOWN;return"doc"===e?t=r.FILE_TYPE.WORD:"sheet"===e?t=r.FILE_TYPE.EXCEL:"slide"===e&&(t=r.FILE_TYPE.SLIDE),t};var h=function(e){var t;return e===r.FILE_TYPE.WORD?t="doc":e===r.FILE_TYPE.EXCEL?t="sheet":e===r.FILE_TYPE.SLIDE&&(t="slide"),t};t.getFileTypeName=h;t.reconstructDocUrl=function(e,t){return"https://docs.qq.com/"+h(e)+"/"+t},t.logSyncResult=function(e){var t;return e?"result is { resultCode: "+e.resultCode+" subResultCode: "+e.subResultCode+" message: "+e.message+" dataUndefinedCheck: "+(void 0===e.data)+" error: "+(null===(t=e.error)||void 0===t?void 0:t.stack)+"}":"result is undefine!!!"}},,,,function(e,t,o){"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OFFLINE_DATA="OfflineData",e.DOCUMENT_DATA="DocumentData",e.PAD_INFO="PadInfo",e.NEW_DOCUMENT_ID="NewDocumentIds",e.FOLDER_INFO="FolderInfo",e.USER_INFO="UserInfo",e.DOCUMENT_STATUS="DocumentStatus",e.LIST_TYPE="ListType",e.DATA_CHANGE="DataChange",e.QUICK_LOOK_WORD="QuickLookWord"}(r||(r={})),t.TableName=r,function(e){e.EXCEL="EXCEL",e.WORD="WORD",e.SLIDE="SLIDE"}(n||(n={})),t.DOC_TYPE=n,function(e){e.GLOBAL="globalPadId",e.SECRET="secretId"}(i||(i={})),t.PadIdType=i;t.DB_NAME="TencentDocs";t.DB_NAME_TESTENV="TencentDocs_TestEnv";t.DB_VERSION=2;var a="true"===localStorage.getItem("isOfflineModuleDebug")||!1;t.DEBUG=a,t.switchDebug=function(e){localStorage.setItem("isOfflineModuleDebug",String(e)),t.DEBUG=a=e}},,,,function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.get=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""},e.set=function(e,t,o,r,n){var i=new Date;i.setTime(i.getTime()+(n?36e5*n:2592e6)),document.cookie=e+"="+t+"; expires="+i.toUTCString()+"; path="+(r||"/")+"; "+(o?"domain="+o+";":"")},e.del=function(e,t,o){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(o||"/")+"; "+(t?"domain="+t+";":"")},e.uin=function(){var t=e.get("uin");return t?parseInt(t.substring(1,t.length),10):null},e}()},,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=o(40),i=o(39);!function(e){e.INIT="init",e.DOCUMENT="document",e.WORKBOOK="workbook",e.CHUNK="chunk",e.ACCEPTED="accepted",e.MISS_CHANGE="misschange",e.NEW_CHANGE="newchange",e.COMMITING="commiting",e.WATTING="watting",e.QUEUE="queue"}(r||(r={})),t.OFFLINE_ITEM_TYPE=r;var a=function(){function e(t){this.chunkId=0,this.default=!1,t.taskId||(t.taskId=e.createMessageSeq()),t.key||(t.chunkId=t.chunkId||0,t.type===r.INIT?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid:t.type===r.DOCUMENT?t.key=t.globalPadId+"_"+t.uid+"_version_"+t.version:t.type===r.WORKBOOK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_version_"+t.version:t.type===r.CHUNK?t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.chunkId+"_"+t.uid+"_version_"+t.version:t.key=t.globalPadId+"_"+t.subSheetId+"_"+t.uid+"_taskId_"+t.taskId),t.default=t.default||!1,this.key=t.key,this.uid=t.uid,this.globalPadId=t.globalPadId,this.secretId=t.secretId,this.subSheetId=t.subSheetId,this.chunkId=t.chunkId,this.type=t.type,this.docType=t.docType,this.padStatus=t.padStatus,this.taskId=t.taskId,this.version=t.version,this.data=t.data||t._data,this.default=t.default,this.createTime=t.createTime,this.dver=t.dver}return e.createMessageSeq=function(){return Math.ceil(2147483648*Math.random())},e.prototype.disableConvert=function(){return this.docType===n.FILE_TYPE.WORD&&"BB08J2"!==this.subSheetId},Object.defineProperty(e.prototype,"data",{get:function(){if("string"==typeof this._data&&!this.disableConvert()){var e=this._data;try{e=JSON.parse(this._data)}catch(e){i.Log.error(e)}return e}return this._data},set:function(e){this._data="string"!=typeof e?JSON.stringify(e):e},enumerable:!0,configurable:!0}),e}();t.OfflineData=a},function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(14),c=o(45),d=o(173),u=o(65),p=o(57),h=o(40),f=o(66),m=l(o(117)),y=l(o(39)),g=l(o(118)),v=o(41);function _(e){return v.isSupportClientDB()&&!v.checkDebugOffline()?new m.default(e):new g.default(e)}t.Lock=v.isSupportClientDB()&&!v.checkDebugOffline()?m.default:g.default,t.createLock=_;t.LocalNewMaxNum=10;var b=function(){function e(e){this.defaultCodeVersion=new Map,this.parent=e.parent,this.database=e.database,this.setDefaultCodeVersion("doc","2.1.0"),this.setDefaultCodeVersion("sheet","2.4.0"),this.setDefaultCodeVersion("slide","1.0.0")}return e.prototype.filterUncommitedPadId=function(e){return n(this,void 0,void 0,(function(){var t,o,r,n;return i(this,(function(i){switch(i.label){case 0:return e&&0===e.length?[2,new s.Result(new s.ArgumentError(s.ArgumentErrorType.ILLEGAL_ARGUMENT,"文档Id数组长度不能为0"))]:(t=s.QueryCondition.newInstance().addCondition("type",s.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),e&&t.addCondition("globalPadId",s.QUERY_CONDITION_TYPE.IN,e),[4,this.database.getAll(c.TableName.OFFLINE_DATA,t)]);case 1:return(o=i.sent()).error?(y.default.error("查询失败",o.error),[2,o]):(r=o.data,n=r.map((function(e){return e.globalPadId})).reduce((function(e,t){return e.includes(t)?e:a(e,[t])}),new Array),[2,new s.Result(void 0,n)])}}))}))},e.prototype.filterNeedUpdateCachePadId=function(e){return n(this,void 0,void 0,(function(){var t,o,r,n,a,l,d,u;return i(this,(function(i){switch(i.label){case 0:return e&&0===e.length?[2,new s.Result(new s.ArgumentError(s.ArgumentErrorType.ILLEGAL_ARGUMENT,"文档Id数组长度不能为0"))]:(t=s.QueryCondition.newInstance().addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),e&&t.addCondition("globalPadId",s.QUERY_CONDITION_TYPE.IN,e),[4,this.database.getAll(c.TableName.DOCUMENT_DATA,t)]);case 1:if((o=i.sent()).error)return y.default.error("查询失败",o.error),[2,o];for(10,r=o.data,n=new Map,a=new Array,l=0;l<r.length;l++)d=r[l],u=n.get(d.globalPadId)||0,n.set(d.globalPadId,u+1),u+1===10&&a.push(d.globalPadId);return[2,new s.Result(void 0,a)]}}))}))},e.prototype.getUncommitedOfflineData=function(){return n(this,void 0,void 0,(function(){var e,t;return i(this,(function(o){switch(o.label){case 0:return e=s.QueryCondition.newInstance().addCondition("type",s.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.getAll(c.TableName.OFFLINE_DATA,e)];case 1:return(t=o.sent()).error?(y.default.error("查询失败",t.error),[2,t]):[2,t]}}))}))},e.prototype.syncOfflineData=function(e){var t;return n(this,void 0,void 0,(function(){var o,r,n,a,l,s,c,d,p,h,f,m,g,v,b,T;return i(this,(function(i){switch(i.label){case 0:return y.default.log("call SyncOfflineData()",e),o=e.padId,r=e.secretId,n=e.padType,a=e.onCommiting,l=e.onCommitFinished,s=e.source,c=void 0===s?"list":s,d=e.force,p=void 0!==d&&d,[4,this.checkUpdateInterval(e)];case 1:return(h=i.sent()).resultCode!==u.SyncResultCode.Success?[2,h]:[4,_().lock("offline_"+r,{source:c})];case 2:if(!(f=i.sent()).isSuccess)return y.default.warn("SyncOfflineData. 竞争离线锁失败，同步接口异常结束",o,r,c,p,n,f),[2,{resultCode:u.SyncResultCode.GetDocLockError,subResultCode:-1,message:"竞争离线锁失败"}];i.label=3;case 3:return i.trys.push([3,8,9,11]),a&&a(o),y.default.log("SyncOfflineData. 第一步：带数据创建文档",o,r,c,p,n),[4,this.commitLocalFile(e)];case 4:return(g=i.sent()).resultCode!==u.SyncResultCode.Success?(l&&l(!1,o),[2,g]):(y.default.log("SyncOfflineData. 第二步，提交未提交的离线数据",o,r,c,p,n),[4,this.commitUncommitData(e)]);case 5:return(v=i.sent()).resultCode!==u.SyncResultCode.Success?(l&&l(!1,o),[2,v]):(l&&l(!0,o),y.default.log("SyncOfflineData. 第三步，检查版本更新",o,r,c,p,n),[4,this.checkVersionUpdate(n,o)]);case 6:return i.sent(),y.default.log("SyncOfflineData. 第四步，预拉离线缓存数据",o,r,c,p,n),[4,this.fetchAndStoreDocumentCache(e)];case 7:return(b=i.sent()).resultCode!==u.SyncResultCode.Success?[2,b]:(m=b.data,[3,11]);case 8:return T=i.sent(),y.default.error("SyncOfflineData. 同步文档异常结束",null===(t=T)||void 0===t?void 0:t.stack),[2,{resultCode:u.SyncResultCode.SyncOfflineDataUnknownError,subResultCode:-1,message:"SyncOfflineDataUnknownError。 同步离线数据的时候发生了未知错误 被catch住了。",error:T||new Error("SyncOfflineDataUnknownError")}];case 9:return[4,_().release("offline_"+r)];case 10:return i.sent(),[7];case 11:return y.default.log("SyncOfflineData. 结束",o,r,c,p,n),[2,{resultCode:u.SyncResultCode.Success,subResultCode:0,message:"Success",data:m}]}}))}))},e.prototype.checkUpdateInterval=function(e){return n(this,void 0,void 0,(function(){var t,o,r,n,a,l,d,p,h,f;return i(this,(function(i){switch(i.label){case 0:return t=e.padId,o=e.secretId,r=e.padType,n=e.source,a=void 0===n?"list":n,l=e.force,(d=void 0!==l&&l)?[3,2]:(p=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,t).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.get(c.TableName.DOCUMENT_STATUS,p)]);case 1:if((h=i.sent()).error&&!s.isNoResultError(h.error))return y.default.warn("SyncOfflineData. 查询DocumentStatus发生错误",t,o,a,d,r,h.error),[2,{resultCode:u.SyncResultCode.GetDocumentStatusError,subResultCode:-1,message:"数据库查询DocumentStatus发生错误",error:h.error}];if(!h.error&&(f=h.data,Date.now()-f.lastSyncTime<6e5))return y.default.warn("SyncOfflineData. RejcectByThrottle节流了",t,o,a,d,r),[2,{resultCode:u.SyncResultCode.RejcectByThrottleError,subResultCode:-1,message:"同步任务失败，10分钟内已经同步过了，节流下。上次同步时间 "+new Date(f.lastSyncTime)}];i.label=2;case 2:return[2,{resultCode:u.SyncResultCode.Success,subResultCode:-1,message:"同步任务开始"}]}}))}))},e.prototype.commitLocalFile=function(e){return n(this,void 0,void 0,(function(){var t,o,r,n,a,l,s;return i(this,(function(i){switch(i.label){case 0:return t=e.padId,o=e.secretId,r=e.source,n=e.force,a=e.padType,[4,this.getPadInfo(t)];case 1:return(l=i.sent())?!l||l.status!==h.PadStatus.NEW&&l.status!==h.PadStatus.LOCAL?[3,3]:[4,this.createFileWithData(t,a,l.folder)]:(y.default.error("commitLocalFile. getPadInfoError. ",t,o,r,n,a),[2,{resultCode:u.SyncResultCode.CreateFileError,subResultCode:-1e3,message:"commitLocalFile 查询文档PadInfo发生错误，PadInfo不存在或者数据库操作错误。"}]);case 2:if((s=i.sent()).error)return y.default.error("commitLocalFile 带数据创建文档失败",t,o,r,n,a,s.error),[2,{resultCode:u.SyncResultCode.CreateFileError,subResultCode:-2e3,message:"commitLocalFile 带数据创建文档失败了。",error:s.error}];i.label=3;case 3:return[2,{resultCode:u.SyncResultCode.Success,subResultCode:-1,message:"commitLocalFile 正常"}]}}))}))},e.prototype.commitUncommitData=function(e){var t;return n(this,void 0,void 0,(function(){var o,r,n,a,l,s,c,d,p,h;return i(this,(function(i){switch(i.label){case 0:return o=e.padId,r=e.secretId,n=e.source,a=e.force,l=e.padType,[4,this.getUnCommitedData(o)];case 1:return(s=i.sent()).error?(y.default.error(s.error),[2,{resultCode:u.SyncResultCode.GetUncommitDataError,subResultCode:-1,message:"commitUncommitData 查询本地未提交数据错误。",error:s.error}]):(y.default.log("commitUncommitData. 查询本地未提交离线数据",o,r,n,a,l,s.data.length),(c=s.data).length>0?[4,this.batchCommitOfflineData(o,r,c)]:[3,4]);case 2:return(d=i.sent()).resultCode!==u.SyncResultCode.Success?(y.default.error("commitUncommitData. 提交离线未提交数据时出错了，同步失败",o,r,n,a,l),[2,d]):(p=d.data).length>0?[4,this.updateDocUncommitedData(o,p)]:[3,4];case 3:if((h=i.sent()).error)return y.default.error("SyncOfflineData. 更新未提交数据为已提交数据出错",o,r,n,a,l,h.error,null===(t=h.error)||void 0===t?void 0:t.stack),[2,{resultCode:u.SyncResultCode.UpdateUnCommitedDataError,subResultCode:-1,message:"commitUncommitData 提交成功后更新数据库中本地未提交离线数据时发生错误。",error:h.error}];i.label=4;case 4:return[2,{resultCode:u.SyncResultCode.Success,subResultCode:-1,message:"commitUncommitData 正常"}]}}))}))},e.prototype.fetchAndStoreDocumentCache=function(e){var t,o,r;return n(this,void 0,void 0,(function(){var n,a,l,s,c,p,h,f,m,g,_,b,T,S,C,w,E,I,x,R,O=this;return i(this,(function(i){switch(i.label){case 0:return n=e.padId,a=e.secretId,l=e.source,s=e.force,c=e.padType,p=e.deleteOldCache,h=void 0===p||p,f=e.rev,m=e.isManualOffline,[4,this.preFetchDocData(n,a,f)];case 1:return(g=i.sent()).resultCode!==u.SyncResultCode.Success?(y.default.error("SyncOfflineData. 拉取新的离线数据失败, 同步失败",n,a,l,s,c,v.logSyncResult(g)),[2,g]):(_=g.data,b=_.dver,T=_.allBlockData,y.default.log("SyncOfflineData. 第五步，删除本地离线数据&写入新的预拉数据",n,a,l,s,c),S=T.map((function(e){return O.blockData2OfflineData(e,b)})),[4,this.updateDocOfflineData(n,S,h,f)]);case 2:return(C=i.sent()).error?(y.default.error("SyncOfflineData. 写入离线缓存数据错误.",n,a,l,s,c,f,b,S.length,C.error,null===(t=C.error)||void 0===t?void 0:t.stack),[2,{resultCode:u.SyncResultCode.UpdatePreFetchOfflienDataError,subResultCode:-1,message:"updateDocOfflineData 操作数据库更新离线缓存数据失败",error:C.error}]):[4,this.getManualPadInfo(a)];case 3:return(!(w=i.sent()).error&&w.data||m)&&T.forEach((function(e){O.cacheImageData(e)})),E=void 0!==m?{dver:b,isOfflineCache:!0,isManualOffline:m}:{dver:b,isOfflineCache:!0},[4,this.updatePadInfo(n,E)];case 4:return(I=i.sent()).error?(y.default.error("SyncOfflineData. 增量更新padInfo错误.",n,a,l,s,c,f,b,I.error,null===(o=I.error)||void 0===o?void 0:o.stack),[2,{resultCode:u.SyncResultCode.UpdatePadInfoError,subResultCode:-1,message:"updatePadInfo 操作数据库更新离线PadInfo缓存数据失败",error:I.error}]):(x=new d.DocumentStatus({uid:this.parent.user.getUserId(),globalPadId:n,secretId:a,lastSyncTime:Date.now()}),[4,this.updateDocumentStatus(x)]);case 5:return(R=i.sent()).error&&y.default.error("SyncOfflineData. 更新文档Status表错误.",n,a,l,s,c,f,b,R.error,null===(r=R.error)||void 0===r?void 0:r.stack),this.parent.mapDocumentVersion(b,v.reconstructDocUrl(c,a)),[2,{resultCode:u.SyncResultCode.Success,subResultCode:0,message:"fetchAndStoreDocumentCache Success",data:I.data[0]}]}}))}))},e.prototype.updateDocumentStatus=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.database.update(c.TableName.DOCUMENT_STATUS,e)];case 1:return[2,t.sent()]}}))}))},e.prototype.updatePadInfo=function(e,t){return n(this,void 0,void 0,(function(){var o;return i(this,(function(r){switch(r.label){case 0:return o=(new s.QueryCondition).addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.updateField(c.TableName.PAD_INFO,o,t)];case 1:return[2,r.sent()]}}))}))},e.prototype.getUnCommitedData=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(o){switch(o.label){case 0:return t=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",s.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.getAll(c.TableName.OFFLINE_DATA,t)];case 1:return[2,o.sent()]}}))}))},e.prototype.clearDocOfflineData=function(e,t){return void 0===t&&(t=!0),n(this,void 0,void 0,(function(){var o,r;return i(this,(function(n){switch(n.label){case 0:return o=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.delete(c.TableName.OFFLINE_DATA,o)];case 1:return r=n.sent(),t?!r.error?[4,this.database.delete(c.TableName.DOCUMENT_DATA,o)]:[3,3]:[3,8];case 2:r=n.sent(),n.label=3;case 3:return!r.error?[4,this.database.delete(c.TableName.DOCUMENT_STATUS,o)]:[3,5];case 4:r=n.sent(),n.label=5;case 5:return!r.error?[4,this.database.updateField(c.TableName.PAD_INFO,o,{isOfflineCache:!1})]:[3,7];case 6:r=n.sent(),n.label=7;case 7:n.label=8;case 8:return[2,r]}}))}))},e.prototype.updateDocOfflineData=function(e,t,o,r){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return n=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),void 0!==r&&n.addCondition("version",s.QUERY_CONDITION_TYPE.UPPER_BOUND,{upper:r,open:!1}),o?[4,this.database.deleteAndWrite(c.TableName.DOCUMENT_DATA,n,t)]:[3,2];case 1:return[2,i.sent()];case 2:return a=t.map((function(e){return{tableName:c.TableName.DOCUMENT_DATA,data:e}})),[4,this.database.updateMultiTableData(a)];case 3:return[2,i.sent()]}}))}))},e.prototype.composeOfflineData=function(e,t){var o=this.parent.user.getUserId(),r=t[0];return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,uid:o,dver:r.dver,base_rev:r.type===p.OFFLINE_ITEM_TYPE.INIT?r.version:r.data.baseVersion,code_ver:r.docType===h.FILE_TYPE.EXCEL?1:0,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:r.docType===h.FILE_TYPE.WORD?2:1,uuId:r.type===p.OFFLINE_ITEM_TYPE.INIT?this.parent.user.getUserId():r.data.data.uuId},respective:t.filter((function(e){if(e.type!==p.OFFLINE_ITEM_TYPE.INIT)return e})).map((function(e){var t=e.data.data,o={task_id:t.taskId,subId:t.subId,oSubId:t.oSubId||!1,head:t.head,keydata:t.keyData||!1,changeSetCount:t.changeData?1:void 0!==t.changeSetCount?t.changeSetCount:t.mutations.length,changeset:t.changeset?t.changeset:JSON.stringify(t.changeData||t.mutations||"[]"),apool:t.apool};return r.docType===h.FILE_TYPE.EXCEL&&(o.changeset=o.changeset+"\n"),o}))}},e.prototype.batchCommitOfflineData=function(e,t,o){return n(this,void 0,void 0,(function(){var r,n,a,l,s,c;return i(this,(function(i){switch(i.label){case 0:return 0===(r=o).length?[2,{resultCode:u.SyncResultCode.CommitOfflineDataError,subResultCode:-1e3,message:"batchCommitOfflineData 参数错误。待提交的OfflineData数组长度为0"}]:(r=this.offlineDataSort(r),n=this.composeOfflineData(e,o),[4,this.commitOfflineData(e,n)]);case 1:return(a=i.sent()).error?(y.default.error(a.error),[2,{resultCode:u.SyncResultCode.CommitOfflineDataError,subResultCode:-2e3,message:"batchCommitOfflineData 批量提交离线数据时发生错误。",error:a.error}]):(l=a.data,0===(s=l.retcode)?(c=this.createMisschangeData(e,t,l.Data),[2,{resultCode:u.SyncResultCode.Success,subResultCode:-1,data:c,message:"batchCommitOfflineData 提交正常。"}]):(y.default.error("batchCommitOfflineData retcode:"+s),[2,{resultCode:u.SyncResultCode.CommitOfflineDataError,subResultCode:-2001,message:"batchCommitOfflineData 批量提交离线数据时发生错误。retCode不为0 retCode="+s}]))}}))}))},e.prototype.getHeaderGeneralPacket=function(){var e={};return window.__globalReleaseVersion&&(e.rel_rev=window.__globalReleaseVersion),e},e.prototype.commitOfflineData=function(e,t){return n(this,void 0,void 0,(function(){var o,r;return i(this,(function(n){return o="/dop-api/commitchanges?padId="+e+"&xsrf="+v.getXsrf(),r=JSON.stringify(t),r=encodeURIComponent(r),[2,f.CGI.sendCommonRequest(o,f.Method.POST,"data="+r)]}))}))},e.prototype.getGlobalPadIdBySecretId=function(e,t,o){return void 0===o&&(o=!0),n(this,void 0,void 0,(function(){var r,n;return i(this,(function(i){switch(i.label){case 0:return[4,this.getPadInfo(e,c.PadIdType.SECRET)];case 1:return(r=i.sent())?[2,r.globalPadId]:[4,this.getClientVarsBySecretId(e,t,o)];case 2:return(n=i.sent()).error?[2,void 0]:[2,n.data.globalPadId]}}))}))},e.prototype.getClientVarsBySecretId=function(e,t,o){return void 0===o&&(o=!0),n(this,void 0,void 0,(function(){var r,n,a,l;return i(this,(function(i){switch(i.label){case 0:return[4,f.CGI.fetchDocData(e,t,o)];case 1:if((r=i.sent()).error)return[2,new s.Result(r.error)];n=r.data,i.label=2;case 2:return i.trys.push([2,4,,5]),"blankpage"===(a=this.convertDataToClientVars(n)).padType||!0===a.isBlankPage?(y.default.error("文档数据不存在，或者无权限"),[2,new s.Result(new Error("FileNotExsit"))]):[4,this.createPadInfoFromClientVars(a)];case 3:return i.sent(),[2,new s.Result(void 0,a)];case 4:return l=i.sent(),y.default.error("解析后台预拉数据异常",l),[2,new s.Result(l||new Error("ParseResponseError"))];case 5:return[2]}}))}))},e.prototype.convertDataToClientVars=function(e){var t=this.unpackEjsData(e);if(t){var o=t.head.value;if(t.text&&t.text.value){var r=o.needEscape?escape(t.text.value):t.text.value;o.clientVars.collab_client_vars.initialAttributedText.text=r,o.clientVars.collab_client_vars.initialAttributedText.attribs=t.attribs.value}return o.clientVars}},e.prototype.unpackEjsData=function(e){for(var t=0,o=e||"",r=o.length,n={text:{type:"",value:null},attribs:{type:"",value:null},head:{type:"",value:null}};t<r;){var i=o.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],l=i[1],s=parseInt(i[2],10);t+=i[0].length+i[1].length+i[2].length+3;var c=o.slice(t,t+s);t+=s+1,"text"===a?(n.text.type=l,n.text.value="json"===l?JSON.parse(c):c):"head"===a?(n.head.type=l,n.head.value="json"===l?JSON.parse(c):c):"attribs"===a&&(n.attribs.type=l,n.attribs.value="json"===l?JSON.parse(c):c)}return n},e.prototype.checkVersionUpdate=function(e,t){return n(this,void 0,void 0,(function(){var o,r,n;return i(this,(function(i){switch(i.label){case 0:return o=this.getTypeStringWithPadType(e),r="https://docs.qq.com/dte-api/dver/gray?padId="+t+"&type="+o,[4,f.CGI.sendCommonRequest(r,f.Method.GET,void 0,"custom")];case 1:return(n=i.sent()).error&&y.default.error("checkVersionUpdate error.",n.error),y.default.log("checkVersionUpdate. response=",n.data),[2,n]}}))}))},e.prototype.preFetchDocData=function(e,t,o){return n(this,void 0,void 0,(function(){var r,n,a;return i(this,(function(i){switch(i.label){case 0:return r=this.getFetchUrl(e,t,o),[4,f.CGI.sendCommonRequest(r,f.Method.GET,void 0,"custom")];case 1:return(n=i.sent()).error?[2,this.handleCommonRequestError(n)]:(a=n.data,[2,this.handlePreFetchDocData(e,a)])}}))}))},e.prototype.handleCommonRequestError=function(e){return"HttpError"===e.error.errorType?{resultCode:u.SyncResultCode.PreFetchDocDataError,subResultCode:e.error.statusCode,message:"Prefetch Data请求遇到HttpError",error:e.error}:"TimeOutError"===e.error.message?{resultCode:u.SyncResultCode.PreFetchDocDataError,subResultCode:-200801,message:"Prefetch Data请求超时",error:e.error}:{resultCode:u.SyncResultCode.PreFetchDocDataError,subResultCode:-200802,message:"Prefetch Data请求遇到其他错误",error:e.error}},e.prototype.getSubBlockList=function(e){return this.parseHeadersFromClientVars(e)},e.prototype.pushState=function(e,t){var o=window.history;try{t?o.replaceState(null,"",e):o.pushState(null,"",e)}catch(o){window.location[t?"replace":"assign"](e)}},e.prototype.isFileCreated=function(e){return n(this,void 0,void 0,(function(){var t;return i(this,(function(o){switch(o.label){case 0:return[4,this.getPadInfo(e,c.PadIdType.GLOBAL)];case 1:return(t=o.sent())?t.status===h.PadStatus.NORMAL?[2,new s.Result(void 0,!0)]:[2,new s.Result(void 0,!1)]:(y.default.error("文档基本信息不存在"),[2,new s.Result(new Error("FileNotExsit"))])}}))}))},e.prototype.createFileWithData=function(e,t,o){return void 0===t&&(t=h.FILE_TYPE.EXCEL),void 0===o&&(o="/"),n(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.createFile(e,t,!0,o)]}))}))},e.prototype.createFile=function(e,t,o,r){return void 0===t&&(t=h.FILE_TYPE.EXCEL),void 0===o&&(o=!0),n(this,void 0,void 0,(function(){var n,a,l,d,u,m,g,_,b,T,S,C,w,E,I,x,R,O,P,D,N,k;return i(this,(function(i){switch(i.label){case 0:return n="/cgi-bin/online_docs/createdoc_new",11,0,a=t,l="string"==typeof e?e.split("$")[0]:"",d="string"==typeof e?e.split("$")[1]:"","2.0.0",u="create_type=11&pad_id="+d+"&domain_id="+l+"&doc_type="+a+"&templateId=0&xsrf="+v.getXsrf()+"&version=2.0.0",[4,this.getPadInfo(e,c.PadIdType.GLOBAL)];case 1:return(m=i.sent())?m.status===h.PadStatus.NORMAL?(y.default.error("已经创建过该文档了，不用再创建了",e),[2,new s.Result(new Error("AlreadyCreatedError"))]):(g=r||m.folder||"/",y.default.log("createFile folder_id:",g),u+="&folder_id="+g+"&title="+m.title,[4,this.getLocalCreateFileData(e,o)]):(y.default.error("获取文档padInfo失败了",e),[2,new s.Result(new Error("NoPadInfoError"))]);case 2:return(_=i.sent()).error?(y.default.error(_.error,"读取文档离线未提交数据失败"),[2,_]):((b=_.data).length>0&&t===h.FILE_TYPE.WORD&&(T=b[0]).type===p.OFFLINE_ITEM_TYPE.INIT&&(u+="&atext="+encodeURIComponent(JSON.stringify(T.data.collab_client_vars.initialAttributedText)),u+="&apool="+JSON.stringify(T.data.collab_client_vars.apool)),Math.max.apply(Math,b.map((function(e){return e.createTime}))),b.length>0&&(b=this.offlineDataSort(b),S=this.composeOfflineData(e,o?b:[b[0]]),C=encodeURIComponent(JSON.stringify(S)),u+="&data="+C),[4,f.CGI.sendCommonRequest(n,f.Method.POST,u)]);case 3:return(w=i.sent()).error?(y.default.error(w.error,"创建文档请求失败"),[2,w]):0!==(E=w.data).retcode?[3,14]:!0!==E.is_doc_id_dup?[3,8]:(I=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.delete(c.TableName.PAD_INFO,I)]);case 4:return i.sent(),[4,this.database.delete(c.TableName.OFFLINE_DATA,I)];case 5:return i.sent(),[4,this.database.delete(c.TableName.DOCUMENT_DATA,I)];case 6:return i.sent(),[4,this.database.delete(c.TableName.DOCUMENT_STATUS,I)];case 7:return i.sent(),[2,new s.Result(new s.HttpError(0,10033,"DocumentIdDuplicated"),{retcode:10033,url:E.doc_url})];case 8:return m.status=h.PadStatus.NORMAL,x=Date.now(),m.last_modify_ts=x,m.lastSyncTime=x,[4,this.getDefaultDocData(e,c.PadIdType.GLOBAL)];case 9:return(R=i.sent()).error?[2,R]:(O=R.data.data,E.miss_changes&&(t==h.FILE_TYPE.EXCEL||t===h.FILE_TYPE.WORD&&o)&&(P=this.createMisschangeData(e,m.secretId||O.data.collab_client_vars.client.upid,JSON.parse(E.miss_changes))).length>0?[4,this.updateDocUncommitedData(e,P)]:[3,11]);case 10:if((D=i.sent()).error)return y.default.error(D.error),[2,D];i.label=11;case 11:return O.isTemp=!1,[4,this.updateClientVarsSocketInfo(e,O)];case 12:return(N=i.sent()).error?[2,N]:(t===h.FILE_TYPE.WORD&&(N.data.collab_client_vars.rev=0),N.data.isLocalDoc=!1,N.data.padStatus=h.PadStatus.NORMAL,k=this.clientVars2OfflineData(e,N.data,!0),[4,this.database.updateMultiTableData([{tableName:c.TableName.PAD_INFO,data:m},{tableName:c.TableName.DOCUMENT_DATA,data:k}])]);case 13:return i.sent(),[2,new s.Result(void 0,{retcode:0,data:N.data})];case 14:return y.default.error("创建文档失败"),[2,new s.Result(new Error("CreatFileError"),E)]}}))}))},e.prototype.updateOfflineDataBaseVersion=function(e,t,o){},e.prototype.updateClientVarsSocketInfo=function(e,t){return n(this,void 0,void 0,(function(){var o,r,n,a,l,c;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),o=t.collab_client_vars.rev,r=t.collab_client_vars.padSubId,n=t.collab_client_vars.client.upid,[4,this.preFetchSingleSubBlockData(e,n,r,o)];case 1:return(a=i.sent()).error?[2,a]:(l=a.data.data,t.collab_client_vars.client=Object.assign(l.collab_client_vars.client,{upid:n}),t.collab_client_vars.pver=l.collab_client_vars.pver,t.collab_client_vars.apid=l.collab_client_vars.apid,t.collab_client_vars.wmode=l.collab_client_vars.wmode,t.collab_client_vars.websocketReopenCount=l.collab_client_vars.websocketReopenCount,t.collab_client_vars.pollingAttemptNumber=l.collab_client_vars.pollingAttemptNumber,t.userInfo=l.userInfo,[2,new s.Result(void 0,t)]);case 2:return c=i.sent(),[2,new s.Result(c)];case 3:return[2]}}))}))},e.prototype.getPadInfo=function(e,t){return void 0===t&&(t=c.PadIdType.GLOBAL),n(this,void 0,void 0,(function(){var o,r;return i(this,(function(n){switch(n.label){case 0:switch(o=s.QueryCondition.newInstance().addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),t){case c.PadIdType.GLOBAL:o.addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e);break;case c.PadIdType.SECRET:o.addCondition("secretId",s.QUERY_CONDITION_TYPE.ONLY,e)}return[4,this.database.get(c.TableName.PAD_INFO,o)];case 1:return(r=n.sent()).error?(y.default.error(r.error),[2,null]):[2,r.data]}}))}))},e.prototype.storeNewDocData=function(e,t,o,r,a,l){var s;return void 0===l&&(l=!1),n(this,void 0,void 0,(function(){var n,d,u,p,f;return i(this,(function(i){switch(i.label){case 0:return n=Date.now()/1e3,(d=this.generatorPadInfo({globalPadId:o,localPadId:a.localPadId,secretId:r,padType:e,folder:t,dver:a.collab_client_vars.dver,initTitle:a.padTitle,time:n,isShareme:l})).creator_domain=this.getDomainId(o),(u=this.clientVars2OfflineData(o,a,!0)).padStatus=h.PadStatus.LOCAL,p={globalPadId:o,secretId:r,uid:d.uid,lastSyncTime:n},[4,this.database.updateMultiTableData([{tableName:c.TableName.PAD_INFO,data:d},{tableName:c.TableName.DOCUMENT_DATA,data:u},{tableName:c.TableName.DOCUMENT_STATUS,data:p}])];case 1:return(f=i.sent()).error?(y.default.error("storeNewDocData 写入新文档数据发生异常",null===(s=f.error)||void 0===s?void 0:s.stack),[2,f]):[2,f]}}))}))},e.prototype.preCreateDoc=function(){return n(this,void 0,void 0,(function(){var e,o,r,n;return i(this,(function(i){switch(i.label){case 0:return(e=s.QueryCondition.newInstance()).addCondition("isCreated",s.QUERY_CONDITION_TYPE.ONLY,!1),[4,this.database.getAll(c.TableName.NEW_DOCUMENT_ID,e)];case 1:return(o=i.sent()).error&&!s.isNoResultError(o.error)?[2,o]:(r=o.data)&&r.length>t.LocalNewMaxNum?[2,this.preCreateDefaultClientVars(r)]:[4,this.parent.preFetchDocIds()];case 2:return(n=i.sent()).error?(y.default.error(n.error,"预拉异常"),[2,null]):[2,this.preCreateDoc()]}}))}))},e.prototype.updatePreFetchIdInfo=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return(new s.QueryCondition).addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,e.globalPadId),[4,this.database.updateMultiTableData([{tableName:c.TableName.NEW_DOCUMENT_ID,data:e}])];case 1:return t.sent(),[2]}}))}))},e.prototype.checkLocalClientVars=function(){return n(this,void 0,void 0,(function(){var e,t,o,r;return i(this,(function(n){switch(n.label){case 0:return e=[h.FILE_TYPE.WORD,h.FILE_TYPE.EXCEL,h.FILE_TYPE.SLIDE],t=s.QueryCondition.newInstance().addCondition("docType",s.QUERY_CONDITION_TYPE.IN,e).addCondition("padStatus",s.QUERY_CONDITION_TYPE.ONLY,h.PadStatus.NEW).addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),o=new s.Result(void 0,{DocNum:0,ExcelNum:0,SlideNum:0}),[4,this.database.getAll(c.TableName.DOCUMENT_DATA,t)];case 1:return(r=n.sent()).error?(y.default.error(r.error,"读取本地预创建文档数据失败"),o.error=r.error,[2,o]):(r&&r.data&&r.data.forEach((function(e){e.docType===h.FILE_TYPE.EXCEL?o.data.ExcelNum=o.data.ExcelNum+1:e.docType===h.FILE_TYPE.WORD?o.data.DocNum=o.data.DocNum+1:e.docType===h.FILE_TYPE.SLIDE&&(o.data.SlideNum=o.data.SlideNum+1)})),[2,o])}}))}))},e.prototype.updateFolderChildren=function(e,t){var o;return void 0===e&&(e="/"),n(this,void 0,void 0,(function(){var r,n;return i(this,(function(i){switch(i.label){case 0:return(r=new s.QueryCondition).addCondition("key",s.QUERY_CONDITION_TYPE.IN,[this.parent.user.getUserId()+e]),[4,this.database.get(c.TableName.FOLDER_INFO,r)];case 1:return(n=i.sent()).error?(y.default.error("updateFolderChildren() getPadInfo error。",null===(o=n.error)||void 0===o?void 0:o.stack),[2,new s.Result(new Error("GetPadInfoError"))]):(n.data.childrenKey||(n.data.childrenKey=[]),n.data.childrenKey.push(t),[2,this.database.update(c.TableName.FOLDER_INFO,n.data)])}}))}))},e.prototype.getDomainId=function(e){return e.split("$")&&e.split("$").length?e.split("$")[0]:""},e.prototype.getDefaultInitTitle=function(e){var t="无标题文档";switch(e){case h.FILE_TYPE.WORD:t="无标题文档";break;case h.FILE_TYPE.EXCEL:t="无标题表格";break;case h.FILE_TYPE.SLIDE:t="无标题幻灯片"}return t},e.prototype.generatorPadInfo=function(e){var t=e.globalPadId,o=e.secretId,n=e.localPadId,i=e.padType,a=e.folder,l=e.dver,s=e.time,c=void 0===s?Date.now()/1e3:s,d=e.isShareme,u=void 0!==d&&d,p=new h.PadInfo(this.parent.user),f=this.parent.user.getUserId()+t,m=this.getDomainId(t);return r(r({},p),{key:f,type:i,uid:this.parent.user.getUserId(),globalPadId:t,domain_id:m,secretId:o,title:e.initTitle||this.getDefaultInitTitle(i),pad_id:n,status:h.PadStatus.NEW,creator:this.parent.user.getUserId(),create_ts:c,doc_type:i,isMydoc:!0,isMyCreated:!0,isRencent:!0,isShareme:!0===u,isOfflineCache:!0,dver:l,doc_type_desc:h.typeMap[i],doc_url:"//docs.qq.com/"+h.typeMap[i]+"/"+o,folder:a,privilege:0,last_modify_ts:c,last_browse_ts:c})},e.prototype.createPadInfo=function(e,t,o){return n(this,void 0,void 0,(function(){var r,n,a,l,d,u;return i(this,(function(i){switch(i.label){case 0:return(r=s.QueryCondition.newInstance()).addCondition("isCreated",s.QUERY_CONDITION_TYPE.IN,[!0]),r.addCondition("padType",s.QUERY_CONDITION_TYPE.ONLY,e),[4,this.database.get(c.TableName.NEW_DOCUMENT_ID,r)];case 1:return(n=i.sent()).error?((r=s.QueryCondition.newInstance()).addCondition("isCreated",s.QUERY_CONDITION_TYPE.ONLY,!1),[4,this.database.get(c.TableName.NEW_DOCUMENT_ID,r)]):[3,6];case 2:return(n=i.sent()).error?[4,this.preCreateDoc()]:[3,5];case 3:return i.sent(),(r=s.QueryCondition.newInstance()).addCondition("isCreated",s.QUERY_CONDITION_TYPE.IN,[!0]),r.addCondition("padType",s.QUERY_CONDITION_TYPE.ONLY,e),[4,this.database.get(c.TableName.NEW_DOCUMENT_ID,r)];case 4:return[2,n=i.sent()];case 5:n.data&&this.createDefaultClientVarsAndWriteDB(n.data),i.label=6;case 6:return this.parent.user&&this.parent.user.getUserId()?(a=n.data)?(l=this.getDverWithPadType(e),d=Date.now()/1e3,u=this.generatorPadInfo({globalPadId:a.globalPadId,secretId:a.secretId,localPadId:a.localPadId,padType:e,folder:t,dver:l,time:d,isShareme:o}),r=s.QueryCondition.newInstance().addCondition("globalPadId",s.QUERY_CONDITION_TYPE.ONLY,a.globalPadId),[4,this.database.delete(c.TableName.NEW_DOCUMENT_ID,r)]):(y.default.error({retcode:-1,reason:"indexDB has not NewDocumentIds!"}),[2,new s.Result(new Error("NoAvaliableIdError"))]):[2,new s.Result(new Error("UidError"))];case 7:return i.sent(),[4,this.database.set(c.TableName.PAD_INFO,u)];case 8:return i.sent(),[4,this.updateFolderChildren(t,u.key)];case 9:return i.sent(),this.preCreateDoc(),[2,new s.Result(void 0,u)]}}))}))},e.prototype.createPadInfoFromClientVars=function(e){return n(this,void 0,void 0,(function(){var t,o;return i(this,(function(r){switch(r.label){case 0:return t=e.globalPadId,[4,this.getPadInfo(t)];case 1:return r.sent()||(o=this.buildPadInfo(e))&&(y.default.log("更新padInfo：",o),this.database.set(c.TableName.PAD_INFO,o)),[2]}}))}))},e.prototype.getManualPadInfo=function(e){return n(this,void 0,void 0,(function(){var t,o,r;return i(this,(function(n){switch(n.label){case 0:return t=this.parent.user.getUserId(),o=s.QueryCondition.newInstance().addCondition("uid",s.QUERY_CONDITION_TYPE.ONLY,t).addCondition("isManualOffline",s.QUERY_CONDITION_TYPE.ONLY,!0).addCondition("secretId",s.QUERY_CONDITION_TYPE.ONLY,e),[4,this.database.get(c.TableName.PAD_INFO,o)];case 1:return(r=n.sent()).error&&y.default.error("查询失败",r.error),[2,r]}}))}))},e.prototype.setDefaultCodeVersion=function(e,t){this.defaultCodeVersion.set(e,t),localStorage.setItem(e+"_code_version",t)},e.prototype.getCodeVersion=function(e){return this.defaultCodeVersion.get(e)||localStorage.getItem(e+"_code_version")||""},e.prototype.getDverWithPadType=function(e){return e===h.FILE_TYPE.EXCEL?this.getCodeVersion("sheet"):e===h.FILE_TYPE.WORD?this.getCodeVersion("doc"):e===h.FILE_TYPE.SLIDE?this.getCodeVersion("slide"):void 0},e.prototype.getTypeStringWithPadType=function(e){return e===h.FILE_TYPE.EXCEL?"sheet":e===h.FILE_TYPE.WORD?"word":e===h.FILE_TYPE.SLIDE?"slide":void 0},e}();t.BaseBusinessHelper=b},,,,,,,function(e,t,o){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UnknownError=-1]="UnknownError",e[e.Success=0]="Success",e[e.NoGlobalPadIdError=-1001]="NoGlobalPadIdError",e[e.InvalidFileTypeError=-1002]="InvalidFileTypeError",e[e.InvalidUrlError=-1003]="InvalidUrlError",e[e.PreloadParseError=-1004]="PreloadParseError",e[e.AIOUrlTypeError=-1005]="AIOUrlTypeError",e[e.GetDocumentStatusError=-2001]="GetDocumentStatusError",e[e.RejcectByThrottleError=-2002]="RejcectByThrottleError",e[e.GetDocLockError=-2003]="GetDocLockError",e[e.GetUncommitDataError=-2004]="GetUncommitDataError",e[e.CreateFileError=-2005]="CreateFileError",e[e.CommitOfflineDataError=-2006]="CommitOfflineDataError",e[e.UpdateUnCommitedDataError=-2007]="UpdateUnCommitedDataError",e[e.PreFetchDocDataError=-2008]="PreFetchDocDataError",e[e.UpdatePreFetchOfflienDataError=-2009]="UpdatePreFetchOfflienDataError",e[e.UpdatePadInfoError=-2010]="UpdatePadInfoError",e[e.SyncOfflineDataUnknownError=-2011]="SyncOfflineDataUnknownError",e[e.PadInfoNotExistError=-2012]="PadInfoNotExistError",e[e.FileNotExsitError=-2013]="FileNotExsitError",e[e.HttpStatusError=-2014]="HttpStatusError",e[e.DocumentBlankPageError=-2015]="DocumentBlankPageError"}(r=t.SyncResultCode||(t.SyncResultCode={}));var n=function(e,t,o,n){this.subResultCode=-1,this.resultCode=e,this.message=t||r[e],void 0!==n&&(this.subResultCode=n),this.error=o};t.ErrorSyncResult=n},function(e,t,o){"use strict";var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,l=o(41),s=o(14),c=o(14),d=i(o(39));!function(e){e.POST="POST",e.GET="GET"}(a||(a={})),t.Method=a,function(e){e[e.privilegeAttribute=1]="privilegeAttribute",e[e.title=2]="title"}(t.PadInfoKey||(t.PadInfoKey={}));var u=function(){function e(){}return e.transferHide2Normal=function(e){return r(this,void 0,void 0,(function(){var t;return n(this,(function(o){switch(o.label){case 0:return"/cgi-bin/online_docs/doc_transferhidetonormal",t="'encrypted_doc_id="+e,[4,this.sendCommonRequest("/cgi-bin/online_docs/doc_transferhidetonormal",a.POST,t)];case 1:return[2,o.sent()]}}))}))},e.notifyOpenDoc=function(e){return r(this,void 0,void 0,(function(){var t;return n(this,(function(o){switch(o.label){case 0:return"/cgi-bin/online_docs/doc_broselistadd?t=1",t="'encrypted_doc_id="+e,[4,this.sendCommonRequest("/cgi-bin/online_docs/doc_broselistadd?t=1",a.POST,t)];case 1:return[2,o.sent()]}}))}))},e.fetchDocDataSlide=function(e,t){return void 0===t&&(t=!1),r(this,void 0,void 0,(function(){var o;return n(this,(function(r){switch(r.label){case 0:return o="https://docs.qq.com/dop-api/slide/data/get?id="+e+"&normal=1&prefetch=1&offline=1",[4,this.sendCommonRequest(o,a.GET,"",t?void 0:"custom")];case 1:return[2,r.sent()]}}))}))},e.fetchDocData=function(e,t,o,i){return void 0===o&&(o=!0),void 0===i&&(i=!1),r(this,void 0,void 0,(function(){var r,s;return n(this,(function(n){switch(n.label){case 0:return t&&t.indexOf("?")>-1||(t+="?"),"preview_token",r=l.getCookie("preview_token"),s="/dop-api/opendoc"+t+(o&&"&prefetch=1")+(i?"&outformat=1":"")+"&normal=1&id="+e+"&key="+r,[4,this.sendCommonRequest(s,a.GET,"",i?void 0:"custom")];case 1:return[2,n.sent()]}}))}))},e.getPadInfo=function(e,t){return r(this,void 0,void 0,(function(){var o;return n(this,(function(r){switch(r.label){case 0:return o="/cgi-go/padinfo/getpadinfo?encodePadId="+e+(t?"&infoKeys=["+t+"]":"")+"&xsrf="+l.getXsrf(),[4,this.sendCommonRequest(o,a.GET)];case 1:return[2,r.sent()]}}))}))},e.sendCommonRequest=function(e,t,o,i){return void 0===t&&(t=a.GET),r(this,void 0,void 0,(function(){return n(this,(function(r){return[2,new Promise((function(r,n){try{var a,l=new XMLHttpRequest;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE){var t="";if(200===l.status)try{t=i&&"custom"===i?l.responseText:JSON.parse(l.responseText)}catch(t){d.default.error("sendCommonRequest failed: query:"+e+", responseText:"+l.responseText+" error:"+t),a=t}else a=new c.HttpError(l.status,0,"StatusError");r(new s.Result(a,t))}};try{l.timeout=3e4}catch(e){}l.ontimeout=function(){a=new Error("TimeOutError"),r(new s.Result(a))},l.open(t,e),l.setRequestHeader("content-type","application/x-www-form-urlencoded"),l.send(o)}catch(e){r(new s.Result(e))}}))]}))}))},e}();t.CGI=u},,,,,,,,,,,,function(e,t,o){"use strict";function r(){var e=window.location.pathname.split("/").pop();return e||(e=""),e}function n(e){return new URL(e).pathname.split("/").pop()||""}function i(e,t){var o=e.split("."),r=t.split(".");return o[0]===r[0]&&o[1]===r[1]}o.d(t,"a",(function(){return r})),o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return i}))},,,,,,,,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.uid=e.uid||"",this.uin=e.uin?e.uin:"",this.loginTime=(new Date).getTime()}return e.prototype.getUserId=function(){return this.uid},e.prototype.setUserId=function(e){this.uid=e},e}();t.UserInfo=r},function(e,t,o){"use strict";var r,n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ONCE=0]="ONCE",e[e.RETRY=1]="RETRY"}(r||(r={})),t.LockStrategy=r;var i=function(){function e(e){this.tabId=this.getTabID(),e=e?n(n({},this.getDefaultConfig()),e):this.getDefaultConfig(),this.strategy=e.strategy,this.period=e.period,this.autoRenewal=e.autoRenewal}return e.prototype.getTabID=function(){var e=new Date;return 1+e.getMonth()+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+":"+e.getMilliseconds()+" "+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)},e.prototype.renewal=function(e,t){},e.DEBUG=!1,e.DEFAULT_CONFIG={strategy:r.ONCE,period:3e5,autoRenewal:!0},e.renewalHanlder=new Map,e}();t.MutexLock=i},,,,,,,,function(e,t,o){var r,n;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(n="function"==typeof(r=i)?r.call(t,o,t,e):r)||(e.exports=n),!0,e.exports=i(),!!0){var a=window.Cookies,l=window.Cookies=i();l.noConflict=function(){return window.Cookies=a,l}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var o=arguments[e];for(var r in o)t[r]=o[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function o(r){function n(){}function i(t,o,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},n.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(o);/^[\{\[]/.test(a)&&(o=a)}catch(e){}o=r.write?r.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var l="";for(var s in i)i[s]&&(l+="; "+s,!0!==i[s]&&(l+="="+i[s].split(";")[0]));return document.cookie=t+"="+o+l}}function a(e,o){if("undefined"!=typeof document){for(var n={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var l=i[a].split("="),s=l.slice(1).join("=");o||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var c=t(l[0]);if(s=(r.read||r)(s,c)||t(s),o)try{s=JSON.parse(s)}catch(e){}if(n[c]=s,e===c)break}catch(e){}}return e?n[e]:n}}return n.set=i,n.get=function(e){return a(e,!1)},n.getJSON=function(e){return a(e,!0)},n.remove=function(t,o){i(t,"",e(o,{expires:-1}))},n.defaults={},n.withConverter=o,n}((function(){}))}))},,,,,,,,,,,,,,,,function(e,t,o){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(93),s=o(45),c=o(14),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDefaultConfig=function(){return{strategy:l.LockStrategy.ONCE,period:-1,autoRenewal:!0}},t.prototype.lock=function(e,t){return i(this,void 0,void 0,(function(){var o,r,n;return a(this,(function(i){switch(i.label){case 0:return o={tabId:this.tabId,expire:-1===this.period?-1:Date.now()+this.period,optional:t},r={command:"lock",key:e,item:o},s.DEBUG&&console.log("-----ClientMutexLockReqeust",r),[4,new Promise((function(e){c.JSApi.invokeNative("docx","clientMutexLock",r,(function(t){if(s.DEBUG&&console.log("-----ClientMutexLockResponse:",t),t.err_msg||t.err_code){var o=new Error(t.err_msg||t.err_code);e(new c.Result(o))}else e(new c.Result(void 0,t.result))}))}))];case 1:return(n=i.sent()).error?[2,{isSuccess:!1,data:n.data}]:n.data.tabId===this.tabId?[2,{isSuccess:!0,data:n.data}]:[2,{isSuccess:!1,data:n.data}]}}))}))},t.prototype.detectKey=function(e){return i(this,void 0,void 0,(function(){var t,o,r;return a(this,(function(n){switch(n.label){case 0:return t={command:"detectKey",key:e},s.DEBUG&&console.log("-----ClientMutexLockReqeust",t),[4,new Promise((function(e){c.JSApi.invokeNative("docx","clientMutexLock",t,(function(t){s.DEBUG&&console.log("-----ClientMutexLockResponse:",t),e(t)}))}))];case 1:return o=n.sent(),r=new c.Result(void 0,o.result),o.err_code?(r.error=new c.BaseError(""+o.err_code),[2,r]):[2,r]}}))}))},t.prototype.release=function(e){return i(this,void 0,void 0,(function(){var t;return a(this,(function(o){switch(o.label){case 0:return t={command:"release",key:e},s.DEBUG&&console.log("-----ClientMutexLockReqeust",t),[4,new Promise((function(e,o){c.JSApi.invokeNative("docx","clientMutexLock",t,(function(t){if(s.DEBUG&&console.log("-----ClientMutexLockResponse:",t),t.err_msg||t.err_code){var o=new Error(t.err_msg||t.err_code);e(new c.Result(o))}else e(new c.Result(void 0,t.result))}))}))];case 1:return o.sent().error?[2,!1]:[2,!0]}}))}))},t}(l.MutexLock);t.ClientMutexLock=d,t.default=d},function(e,t,o){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(93),d=s(o(39)),u=o(14),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getDefaultConfig=function(){return{strategy:c.LockStrategy.ONCE,period:3e5,autoRenewal:!0}},t.prototype.getXKey=function(e){return t.PREFIX_LOCK_X+"_"+e},t.prototype.getYKey=function(e){return t.PREFIX_LOCK_Y+"_"+e},t.prototype.tryToLockKey=function(e,o,r,n){var i=this,a=this.getXKey(e),l=this.getYKey(e);t.DEBUG&&d.default.log("tryToLockKey(). strategy="+this.strategy+" lockX="+a+" lockY="+l),localStorage.setItem(a,this.tabId);var s=localStorage.getItem(l);if(t.DEBUG&&d.default.log("tryToLockKey(). strategy="+this.strategy+" lockX="+a+" lockY="+l+" valueY="+s),s){var u=JSON.parse(s);if(u.expire>Date.now())return t.DEBUG&&d.default.log("tryToLockKey(). 被其他tab拿到了Y锁 strategy="+this.strategy+" lockX="+a+" lockY="+l+" valueY="+s),d.default.log("有其他tab已经拿到了Y锁"),void(this.strategy===c.LockStrategy.ONCE?n(u):setTimeout((function(){return i.tryToLockKey(e,o,r,n)})))}var p={tabId:this.tabId,expire:Date.now()+this.period,optional:o};localStorage.setItem(l,JSON.stringify(p)),t.DEBUG&&d.default.log("tryToLockKey(). 写入Y锁. strategy="+this.strategy+" lockX="+a+" lockY="+l+" valueY="+s+" lockItemY="+p);var h=localStorage.getItem(a);t.DEBUG&&d.default.log("tryToLockKey(). 查看X锁. strategy="+this.strategy+" lockX="+a+" lockY="+l+" valueY="+s+" valueX="+h),h!==this.tabId?setTimeout((function(){var u=!1;s=localStorage.getItem(l);var p=JSON.parse(s||"{}");t.DEBUG&&d.default.log("tryToLockKey(). 再次查看Y锁. strategy="+i.strategy+" lockX="+a+" lockY="+l+" valueY="+s+" valueX="+h),s&&p.tabId===i.tabId&&p.expire>Date.now()&&(u=!0),u?(t.DEBUG&&d.default.log("tryToLockKey(). 竞争锁成功. strategy="+i.strategy+" lockX="+a+" lockY="+l),r(p)):i.strategy===c.LockStrategy.ONCE?(t.DEBUG&&d.default.log("tryToLockKey(). 竞争锁失败. strategy="+i.strategy+" lockX="+a+" lockY="+l),n(p)):(t.DEBUG&&d.default.log("tryToLockKey(). 竞争锁失败，重新竞争. strategy="+i.strategy+" lockX="+a+" lockY="+l),setTimeout((function(){return i.tryToLockKey(e,o,r,n)})))})):(t.DEBUG&&d.default.log("tryToLockKey(). 竞争锁成功. strategy="+this.strategy+" lockX="+a+" lockY="+l),r(p))},t.prototype.lock=function(e,t){return a(this,void 0,void 0,(function(){var o=this;return l(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r,n){o.tryToLockKey(e,t,r,n)})).then((function(t){return o.autoRenewal&&o.renewal(e,o.period),{isSuccess:!0,data:t}}),(function(t){var r=o.getXKey(e);return localStorage.getItem(r)===o.tabId&&localStorage.removeItem(r),{isSuccess:!1,data:t}}))];case 1:return[2,r.sent()]}}))}))},t.prototype.detectKey=function(e){return a(this,void 0,void 0,(function(){var t,o,r,n;return l(this,(function(i){return t=this.getYKey(e),o=new u.Result(void 0,void 0),(r=localStorage.getItem(t))&&(n=JSON.parse(r)).expire>Date.now()&&(o.data=n),[2,o]}))}))},t.prototype.release=function(e){return a(this,void 0,void 0,(function(){var o,r,n,i;return l(this,(function(a){return o=this.getXKey(e),r=this.getYKey(e),(n=localStorage.getItem(r))&&JSON.parse(n).tabId===this.tabId&&(t.DEBUG&&d.default.log("releaseKey(). 释放锁. strategy="+this.strategy+" key="+e),localStorage.removeItem(r),localStorage.getItem(o)===this.tabId&&localStorage.removeItem(o)),(i=t.renewalHanlder.get(e))&&(clearTimeout(i),t.renewalHanlder.delete(e)),[2,!0]}))}))},t.prototype.renewal=function(e,o){var r=this,n=t.renewalHanlder.get(e);n&&clearTimeout(n);var a=setTimeout((function(){t.DEBUG&&d.default.log("renewal(). 自动续期锁. strategy="+r.strategy+" key="+e+" period="+o);var n=r.getYKey(e),a=localStorage.getItem(n);if(a){var l=JSON.parse(a);if(l.tabId===r.tabId){var s=i(i({},l),{expire:Date.now()+r.period});localStorage.setItem(r.getYKey(e),JSON.stringify(s)),r.renewal(e,o)}else d.default.error("自动续期失败，Y锁已经被其他地方占有了。",l)}else d.default.error("Y锁没有读到值")}),.85*o);return t.renewalHanlder.set(e,a),a},t.PREFIX_LOCK_X="prefix_lock_x",t.PREFIX_LOCK_Y="prefix_lock_y",t}(c.MutexLock);t.MultiTabLock=p,t.default=p},function(e,t,o){"use strict";var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=i(o(175)),s=i(o(194)),c=i(o(195)),d=o(45),u=a(o(14)),p=o(40),h=o(92),f=o(41),m=o(14),y=i(o(39)),g=o(14),v=o(3);t.MaxIDCount=50;var _=function(){function e(e){this.options=e,e&&void 0!==e.businessType&&(this.businessType=e.businessType);var t=f.getCookie("uid");e&&e.user?this.user=e.user:this.user=t?new h.UserInfo({uid:t}):new h.UserInfo({uid:"guest"}),y.default.log("OfflineDataManager",this.user.getUserId())}return e.prototype.init=function(){return r(this,void 0,void 0,(function(){var e,t,o;return n(this,(function(r){switch(r.label){case 0:return e=new u.default(this.checkReleaseEvn()?d.DB_NAME:d.DB_NAME_TESTENV,[{tableName:d.TableName.DOCUMENT_DATA,keyName:"key",indexs:["globalPadId","secretId","type","version"]},{tableName:d.TableName.OFFLINE_DATA,keyName:"key",indexs:["globalPadId","secretId","type","version"]},{tableName:d.TableName.PAD_INFO,keyName:"key",indexs:["globalPadId","secretId"]},{tableName:d.TableName.NEW_DOCUMENT_ID,keyName:"globalPadId"},{tableName:d.TableName.FOLDER_INFO,keyName:"key"},{tableName:d.TableName.USER_INFO,keyName:"uid"},{tableName:d.TableName.DOCUMENT_STATUS,keyName:"globalPadId",indexs:["globalPadId","secretId"]},{tableName:d.TableName.DATA_CHANGE,keyName:"key"}],f.isSupportClientDB()&&!f.checkDebugOffline()?g.DBDriver.ClientDB:g.DBDriver.IndexDB,d.DB_VERSION),this.database=e.database,[4,this.database.init()];case 1:return(t=r.sent()).error?(y.default.error(t.error),[2,t]):(y.default.log("init IndexedDB success"),o={parent:this,database:this.database},this.businessType===p.FILE_TYPE.EXCEL?this.excelHelper=new l.default(o):this.businessType===p.FILE_TYPE.WORD?this.wordHelper=new s.default(o):(this.businessType===p.FILE_TYPE.SLIDE||(this.excelHelper=new l.default(o),this.wordHelper=new s.default(o)),this.slideHelper=new c.default(o)),[2,new m.Result(void 0,!0)])}}))}))},e.prototype.getHelper=function(e){var t;if(void 0===e&&(e=this.businessType),e===p.FILE_TYPE.EXCEL)t=this.excelHelper;else if(e===p.FILE_TYPE.WORD)t=this.wordHelper;else{if(e!==p.FILE_TYPE.SLIDE)throw new Error("没有指定businessType的情况下 getHepler必须明确指定FILE_TYPE来获取对应的helper.");t=this.slideHelper}return t},e.prototype.getDatabase=function(){return this.database},e.prototype.getDocumentId=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){return(e=u.QueryCondition.newInstance()).addCondition("isCreated",u.QUERY_CONDITION_TYPE.ONLY,!1),[2,this.database.get(d.TableName.NEW_DOCUMENT_ID,e)]}))}))},e.prototype.popDocumentId=function(){return r(this,void 0,void 0,(function(){var e,t,o;return n(this,(function(r){switch(r.label){case 0:return this.user&&this.user.getUserId()?[4,this.getDocumentId()]:[2,new m.Result(new Error("UidError"))];case 1:return(e=r.sent()).error?[4,this.preFetchDocIds()]:[3,4];case 2:return r.sent(),[4,this.getDocumentId()];case 3:e=r.sent(),r.label=4;case 4:return(t=e.data)?(o=u.QueryCondition.newInstance().addCondition("globalPadId",u.QUERY_CONDITION_TYPE.ONLY,t.globalPadId),[4,this.database.delete(d.TableName.NEW_DOCUMENT_ID,o)]):(y.default.error({retcode:-1,reason:"indexDB has not NewDocumentIds!"}),[2,new m.Result(new Error("NoAvaliableIdError"))]);case 5:return r.sent(),this.preFetchDocIds(),[2,new m.Result(void 0,t)]}}))}))},e.prototype.preFetchDocIds=function(){return r(this,void 0,void 0,(function(){var e,o,r,i,a,l,s,c,h;return n(this,(function(n){switch(n.label){case 0:return(e=u.QueryCondition.newInstance()).addCondition("isCreated",u.QUERY_CONDITION_TYPE.ONLY,!1),[4,this.database.getAll(d.TableName.NEW_DOCUMENT_ID,e)];case 1:return(o=n.sent()).error?[2,o]:(r=o.data)&&r.length>.5*t.MaxIDCount?[2,new m.Result(new Error("ID还剩下超过一半，不用拉新的了。"),{count:r.length})]:("https://docs.qq.com/cgi-bin/online_docs/predocid_get",[4,v.CGI.sendCommonRequest("https://docs.qq.com/cgi-bin/online_docs/predocid_get")]);case 2:if((i=n.sent()).error)return[2,i];a=i.data,n.label=3;case 3:return n.trys.push([3,6,,7]),0!==a.retcode?[3,5]:(l=a.doc_id_list.splice(0,t.MaxIDCount),s=l.map((function(e){return{globalPadId:e.domain_id+"$"+e.pad_id,localPadId:""+e.pad_id,secretId:""+e.encoded_doc_id,isCreated:!1,padType:p.FILE_TYPE.UNKNOWN}})),c=s.map((function(e){return{tableName:d.TableName.NEW_DOCUMENT_ID,data:e}})),[4,this.database.updateMultiTableData(c)]);case 4:return[2,n.sent()];case 5:return y.default.error("后台retCode不为0"),[2,new m.Result(new Error(""))];case 6:return h=n.sent(),y.default.error(h,"处理数据异常"),[2,new m.Result(h)];case 7:return[2]}}))}))},e.prototype.checkEvn=function(){return r(this,void 0,void 0,(function(){var e,t,o,r;return n(this,(function(n){return e=localStorage.getItem("last_dev_route_id"),t=localStorage.getItem("last_fd"),o=f.getCookie("dev_route_id"),r=f.getCookie("fd"),e!==o||t!==r?(this.setEvn(o,r),[2,!0]):(this.setEvn(o,r),[2,!1])}))}))},e.prototype.setEvn=function(e,t){localStorage.setItem("last_dev_route_id",e),localStorage.setItem("last_fd",t)},e.prototype.checkReleaseEvn=function(){var e=f.getCookie("dev_route_id");return!e||-1!==["3","113","274"].indexOf(e)},e.prototype.mapDocumentVersion=function(e,t){y.default.debug("mapDocumentVersion  "+t+":"+e),f.UserAgent.isDesktop?this.sendCommandToSW({type:"preload-map-document-version",data:{url:t,dver:e}}):window.mqq&&window.mqq.invoke("docx","mapDocumentVersion",{url:t,dver:e},(function(e){y.default.info("mapDocumentVersion "+JSON.stringify(e))}))},e.prototype.removeDocumentVersion=function(e){y.default.debug("removeDocumentVersion "+e),f.UserAgent.isDesktop?this.sendCommandToSW({type:"preload-remove-document-version",data:e}):window.mqq&&window.mqq.invoke("docx","removeDocumentVersion",{url:e},(function(e){y.default.info("removeDocumentVersion "+JSON.stringify(e))}))},e.prototype.sendCommandToSW=function(e){navigator.serviceWorker.controller?(y.default.debug("send command to service worker "+JSON.stringify(e)),navigator.serviceWorker.controller.postMessage(e)):y.default.error("service worker is not available")},e}();t.OfflineDataManager=_},function(e,t,o){"use strict";e.exports=function(e,t){return function(){for(var o=new Array(arguments.length),r=0;r<o.length;r++)o[r]=arguments[r];return e.apply(t,o)}}},function(e,t,o){"use strict";var r=o(31);function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,o){if(!t)return e;var i;if(o)i=o(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(n(t)+"="+n(e))})))})),i=a.join("&")}if(i){var l=e.indexOf("#");-1!==l&&(e=e.slice(0,l)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},function(e,t,o){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,o){"use strict";(function(t){var r=o(31),n=o(183),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,s={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(l=o(124)),l),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};s.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){s.headers[e]=r.merge(i)})),e.exports=s}).call(this,o(182))},function(e,t,o){"use strict";var r=o(31),n=o(184),i=o(121),a=o(186),l=o(189),s=o(190),c=o(125);e.exports=function(e){return new Promise((function(t,d){var u=e.data,p=e.headers;r.isFormData(u)&&delete p["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",m=e.auth.password||"";p.Authorization="Basic "+btoa(f+":"+m)}var y=a(e.baseURL,e.url);if(h.open(e.method.toUpperCase(),i(y,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var o="getAllResponseHeaders"in h?l(h.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:o,config:e,request:h};n(t,d,r),h=null}},h.onabort=function(){h&&(d(c("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){d(c("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),d(c(t,e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var g=o(191),v=(e.withCredentials||s(y))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;v&&(p[e.xsrfHeaderName]=v)}if("setRequestHeader"in h&&r.forEach(p,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete p[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),d(e),h=null)})),void 0===u&&(u=null),h.send(u)}))}},function(e,t,o){"use strict";var r=o(185);e.exports=function(e,t,o,n,i){var a=new Error(e);return r(a,t,o,n,i)}},function(e,t,o){"use strict";var r=o(31);e.exports=function(e,t){t=t||{};var o={},n=["url","method","params","data"],i=["headers","auth","proxy"],a=["baseURL","url","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"];r.forEach(n,(function(e){void 0!==t[e]&&(o[e]=t[e])})),r.forEach(i,(function(n){r.isObject(t[n])?o[n]=r.deepMerge(e[n],t[n]):void 0!==t[n]?o[n]=t[n]:r.isObject(e[n])?o[n]=r.deepMerge(e[n]):void 0!==e[n]&&(o[n]=e[n])})),r.forEach(a,(function(r){void 0!==t[r]?o[r]=t[r]:void 0!==e[r]&&(o[r]=e[r])}));var l=n.concat(i).concat(a),s=Object.keys(t).filter((function(e){return-1===l.indexOf(e)}));return r.forEach(s,(function(r){void 0!==t[r]?o[r]=t[r]:void 0!==e[r]&&(o[r]=e[r])})),o}},function(e,t,o){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.listTypeOffline=-1]="listTypeOffline",e[e.listTypeAll=1]="listTypeAll",e[e.listTypeCreated=2]="listTypeCreated",e[e.listTypeTrash=3]="listTypeTrash",e[e.listTypeShared=4]="listTypeShared",e[e.listTypeMyDoc=5]="listTypeMyDoc",e[e.listTypeRecent=6]="listTypeRecent",e[e.listTypeStared=7]="listTypeStared",e[e.listTypeInSharedFolder=9]="listTypeInSharedFolder"}(t.AppDocsListType||(t.AppDocsListType={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){};t.DocumentId=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.uid=e.uid,this.globalPadId=e.globalPadId,this.secretId=e.secretId,this.lastSyncTime=e.lastSyncTime||Date.now()};t.DocumentStatus=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.convertData2ClientVars=function(e){},e.unpackEjsData=function(e){for(var t=0,o=e||"",r=o.length,n={};t<r;){var i=o.slice(t,t+50).split("\n");if(!(i&&i.length>=3))break;var a=i[0],l=i[1],s=parseInt(i[2]);t+=i[0].length+i[1].length+i[2].length+3;var c=o.slice(t,t+s);t+=s+1,n[a]={type:l},n[a].value="json"===l?JSON.parse(c):c}return n},e.updateClientVarsByEditPadInfo=function(e,t){e&&e.globalPadId===t.padInfo.globalPadId&&(t.privilegeAttribute&&(e.privilegeAttribute=t.privilegeAttribute),t.advPolicy&&(e.advPolicy=t.advPolicy),t.title&&(e.padTitle=t.title))},e}();t.ClientVarsHelper=r,t.default=r},function(e,t,o){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(58),d=o(45),u=o(14),p=o(57),h=o(40),f=o(66),m=o(41),y=o(65),g=s(o(39)),v=s(o(176)),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=d.DOC_TYPE.EXCEL,t}return n(t,e),t.prototype.preFetchSingleSubBlockData=function(e,t,o,r){return i(this,void 0,void 0,(function(){var n,i,l,s;return a(this,(function(a){switch(a.label){case 0:return n=this.getFetchUrl(e,t,r,o),[4,f.CGI.sendCommonRequest(n)];case 1:if((i=a.sent()).error)return[2,i];l=i.data;try{return"blankpage"===l.padType?(g.default.error("文档数据不存在"),[2,new u.Result(new Error("FileNotExsit"))]):(s="string"==typeof l?JSON.parse(l).clientVars:l.clientVars,[2,new u.Result(void 0,{gloabalPadId:s.globalPadId,blockId:o,rev:r,data:s,default:!1})])}catch(e){return g.default.error("处理数据异常"),[2,new u.Result(new Error("ParseResponseError"))]}return[2]}}))}))},t.prototype.getFetchUrl=function(e,t,o,r){return"/dop-api/opendoc?prefetch=1&outformat=1&normal=1"+(t?"&id="+t:"")+(e?"&padId="+e:"")+(r?"&tab="+r:"")+"&padinfo=1&rev="+o},t.prototype.unPackStreamData=function(e){var t={},o=/(.+)\n(.+)\n(.+)\n/g;do{var r=o.exec(e);if(r){var n=r[1],i=r[2],a=Number(r[3]),l=e.substr(r.index+r[0].length,a);try{t[n]="jsonText"===i||"json"===i?JSON.parse(l):l}catch(e){t[n]=l}o.lastIndex+=a}}while(o.lastIndex>0);return t},t.prototype.handlePreFetchDocData=function(e,t){var o,r,n;return i(this,void 0,void 0,(function(){var e,i,s,c,d,u,p,h,f,m,_,b,T,S,C,w,E;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),"blankpage"===(e="string"==typeof t?JSON.parse(t):t).padType||!0===e.isBlankPage?(g.default.error("文档数据不存在，或者无权限"),[2,{resultCode:y.SyncResultCode.PreFetchDocDataError,subResultCode:-200803,message:"handlePreFetchDocData excel 后台回包blankpage 文档数据不存在，或者无权限",error:new Error("DocumentBlankPageError")}]):(i=e.clientVars,s=i.globalPadId,c=i.collab_client_vars.rev,d=i.collab_client_vars.padSubId,[4,v.default({url:"/dop-api/sheet/data?padId="+s+"&rev="+c,method:"GET",responseType:"text"})]);case 1:return u=a.sent(),p=u.data,h=this.unPackStreamData(p),"blankpage"===(null===(o=h.head)||void 0===o?void 0:o.padType)?0!==(f=(null===(n=null===(r=h.head)||void 0===r?void 0:r.clientVars)||void 0===n?void 0:n.cgicode)||0)?[2,{resultCode:y.SyncResultCode.PreFetchDocDataError,subResultCode:f,message:"handlePreFetchDocData data接口后台回包cgi_code="+f+" 不为0",error:new Error("DocumentBlankPageError")}]:[2,{resultCode:y.SyncResultCode.PreFetchDocDataError,subResultCode:f||-200804,message:"handlePreFetchDocData data接口后台回包blankpage",error:new Error("DocumentBlankPageError")}]:(m=Number(h.rev),_=h.dVer||i.collab_client_vars.dver,b=Object.keys(h).filter((function(e){if(e.startsWith("chunk"))return!0})).map((function(e){var t=e.split("_");return{subId:t[1],chunkInfo:{startRow:Number(t[2]),endRow:Number(t[3]),data:h[e]}}})).sort((function(e,t){return e.subId===t.subId?e.chunkInfo.startRow-t.chunkInfo.startRow:e.subId>t.subId?1:-1})),T={gloabalPadId:i.globalPadId,secretId:i.collab_client_vars.client.upid,blockId:"document",rev:m,data:i,default:!0},S={},C=b.map((function(e){var t=S[e.subId]||0;return S[e.subId]=t+1,{gloabalPadId:i.globalPadId,secretId:i.collab_client_vars.client.upid,blockId:e.subId,chunkId:t,rev:m,data:e.chunkInfo,default:e.subId===d}})),w=l([T],C),[2,{resultCode:y.SyncResultCode.Success,subResultCode:0,message:"handlePreFetchDocData Success",data:{rev:m,dver:_,allBlockData:w}}]);case 2:return E=a.sent(),g.default.error("解析后台预拉数据异常",E),[2,{resultCode:y.SyncResultCode.PreFetchDocDataError,subResultCode:-200805,message:"handlePreFetchDocData excel Catch Error",error:E||new Error("ParseResponseError")}];case 3:return[2]}}))}))},t.prototype.buildPadInfo=function(e){var t=Date.now()/1e3,o=new h.PadInfo(this.parent.user);return Object.assign(o,{key:this.parent.user.getUserId()+e.globalPadId,type:h.FILE_TYPE.EXCEL,uid:this.parent.user.getUserId(),dver:e.collab_client_vars.dver||void 0,pad_id:e.localPadId,globalPadId:e.globalPadId,secretId:e.collab_client_vars.client.upid,title:e.padTitle,status:h.PadStatus.NORMAL,creator:this.parent.user.getUserId(),isOfflineCache:!0,create_ts:t,isRencent:!0,last_modify_ts:t,last_browse_ts:t,doc_type:h.FILE_TYPE.EXCEL,doc_type_desc:h.typeMap[h.FILE_TYPE.EXCEL],doc_url:"//docs.qq.com/sheet/"+e.collab_client_vars.client.upid,lastSyncTime:t})},t.prototype.blockData2OfflineData=function(e,t){var o,r=e.gloabalPadId,n=e.default;o="document"===e.blockId?p.OFFLINE_ITEM_TYPE.DOCUMENT:"workbook"===e.blockId?p.OFFLINE_ITEM_TYPE.WORKBOOK:p.OFFLINE_ITEM_TYPE.CHUNK;var i=this.parent.user.getUserId();return new p.OfflineData({uid:i,globalPadId:r,secretId:e.secretId,subSheetId:e.blockId,type:o,chunkId:e.chunkId,docType:h.FILE_TYPE.EXCEL,taskId:0,padStatus:h.PadStatus.NORMAL,version:e.rev,data:e.data,default:n,createTime:Date.now(),dver:t})},t.prototype.cacheImageData=function(e){var t=[];if("document"!==e.blockId&&"workbook"!==e.blockId){var o="https://docs.qq.com/sheet/"+e.secretId;if((t=t.concat(m.k2sConverter(e.data.data))).length){g.default.log("主动缓存图片","https://docs.qq.com/sheet/"+e.secretId,t);var r=[];t.forEach((function(e){r.push({url:e,method:"get"})})),u.JSApi.invokeNative("docx","manualSaveDocData",{docUrl:o,request:{image:r}},(function(){}))}}},t.prototype.clientVars2OfflineData=function(e,t,o){void 0===o&&(o=!1);var r=this.parent.user.getUserId();return new p.OfflineData({uid:r,globalPadId:e,secretId:t.collab_client_vars.client.upid,subSheetId:t.collab_client_vars.padSubId,type:p.OFFLINE_ITEM_TYPE.DOCUMENT,docType:h.FILE_TYPE.EXCEL,taskId:0,padStatus:t.padStatus||h.PadStatus.NORMAL,version:t.collab_client_vars.rev,data:t,default:o,createTime:Date.now(),dver:t.collab_client_vars.dver})},t.prototype.parseHeadersFromClientVars=function(e){return e.collab_client_vars.header[0].d},t.prototype.getDefaultDocData=function(e,t){return void 0===t&&(t=d.PadIdType.GLOBAL),i(this,void 0,void 0,(function(){var o;return a(this,(function(r){switch(r.label){case 0:switch(o=u.QueryCondition.newInstance().addCondition("type",u.QUERY_CONDITION_TYPE.ONLY,p.OFFLINE_ITEM_TYPE.DOCUMENT).addCondition("default",u.QUERY_CONDITION_TYPE.ONLY,!0).orderby("version",u.IorderType.DECREASE).addCondition("uid",u.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),t){case d.PadIdType.GLOBAL:o.addCondition("globalPadId",u.QUERY_CONDITION_TYPE.ONLY,e);break;case d.PadIdType.SECRET:o.addCondition("secretId",u.QUERY_CONDITION_TYPE.ONLY,e)}return[4,this.database.get(d.TableName.DOCUMENT_DATA,o)];case 1:return[2,r.sent()]}}))}))},t.prototype.createMisschangeData=function(e,t,o){var r=this;return o.respective.filter((function(e){return"NEW_CHANGES"===e.type})).map((function(e){return{commitId:e.commitId,sheetId:e.subId,oSubId:e.oSubId,newVersion:e.new_rev,changeset:e.changeset||"[]",apool:e.apool,head:e.head,revert:e.revert,dver:e.dver}})).map((function(o){return new p.OfflineData({uid:r.parent.user.getUserId(),globalPadId:e,secretId:t||"",subSheetId:o.sheetId,type:p.OFFLINE_ITEM_TYPE.NEW_CHANGE,docType:h.FILE_TYPE.EXCEL,taskId:o.commitId,version:o.newVersion,data:o,createTime:Date.now(),dver:o.dver||window.globalCodeVersion})}))},t.prototype.offlineDataSort=function(e){return e.sort((function(e,t){return e.createTime-t.createTime}))},t.prototype.createDefaultClientVars=function(e){var t=e.globalPadId,o=e.secretId,r=e.dver,n=e.uid||m.getCookie("uid"),i="string"==typeof t?t.split("$")[1]:"",a="string"==typeof t?t.split("$")[0]:"";return{appInfoConfig:null,padType:"sheet",isProPad:!0,shortLink:"https://docs.qq.com/sheet/"+o,docStatus:0,advPolicy:{view_forbid_copy_print:0,reader_can_comment:0,writer_can_comment:0},uin:"",isEmbed:!0,invitedGroupInfos:[],newOpenSvc:1,nameGuess:null,colorPalette:[],domainId:a,userId:n,useFbChat:!1,localPadId:i,userName:"",disableFB:!0,relativeUrl:null,collab_client_vars:{padType:"sheet",rev:1,client:{sid:"",upid:o,tid:0,sig:""},initialAttributedText:{text:[[[{t:14,v:5,c:["BB08J2",14,0,200]},{t:14,v:5,c:["BB08J2",2,0,26]}],[{t:3,v:5,c:[["BB08J2",0,60,0,25],{},{0:[],1:[],2:[]}]}]]],attribs:""},maxCol:26,maxRow:200,globalPadId:t,ver:6,bad:2,padSubId:"BB08J2",gray:0,apool:{},header:[{d:[{id:"BB08J2",name:"工作表1"}],type:"ms"}],wmode:"wb",pos:1,websocket:!0,apid:{},pver:1,dirty:2,padId:i,websocketReopenCount:-1,dver:r,pollingAttemptNumber:0},padTitle:"无标题表格",padStatus:h.PadStatus.NEW,isLocalDoc:!0,isUserChangeTitle:0,initialOptions:{guestPolicy:""},globalPadId:t,titleIsReadOnly:!0,relative:null,envi:{port:8084,type:1,ip:0},userColor:0,isOwner:!0,policy:0,friendUserIds:[],clientIp:"",userIsGuest:!1,proTitle:"",userDomain:"",ownerId:n,specialKey:null,isTimDomain:!0,isOverConNum:!1,shouldGetFbLoginStatus:!0,initialSpaces:null,ownerAppid:"",accountPrivs:{maxRevisions:1e8},isPublicPad:!1,userInfo:{uid:n,corp_id:"",uin:0,third_uid:"",domain:"",fullName:"",wx_openid:"oDzL40GSNzd1-VCksCAEF8hDYi7o"},padId:i,rightFlag:4294967295,isPadAdmin:!0,siteName:"",isLogin:!0,initialRevisionList:[],specialKeyTranslation:null,userPic:"",privilegeExpire:0,privilegeAttribute:{can_read:1,is_auth:1,can_edit:1,can_link_exp:1,can_watermark:1,can_history:1,can_copy_doc:1,can_translate:1,can_about:1,can_copy:1,can_comment:1,can_add_user:1,can_search:1,can_edit_title:1,can_share:1,can_spit_slot:1,can_view_image:1,can_print:1},creatorId:n,initialTitle:"无标题表格",creatorDomain:a,isOpendocxfromTim:!1,isCreator:!0,encrypted:"",userLink:"",dropboxConnected:!1,invitedUserInfos:[],isTimOnline:!0,preview:"",lastModifyUser:"",createdDate:Date.now(),isSnapshot:!1,metaCreateTime:Date.now(),tinyid:"",lastModifyTime:Date.now(),oPadSubId:"BB08J2",userType:"",uidKey:"",vipInfo:"",enableToCVipFeature:!1,templateInfo:"",newPadType:""}},t.prototype.getLocalCreateFileData=function(e,t){return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){var t;return a(this,(function(o){return t=new p.OfflineData({uid:this.parent.user.getUserId(),globalPadId:e,secretId:"",subSheetId:"BB08J2",type:p.OFFLINE_ITEM_TYPE.COMMITING,chunkId:0,docType:h.FILE_TYPE.EXCEL,taskId:123456789,version:0,data:{baseVersion:0,sheetId:"BB08J2",isOfflineMessage:!0,data:{type:"USER_CHANGES",taskId:123456789,baseRev:0,mutations:[[]],changeData:null,keyData:null,head:!1,subId:"BB08J2",oSubId:!1,pver:1},time:1585838012500,status:1},createTime:Date.now(),dver:this.getCodeVersion("sheet")}),[2,new u.Result(void 0,[t])]}))}))},t.prototype.createDefaultClientVarsAndWriteDB=function(e){return i(this,void 0,void 0,(function(){var t,o;return a(this,(function(r){switch(r.label){case 0:return t=this.createDefaultClientVars({globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),dver:this.getCodeVersion("sheet")}),(o=this.clientVars2OfflineData(e.globalPadId,t,!0)).padStatus=h.PadStatus.NEW,[4,this.database.updateMultiTableData([{tableName:d.TableName.DOCUMENT_DATA,data:o},{tableName:d.TableName.DOCUMENT_STATUS,data:{globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),lastSyncTime:Date.now()}}])];case 1:return[2,r.sent()]}}))}))},t.prototype.preCreateDefaultClientVars=function(e){return i(this,void 0,void 0,(function(){var t,o,r,n;return a(this,(function(i){switch(i.label){case 0:return[4,this.checkLocalClientVars()];case 1:if((t=i.sent()).error)return[2];for(o=[],r=0;r<e.length;r++)t.data&&t.data.ExcelNum<c.LocalNewMaxNum&&(n=e[r],this.createDefaultClientVarsAndWriteDB(e[r]),t.data.ExcelNum=t.data.ExcelNum+1,o.push(e[r]),n.isCreated=!0,n.padType=h.FILE_TYPE.EXCEL,this.updatePreFetchIdInfo(n));return[2]}}))}))},t.prototype.updateDocUncommitedData=function(e,t){return i(this,void 0,void 0,(function(){var o,r,n;return a(this,(function(i){switch(i.label){case 0:o=u.QueryCondition.newInstance().addCondition("globalPadId",u.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",u.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",u.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),r=t.map((function(e){return e.taskId})),o.addCondition("taskId",u.QUERY_CONDITION_TYPE.IN,r),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.database.delete(d.TableName.OFFLINE_DATA,o)];case 2:return i.sent(),n=t.map((function(e){return{tableName:d.TableName.DOCUMENT_DATA,data:e}})),[4,this.database.updateMultiTableData(n)];case 3:return[2,i.sent()];case 4:return i.sent(),[2,new u.Result(new Error("createDocAndUpdateDocUncommitedDataError"))];case 5:return[2]}}))}))},t.prototype.getPictureList=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return[2,Promise.resolve(new u.Result(void 0,[]))]}))}))},t}(c.BaseBusinessHelper);t.default=_},function(e,t,o){e.exports=o(177)},function(e,t,o){"use strict";var r=o(31),n=o(120),i=o(178),a=o(126);function l(e){var t=new i(e),o=n(i.prototype.request,t);return r.extend(o,i.prototype,t),r.extend(o,t),o}var s=l(o(123));s.Axios=i,s.create=function(e){return l(a(s.defaults,e))},s.Cancel=o(127),s.CancelToken=o(192),s.isCancel=o(122),s.all=function(e){return Promise.all(e)},s.spread=o(193),e.exports=s,e.exports.default=s},function(e,t,o){"use strict";var r=o(31),n=o(121),i=o(179),a=o(180),l=o(126);function s(e){this.defaults=e,this.interceptors={request:new i,response:new i}}s.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=l(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],o=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)o=o.then(t.shift(),t.shift());return o},s.prototype.getUri=function(e){return e=l(this.defaults,e),n(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){s.prototype[e]=function(t,o){return this.request(r.merge(o||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){s.prototype[e]=function(t,o,n){return this.request(r.merge(n||{},{method:e,url:t,data:o}))}})),e.exports=s},function(e,t,o){"use strict";var r=o(31);function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},function(e,t,o){"use strict";var r=o(31),n=o(181),i=o(122),a=o(123);function l(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return l(e),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return l(e),t.data=n(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(l(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,o){"use strict";var r=o(31);e.exports=function(e,t,o){return r.forEach(o,(function(o){e=o(e,t)})),e}},function(e,t){var o,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,c=[],d=!1,u=-1;function p(){d&&s&&(d=!1,s.length?c=s.concat(c):u=-1,c.length&&h())}function h(){if(!d){var e=l(p);d=!0;for(var t=c.length;t;){for(s=c,c=[];++u<t;)s&&s[u].run();u=-1,t=c.length}s=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];c.push(new f(e,t)),1!==c.length||d||l(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,o){"use strict";var r=o(31);e.exports=function(e,t){r.forEach(e,(function(o,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=o,delete e[r])}))}},function(e,t,o){"use strict";var r=o(125);e.exports=function(e,t,o){var n=o.config.validateStatus;!n||n(o.status)?e(o):t(r("Request failed with status code "+o.status,o.config,null,o.request,o))}},function(e,t,o){"use strict";e.exports=function(e,t,o,r,n){return e.config=t,o&&(e.code=o),e.request=r,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,o){"use strict";var r=o(187),n=o(188);e.exports=function(e,t){return e&&!r(t)?n(e,t):t}},function(e,t,o){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,o){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,o){"use strict";var r=o(31),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,o,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),o=r.trim(e.substr(i+1)),t){if(a[t]&&n.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([o]):a[t]?a[t]+", "+o:o}})),a):a}},function(e,t,o){"use strict";var r=o(31);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");function n(e){var r=e;return t&&(o.setAttribute("href",r),r=o.href),o.setAttribute("href",r),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return e=n(window.location.href),function(t){var o=r.isString(t)?n(t):t;return o.protocol===e.protocol&&o.host===e.host}}():function(){return!0}},function(e,t,o){"use strict";var r=o(31);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,o,n,i,a){var l=[];l.push(e+"="+encodeURIComponent(t)),r.isNumber(o)&&l.push("expires="+new Date(o).toGMTString()),r.isString(n)&&l.push("path="+n),r.isString(i)&&l.push("domain="+i),!0===a&&l.push("secure"),document.cookie=l.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,o){"use strict";var r=o(127);function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var o=this;e((function(e){o.reason||(o.reason=new r(e),t(o.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},e.exports=n},function(e,t,o){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,o){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(58),d=o(14),u=o(45),p=o(57),h=o(40),f=o(66),m=o(41),y=s(o(39)),g=o(65),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=u.DOC_TYPE.WORD,t}return n(t,e),t.prototype.preFetchSingleSubBlockData=function(e,t,o,r){return a(this,void 0,void 0,(function(){var t,n,i,a;return l(this,(function(l){switch(l.label){case 0:return t="/dop-api/opendoc?prefetch=1&offline=1&normal=1&padId="+e+"&subId="+o+"&rev="+r,[4,f.CGI.sendCommonRequest(t,f.Method.GET,"","custom")];case 1:return(n=l.sent()).error?[2,n]:(i=n.data,"blankpage"===(a=this.convertDataToClientVars(i)).padType||!0===a.isBlankPage?(y.default.error("文档数据不存在"),[2,new d.Result(new Error("FileNotExsit"))]):a.collab_client_vars?[2,new d.Result(void 0,{id:a.globalPadId,subBlock:o,rev:r,data:a,default:!1})]:(y.default.error("拉取失败"),[2,new d.Result(new Error("ResponseDataError"))]))}}))}))},t.prototype.preFetchSingleSubFormData=function(e,t,o){return a(this,void 0,void 0,(function(){var r,n,i,a;return l(this,(function(l){switch(l.label){case 0:return r="/dop-api/get/table?padId="+e+"&subId="+t+"&rev="+o,[4,f.CGI.sendCommonRequest(r,f.Method.GET,"")];case 1:return(n=l.sent()).error?[2,new d.Result(new Error("ResponseDataError"))]:0===(i=n.data).retcode&&i.data&&i.data.padSubId===t&&i.data.initialAttributedText?(a=unescape(i.data.initialAttributedText.text||""))?[2,new d.Result(void 0,{padId:e,subId:t,data:a,rev:o})]:(y.default.error("文档数据不存在"),[2,new d.Result(new Error("FileNotExsit"))]):[2,new d.Result(new Error("ResponseDataError"))]}}))}))},t.prototype.batchFetchSubFormData=function(e,t,o){return a(this,void 0,void 0,(function(){var r,n,i,a,s;return l(this,(function(l){switch(l.label){case 0:r=new Array,n=0,l.label=1;case 1:return n<t.length?(i=t[n],[4,this.preFetchSingleSubFormData(e,i.id,o)]):[3,4];case 2:if((a=l.sent()).error)return y.default.error(a.error),[2,new d.Result(a.error)];s=a.data,r.push(s),l.label=3;case 3:return n++,[3,1];case 4:return[2,new d.Result(void 0,r)]}}))}))},t.prototype.getFetchUrl=function(e,t,o,r){return"/dop-api/opendoc?prefetch=1&normal=1&offline=1&padId="+e+"&id="+t},t.prototype.handlePreFetchDocData=function(e,t){return a(this,void 0,void 0,(function(){var e,o,r,n,i,a,s;return l(this,(function(l){e=t;try{e=this.convertDataToClientVars(t)}catch(e){return y.default.error("word文档数据解析异常"),[2,{resultCode:g.SyncResultCode.PreFetchDocDataError,subResultCode:-200855,message:"handlePreFetchDocData word Catch Error",error:e||new Error("ParseResponseError")}]}return"blankpage"===e.padType||!0===e.isBlankPage?(y.default.error("文档数据不存在，或者无权限"),[2,{resultCode:g.SyncResultCode.PreFetchDocDataError,subResultCode:-200853,message:"handlePreFetchDocData word 后台回包blankpage 文档数据不存在，或者无权限",error:new Error("DocumentBlankPageError")}]):(r=(o=e).collab_client_vars.rev,n=o.collab_client_vars.dver,i=o.collab_client_vars.padSubId,a={gloabalPadId:o.globalPadId,secretId:o.collab_client_vars.client.upid,subBlock:i,rev:r,data:o,default:!0},s=[a],[2,{resultCode:g.SyncResultCode.Success,subResultCode:0,message:"handlePreFetchDocData Success",data:{rev:r,dver:n,allBlockData:s}}])}))}))},t.prototype.subTable2OfflineData=function(e,t,o){var r=this.parent.user.getUserId();return new p.OfflineData({uid:r,globalPadId:e,secretId:t.collab_client_vars.client.upid,subSheetId:o.subId,type:p.OFFLINE_ITEM_TYPE.INIT,docType:h.FILE_TYPE.WORD,taskId:p.OfflineData.createMessageSeq(),version:o.rev,data:o.data,createTime:Date.now(),dver:t.collab_client_vars.dver})},t.prototype.blockData2OfflineData=function(e,t){return this.clientVars2OfflineData(e.gloabalPadId,e.data,e.default||!1)},t.prototype.clientVars2OfflineData=function(e,t,o){void 0===o&&(o=!1);var r=this.parent.user.getUserId();return t.collab_client_vars&&"BB08J2"!==t.collab_client_vars.padSubId?new p.OfflineData({uid:r,globalPadId:e,secretId:t.collab_client_vars.client.upid,subSheetId:t.padSubId,type:p.OFFLINE_ITEM_TYPE.INIT,docType:h.FILE_TYPE.WORD,taskId:p.OfflineData.createMessageSeq(),version:t.rev,data:unescape(t.initialAttributedText.text||""),padStatus:t.padStatus||h.PadStatus.NORMAL,createTime:Date.now(),dver:t.collab_client_vars.dver}):new p.OfflineData({uid:r,globalPadId:e,secretId:t.collab_client_vars.client.upid,subSheetId:t.collab_client_vars.padSubId,type:p.OFFLINE_ITEM_TYPE.INIT,docType:h.FILE_TYPE.WORD,taskId:p.OfflineData.createMessageSeq(),version:t.collab_client_vars.rev,data:t,padStatus:t.padStatus||h.PadStatus.NORMAL,createTime:Date.now(),dver:t.collab_client_vars.dver})},t.prototype.parseHeadersFromClientVars=function(e){return this.getDocSubIds(e)},t.prototype.getDocSubIds=function(e){var t=[],o=e.collab_client_vars.apool&&e.collab_client_vars.apool.numToAttrib;return o&&Object.values(o).forEach((function(e){var o=e;2===o.length&&"table"===o[0]&&t.push({id:o[1],name:"文档表格",type:"ms"})})),t},t.prototype.getDefaultDocData=function(e,t){return void 0===t&&(t=u.PadIdType.GLOBAL),a(this,void 0,void 0,(function(){var o;return l(this,(function(r){switch(r.label){case 0:switch(o=d.QueryCondition.newInstance().addCondition("type",d.QUERY_CONDITION_TYPE.ONLY,p.OFFLINE_ITEM_TYPE.INIT).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()).addCondition("subSheetId",d.QUERY_CONDITION_TYPE.ONLY,"BB08J2"),t){case u.PadIdType.GLOBAL:o.addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e);break;case u.PadIdType.SECRET:o.addCondition("secretId",d.QUERY_CONDITION_TYPE.ONLY,e)}return[4,this.database.get(u.TableName.DOCUMENT_DATA,o)];case 1:return[2,r.sent()]}}))}))},t.prototype.createMisschangeData=function(e,t,o){var r=this,n=o.common;return o.respective.filter((function(e){return"NEW_CHANGES"===e.type&&1!==e.new_rev})).map((function(e){return{taskId:e.commitId,baseRev:e.new_rev,changeSetCount:1,changeset:e.changeset||"",apool:e.apool,keyData:e.keydata,head:e.head,subId:e.subId,oSubId:e.oSubId,newVersion:e.new_rev,uuId:n.uuId,pver:n.pver}})).map((function(o){var i=Date.now(),a={baseVersion:o.newVersion,sheetId:o.subId,isOfflineMessage:!0,data:o,time:i};return new p.OfflineData({uid:r.parent.user.getUserId(),globalPadId:e,secretId:t||"",subSheetId:o.subId,type:p.OFFLINE_ITEM_TYPE.NEW_CHANGE,docType:h.FILE_TYPE.WORD,taskId:o.taskId,version:o.newVersion,data:a,createTime:i,dver:n.dver||m.wordCodeVersion()||r.getCodeVersion("doc")})}))},t.prototype.buildPadInfo=function(e){var t=Date.now()/1e3,o=new h.PadInfo(this.parent.user);return i(i({},o),{key:this.parent.user.getUserId()+e.globalPadId,type:h.FILE_TYPE.WORD,uid:this.parent.user.getUserId(),dver:e.collab_client_vars.dver||void 0,pad_id:e.localPadId,globalPadId:e.globalPadId,secretId:e.collab_client_vars.client.upid,title:e.padTitle,status:e.padStatus||h.PadStatus.NORMAL,creator:this.parent.user.getUserId(),create_ts:t,isRencent:!0,last_modify_ts:t,last_browse_ts:t,doc_type:h.FILE_TYPE.WORD,doc_type_desc:h.typeMap[h.FILE_TYPE.WORD],doc_url:"//docs.qq.com/doc/"+e.collab_client_vars.client.upid,lastSyncTime:t})},t.prototype.offlineDataSort=function(e){return e.sort((function(e,t){if(e.type===t.type&&e.type===p.OFFLINE_ITEM_TYPE.QUEUE)return e.createTime-t.createTime;var o=[p.OFFLINE_ITEM_TYPE.INIT,p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.QUEUE,p.OFFLINE_ITEM_TYPE.WATTING];return o.indexOf(e.type)-o.indexOf(t.type)}))},t.prototype.updateOfflineDataBaseVersion=function(e,t,o){return a(this,void 0,void 0,(function(){var r,n,i,a,s,c,h,f;return l(this,(function(l){switch(l.label){case 0:return r=[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.QUEUE,p.OFFLINE_ITEM_TYPE.WATTING],n=this.parent.user.getUserId(),i=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,t).addCondition("type",d.QUERY_CONDITION_TYPE.IN,r).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,n),[4,this.database.getAll(u.TableName.OFFLINE_DATA,i)];case 1:return(a=l.sent()).error?(y.default.error(a.error),[2,{error:a.error}]):(s=a.data,c=s.map((function(t){if(t.version=e,t.data&&t.data.data){var o=Object.assign(t.data.data,{baseRev:e}),r=Object.assign(t.data,{baseVersion:e,data:o});t.data=r}return{tableName:u.TableName.OFFLINE_DATA,data:t}})),(h=o)&&h.collab_client_vars&&(h.collab_client_vars.rev=e,f=this.clientVars2OfflineData(h.globalPadId,h),c.push({tableName:u.TableName.DOCUMENT_DATA,data:f})),[4,this.database.updateMultiTableData(c)]);case 2:return[2,l.sent()]}}))}))},t.prototype.createDefaultClientVars=function(e){var t=e.secretId,o=e.globalPadId,r=e.dver,n=e.uid||m.getCookie("uid"),i="string"==typeof o?o.split("$")[1]:"";return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{0:["author",""],1:["pap-stylesheet-name","title"],2:["textalign","left"],3:["flowid","BB08J2"],4:["flowid","LSTTMP"],5:["story-type","list-template"]},nextNum:6},bad:-1,client:{upid:t},dirty:-1,dver:r,globalPadId:o,gray:-1,header:[],initialAttributedText:{text:"%0A%0A%0F%03%02%0A%03%0A",attribs:"*0*1*2+1+2*3+1*4*5+1+1*4*5+1+1"},padId:i,padSubId:"BB08J2",padType:"doc",pollingAttemptNumber:-1,pos:1,pver:2,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:o,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:m.UserAgent.isPad,isIPhone:!1,isLocalDoc:!0,isLogin:!0,isMac:!1,isMobile:m.UserAgent.isMobile,isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:i,newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:i,padTitle:"无标题文档",padType:"doc",padStatus:h.PadStatus.NEW,pagingFlag:"",policy:0,privilegeAttribute:{can_about:1,can_add_user:1,can_comment:1,can_copy:1,can_edit:1,can_edit_title:1,can_history:1,can_link_exp:1,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:1,is_auth:1},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:m.getCookie("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:"p."+n,userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:""}},t.prototype.getLocalCreateFileData=function(e,t){return void 0===t&&(t=!0),a(this,void 0,void 0,(function(){var o,r,n,i,a;return l(this,(function(l){switch(l.label){case 0:return o=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",d.QUERY_CONDITION_TYPE.ONLY,p.OFFLINE_ITEM_TYPE.INIT).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.get(u.TableName.DOCUMENT_DATA,o)];case 1:return(r=l.sent()).error?[2,new d.Result(r.error)]:(n=[r.data],t?(i=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",d.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.QUEUE,p.OFFLINE_ITEM_TYPE.WATTING]).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.getAll(u.TableName.OFFLINE_DATA,i)]):[3,3]);case 2:if((a=l.sent()).error)return[2,new d.Result(a.error)];n.push.apply(n,a.data),l.label=3;case 3:return[2,new d.Result(void 0,n)]}}))}))},t.prototype.createDefaultClientVarsAndWriteDB=function(e){return a(this,void 0,void 0,(function(){var t,o;return l(this,(function(r){switch(r.label){case 0:return t=this.createDefaultClientVars({globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),dver:this.getCodeVersion("doc")}),(o=this.clientVars2OfflineData(e.globalPadId,t)).padStatus=h.PadStatus.NEW,[4,this.database.updateMultiTableData([{tableName:u.TableName.DOCUMENT_DATA,data:o},{tableName:u.TableName.DOCUMENT_STATUS,data:{globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),lastSyncTime:Date.now()}}])];case 1:return[2,r.sent()]}}))}))},t.prototype.preCreateDefaultClientVars=function(e){return a(this,void 0,void 0,(function(){var t,o,r,n;return l(this,(function(i){switch(i.label){case 0:return[4,this.checkLocalClientVars()];case 1:if((t=i.sent()).error)return[2];for(o=[],r=0;r<e.length;r++)t.data&&t.data.DocNum<c.LocalNewMaxNum&&(n=e[r],this.createDefaultClientVarsAndWriteDB(n),t.data.DocNum=t.data.DocNum+1,o.push(e[r]),n.isCreated=!0,n.padType=h.FILE_TYPE.WORD,this.updatePreFetchIdInfo(n));return[2]}}))}))},t.prototype.updateDocUncommitedData=function(e,t){return a(this,void 0,void 0,(function(){var o,r;return l(this,(function(n){switch(n.label){case 0:o=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",d.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this.database.delete(u.TableName.OFFLINE_DATA,o)];case 2:return n.sent(),r=t.map((function(e){return{tableName:u.TableName.DOCUMENT_DATA,data:e}})),[4,this.database.updateMultiTableData(r)];case 3:return[2,n.sent()];case 4:return n.sent(),[2,new d.Result(new Error("createDocAndUpdateDocUncommitedDataError"))];case 5:return[2]}}))}))},t.prototype.getPictureList=function(e){var o,r,n;return a(this,void 0,void 0,(function(){var i,a,s,c;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.getDefaultDocData(e,u.PadIdType.GLOBAL)];case 1:return i=l.sent(),a=(null===(n=null===(r=null===(o=i)||void 0===o?void 0:o.data)||void 0===r?void 0:r.data)||void 0===n?void 0:n.collab_client_vars).apool,s=Object.values(a.numToAttrib).filter((function(e){return"img"===e[0]})).map((function(e){return t.getImageThumb1123(e[1])})),[2,new d.Result(void 0,s)];case 2:return c=l.sent(),y.default.error("getPictureList failed",c),[2,new d.Result(new Error("createDocAndUpdateDocUncommitedDataError"))];case 3:return[2]}}))}))},t.getImageThumb1123=function(e){if(!this.isValidQqadaptDomain(e))return e;if(e.indexOf("?type=image/gif")>0){var t=e.indexOf("?type=image/gif");return e.substring(0,t)}var o=e.split("?")[0];return o.substring(0,o.length-1)+"1123"},t.isValidQqadaptDomain=function(e){return!(!e||e.length<1)&&e.indexOf("qqadapt.qpic.cn")>0},t.prototype.cacheImageData=function(){},t}(c.BaseBusinessHelper);t.default=v},function(e,t,o){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(58),d=o(14),u=o(45),p=o(57),h=o(40),f=o(66),m=o(41),y=s(o(39)),g=o(65),v=o(196),_="1.0.0",b="[SlideHelper]",T=function(e){function t(t){var o=e.call(this,t)||this;return o.type=u.DOC_TYPE.SLIDE,o}return n(t,e),t.prototype.createFile=function(e,t,o,r){return void 0===t&&(t=h.FILE_TYPE.SLIDE),void 0===o&&(o=!0),a(this,void 0,void 0,(function(){var o,n,i,a,s,c,p,g,v,_,T,S,C,w,E,I,x,R,O,P,D,N;return l(this,(function(l){switch(l.label){case 0:return y.default.log(b+" - createFile - start - globalPadId:"+e+" - padType:"+t),o="/cgi-bin/online_docs/createdoc_new",11,0,n=t,i="string"==typeof e?e.split("$")[0]:"",a="string"==typeof e?e.split("$")[1]:"",s="create_type=11&pad_id="+a+"&domain_id="+i+"&doc_type="+n+"&template_id=0&xsrf="+m.getXsrf()+"&hum=1",[4,this.getPadInfo(e,u.PadIdType.GLOBAL)];case 1:return(c=l.sent())?c.status===h.PadStatus.NORMAL?(y.default.error("已经创建过该文档了，不用再创建了",e),[2,new d.Result(new Error("AlreadyCreatedError"))]):(p=r||c.folder||"/",y.default.log("createFile folder_id:",p),s+="&folder_id="+p+"&title="+c.title,g=this.compose4CreateFileWithCreate(e),v=encodeURIComponent(JSON.stringify(g)),s+="&data="+v,[4,f.CGI.sendCommonRequest(o,f.Method.POST,s)]):(y.default.error("获取文档padInfo失败了",e),[2,new d.Result(new Error("NoPadInfoError"))]);case 2:return(_=l.sent()).error?(y.default.error(_.error,"创建文档请求失败"),[2,_]):0!==(T=_.data).retcode?[3,15]:!0!==T.is_doc_id_dup?[3,7]:(S=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.delete(u.TableName.PAD_INFO,S)]);case 3:return l.sent(),[4,this.database.delete(u.TableName.OFFLINE_DATA,S)];case 4:return l.sent(),[4,this.database.delete(u.TableName.DOCUMENT_DATA,S)];case 5:return l.sent(),[4,this.database.delete(u.TableName.DOCUMENT_STATUS,S)];case 6:return l.sent(),[2,new d.Result(new d.HttpError(0,10033,"DocumentIdDuplicated"),{retcode:10033,url:T.doc_url})];case 7:return c.status=h.PadStatus.NORMAL,C=Date.now(),c.last_modify_ts=C,c.lastSyncTime=C,[4,this.getDefaultDocData(e,u.PadIdType.GLOBAL)];case 8:return(w=l.sent()).error?[2,w]:((E=w.data.data).isTemp=!1,[4,this.updateClientVarsSocketInfo(e,E)]);case 9:return(I=l.sent()).error?[2,I]:(I.data.isLocalDoc=!1,I.data.padStatus=h.PadStatus.NORMAL,x=this.clientVars2OfflineData(e,I.data,!0),[4,this.database.updateMultiTableData([{tableName:u.TableName.PAD_INFO,data:c},{tableName:u.TableName.DOCUMENT_DATA,data:x}])]);case 10:return l.sent(),[4,this.getUnCommitedData(e)];case 11:return(R=l.sent()).error?(y.default.error("获取未提交数据失败"),[2,new d.Result(new Error("getUnCommitedDataFail"))]):(O=R.data).length>0&&(P=this.compose4CreateFileWithOfflineData(e,O,1))?[4,this.commitOfflineData(e,P)]:[3,14];case 12:return(D=l.sent()).error?(y.default.error(D.error),[2,new d.Result(new Error("commitOfflineDataFail"))]):0!==(N=D.data).retcode?(y.default.error("CreateFile流程提交离线数据失败"),[2,new d.Result(new Error("commitOfflineDataFail"+N.retcode))]):[4,this.removeUncommitedData(e)];case 13:if(l.sent().error)return y.default.error("CreateFile流程提交离线数据失败"),[2,new d.Result(new Error("removeUncommitedDataFail"))];l.label=14;case 14:return y.default.log(b+" - createFile - end - globalPadId:"+e+" - padType:"+t),[2,new d.Result(void 0,{retcode:0,data:I.data})];case 15:return y.default.error("创建文档失败"),[2,new d.Result(new Error("CreatFileError"),T)]}}))}))},t.prototype.commitUncommitData=function(e){return a(this,void 0,void 0,(function(){var t,o,r,n,i,a,s,c;return l(this,(function(l){switch(l.label){case 0:return t=e.padId,o=e.secretId,r=e.source,n=e.force,i=e.padType,y.default.log(b+" - commitUncommitData - start",e),[4,this.getUnCommitedData(t)];case 1:return(a=l.sent()).error?(y.default.error(a.error),[2,{resultCode:g.SyncResultCode.GetUncommitDataError,subResultCode:-1,message:"commitUncommitData 查询本地未提交数据错误。",error:a.error}]):(y.default.log("SyncOfflineData. 查询本地未提交离线数据",t,o,r,n,i,a.data.length),(s=a.data).length>0?[4,this.batchCommitSlideOfflineData(t,o,s)]:[3,3]);case 2:if((c=l.sent()).error)return y.default.error("SyncOfflineData. 提交离线未提交数据时出错了，同步失败",t,o,r,n,i),[2,c];l.label=3;case 3:return y.default.log(b+" - commitUncommitData - end",e),[2,{resultCode:g.SyncResultCode.Success,subResultCode:-1,message:"commitUncommitData 正常"}]}}))}))},t.prototype.batchCommitSlideOfflineData=function(e,t,o){return a(this,void 0,void 0,(function(){var r,n,i,a,s,c,d,u,p,h,m,_;return l(this,(function(l){switch(l.label){case 0:return 0===o.length?[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-1e3,message:"batchCommitOfflineData 参数错误。待提交的OfflineData数组长度为0"}]:[4,f.CGI.fetchDocDataSlide(t)];case 1:if((n=l.sent()).error)return[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2e3,message:"batchCommitOfflineData 批量提交离线数据时发生错误。"}];i=n.data,y.default.log(b,"getClientVarsBySecretId - response:",i);try{if(y.default.log(b,"getClientVarsBySecretId - will convertDataToClientVars"),"blankpage"===(r=this.convertDataToClientVars(i)).padType||!0===r.isBlankPage)return y.default.error("文档数据不存在，或者无权限"),[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2001,message:"batchCommitOfflineData FileNotExsit"}]}catch(e){return y.default.error("解析后台预拉数据异常",e),[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2002,message:"batchCommitOfflineData ParseResponseError"}]}return(a=new v.App).initializeDataWithClientVars(r),(s=o)&&0!==s.length?(c=s[0].data)&&0!==c.length?(d=c[0].revision,[4,this.conflictOfflineData4OfflineEdit(a,c,d)]):[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2004,message:"batchCommitOfflineData SlideChangesetPack为空"}]:[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2003,message:"batchCommitOfflineData unCommitDataResultData为空"}];case 2:return u=l.sent(),p=this.composeChangesetPacks(e,u,r),[4,this.commitOfflineData(e,p)];case 3:return(h=l.sent()).error?(y.default.error(h.error),[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2005,message:"batchCommitOfflineData CommitDataFail"}]):(m=h.data,0!==(_=m.retcode)?[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2006,message:"batchCommitOfflineData CommitDataFail"+_}]:[4,this.saveClientVars(r)]);case 4:return l.sent().error?[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2007,message:"batchCommitOfflineData SaveNewClientVarsFail"}]:[4,this.removeUncommitedData(e)];case 5:return l.sent().error?[2,{resultCode:g.SyncResultCode.CommitOfflineDataError,subResultCode:-2008,message:"batchCommitOfflineData CommitDataFail"}]:[2,{resultCode:g.SyncResultCode.Success,subResultCode:-1,message:"batchCommitOfflineData 提交正常。"}]}}))}))},t.prototype.fetchAndStoreDocumentCache=function(e){var t;return a(this,void 0,void 0,(function(){var o,r,n,i,a,s,c,d,p,v,T,S,C;return l(this,(function(l){switch(l.label){case 0:return o=e.padId,r=e.secretId,n=e.source,i=e.force,a=e.padType,s=e.deleteOldCache,void 0===s||s,e.rev,e.isManualOffline,y.default.log(b+" - fetchAndStoreDocumentCache - start",e),y.default.log(b+" - fetchAndStoreDocumentCache: padId, secretId, source, force, padTyp",o,r,n,i,a),[4,f.CGI.fetchDocDataSlide(r)];case 1:return(c=l.sent()).error?(y.default.error(b+" - SyncOfflineData. 拉取新的离线数据失败, 同步失败",o,r,n,i,a,c.error,null===(t=c.error)||void 0===t?void 0:t.stack),"blankpage"===(d="string"==typeof c.data?JSON.parse(c.data):c.data).padType||!0===d.isBlankPage?[2,{resultCode:g.SyncResultCode.FileNotExsitError,subResultCode:-200803,message:"handlePreFetchDocData slide 后台回包blankpage 文档数据不存在，或者无权限",error:new Error("DocumentBlankPageError")}]:[2,this.handleCommonRequestError(c)]):(p=c.data,(v=this.convertDataToClientVars(p))?(T=this.clientVars2OfflineData(o,v),S=v.collab_client_vars.dver||_,[4,this.getPadInfo(r,u.PadIdType.SECRET)]):[2,{resultCode:g.SyncResultCode.UpdatePreFetchOfflienDataError,subResultCode:-1,message:"updateDocOfflineData fetchDocDataSlideFail"}]);case 2:return(C=l.sent())||(C=this.buildPadInfo(v),y.default.log(b+" - fetchAndStoreDocumentCache - getPadInfo is null , buildPadInfo",C)),C.isOfflineCache=!0,C.status=h.PadStatus.NORMAL,C.lastSyncTime=Date.now(),C.dver=S,y.default.log(b+" - fetchAndStoreDocumentCache - padInfo result",C),[4,this.database.updateMultiTableData([{tableName:u.TableName.PAD_INFO,data:C},{tableName:u.TableName.DOCUMENT_DATA,data:T},{tableName:u.TableName.DOCUMENT_STATUS,data:{globalPadId:o,secretId:r,uid:this.parent.user.getUserId(),lastSyncTime:Date.now()}}])];case 3:return l.sent(),this.parent.mapDocumentVersion(S,m.reconstructDocUrl(a,r)),y.default.log(b+" - fetchAndStoreDocumentCache - end",e),[2,{resultCode:g.SyncResultCode.Success,subResultCode:0,message:"fetchAndStoreDocumentCache Success",data:C}]}}))}))},t.prototype.updateDocUncommitedData=function(e,t){return a(this,void 0,void 0,(function(){return l(this,(function(e){return[2,new d.Result(void 0,!0)]}))}))},t.prototype.conflictOfflineData4OfflineEdit=function(e,t,o){return new Promise((function(r,n){e.presentationStore.changeSetManager.conflictOfflineData4OfflineEdit(e,t,o,t.length,(function(e,t){r(e)}))}))},t.prototype.composeChangesetPacks=function(e,t,o){var r=this.parent.user.getUserId(),n=t[0],i=n.subId,a=n.uuId,l=o&&o.collab_client_vars&&o.collab_client_vars.dver||_,s=t.map((function(e){return{head:!1,oSubId:i,keydata:!1,subId:i,changeSetCount:1,task_id:e.seq,changeset:JSON.stringify(e.cs)+"\n"}}));return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,code_ver:0,uid:r,dver:l,base_rev:t[0].revision,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:1,uuId:a},respective:s}},t.prototype.compose4CreateFileWithCreate=function(e){var t=this.parent.user.getUserId(),o=this.parent.user.getUserId(),r=(new v.App).createPresentationWithChangeset(),n=[{head:!1,oSubId:"BB08J2",keydata:!1,subId:"BB08J2",task_id:this.createMessageSeq(),changeset:JSON.stringify(r.cs)+"\n"}];return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,code_ver:0,uid:t,dver:"1.0.0",base_rev:0,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:1,uuId:o},respective:n}},t.prototype.compose4CreateFileWithOfflineData=function(e,t,o){var r=this.parent.user.getUserId();if(t&&0!==t.length){var n=t[0];if(n.data&&0!==n.data.length){var i=n.data;if(i&&0!==i.length){var a=i[0],l=a&&(a.subId||"BB08J2"),s=a.uuId||r,c=a.dver||_,d=i.map((function(e){return{head:!1,oSubId:l,keydata:!1,subId:l,changeSetCount:1,task_id:e.seq,changeset:JSON.stringify(e.cs)+"\n"}}));return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,code_ver:0,uid:r,dver:c,base_rev:o,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:1,uuId:s},respective:d}}}}},t.prototype.composeOfflineData=function(e,t){if(0!==t.length){var o=this.parent.user.getUserId(),r=t[0],n=r.data[0],i=n.subId||"BB08J2",a=n.dver||_,l=n.uuId||this.parent.user.getUserId(),s=n.revision||0,c=r.data.map((function(e){return{head:!1,oSubId:i,keydata:!1,subId:i,task_id:e.seq,changeset:JSON.stringify(e.cs)+"\n"}}));return{common:{type:"USER_CHANGES",offlineMsg:!0,docid:e,code_ver:0,uid:o,dver:a,base_rev:s,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:this.getHeaderGeneralPacket(),pver:1,uuId:l},respective:c}}},t.prototype.getGlobalPadIdBySecretId=function(e,t,o){return void 0===o&&(o=!0),a(this,void 0,void 0,(function(){var r,n;return l(this,(function(i){switch(i.label){case 0:return y.default.log(b,"getGlobalPadIdBySecretId - secretId:"+e),[4,this.getPadInfo(e,u.PadIdType.SECRET)];case 1:return(r=i.sent())?(y.default.log(b,"getGlobalPadIdBySecretId - padInfo.globalPadId:"+r.globalPadId),[2,r.globalPadId]):[4,this.getClientVarsBySecretId(e,t,o)];case 2:return(n=i.sent()).error?[2,void 0]:(y.default.log(b,"getGlobalPadIdBySecretId - data.data.globalPadId:"+n.data.globalPadId),[2,n.data.globalPadId])}}))}))},t.prototype.getClientVarsBySecretId=function(e,t,o){return void 0===o&&(o=!0),a(this,void 0,void 0,(function(){var t,o,r,n;return l(this,(function(i){switch(i.label){case 0:return y.default.log(b,"getClientVarsBySecretId - secretId:"+e),[4,f.CGI.fetchDocDataSlide(e)];case 1:if((t=i.sent()).error)return[2,new d.Result(t.error)];o=t.data,y.default.log(b,"getClientVarsBySecretId - response:",o),i.label=2;case 2:return i.trys.push([2,5,,6]),y.default.log(b,"getClientVarsBySecretId - will convertDataToClientVars"),"blankpage"===(r=this.convertDataToClientVars(o)).padType||!0===r.isBlankPage?(y.default.error("文档数据不存在，或者无权限"),[2,new d.Result(new Error("FileNotExsit"))]):(y.default.log(b,"getClientVarsBySecretId - will createPadInfoFromClientVars clientVars:",r),[4,this.createPadInfoFromClientVars(r)]);case 3:return i.sent(),[4,this.saveClientVars(r)];case 4:return i.sent(),[2,new d.Result(void 0,r)];case 5:return n=i.sent(),y.default.error("解析后台预拉数据异常",n),[2,new d.Result(n||new Error("ParseResponseError"))];case 6:return[2]}}))}))},t.prototype.saveClientVars=function(e){return a(this,void 0,void 0,(function(){var t,o,r;return l(this,(function(n){switch(n.label){case 0:return t=e.globalPadId,o=this.clientVars2OfflineData(t,e),[4,this.database.update(u.TableName.DOCUMENT_DATA,o)];case 1:return(r=n.sent()).error?y.default.log(b,"saveClientVars - updateResult error",r.error):y.default.log(b,"saveClientVars - updateResult success",e),[2,r]}}))}))},t.prototype.convertDataToClientVars=function(e){y.default.log(b,"convertDataToClientVars - responseText:",e);var t=JSON.parse(e),o=t.retcode,r=t.data;if(0===o)return y.default.log(b,"convertDataToClientVars - data:",r),r;y.default.error(b,"convertDataToClientVars - business fail - retcode:",o)},t.prototype.cacheImageData=function(){y.default.error("[SlideHelper_unimplements]","cacheImageData")},t.prototype.getPictureList=function(e){return a(this,void 0,void 0,(function(){return l(this,(function(e){return y.default.error("[SlideHelper_unimplements]","getPictureList"),[2,new d.Result(void 0,void 0)]}))}))},t.prototype.preFetchSingleSubBlockData=function(e,t,o,r){return a(this,void 0,void 0,(function(){var n,i,a,s;return l(this,(function(l){switch(l.label){case 0:return y.default.log(b,"preFetchSingleSubBlockData"),n=this.getFetchUrl(e,t,r,o),[4,f.CGI.sendCommonRequest(n,f.Method.GET,"","custom")];case 1:return(i=l.sent()).error?[2,i]:(a=i.data,"blankpage"===(s=this.convertDataToClientVars(a)).padType||!0===s.isBlankPage?(y.default.error("文档数据不存在"),[2,new d.Result(new Error("FileNotExsit"))]):s.collab_client_vars?[2,new d.Result(void 0,{id:s.globalPadId,subBlock:o,rev:r,data:s,default:!1})]:(y.default.error("拉取失败"),[2,new d.Result(new Error("ResponseDataError"))]))}}))}))},t.prototype.clientVars2OfflineData=function(e,t,o){void 0===o&&(o=!1);var r=this.parent.user.getUserId(),n=t.collab_client_vars.client.upid,i=e+"_BB08J2_"+r,a=t&&t.collab_client_vars&&t.collab_client_vars.dver||_;return new p.OfflineData({key:i,uid:r,globalPadId:e,secretId:n,subSheetId:"BB08J2",type:p.OFFLINE_ITEM_TYPE.INIT,docType:h.FILE_TYPE.SLIDE,taskId:this.createMessageSeq(),padStatus:t.padStatus||h.PadStatus.NORMAL,version:t.collab_client_vars.rev,data:t,createTime:Date.now(),dver:a})},t.prototype.getFetchUrl=function(e,t,o,r){return y.default.log(b,"getFetchUrl - padId:"+e),"https://docs.qq.com/dop-api/slide/data/get?id="+t+"&normal=1&prefetch=1&offline=1"},t.prototype.handlePreFetchDocData=function(e,t){return a(this,void 0,void 0,(function(){var o,r,n,i,a,s,c;return l(this,(function(l){return y.default.log(b,"handlePreFetchDocData - padId:"+e),"blankpage"===(o="string"==typeof t?JSON.parse(t):t).padType||!0===o.isBlankPage?(y.default.error("文档数据不存在，或者无权限"),[2,{resultCode:g.SyncResultCode.FileNotExsitError,subResultCode:-200803,message:"handlePreFetchDocData slide 后台回包blankpage 文档数据不存在，或者无权限",error:new Error("DocumentBlankPageError")}]):(r=o.data,n=r.collab_client_vars.rev,i=r.collab_client_vars.dver,a=r.collab_client_vars.padSubId,s={gloabalPadId:r.globalPadId,secretId:r.collab_client_vars.client.upid,subBlock:a,rev:n,data:r,default:!0},c=[s],[2,{resultCode:g.SyncResultCode.Success,subResultCode:0,message:"handlePreFetchDocData Success",data:{rev:n,dver:i,allBlockData:c}}])}))}))},t.prototype.blockData2OfflineData=function(e,t){return y.default.log(b,"blockData2OfflineData"),this.clientVars2OfflineData(e.gloabalPadId,e.data,e.default||!1)},t.prototype.getDefaultDocData=function(e,t){return void 0===t&&(t=u.PadIdType.GLOBAL),a(this,void 0,void 0,(function(){var o;return l(this,(function(r){switch(r.label){case 0:switch(y.default.log(b,"getDefaultDocData - padId:"+e),o=d.QueryCondition.newInstance().addCondition("type",d.QUERY_CONDITION_TYPE.ONLY,p.OFFLINE_ITEM_TYPE.INIT).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),t){case u.PadIdType.GLOBAL:o.addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e);break;case u.PadIdType.SECRET:o.addCondition("secretId",d.QUERY_CONDITION_TYPE.ONLY,e)}return[4,this.database.get(u.TableName.DOCUMENT_DATA,o)];case 1:return[2,r.sent()]}}))}))},t.prototype.buildPadInfo=function(e){y.default.log(b,"buildPadInfo");var t=Date.now()/1e3,o=this.parent.user.getUserId(),r=new h.PadInfo(this.parent.user),n=e&&e.collab_client_vars&&e.collab_client_vars.dver||_,a=e&&e.collab_client_vars&&e.collab_client_vars.client.upid||"",l=e.globalPadId,s=e.title;return i(i({},r),{key:this.parent.user.getUserId()+l,type:h.FILE_TYPE.SLIDE,uid:o,dver:n,pad_id:e.localPadId,globalPadId:l,secretId:a,title:s,status:e.padStatus||h.PadStatus.NORMAL,creator:this.parent.user.getUserId(),isOfflineCache:!0,create_ts:t,isRencent:!0,last_modify_ts:t,last_browse_ts:t,doc_type:h.FILE_TYPE.SLIDE,doc_type_desc:h.TYPE_DES.SLIDE,doc_url:"//docs.qq.com/slide/"+a,lastSyncTime:t})},t.prototype.offlineDataSort=function(e){return y.default.log(b,"offlineDataSort"),e.sort((function(e,t){return e.createTime-t.createTime}))},t.prototype.getLocalCreateFileData=function(e,t){return void 0===t&&(t=!0),a(this,void 0,void 0,(function(){var t,o;return l(this,(function(r){switch(r.label){case 0:return y.default.log(b,"getLocalCreateFileData"),t=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",d.QUERY_CONDITION_TYPE.ONLY,p.OFFLINE_ITEM_TYPE.INIT).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),[4,this.database.get(u.TableName.DOCUMENT_DATA,t)];case 1:return(o=r.sent()).error?[2,new d.Result(o.error)]:[2,new d.Result(void 0,o.data)]}}))}))},t.prototype.createDefaultClientVarsAndWriteDB=function(e){return a(this,void 0,void 0,(function(){var t,o;return l(this,(function(r){switch(r.label){case 0:return y.default.log(b,"createDefaultClientVarsAndWriteDB"),t=this.createDefaultClientVars({globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),dver:_}),(o=this.clientVars2OfflineData(e.globalPadId,t)).padStatus=h.PadStatus.NEW,[4,this.database.updateMultiTableData([{tableName:u.TableName.DOCUMENT_DATA,data:o},{tableName:u.TableName.DOCUMENT_STATUS,data:{globalPadId:e.globalPadId,secretId:e.secretId,uid:this.parent.user.getUserId(),lastSyncTime:Date.now()}}])];case 1:return[2,r.sent()]}}))}))},t.prototype.createDefaultClientVars=function(e){y.default.log(b,"createDefaultClientVars");var t=(new v.App).createSlideEmptyTemplate(),o=JSON.stringify(t),r=e.secretId,n=e.globalPadId,i=e.dver,a=e.uid||m.getCookie("uid"),l="string"==typeof n?n.split("$")[1]:"";return{accountPrivs:{},advPolicy:{},cdn:"",clientIp:"",collab_client_vars:{apid:{},apool:{numToAttrib:{0:["flowid","BB08J2"],1:["flowid","LSTTMP"],2:["story-type","list-template"]},nextNum:3},bad:-1,client:{upid:r},dirty:-1,dver:i||_,globalPadId:n,gray:-1,header:[],initialAttributedText:{text:o,attribs:""},padId:l,padSubId:"BB08J2",padType:"slide",pollingAttemptNumber:-1,pos:1,pver:1,rev:0,ver:2147483647,websocket:!1,websocketReopenCount:-1,wmode:"wb"},colorPalette:[],creatorDomain:"300000000",creatorId:"",disableFB:!1,docStatus:-1,domainId:"300000000",dropboxConnected:!1,encrypted:"",envi:null,friendUserIds:[],globalPadId:n,initialOptions:{},initialRevisionList:[],initialTitle:"",invitedGroupInfos:[],invitedUserInfos:[],isCreator:!0,isDesktopApp:!1,isEmbed:!1,isIPad:m.UserAgent.isPad,isIPhone:!1,isLocalDoc:!0,isLogin:!0,isMac:!1,isMobile:m.UserAgent.isMobile,isMobileApp:!1,isNewProject:!1,isOpendocxfromTim:!1,isOverConNum:!1,isOwner:!0,isPadAdmin:!1,isProPad:!1,isPublicPad:!1,isTIM:!1,isTimDomain:!1,isTimOnline:!1,isUserChangeTitle:-1,localPadId:l,newOpenSvc:-1,ownerAppid:"",ownerId:"",padId:l,padTitle:"无标题文档",padType:"slide",padStatus:h.PadStatus.NEW,pagingFlag:"",policy:-1,privilegeAttribute:{can_about:1,can_add_user:1,can_comment:1,can_copy:1,can_edit:1,can_edit_title:1,can_history:1,can_link_exp:1,can_print:1,can_read:1,can_search:1,can_share:1,can_spit_slot:1,can_translate:1,can_view_image:1,can_watermark:1,is_auth:1},privilegeExpire:-1,proTitle:"",rightFlag:4294967295,shortLink:"",shouldGetFbLoginStatus:!1,siteName:"",titleIsReadOnly:!1,uin:m.getCookie("uin"),useFbChat:!1,userColor:-1,userDomain:"",userId:"p."+a,userInfo:{},userIsGuest:!1,userLink:"",userName:"",userPic:"",userType:"",xsrf:""}},t.prototype.preCreateDefaultClientVars=function(e){return a(this,void 0,void 0,(function(){var t,o,r,n;return l(this,(function(i){switch(i.label){case 0:return y.default.log(b,"preCreateDefaultClientVars"),[4,this.checkLocalClientVars()];case 1:if((t=i.sent()).error)return y.default.log(b,"preCreateDefaultClientVars"+t.error),[2];for(o=[],r=0;r<e.length;r++)t.data&&t.data.SlideNum<c.LocalNewMaxNum&&(n=e[r],this.createDefaultClientVarsAndWriteDB(n),t.data.SlideNum=t.data.SlideNum+1,o.push(e[r]),n.isCreated=!0,n.padType=h.FILE_TYPE.SLIDE,this.updatePreFetchIdInfo(n));return[2]}}))}))},t.prototype.parseHeadersFromClientVars=function(e){return y.default.log(b,"parseHeadersFromClientVars"),e.collab_client_vars.header[0].d},t.prototype.createMisschangeData=function(e,t,o){y.default.log(b,"createMisschangeData - padId:"+e)},t.prototype.createMessageSeq=function(){var e=(new Date).getTime(),t=Math.ceil(2147483648*Math.random());return t+=e},t.prototype.removeUncommitedData=function(e){return a(this,void 0,void 0,(function(){var t;return l(this,(function(o){switch(o.label){case 0:t=d.QueryCondition.newInstance().addCondition("globalPadId",d.QUERY_CONDITION_TYPE.ONLY,e).addCondition("type",d.QUERY_CONDITION_TYPE.IN,[p.OFFLINE_ITEM_TYPE.COMMITING,p.OFFLINE_ITEM_TYPE.WATTING,p.OFFLINE_ITEM_TYPE.QUEUE]).addCondition("uid",d.QUERY_CONDITION_TYPE.ONLY,this.parent.user.getUserId()),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.database.delete(u.TableName.OFFLINE_DATA,t)];case 2:return[2,o.sent()];case 3:return o.sent(),[2,new d.Result(new Error("createDocAndUpdateDocUncommitedDataError"))];case 4:return[2]}}))}))},t}(c.BaseBusinessHelper);t.default=T},function(e,t,o){e.exports=function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s="../index.ts")}({"../index.ts":
/*!*******************!*\
  !*** ../index.ts ***!
  \*******************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(/*! ./src */"./index.ts");Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return r.initialize}}),Object.defineProperty(t,"SlideApp",{enumerable:!0,get:function(){return r.SlideApp}}),Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return r.Store}}),Object.defineProperty(t,"UploadManager",{enumerable:!0,get:function(){return r.UploadManager}}),Object.defineProperty(t,"Presentation",{enumerable:!0,get:function(){return r.Presentation}}),Object.defineProperty(t,"Slide",{enumerable:!0,get:function(){return r.Slide}}),Object.defineProperty(t,"Shape",{enumerable:!0,get:function(){return r.Shape}}),Object.defineProperty(t,"Picture",{enumerable:!0,get:function(){return r.Picture}}),Object.defineProperty(t,"GroupShape",{enumerable:!0,get:function(){return r.GroupShape}}),Object.defineProperty(t,"Connector",{enumerable:!0,get:function(){return r.Connector}}),Object.defineProperty(t,"Table",{enumerable:!0,get:function(){return r.Table}}),Object.defineProperty(t,"App",{enumerable:!0,get:function(){return r.App}});var n=o(/*! ./src/common/transaction */"./common/transaction.ts");Object.defineProperty(t,"transaction",{enumerable:!0,get:function(){return n.transaction}})},"../node_modules/@tencent/tencent-doc-report/lib/index.browser.js":
/*!************************************************************************!*\
  !*** ../node_modules/@tencent/tencent-doc-report/lib/index.browser.js ***!
  \************************************************************************/
/*! no static exports found */function(e,t,o){console.log("腾讯文档上报组件的版本是0.1.29"),function(e){"use strict";function t(e){return void 0===e&&(e=window.navigator.userAgent),/(mobile)/i.test(e)}function o(e){return void 0===e&&(e=window.navigator.userAgent),/(ipad)/i.test(e)}function r(e){return void 0===e&&(e=window.navigator.userAgent),!t(e)&&/Mac OS X/i.test(e)}function n(e){return void 0===e&&(e=window.navigator.userAgent),/android|adr/i.test(e)}function i(e){return void 0===e&&(e=window.navigator.userAgent),/(iphone|ipad|ipod)/i.test(e)}function a(e){return void 0===e&&(e=window.navigator.userAgent),/MSAppHost/i.test(e)}function l(e){return void 0===e&&(e=window.navigator.userAgent),!t(e)&&/QQBrowser/i.test(e)&&!/QBCore/i.test(e)}function s(e){return void 0===e&&(e=window.navigator.userAgent),t(e)&&/MQQBrowser/i.test(e)&&!/TBS/i.test(e)}function c(e){return void 0===e&&(e=window.navigator.userAgent),t(e)?s(e):l(e)}function d(e){return void 0===e&&(e=window.navigator.userAgent),/TencentDocs/i.test(e)}var u=d;function p(e){return void 0===e&&(e=window.navigator.userAgent),window.location.href.indexOf("__wxjs_environment=miniprogram")>-1||/MicroMessenger/i.test(e)&&/miniProgram/i.test(e)||"miniprogram"===window.__wxjs_environment}function h(e){return void 0===e&&(e=window.navigator.userAgent),window.location.href.indexOf("__wxjs_environment=qqminiprogram")>-1||/QQ/i.test(e)&&/MiniApp/i.test(e)||"qqminiprogram"===window.__wxjs_environment}function f(e){return void 0===e&&(e=window.navigator.userAgent),/(wxwork)/i.test(e)}var m=f;function y(e){return void 0===e&&(e=window.navigator.userAgent),/MicroMessenger/i.test(e)&&!f(e)&&!p(e)}var g=y;function v(e){return void 0===e&&(e=window.navigator.userAgent),/TIM/i.test(e)}function _(e){return void 0===e&&(e=window.navigator.userAgent),/QQ/i.test(e)&&!d(e)&&!f(e)&&!y(e)&&!c(e)&&!h(e)&&!v(e)}function b(e){return void 0===e&&(e=window.navigator.userAgent),void 0===e&&(e=window.navigator.userAgent),/weiyun/i.test(e)}function T(e){return void 0===e&&(e=window.navigator.userAgent),v(e)||_(e)}var S=T;function C(e){return void 0===e&&(e=window.navigator.userAgent),/TxDocsPC/i.test(e)}var w=function(e,t){return function(e){!function(){var t={},o=!1,r=[],n=0,i=null,a=function(e){var o;return window&&window.localStorage?(o=window.localStorage.getItem(e))&&JSON.parse(o)||void 0:t[e]},l=function(e,o){o?window&&window.localStorage?window.localStorage.setItem(e,JSON.stringify(o)):t[e]=o:window&&window.localStorage?window.localStorage.removeItem(e):delete t[e]},s=function(e,t){var o=+new Date;if(clearTimeout(i),o-n<50)return e&&t&&r.push({t:e,d:t}),void(i=setTimeout(s,10));n=o;var c=[];try{(!(c=a("ALLOY_REPORT_TEMP"))instanceof Array||!c)&&(c=[]),e&&t&&c.push({t:e,d:t}),c=c.concat(r),r=[],l("ALLOY_REPORT_TEMP",c)}catch(e){console.error(e)}c.push({t:e,d:t})},c=["monitor","tdw","huatuo","retcode","tdbank","tdw.setDefaultTable","tdbank.setDefaultTable","tdw.setDefaultData","tdbank.setDefaultData","tdw.clearDefaultData","tdbank.clearDefaultData","performance","closeLog","openLog","reset"],d={},u=function(e){if(e=e||0,("undefined"!=typeof window||"undefined"!=typeof document)&&!window.QReport.isMain&&e<4){var t="//s.url.cn/pub/js/alloyreport.next.js?_bid=2231";e&&e<3?t="//s"+e+".url.cn/pub/js/alloyreport.next.js":e&&(t="//pub.idqqimg.com/pub/js/alloyreport.next.js");var r=document.createElement("script");r.setAttribute("src",t),r.onload=r.onreadystatechange=function(){if(!(o||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState))if(o=!0,window.QReport.isMain)try{window.QReport.reset=window.AlloyReportCore&&window.AlloyReportCore.reset||function(){},Object.assign(d,window.QReport),function(){var e;!(e=a("ALLOY_REPORT_TEMP"))instanceof Array&&(e=[]);for(var t=0;t<e.length;t++)try{var o=e[t].t.split(".");if(o.length>1){if(!d[o[0]])return;d[o[0]][o[1]].apply(this,e[t].d)}else d[o[0]].apply(this,e[t].d)}catch(e){console.error(e)}l("ALLOY_REPORT_TEMP"),window.__reportWating=!1}()}catch(e){}else{switch(o=!1,e){case 0:window.QReport.monitor(2396704);break;case 1:window.QReport.monitor(2396705);break;case 2:window.QReport.monitor(2396706)}u(e+1)}},r.onerror=function(){switch(e){case 0:window.QReport.monitor(2396704);break;case 1:window.QReport.monitor(2396705);break;case 2:window.QReport.monitor(2396706)}u(e+1)},document.body.appendChild(r)}};"function"!=typeof Object.assign&&(Object.assign=function(e){if(!e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var o=arguments[t];if(o)for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e});for(var p=0;p<c.length;p++){var h=c[p],f=h.split("."),m=function(e){return function(){for(var t=[],o=0;o<arguments.length;o++)t.push(arguments[o]);s(e,t)}}(h);f.length>1?(d[f[0]]||(d[f[0]]={}),d[f[0]][f[1]]=m):d[f[0]]=m}"undefined"==typeof window&&"undefined"==typeof document||window.QReport||(window.QReport=d,window.AlloyReport=d,window.__reportWating=!0,u(0)),e.exports&&(e.exports=window.QReport)}()}(t={exports:{}}),t.exports}();function E(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),o=document.cookie.match(t);return o?o[1]:""}var I="";function x(){if(I)return I;var e=E("p_luin")||E("p_uin");return e&&(I=e.replace(/^[o0]+/i,"")),I}var R="";function O(){if(R)return R;var e=E("uid");return e&&(R=e),R}function P(e){for(var t="",o=0;o<e;o++)t+=Math.random().toString(36).substr(2);return t}function D(){try{var e=window.localStorage&&window.localStorage.getItem("browserStr");return e||(e=P(5),window.localStorage&&window.localStorage.setItem("browserStr",e)),e}catch(e){return P(5)}}function N(e){var t=window.location.search.substring(1);if(t)for(var o=0,r=t.split("&");o<r.length;o++){var n=r[o].split("="),i=n[0],a=n[1];if(i===e)return a}}function k(e){void 0===e&&(e=window.navigator.userAgent);var t=e.split("TxDocsPC/")[1];return t?t.split("_")[1]:""}var L=window.clientVars,F={qq:1,wx:2,guest:3,ww:5};function A(){var e=E("utype")||"guest";return L?L.userIsGuest?3:L.uin?"wx"===e?2:"ww"===e?5:1:4:F[e]||4}w.reset({mergeQueueConfig:{maxInBatch:30}});var V={doc:1,sheet:2,form:3,slide:4,tnote:6,pdf:7};function j(e){void 0===e&&(e="");var t=L&&L.padType||e;return t&&V[t]||""}function B(e){return e?2&e?2:1&e?1:3:""}function M(){return t()?n()?2:i()?o()?6:3:4:r()?5:1}function U(){return C()?10:v()?2:p()?3:y()?4:d()?6:a()?8:c()?5:_()?1:m()?9:b()?11:h()?12:5}var H={};function Y(){L=window.clientVars,Object.assign(H,{table:"dc03111",third_appid:L&&L.collab_client_vars&&L.collab_client_vars.apid&&L.collab_client_vars.apid.apid,uin:x()||O(),uid:L&&"string"==typeof L.userId?L.userId.replace(/^p\./,""):O()||"",user_mac:D(),uin_type:A(),platform:M(),appid:"",touin:L&&L.creatorDomain||"",toid:O(),isOwner:L&&L.isOwner||0,file_type:j(),id:L&&L.padId||"",source1:U(),source2:"",source3:N("from")||k(),obj1:B(L&&L.rightFlag),obj2:(L&&L.padTitle||"").replace(/\t/g,""),ver1:L&&L.globalPadId||"",ver2:L&&L.creatorId||"",ver3:L&&L.domainId||"",ver4:L&&L.ownerId||""})}Y();var z=w;e.AlloyReport=z,e.isMobile=t,e.isIPad=o,e.isMac=r,e.isAndroid=n,e.isIOS=i,e.isWindowStore=a,e.isPCQQBrowser=l,e.isMobileQQBrowser=s,e.isQQBrowser=c,e.isTencentDocApp=d,e.isTencentDocsApp=u,e.isWxMiniProgram=p,e.isQQMiniProgram=h,e.isMiniProgram=function(e){return void 0===e&&(e=window.navigator.userAgent),p(e)||h(e)},e.isWxWork=f,e.isWeWork=m,e.isWeChat=y,e.isWechat=g,e.isTim=v,e.isQQ=_,e.isWeiYunApp=b,e.isTimOrQQ=T,e.isTimQQ=S,e.isTimOrQQFamily=function(e){return void 0===e&&(e=window.navigator.userAgent),v()||/QQ/i.test(e)},e.isPCTim=function(e){return void 0===e&&(e=window.navigator.userAgent),/QBCore/i.test(e)&&/TIM2.0/i.test(e)},e.isQQFamily=function(e){return void 0===e&&(e=window.navigator.userAgent),/QQ/i.test(e)},e.isPCTencentDocApp=C,e.getUinTypeForReport=A,e.getFileTypeForReport=j,e.getAuth=B,e.getPlatform=M,e.getSource1=U,e.resetDefaultTdwData=Y,e.tdw=function(e,t){void 0===e&&(e={});var o=void 0===t?{}:t,r=o.showLog,n=void 0!==r&&r,i=o.immediate,a=Object.assign({},H);for(var l in e){var s=e[l];void 0!==s&&(a[l]=s)}return(n||window._tencent_doc_report_show_log)&&console.log("打点上传的参数是",a),w.tdw(a,i)},e.tdwSingle=function(e,t){void 0===e&&(e={});var o=Object.assign({},H);for(var r in e){var n=e[r];void 0!==n&&(o[r]=n)}o.table,t=t instanceof Array?t:[];var i={};for(var a in o)if(o.hasOwnProperty(a)){if(t.indexOf(a)>-1)continue;i[a]=o[a]}return w.tdw(i)},e.getCookie=E,e.getCookieUin=x,e.getCookieUid=O,e.getBrowserStr=D,e.getUrlParameter=N,e.getSource3FromUserAgent=k,Object.defineProperty(e,"__esModule",{value:!0})}(t)},"../node_modules/assert/assert.js":
/*!****************************************!*\
  !*** ../node_modules/assert/assert.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(t){var r=o(/*! object-assign */"../node_modules/object-assign/index.js");
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function n(e,t){if(e===t)return 0;for(var o=e.length,r=t.length,n=0,i=Math.min(o,r);n<i;++n)if(e[n]!==t[n]){o=e[n],r=t[n];break}return o<r?-1:r<o?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var a=o(/*! util/ */"../node_modules/util/util.js"),l=Object.prototype.hasOwnProperty,s=Array.prototype.slice,c="foo"===function(){}.name;function d(e){return Object.prototype.toString.call(e)}function u(e){return!i(e)&&"function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}var p=e.exports=v,h=/\s*function\s+([^\(\s]*)\s*/;function f(e){if(a.isFunction(e)){if(c)return e.name;var t=e.toString().match(h);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function y(e){if(c||!a.isFunction(e))return a.inspect(e);var t=f(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,o,r,n){throw new p.AssertionError({message:o,actual:e,expected:t,operator:r,stackStartFunction:n})}function v(e,t){e||g(e,!0,t,"==",p.ok)}function _(e,t,o,r){if(e===t)return!0;if(i(e)&&i(t))return 0===n(e,t);if(a.isDate(e)&&a.isDate(t))return e.getTime()===t.getTime();if(a.isRegExp(e)&&a.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(u(e)&&u(t)&&d(e)===d(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===n(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var l=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==l&&l===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,o,r){if(null==e||null==t)return!1;if(a.isPrimitive(e)||a.isPrimitive(t))return e===t;if(o&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var n=b(e),i=b(t);if(n&&!i||!n&&i)return!1;if(n)return _(e=s.call(e),t=s.call(t),o);var l,c,d=C(e),u=C(t);if(d.length!==u.length)return!1;for(d.sort(),u.sort(),c=d.length-1;c>=0;c--)if(d[c]!==u[c])return!1;for(c=d.length-1;c>=0;c--)if(!_(e[l=d[c]],t[l],o,r))return!1;return!0}(e,t,o,r))}return o?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function T(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function S(e,t,o,r){var n;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof o&&(r=o,o=null),n=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(o&&o.name?" ("+o.name+").":".")+(r?" "+r:"."),e&&!n&&g(n,o,"Missing expected exception"+r);var i="string"==typeof r,l=!e&&n&&!o;if((!e&&a.isError(n)&&i&&T(n,o)||l)&&g(n,o,"Got unwanted exception"+r),e&&n&&o&&!T(n,o)||!e&&n)throw n}p.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(y(e.actual),128)+" "+e.operator+" "+m(y(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var o=new Error;if(o.stack){var r=o.stack,n=f(t),i=r.indexOf("\n"+n);if(i>=0){var a=r.indexOf("\n",i+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(p.AssertionError,Error),p.fail=g,p.ok=v,p.equal=function(e,t,o){e!=t&&g(e,t,o,"==",p.equal)},p.notEqual=function(e,t,o){e==t&&g(e,t,o,"!=",p.notEqual)},p.deepEqual=function(e,t,o){_(e,t,!1)||g(e,t,o,"deepEqual",p.deepEqual)},p.deepStrictEqual=function(e,t,o){_(e,t,!0)||g(e,t,o,"deepStrictEqual",p.deepStrictEqual)},p.notDeepEqual=function(e,t,o){_(e,t,!1)&&g(e,t,o,"notDeepEqual",p.notDeepEqual)},p.notDeepStrictEqual=function e(t,o,r){_(t,o,!0)&&g(t,o,r,"notDeepStrictEqual",e)},p.strictEqual=function(e,t,o){e!==t&&g(e,t,o,"===",p.strictEqual)},p.notStrictEqual=function(e,t,o){e===t&&g(e,t,o,"!==",p.notStrictEqual)},p.throws=function(e,t,o){S(!0,e,t,o)},p.doesNotThrow=function(e,t,o){S(!1,e,t,o)},p.ifError=function(e){if(e)throw e},p.strict=r((function e(t,o){t||g(t,!0,o,"==",e)}),p,{equal:p.strictEqual,deepEqual:p.deepStrictEqual,notEqual:p.notStrictEqual,notDeepEqual:p.notDeepStrictEqual}),p.strict.strict=p.strict;var C=Object.keys||function(e){var t=[];for(var o in e)l.call(e,o)&&t.push(o);return t}}).call(this,o(/*! ./../webpack/buildin/global.js */"../node_modules/webpack/buildin/global.js"))},"../node_modules/axios/index.js":
/*!**************************************!*\
  !*** ../node_modules/axios/index.js ***!
  \**************************************/
/*! no static exports found */function(e,t,o){e.exports=o(/*! ./lib/axios */"../node_modules/axios/lib/axios.js")},"../node_modules/axios/lib/adapters/xhr.js":
/*!*************************************************!*\
  !*** ../node_modules/axios/lib/adapters/xhr.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js"),n=o(/*! ./../core/settle */"../node_modules/axios/lib/core/settle.js"),i=o(/*! ./../helpers/buildURL */"../node_modules/axios/lib/helpers/buildURL.js"),a=o(/*! ./../helpers/parseHeaders */"../node_modules/axios/lib/helpers/parseHeaders.js"),l=o(/*! ./../helpers/isURLSameOrigin */"../node_modules/axios/lib/helpers/isURLSameOrigin.js"),s=o(/*! ../core/createError */"../node_modules/axios/lib/core/createError.js");e.exports=function(e){return new Promise((function(t,c){var d=e.data,u=e.headers;r.isFormData(d)&&delete u["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",f=e.auth.password||"";u.Authorization="Basic "+btoa(h+":"+f)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var o="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:o,config:e,request:p};n(t,c,r),p=null}},p.onerror=function(){c(s("Network Error",e,null,p)),p=null},p.ontimeout=function(){c(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var m=o(/*! ./../helpers/cookies */"../node_modules/axios/lib/helpers/cookies.js"),y=(e.withCredentials||l(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;y&&(u[e.xsrfHeaderName]=y)}if("setRequestHeader"in p&&r.forEach(u,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete u[t]:p.setRequestHeader(t,e)})),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),c(e),p=null)})),void 0===d&&(d=null),p.send(d)}))}},"../node_modules/axios/lib/axios.js":
/*!******************************************!*\
  !*** ../node_modules/axios/lib/axios.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./utils */"../node_modules/axios/lib/utils.js"),n=o(/*! ./helpers/bind */"../node_modules/axios/lib/helpers/bind.js"),i=o(/*! ./core/Axios */"../node_modules/axios/lib/core/Axios.js"),a=o(/*! ./defaults */"../node_modules/axios/lib/defaults.js");function l(e){var t=new i(e),o=n(i.prototype.request,t);return r.extend(o,i.prototype,t),r.extend(o,t),o}var s=l(a);s.Axios=i,s.create=function(e){return l(r.merge(a,e))},s.Cancel=o(/*! ./cancel/Cancel */"../node_modules/axios/lib/cancel/Cancel.js"),s.CancelToken=o(/*! ./cancel/CancelToken */"../node_modules/axios/lib/cancel/CancelToken.js"),s.isCancel=o(/*! ./cancel/isCancel */"../node_modules/axios/lib/cancel/isCancel.js"),s.all=function(e){return Promise.all(e)},s.spread=o(/*! ./helpers/spread */"../node_modules/axios/lib/helpers/spread.js"),e.exports=s,e.exports.default=s},"../node_modules/axios/lib/cancel/Cancel.js":
/*!**************************************************!*\
  !*** ../node_modules/axios/lib/cancel/Cancel.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},"../node_modules/axios/lib/cancel/CancelToken.js":
/*!*******************************************************!*\
  !*** ../node_modules/axios/lib/cancel/CancelToken.js ***!
  \*******************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./Cancel */"../node_modules/axios/lib/cancel/Cancel.js");function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var o=this;e((function(e){o.reason||(o.reason=new r(e),t(o.reason))}))}n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e;return{token:new n((function(t){e=t})),cancel:e}},e.exports=n},"../node_modules/axios/lib/cancel/isCancel.js":
/*!****************************************************!*\
  !*** ../node_modules/axios/lib/cancel/isCancel.js ***!
  \****************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},"../node_modules/axios/lib/core/Axios.js":
/*!***********************************************!*\
  !*** ../node_modules/axios/lib/core/Axios.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../defaults */"../node_modules/axios/lib/defaults.js"),n=o(/*! ./../utils */"../node_modules/axios/lib/utils.js"),i=o(/*! ./InterceptorManager */"../node_modules/axios/lib/core/InterceptorManager.js"),a=o(/*! ./dispatchRequest */"../node_modules/axios/lib/core/dispatchRequest.js");function l(e){this.defaults=e,this.interceptors={request:new i,response:new i}}l.prototype.request=function(e){"string"==typeof e&&(e=n.merge({url:arguments[0]},arguments[1])),(e=n.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],o=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)o=o.then(t.shift(),t.shift());return o},n.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,o){return this.request(n.merge(o||{},{method:e,url:t}))}})),n.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,o,r){return this.request(n.merge(r||{},{method:e,url:t,data:o}))}})),e.exports=l},"../node_modules/axios/lib/core/InterceptorManager.js":
/*!************************************************************!*\
  !*** ../node_modules/axios/lib/core/InterceptorManager.js ***!
  \************************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js");function n(){this.handlers=[]}n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=n},"../node_modules/axios/lib/core/createError.js":
/*!*****************************************************!*\
  !*** ../node_modules/axios/lib/core/createError.js ***!
  \*****************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./enhanceError */"../node_modules/axios/lib/core/enhanceError.js");e.exports=function(e,t,o,n,i){var a=new Error(e);return r(a,t,o,n,i)}},"../node_modules/axios/lib/core/dispatchRequest.js":
/*!*********************************************************!*\
  !*** ../node_modules/axios/lib/core/dispatchRequest.js ***!
  \*********************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js"),n=o(/*! ./transformData */"../node_modules/axios/lib/core/transformData.js"),i=o(/*! ../cancel/isCancel */"../node_modules/axios/lib/cancel/isCancel.js"),a=o(/*! ../defaults */"../node_modules/axios/lib/defaults.js"),l=o(/*! ./../helpers/isAbsoluteURL */"../node_modules/axios/lib/helpers/isAbsoluteURL.js"),s=o(/*! ./../helpers/combineURLs */"../node_modules/axios/lib/helpers/combineURLs.js");function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!l(e.url)&&(e.url=s(e.baseURL,e.url)),e.headers=e.headers||{},e.data=n(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return c(e),t.data=n(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=n(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},"../node_modules/axios/lib/core/enhanceError.js":
/*!******************************************************!*\
  !*** ../node_modules/axios/lib/core/enhanceError.js ***!
  \******************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e,t,o,r,n){return e.config=t,o&&(e.code=o),e.request=r,e.response=n,e}},"../node_modules/axios/lib/core/settle.js":
/*!************************************************!*\
  !*** ../node_modules/axios/lib/core/settle.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./createError */"../node_modules/axios/lib/core/createError.js");e.exports=function(e,t,o){var n=o.config.validateStatus;o.status&&n&&!n(o.status)?t(r("Request failed with status code "+o.status,o.config,null,o.request,o)):e(o)}},"../node_modules/axios/lib/core/transformData.js":
/*!*******************************************************!*\
  !*** ../node_modules/axios/lib/core/transformData.js ***!
  \*******************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js");e.exports=function(e,t,o){return r.forEach(o,(function(o){e=o(e,t)})),e}},"../node_modules/axios/lib/defaults.js":
/*!*********************************************!*\
  !*** ../node_modules/axios/lib/defaults.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(t){var r=o(/*! ./utils */"../node_modules/axios/lib/utils.js"),n=o(/*! ./helpers/normalizeHeaderName */"../node_modules/axios/lib/helpers/normalizeHeaderName.js"),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(e=o(/*! ./adapters/xhr */"../node_modules/axios/lib/adapters/xhr.js")),e}(),transformRequest:[function(e,t){return n(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){l.headers[e]=r.merge(i)})),e.exports=l}).call(this,o(/*! ./../../process/browser.js */"../node_modules/process/browser.js"))},"../node_modules/axios/lib/helpers/bind.js":
/*!*************************************************!*\
  !*** ../node_modules/axios/lib/helpers/bind.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e,t){return function(){for(var o=new Array(arguments.length),r=0;r<o.length;r++)o[r]=arguments[r];return e.apply(t,o)}}},"../node_modules/axios/lib/helpers/buildURL.js":
/*!*****************************************************!*\
  !*** ../node_modules/axios/lib/helpers/buildURL.js ***!
  \*****************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js");function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,o){if(!t)return e;var i;if(o)i=o(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(n(t)+"="+n(e))})))})),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},"../node_modules/axios/lib/helpers/combineURLs.js":
/*!********************************************************!*\
  !*** ../node_modules/axios/lib/helpers/combineURLs.js ***!
  \********************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},"../node_modules/axios/lib/helpers/cookies.js":
/*!****************************************************!*\
  !*** ../node_modules/axios/lib/helpers/cookies.js ***!
  \****************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,o,n,i,a){var l=[];l.push(e+"="+encodeURIComponent(t)),r.isNumber(o)&&l.push("expires="+new Date(o).toGMTString()),r.isString(n)&&l.push("path="+n),r.isString(i)&&l.push("domain="+i),!0===a&&l.push("secure"),document.cookie=l.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},"../node_modules/axios/lib/helpers/isAbsoluteURL.js":
/*!**********************************************************!*\
  !*** ../node_modules/axios/lib/helpers/isAbsoluteURL.js ***!
  \**********************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},"../node_modules/axios/lib/helpers/isURLSameOrigin.js":
/*!************************************************************!*\
  !*** ../node_modules/axios/lib/helpers/isURLSameOrigin.js ***!
  \************************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");function n(e){var r=e;return t&&(o.setAttribute("href",r),r=o.href),o.setAttribute("href",r),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}return e=n(window.location.href),function(t){var o=r.isString(t)?n(t):t;return o.protocol===e.protocol&&o.host===e.host}}():function(){return!0}},"../node_modules/axios/lib/helpers/normalizeHeaderName.js":
/*!****************************************************************!*\
  !*** ../node_modules/axios/lib/helpers/normalizeHeaderName.js ***!
  \****************************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ../utils */"../node_modules/axios/lib/utils.js");e.exports=function(e,t){r.forEach(e,(function(o,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=o,delete e[r])}))}},"../node_modules/axios/lib/helpers/parseHeaders.js":
/*!*********************************************************!*\
  !*** ../node_modules/axios/lib/helpers/parseHeaders.js ***!
  \*********************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./../utils */"../node_modules/axios/lib/utils.js"),n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,o,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),o=r.trim(e.substr(i+1)),t){if(a[t]&&n.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([o]):a[t]?a[t]+", "+o:o}})),a):a}},"../node_modules/axios/lib/helpers/spread.js":
/*!***************************************************!*\
  !*** ../node_modules/axios/lib/helpers/spread.js ***!
  \***************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},"../node_modules/axios/lib/utils.js":
/*!******************************************!*\
  !*** ../node_modules/axios/lib/utils.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./helpers/bind */"../node_modules/axios/lib/helpers/bind.js"),n=o(/*! is-buffer */"../node_modules/is-buffer/index.js"),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function l(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var o=0,r=e.length;o<r;o++)t.call(null,e[o],o,e);else for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:n,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:l,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:s,isStream:function(e){return l(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function e(){var t={};function o(o,r){"object"==typeof t[r]&&"object"==typeof o?t[r]=e(t[r],o):t[r]=o}for(var r=0,n=arguments.length;r<n;r++)c(arguments[r],o);return t},extend:function(e,t,o){return c(t,(function(t,n){e[n]=o&&"function"==typeof t?r(t,o):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},"../node_modules/fast-json-patch/index.mjs":
/*!*************************************************!*\
  !*** ../node_modules/fast-json-patch/index.mjs ***!
  \*************************************************/
/*! exports provided: getValueByPointer, applyOperation, applyPatch, applyReducer, validator, validate, _areEquals, unobserve, observe, generate, compare, JsonPatchError, deepClone, escapePathComponent, unescapePathComponent, default */function(e,t,o){"use strict";o.r(t);var r=o(/*! ./module/core.mjs */"../node_modules/fast-json-patch/module/core.mjs");o.d(t,"getValueByPointer",(function(){return r.getValueByPointer})),o.d(t,"applyOperation",(function(){return r.applyOperation})),o.d(t,"applyPatch",(function(){return r.applyPatch})),o.d(t,"applyReducer",(function(){return r.applyReducer})),o.d(t,"validator",(function(){return r.validator})),o.d(t,"validate",(function(){return r.validate})),o.d(t,"_areEquals",(function(){return r._areEquals}));var n=o(/*! ./module/duplex.mjs */"../node_modules/fast-json-patch/module/duplex.mjs");o.d(t,"unobserve",(function(){return n.unobserve})),o.d(t,"observe",(function(){return n.observe})),o.d(t,"generate",(function(){return n.generate})),o.d(t,"compare",(function(){return n.compare}));var i=o(/*! ./module/helpers.mjs */"../node_modules/fast-json-patch/module/helpers.mjs");o.d(t,"JsonPatchError",(function(){return i.PatchError})),o.d(t,"deepClone",(function(){return i._deepClone})),o.d(t,"escapePathComponent",(function(){return i.escapePathComponent})),o.d(t,"unescapePathComponent",(function(){return i.unescapePathComponent})),t.default=Object.assign({},r,n,{JsonPatchError:i.PatchError,deepClone:i._deepClone,escapePathComponent:i.escapePathComponent,unescapePathComponent:i.unescapePathComponent})},"../node_modules/fast-json-patch/module/core.mjs":
/*!*******************************************************!*\
  !*** ../node_modules/fast-json-patch/module/core.mjs ***!
  \*******************************************************/
/*! exports provided: JsonPatchError, deepClone, getValueByPointer, applyOperation, applyPatch, applyReducer, validator, validate, _areEquals */function(e,t,o){"use strict";o.r(t),o.d(t,"JsonPatchError",(function(){return n})),o.d(t,"deepClone",(function(){return i})),o.d(t,"getValueByPointer",(function(){return s})),o.d(t,"applyOperation",(function(){return c})),o.d(t,"applyPatch",(function(){return d})),o.d(t,"applyReducer",(function(){return u})),o.d(t,"validator",(function(){return p})),o.d(t,"validate",(function(){return h})),o.d(t,"_areEquals",(function(){return f}));var r=o(/*! ./helpers.mjs */"../node_modules/fast-json-patch/module/helpers.mjs"),n=r.PatchError,i=r._deepClone,a={add:function(e,t,o){return e[t]=this.value,{newDocument:o}},remove:function(e,t,o){var r=e[t];return delete e[t],{newDocument:o,removed:r}},replace:function(e,t,o){var r=e[t];return e[t]=this.value,{newDocument:o,removed:r}},move:function(e,t,o){var n=s(o,this.path);n&&(n=Object(r._deepClone)(n));var i=c(o,{op:"remove",path:this.from}).removed;return c(o,{op:"add",path:this.path,value:i}),{newDocument:o,removed:n}},copy:function(e,t,o){var n=s(o,this.from);return c(o,{op:"add",path:this.path,value:Object(r._deepClone)(n)}),{newDocument:o}},test:function(e,t,o){return{newDocument:o,test:f(e[t],this.value)}},_get:function(e,t,o){return this.value=e[t],{newDocument:o}}},l={add:function(e,t,o){return Object(r.isInteger)(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:o,index:t}},remove:function(e,t,o){return{newDocument:o,removed:e.splice(t,1)[0]}},replace:function(e,t,o){var r=e[t];return e[t]=this.value,{newDocument:o,removed:r}},move:a.move,copy:a.copy,test:a.test,_get:a._get};function s(e,t){if(""==t)return e;var o={op:"_get",path:t};return c(e,o),o.value}function c(e,t,o,i,c,d){if(void 0===o&&(o=!1),void 0===i&&(i=!0),void 0===c&&(c=!0),void 0===d&&(d=0),o&&("function"==typeof o?o(t,0,e,t.path):p(t,0)),""===t.path){var u={newDocument:e};if("add"===t.op)return u.newDocument=t.value,u;if("replace"===t.op)return u.newDocument=t.value,u.removed=e,u;if("move"===t.op||"copy"===t.op)return u.newDocument=s(e,t.from),"move"===t.op&&(u.removed=e),u;if("test"===t.op){if(u.test=f(e,t.value),!1===u.test)throw new n("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return u.newDocument=e,u}if("remove"===t.op)return u.removed=e,u.newDocument=null,u;if("_get"===t.op)return t.value=e,u;if(o)throw new n("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",d,t,e);return u}i||(e=Object(r._deepClone)(e));var h=(t.path||"").split("/"),m=e,y=1,g=h.length,v=void 0,_=void 0,b=void 0;for(b="function"==typeof o?o:p;;){if(_=h[y],c&&"__proto__"==_)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(o&&void 0===v&&(void 0===m[_]?v=h.slice(0,y).join("/"):y==g-1&&(v=t.path),void 0!==v&&b(t,0,e,v)),y++,Array.isArray(m)){if("-"===_)_=m.length;else{if(o&&!Object(r.isInteger)(_))throw new n("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",d,t,e);Object(r.isInteger)(_)&&(_=~~_)}if(y>=g){if(o&&"add"===t.op&&_>m.length)throw new n("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",d,t,e);if(!1===(u=l[t.op].call(t,m,_,e)).test)throw new n("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return u}}else if(_&&-1!=_.indexOf("~")&&(_=Object(r.unescapePathComponent)(_)),y>=g){if(!1===(u=a[t.op].call(t,m,_,e)).test)throw new n("Test operation failed","TEST_OPERATION_FAILED",d,t,e);return u}m=m[_]}}function d(e,t,o,i,a){if(void 0===i&&(i=!0),void 0===a&&(a=!0),o&&!Array.isArray(t))throw new n("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=Object(r._deepClone)(e));for(var l=new Array(t.length),s=0,d=t.length;s<d;s++)l[s]=c(e,t[s],o,!0,a,s),e=l[s].newDocument;return l.newDocument=e,l}function u(e,t,o){var r=c(e,t);if(!1===r.test)throw new n("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return r.newDocument}function p(e,t,o,i){if("object"!=typeof e||null===e||Array.isArray(e))throw new n("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,o);if(!a[e.op])throw new n("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,o);if("string"!=typeof e.path)throw new n("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,o);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new n('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,o);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new n("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new n("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,o);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&Object(r.hasUndefined)(e.value))throw new n("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,o);if(o)if("add"==e.op){var l=e.path.split("/").length,s=i.split("/").length;if(l!==s+1&&l!==s)throw new n("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,o)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==i)throw new n("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,o)}else if("move"===e.op||"copy"===e.op){var c=h([{op:"_get",path:e.from,value:void 0}],o);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new n("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,o)}}function h(e,t,o){try{if(!Array.isArray(e))throw new n("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)d(Object(r._deepClone)(t),Object(r._deepClone)(e),o||!0);else{o=o||p;for(var i=0;i<e.length;i++)o(e[i],i,t,void 0)}}catch(e){if(e instanceof n)return e;throw e}}function f(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var o,r,n,i=Array.isArray(e),a=Array.isArray(t);if(i&&a){if((r=e.length)!=t.length)return!1;for(o=r;0!=o--;)if(!f(e[o],t[o]))return!1;return!0}if(i!=a)return!1;var l=Object.keys(e);if((r=l.length)!==Object.keys(t).length)return!1;for(o=r;0!=o--;)if(!t.hasOwnProperty(l[o]))return!1;for(o=r;0!=o--;)if(!f(e[n=l[o]],t[n]))return!1;return!0}return e!=e&&t!=t}},"../node_modules/fast-json-patch/module/duplex.mjs":
/*!*********************************************************!*\
  !*** ../node_modules/fast-json-patch/module/duplex.mjs ***!
  \*********************************************************/
/*! exports provided: unobserve, observe, generate, compare */function(e,t,o){"use strict";o.r(t),o.d(t,"unobserve",(function(){return s})),o.d(t,"observe",(function(){return c})),o.d(t,"generate",(function(){return d})),o.d(t,"compare",(function(){return p}));var r=o(/*! ./helpers.mjs */"../node_modules/fast-json-patch/module/helpers.mjs"),n=o(/*! ./core.mjs */"../node_modules/fast-json-patch/module/core.mjs"),i=new WeakMap,a=function(e){this.observers=new Map,this.obj=e},l=function(e,t){this.callback=e,this.observer=t};function s(e,t){t.unobserve()}function c(e,t){var o,n=function(e){return i.get(e)}(e);if(n){var s=function(e,t){return e.observers.get(t)}(n,t);o=s&&s.observer}else n=new a(e),i.set(e,n);if(o)return o;if(o={},n.value=Object(r._deepClone)(e),t){o.callback=t,o.next=null;var c=function(){d(o)},u=function(){clearTimeout(o.next),o.next=setTimeout(c)};"undefined"!=typeof window&&(window.addEventListener("mouseup",u),window.addEventListener("keyup",u),window.addEventListener("mousedown",u),window.addEventListener("keydown",u),window.addEventListener("change",u))}return o.patches=[],o.object=e,o.unobserve=function(){d(o),clearTimeout(o.next),function(e,t){e.observers.delete(t.callback)}(n,o),"undefined"!=typeof window&&(window.removeEventListener("mouseup",u),window.removeEventListener("keyup",u),window.removeEventListener("mousedown",u),window.removeEventListener("keydown",u),window.removeEventListener("change",u))},n.observers.set(t,new l(t,o)),o}function d(e,t){void 0===t&&(t=!1);var o=i.get(e.object);u(o.value,e.object,e.patches,"",t),e.patches.length&&Object(n.applyPatch)(o.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function u(e,t,o,n,i){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var a=Object(r._objectKeys)(t),l=Object(r._objectKeys)(e),s=!1,c=l.length-1;c>=0;c--){var d=e[h=l[c]];if(!Object(r.hasOwnProperty)(t,h)||void 0===t[h]&&void 0!==d&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&o.push({op:"test",path:n+"/"+Object(r.escapePathComponent)(h),value:Object(r._deepClone)(d)}),o.push({op:"remove",path:n+"/"+Object(r.escapePathComponent)(h)}),s=!0):(i&&o.push({op:"test",path:n,value:e}),o.push({op:"replace",path:n,value:t}));else{var p=t[h];"object"==typeof d&&null!=d&&"object"==typeof p&&null!=p?u(d,p,o,n+"/"+Object(r.escapePathComponent)(h),i):d!==p&&(i&&o.push({op:"test",path:n+"/"+Object(r.escapePathComponent)(h),value:Object(r._deepClone)(d)}),o.push({op:"replace",path:n+"/"+Object(r.escapePathComponent)(h),value:Object(r._deepClone)(p)}))}}if(s||a.length!=l.length)for(c=0;c<a.length;c++){var h=a[c];Object(r.hasOwnProperty)(e,h)||void 0===t[h]||o.push({op:"add",path:n+"/"+Object(r.escapePathComponent)(h),value:Object(r._deepClone)(t[h])})}}}function p(e,t,o){void 0===o&&(o=!1);var r=[];return u(e,t,r,"",o),r}},"../node_modules/fast-json-patch/module/helpers.mjs":
/*!**********************************************************!*\
  !*** ../node_modules/fast-json-patch/module/helpers.mjs ***!
  \**********************************************************/
/*! exports provided: hasOwnProperty, _objectKeys, _deepClone, isInteger, escapePathComponent, unescapePathComponent, _getPathRecursive, getPath, hasUndefined, PatchError */function(e,t,o){"use strict";o.r(t),o.d(t,"hasOwnProperty",(function(){return i})),o.d(t,"_objectKeys",(function(){return a})),o.d(t,"_deepClone",(function(){return l})),o.d(t,"isInteger",(function(){return s})),o.d(t,"escapePathComponent",(function(){return c})),o.d(t,"unescapePathComponent",(function(){return d})),o.d(t,"_getPathRecursive",(function(){return u})),o.d(t,"getPath",(function(){return p})),o.d(t,"hasUndefined",(function(){return h})),o.d(t,"PatchError",(function(){return m}));
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var r=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=Object.prototype.hasOwnProperty;function i(e,t){return n.call(e,t)}function a(e){if(Array.isArray(e)){for(var t=new Array(e.length),o=0;o<t.length;o++)t[o]=""+o;return t}if(Object.keys)return Object.keys(e);for(var r in t=[],e)i(e,r)&&t.push(r);return t}function l(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function s(e){for(var t,o=0,r=e.length;o<r;){if(!((t=e.charCodeAt(o))>=48&&t<=57))return!1;o++}return!0}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function d(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function u(e,t){var o;for(var r in e)if(i(e,r)){if(e[r]===t)return c(r)+"/";if("object"==typeof e[r]&&""!=(o=u(e[r],t)))return c(r)+"/"+o}return""}function p(e,t){if(e===t)return"/";var o=u(e,t);if(""===o)throw new Error("Object not found in root");return"/"+o}function h(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,o=e.length;t<o;t++)if(h(e[t]))return!0}else if("object"==typeof e){var r=a(e),n=r.length;for(t=0;t<n;t++)if(h(e[r[t]]))return!0}return!1}function f(e,t){var o=[e];for(var r in t){var n="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==n&&o.push(r+": "+n)}return o.join("\n")}var m=function(e){function t(t,o,r,n,i){var a=this.constructor,l=e.call(this,f(t,{name:o,index:r,operation:n,tree:i}))||this;return l.name=o,l.index=r,l.operation=n,l.tree=i,Object.setPrototypeOf(l,a.prototype),l.message=f(t,{name:o,index:r,operation:n,tree:i}),l}return r(t,e),t}(Error)},"../node_modules/is-buffer/index.js":
/*!******************************************!*\
  !*** ../node_modules/is-buffer/index.js ***!
  \******************************************/
/*! no static exports found */function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},"../node_modules/jiff/jiff.js":
/*!************************************!*\
  !*** ../node_modules/jiff/jiff.js ***!
  \************************************/
/*! no static exports found */function(e,t,o){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
var r=o(/*! ./lib/lcs */"../node_modules/jiff/lib/lcs.js"),n=o(/*! ./lib/array */"../node_modules/jiff/lib/array.js"),i=o(/*! ./lib/jsonPatch */"../node_modules/jiff/lib/jsonPatch.js"),a=o(/*! ./lib/inverse */"../node_modules/jiff/lib/inverse.js"),l=o(/*! ./lib/jsonPointer */"../node_modules/jiff/lib/jsonPointer.js").encodeSegment;t.diff=function(e,t,o){return function e(t,o,i,a){return Array.isArray(t)&&Array.isArray(o)?function(t,o,i,a){var l=n.map(a.hash,t),s=n.map(a.hash,o);return function(t,o,n,i,a){var l=0;return r.reduce((function(i,a,s,c){var d,u,p=i.patch,h=n+"/"+(c+l);return a===r.REMOVE?(d=p[p.length-1],u=i.makeContext(c,t),i.invertible&&p.push({op:"test",path:h,value:t[c],context:u}),void 0!==d&&"add"===d.op&&d.path===h?(d.op="replace",d.context=u):p.push({op:"remove",path:h,context:u}),l-=1):a===r.ADD?(p.push({op:"add",path:h,value:o[s],context:i.makeContext(c,t)}),l+=1):e(t[c],o[s],h,i),i}),i,a)}(t,o,i,a,r.compare(l,s))}(t,o,i,a):s(t)&&s(o)?function(t,o,r,n){var i,a,s=Object.keys(o),c=n.patch;for(i=s.length-1;i>=0;--i){a=s[i];var d=r+"/"+l(a);void 0!==t[a]?e(t[a],o[a],d,n):c.push({op:"add",path:d,value:o[a]})}for(i=(s=Object.keys(t)).length-1;i>=0;--i)if(void 0===o[a=s[i]]){var u=r+"/"+l(a);n.invertible&&c.push({op:"test",path:u,value:t[a]}),c.push({op:"remove",path:u})}return n}(t,o,i,a):function(e,t,o,r){return e!==t&&(r.invertible&&r.patch.push({op:"test",path:o,value:e}),r.patch.push({op:"replace",path:o,value:t})),r}(t,o,i,a)}(e,t,"",function(e,t){return"object"==typeof e?{patch:t,hash:d(p,e.hash,c),makeContext:d(p,e.makeContext,u),invertible:!(!1===e.invertible)}:{patch:t,hash:d(p,e,c),makeContext:u,invertible:!0}}(o,[])).patch},t.patch=i.apply,t.patchInPlace=i.applyInPlace,t.inverse=a,t.clone=i.clone,t.InvalidPatchOperationError=o(/*! ./lib/InvalidPatchOperationError */"../node_modules/jiff/lib/InvalidPatchOperationError.js"),t.TestFailedError=o(/*! ./lib/TestFailedError */"../node_modules/jiff/lib/TestFailedError.js"),t.PatchNotInvertibleError=o(/*! ./lib/PatchNotInvertibleError */"../node_modules/jiff/lib/PatchNotInvertibleError.js");var s=i.isValidObject,c=i.defaultHash;function d(e,t,o){return e(t)?t:o}function u(){}function p(e){return"function"==typeof e}},"../node_modules/jiff/lib/InvalidPatchOperationError.js":
/*!**************************************************************!*\
  !*** ../node_modules/jiff/lib/InvalidPatchOperationError.js ***!
  \**************************************************************/
/*! no static exports found */function(e,t){function o(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}e.exports=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o},"../node_modules/jiff/lib/PatchNotInvertibleError.js":
/*!***********************************************************!*\
  !*** ../node_modules/jiff/lib/PatchNotInvertibleError.js ***!
  \***********************************************************/
/*! no static exports found */function(e,t){function o(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}e.exports=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o},"../node_modules/jiff/lib/TestFailedError.js":
/*!***************************************************!*\
  !*** ../node_modules/jiff/lib/TestFailedError.js ***!
  \***************************************************/
/*! no static exports found */function(e,t){function o(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}e.exports=o,o.prototype=Object.create(Error.prototype),o.prototype.constructor=o},"../node_modules/jiff/lib/array.js":
/*!*****************************************!*\
  !*** ../node_modules/jiff/lib/array.js ***!
  \*****************************************/
/*! no static exports found */function(e,t){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
t.cons=function(e,t){var o=t.length,r=new Array(o+1);r[0]=e;for(var n=0;n<o;++n)r[n+1]=t[n];return r},t.tail=function(e){for(var t=e.length-1,o=new Array(t),r=0;r<t;++r)o[r]=e[r+1];return o},t.map=function(e,t){for(var o=new Array(t.length),r=0;r<t.length;++r)o[r]=e(t[r]);return o}},"../node_modules/jiff/lib/clone.js":
/*!*****************************************!*\
  !*** ../node_modules/jiff/lib/clone.js ***!
  \*****************************************/
/*! no static exports found */function(e,t){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
e.exports=function e(t){return null==t||"object"!=typeof t?t:Array.isArray(t)?function(t){for(var o=t.length,r=new Array(o),n=0;n<o;++n)r[n]=e(t[n]);return r}(t):function(t){for(var o,r=Object.keys(t),n={},i=0,a=r.length;i<a;++i)n[o=r[i]]=e(t[o]);return n}(t)}},"../node_modules/jiff/lib/commutePaths.js":
/*!************************************************!*\
  !*** ../node_modules/jiff/lib/commutePaths.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./jsonPointer */"../node_modules/jiff/lib/jsonPointer.js");function n(e,t,o,r,n){var i=t.length-1,a=+t[i],l=+r[i],s=r.slice();return a>l||("add"===e.op||"copy"===e.op?s[i]=Math.max(0,l-n):"remove"===e.op&&(s[i]=Math.max(0,l+n))),s}function i(e){return"remove"===e.op?{op:e.op,path:e.path}:"copy"===e.op||"move"===e.op?{op:e.op,path:e.path,from:e.from}:{op:e.op,path:e.path,value:e.value}}e.exports=function(e,t){var o=r.parse(e.path),a=r.parse(t.path),l=function(e,t){var o=e.length,r=t.length;if(0===o||0===r||o<2&&r<2)return[];for(var n=o===r?o-1:Math.min(o,r),i=0;i<n&&e[i]===t[i];)++i;return e.slice(0,i)}(o,a),s=function(e,t,o){return r.isValidArrayIndex(e[o])&&r.isValidArrayIndex(t[o])}(o,a,l.length),c=i(e),d=i(t);return 0!==l.length||s?s?function(e,t,o,i){return t.length===i.length?function(e,t,o,n){var i,a=t.length-1,l=+t[a],s=+n[a];return l<s?"add"===e.op||"copy"===e.op?((i=n.slice())[a]=Math.max(0,s-1),o.path=r.absolute(r.join(i))):"remove"===e.op&&((i=n.slice())[a]=s+1,o.path=r.absolute(r.join(i))):"add"===o.op||"copy"===o.op?((i=t.slice())[a]=l+1,e.path=r.absolute(r.join(i))):l>s&&"remove"===o.op&&((i=t.slice())[a]=Math.max(0,l-1),e.path=r.absolute(r.join(i))),[o,e]}(e,t,o,i):(t.length>i.length?(t=n(o,i,0,t,-1),e.path=r.absolute(r.join(t))):(i=n(e,t,0,i,1),o.path=r.absolute(r.join(i))),[o,e])}(c,o,d,a):function(e,t,o,r){if(e.path===o.path)throw new TypeError("cannot commute "+e.op+","+o.op+" with identical object paths");return[o,e]}(c,0,d):[d,c]}},"../node_modules/jiff/lib/deepEquals.js":
/*!**********************************************!*\
  !*** ../node_modules/jiff/lib/deepEquals.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function e(t,o){return t===o||(Array.isArray(t)&&Array.isArray(o)?function(t,o){if(t.length!==o.length)return!1;for(var r=0;r<t.length;++r)if(!e(t[r],o[r]))return!1;return!0}(t,o):"object"==typeof t&&"object"==typeof o&&function(t,o){if(null===t&&null!==o||null!==t&&null===o)return!1;var r=Object.keys(t),n=Object.keys(o);if(r.length!==n.length)return!1;for(var i,a=0;a<r.length;++a)if(!((i=r[a])in o)||!e(t[i],o[i]))return!1;return!0}(t,o))}},"../node_modules/jiff/lib/inverse.js":
/*!*******************************************!*\
  !*** ../node_modules/jiff/lib/inverse.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./patches */"../node_modules/jiff/lib/patches.js");function n(e,t,o,n){var i=r[t.op];return void 0!==i&&"function"==typeof i.inverse?i.inverse(e,t,o,n):1}e.exports=function(e){var t,o,r=[];for(t=e.length-1;t>=0;t-=o)o=n(r,e[t],t,e);return r}},"../node_modules/jiff/lib/jsonPatch.js":
/*!*********************************************!*\
  !*** ../node_modules/jiff/lib/jsonPatch.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
var r=o(/*! ./patches */"../node_modules/jiff/lib/patches.js"),n=o(/*! ./clone */"../node_modules/jiff/lib/clone.js"),i=o(/*! ./InvalidPatchOperationError */"../node_modules/jiff/lib/InvalidPatchOperationError.js");t.apply=function(e,t,o){return l(e,n(t),o)},t.applyInPlace=l,t.clone=n,t.isValidObject=s,t.defaultHash=function(e){return s(e)||function(e){return"[object Array]"===Object.prototype.toString.call(e)}(e)?JSON.stringify(e):e};var a={};function l(e,t,o){if(o||(o=a),!Array.isArray(e))return t;for(var n,l,s=0;s<e.length;++s){if(l=e[s],void 0===(n=r[l.op]))throw new i("invalid op "+JSON.stringify(l));t=n.apply(t,l,o)}return t}function s(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}},"../node_modules/jiff/lib/jsonPointer.js":
/*!***********************************************!*\
  !*** ../node_modules/jiff/lib/jsonPointer.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
var r=o(/*! ./jsonPointerParse */"../node_modules/jiff/lib/jsonPointerParse.js");t.find=function(e,t,o,i){if("string"==typeof t){if(""===t)return{target:e,key:void 0};if(t===n)return{target:e,key:""};var a,l=e,s=void 0!==i;return r(t,(function(t){if(null==e)return l=null,!1;a=Array.isArray(e)?s?function(e,t,o,r){var n=t;if(n<0)throw new Error("array index out of bounds "+n);if(void 0!==r&&"function"==typeof e&&(n=e(t,o,r))<0)throw new Error("could not find patch context "+r);return n}(o,f(t),e,i):"-"===t?t:f(t):t,l=e,e=e[a]})),null===l?void 0:{target:l,key:a}}},t.join=function(e){return e.join(n)},t.absolute=function(e){return e[0]===n?e:n+e},t.parse=function(e){var t=[];return r(e,t.push.bind(t)),t},t.contains=function(e,t){return 0===t.indexOf(e)&&t[e.length]===n},t.encodeSegment=function(e){return e.replace(c,d).replace(i,a)},t.decodeSegment=function(e){return e.replace(l,n).replace(u,s)},t.parseArrayIndex=f,t.isValidArrayIndex=h;var n="/",i=/\//g,a="~1",l=/~1/g,s="~",c=/~/g,d="~0",u=/~0/g,p=/^(0|[1-9]\d*)$/;function h(e){return p.test(e)}function f(e){if(h(e))return+e;throw new SyntaxError("invalid array index "+e)}},"../node_modules/jiff/lib/jsonPointerParse.js":
/*!****************************************************!*\
  !*** ../node_modules/jiff/lib/jsonPointerParse.js ***!
  \****************************************************/
/*! no static exports found */function(e,t){
/** @license MIT License (c) copyright 2010-2014 original author or authors */
e.exports=function(e,t){var a,l,s,c;for(a=e.charAt(0)===r?1:0,l="",o.lastIndex=a;s=o.exec(e);)if(c=s[0],l+=e.slice(a,o.lastIndex-c.length),a=o.lastIndex,c===r){if(!1===t(l))return e;l=""}else l+=c===i?r:n;return t(l+=e.slice(a)),e};var o=/\/|~1|~0/g,r="/",n="~",i="~1"},"../node_modules/jiff/lib/lcs.js":
/*!***************************************!*\
  !*** ../node_modules/jiff/lib/lcs.js ***!
  \***************************************/
/*! no static exports found */function(e,t){var o,r,n;function i(e,t,i,a,l,s){return t[l+a]===i[s+a]?{value:e[s+1][l+1].value,type:n}:e[s][l+1].value<e[s+1][l].value?{value:e[s][l+1].value+1,type:o}:{value:e[s+1][l].value+1,type:r}}
/** @license MIT License (c) copyright 2010-2014 original author or authors */t.compare=function(e,t){for(var a=e.length,l=t.length,s=function(e,t){for(var o=0,r=Math.min(e.length,t.length);o<r&&e[o]===t[o];)++o;return o}(e,t),c=s<a&&s<l?function(e,t){for(var o=e.length-1,r=t.length-1,n=Math.min(o,r),i=0;i<n&&e[o-i]===t[r-i];)++i;return i}(e,t):0,d=c+s-1,u=function(e,t){var i,a,l,s=[];for(l=s[t]=[],a=0;a<e;++a)l[a]={value:e-a,type:o};for(i=0;i<t;++i)s[i]=[],s[i][e]={value:t-i,type:r};return s[t][e]={value:0,type:n},s}(a-=d,l-=d),p=a-1;p>=0;--p)for(var h=l-1;h>=0;--h)u[h][p]=i(u,e,t,s,p,h);return{prefix:s,matrix:u,suffix:c}},t.reduce=function(e,t,i){var a,l,s,c,d=i.matrix,u=i.prefix;for(a=0;a<u;++a)t=e(t,n,a,a);for(s=a,u=d.length,a=0,l=0;a<u;)switch(c=d[a][l].type,t=e(t,c,a+s,l+s),c){case n:++a,++l;break;case o:++l;break;case r:++a}for(a+=s,l+=s,u=i.suffix,s=0;s<u;++s)t=e(t,n,a+s,l+s);return t},t.REMOVE=o=-1,t.ADD=r=1,t.EQUAL=n=0},"../node_modules/jiff/lib/patches.js":
/*!*******************************************!*\
  !*** ../node_modules/jiff/lib/patches.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./jsonPointer */"../node_modules/jiff/lib/jsonPointer.js"),n=o(/*! ./clone */"../node_modules/jiff/lib/clone.js"),i=o(/*! ./deepEquals */"../node_modules/jiff/lib/deepEquals.js"),a=o(/*! ./commutePaths */"../node_modules/jiff/lib/commutePaths.js"),l=o(/*! ./array */"../node_modules/jiff/lib/array.js"),s=o(/*! ./TestFailedError */"../node_modules/jiff/lib/TestFailedError.js"),c=o(/*! ./InvalidPatchOperationError */"../node_modules/jiff/lib/InvalidPatchOperationError.js"),d=o(/*! ./PatchNotInvertibleError */"../node_modules/jiff/lib/PatchNotInvertibleError.js"),u=r.find,p=r.parseArrayIndex;function h(e,t){var o=e.target;if(Array.isArray(o))if("-"===e.key)o.push(t);else{if(e.key>o.length)throw new c("target of add outside of array bounds");o.splice(e.key,0,t)}else{if(!v(o))throw new c("target of add must be an object or array "+e.key);o[e.key]=t}}function f(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute add,remove -> remove,add for same path");return a(e,t)}function m(e){var t,o=e.target;if(Array.isArray(o))return(t=o.splice(p(e.key),1))[0];if(v(o))return t=o[e.key],delete o[e.key],t;throw new c("target of remove must be an object or array")}function y(e){return void 0===e||null==e.target&&void 0!==e.key}function g(e){return void 0!==e.key&&void 0===e.target[e.key]}function v(e){return null!==e&&"object"==typeof e}t.test={apply:function(e,t,o){var r,n=u(e,t.path,o.findContext,t.context),a=n.target;if(Array.isArray(a)?r=a[p(n.key)]:r=void 0===n.key?n.target:n.target[n.key],!i(r,t.value))throw new s("test failed "+JSON.stringify(t));return e},inverse:function(e,t){return e.push(t),1},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute test,remove -> remove,test for same path");return"test"===t.op||"replace"===t.op?[t,e]:a(e,t)}},t.add={apply:function(e,t,o){var r=u(e,t.path,o.findContext,t.context);if(y(r))throw new c("path does not exist "+t.path);if(void 0===t.value)throw new c("missing value");var i=n(t.value);return void 0===r.key?i:(h(r,i),e)},inverse:function(e,t){var o=t.context;return void 0!==o&&(o={before:o.before,after:l.cons(t.value,o.after)}),e.push({op:"test",path:t.path,value:t.value,context:o}),e.push({op:"remove",path:t.path,context:o}),1},commute:f},t.remove={apply:function(e,t,o){var r=u(e,t.path,o.findContext,t.context);if(y(r)||void 0===r.target[r.key])throw new c("path does not exist "+t.path);return m(r),e},inverse:function(e,t,o,r){var n=r[o-1];if(void 0===n||"test"!==n.op||n.path!==t.path)throw new d("cannot invert remove w/o test");var i=n.context;return void 0!==i&&(i={before:i.before,after:l.tail(i.after)}),e.push({op:"add",path:n.path,value:n.value,context:i}),2},commute:function(e,t){return e.path===t.path&&"remove"===t.op?[t,e]:a(e,t)}},t.replace={apply:function(e,t,o){var r=u(e,t.path,o.findContext,t.context);if(y(r)||g(r))throw new c("path does not exist "+t.path);if(void 0===t.value)throw new c("missing value");var i=n(t.value);if(void 0===r.key)return i;var a=r.target;return Array.isArray(a)?a[p(r.key)]=i:a[r.key]=i,e},inverse:function(e,t,o,r){var n=r[o-1];if(void 0===n||"test"!==n.op||n.path!==t.path)throw new d("cannot invert replace w/o test");var i=n.context;return void 0!==i&&(i={before:i.before,after:l.cons(n.value,l.tail(i.after))}),e.push({op:"test",path:n.path,value:t.value}),e.push({op:"replace",path:n.path,value:n.value}),2},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return"test"===t.op||"replace"===t.op?[t,e]:a(e,t)}},t.move={apply:function(e,t,o){if(r.contains(t.path,t.from))throw new c("move.from cannot be ancestor of move.path");return h(u(e,t.path,o.findContext,t.context),m(u(e,t.from,o.findContext,t.fromContext))),e},inverse:function(e,t){return e.push({op:"move",path:t.from,context:t.fromContext,from:t.path,fromContext:t.context}),1},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute move,remove -> move,replace for same path");return a(e,t)}},t.copy={apply:function(e,t,o){var r=u(e,t.path,o.findContext,t.context),i=u(e,t.from,o.findContext,t.fromContext);if(y(i)||g(i))throw new c("copy.from must exist");var a,l=i.target;return a=Array.isArray(l)?l[p(i.key)]:l[i.key],h(r,n(a)),e},inverse:function(e,t){throw new d("cannot invert "+t.op)},commute:f}},"../node_modules/lodash/_DataView.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_DataView.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(o(/*! ./_root */"../node_modules/lodash/_root.js"),"DataView");e.exports=r},"../node_modules/lodash/_Hash.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/_Hash.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_hashClear */"../node_modules/lodash/_hashClear.js"),n=o(/*! ./_hashDelete */"../node_modules/lodash/_hashDelete.js"),i=o(/*! ./_hashGet */"../node_modules/lodash/_hashGet.js"),a=o(/*! ./_hashHas */"../node_modules/lodash/_hashHas.js"),l=o(/*! ./_hashSet */"../node_modules/lodash/_hashSet.js");function s(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=l,e.exports=s},"../node_modules/lodash/_ListCache.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_ListCache.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_listCacheClear */"../node_modules/lodash/_listCacheClear.js"),n=o(/*! ./_listCacheDelete */"../node_modules/lodash/_listCacheDelete.js"),i=o(/*! ./_listCacheGet */"../node_modules/lodash/_listCacheGet.js"),a=o(/*! ./_listCacheHas */"../node_modules/lodash/_listCacheHas.js"),l=o(/*! ./_listCacheSet */"../node_modules/lodash/_listCacheSet.js");function s(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=l,e.exports=s},"../node_modules/lodash/_Map.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/_Map.js ***!
  \**************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(o(/*! ./_root */"../node_modules/lodash/_root.js"),"Map");e.exports=r},"../node_modules/lodash/_MapCache.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_MapCache.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_mapCacheClear */"../node_modules/lodash/_mapCacheClear.js"),n=o(/*! ./_mapCacheDelete */"../node_modules/lodash/_mapCacheDelete.js"),i=o(/*! ./_mapCacheGet */"../node_modules/lodash/_mapCacheGet.js"),a=o(/*! ./_mapCacheHas */"../node_modules/lodash/_mapCacheHas.js"),l=o(/*! ./_mapCacheSet */"../node_modules/lodash/_mapCacheSet.js");function s(e){var t=-1,o=null==e?0:e.length;for(this.clear();++t<o;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=n,s.prototype.get=i,s.prototype.has=a,s.prototype.set=l,e.exports=s},"../node_modules/lodash/_Promise.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_Promise.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(o(/*! ./_root */"../node_modules/lodash/_root.js"),"Promise");e.exports=r},"../node_modules/lodash/_Set.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/_Set.js ***!
  \**************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(o(/*! ./_root */"../node_modules/lodash/_root.js"),"Set");e.exports=r},"../node_modules/lodash/_SetCache.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_SetCache.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_MapCache */"../node_modules/lodash/_MapCache.js"),n=o(/*! ./_setCacheAdd */"../node_modules/lodash/_setCacheAdd.js"),i=o(/*! ./_setCacheHas */"../node_modules/lodash/_setCacheHas.js");function a(e){var t=-1,o=null==e?0:e.length;for(this.__data__=new r;++t<o;)this.add(e[t])}a.prototype.add=a.prototype.push=n,a.prototype.has=i,e.exports=a},"../node_modules/lodash/_Stack.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/_Stack.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_ListCache */"../node_modules/lodash/_ListCache.js"),n=o(/*! ./_stackClear */"../node_modules/lodash/_stackClear.js"),i=o(/*! ./_stackDelete */"../node_modules/lodash/_stackDelete.js"),a=o(/*! ./_stackGet */"../node_modules/lodash/_stackGet.js"),l=o(/*! ./_stackHas */"../node_modules/lodash/_stackHas.js"),s=o(/*! ./_stackSet */"../node_modules/lodash/_stackSet.js");function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=l,c.prototype.set=s,e.exports=c},"../node_modules/lodash/_Symbol.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/_Symbol.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_root */"../node_modules/lodash/_root.js").Symbol;e.exports=r},"../node_modules/lodash/_Uint8Array.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_Uint8Array.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_root */"../node_modules/lodash/_root.js").Uint8Array;e.exports=r},"../node_modules/lodash/_WeakMap.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_WeakMap.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(o(/*! ./_root */"../node_modules/lodash/_root.js"),"WeakMap");e.exports=r},"../node_modules/lodash/_apply.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/_apply.js ***!
  \****************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}},"../node_modules/lodash/_arrayEach.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_arrayEach.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r&&!1!==t(e[o],o,e););return e}},"../node_modules/lodash/_arrayFilter.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_arrayFilter.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length,n=0,i=[];++o<r;){var a=e[o];t(a,o,e)&&(i[n++]=a)}return i}},"../node_modules/lodash/_arrayIncludes.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_arrayIncludes.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIndexOf */"../node_modules/lodash/_baseIndexOf.js");e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},"../node_modules/lodash/_arrayIncludesWith.js":
/*!****************************************************!*\
  !*** ../node_modules/lodash/_arrayIncludesWith.js ***!
  \****************************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o){for(var r=-1,n=null==e?0:e.length;++r<n;)if(o(t,e[r]))return!0;return!1}},"../node_modules/lodash/_arrayLikeKeys.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_arrayLikeKeys.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseTimes */"../node_modules/lodash/_baseTimes.js"),n=o(/*! ./isArguments */"../node_modules/lodash/isArguments.js"),i=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),a=o(/*! ./isBuffer */"../node_modules/lodash/isBuffer.js"),l=o(/*! ./_isIndex */"../node_modules/lodash/_isIndex.js"),s=o(/*! ./isTypedArray */"../node_modules/lodash/isTypedArray.js"),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var o=i(e),d=!o&&n(e),u=!o&&!d&&a(e),p=!o&&!d&&!u&&s(e),h=o||d||u||p,f=h?r(e.length,String):[],m=f.length;for(var y in e)!t&&!c.call(e,y)||h&&("length"==y||u&&("offset"==y||"parent"==y)||p&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||l(y,m))||f.push(y);return f}},"../node_modules/lodash/_arrayMap.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_arrayMap.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length,n=Array(r);++o<r;)n[o]=t(e[o],o,e);return n}},"../node_modules/lodash/_arrayPush.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_arrayPush.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=t.length,n=e.length;++o<r;)e[n+o]=t[o];return e}},"../node_modules/lodash/_arraySome.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_arraySome.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r;)if(t(e[o],o,e))return!0;return!1}},"../node_modules/lodash/_assignMergeValue.js":
/*!***************************************************!*\
  !*** ../node_modules/lodash/_assignMergeValue.js ***!
  \***************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseAssignValue */"../node_modules/lodash/_baseAssignValue.js"),n=o(/*! ./eq */"../node_modules/lodash/eq.js");e.exports=function(e,t,o){(void 0===o||n(e[t],o))&&(void 0!==o||t in e)||r(e,t,o)}},"../node_modules/lodash/_assignValue.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_assignValue.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseAssignValue */"../node_modules/lodash/_baseAssignValue.js"),n=o(/*! ./eq */"../node_modules/lodash/eq.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,o){var a=e[t];i.call(e,t)&&n(a,o)&&(void 0!==o||t in e)||r(e,t,o)}},"../node_modules/lodash/_assocIndexOf.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_assocIndexOf.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./eq */"../node_modules/lodash/eq.js");e.exports=function(e,t){for(var o=e.length;o--;)if(r(e[o][0],t))return o;return-1}},"../node_modules/lodash/_baseAssign.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_baseAssign.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),n=o(/*! ./keys */"../node_modules/lodash/keys.js");e.exports=function(e,t){return e&&r(t,n(t),e)}},"../node_modules/lodash/_baseAssignIn.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_baseAssignIn.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),n=o(/*! ./keysIn */"../node_modules/lodash/keysIn.js");e.exports=function(e,t){return e&&r(t,n(t),e)}},"../node_modules/lodash/_baseAssignValue.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_baseAssignValue.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_defineProperty */"../node_modules/lodash/_defineProperty.js");e.exports=function(e,t,o){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},"../node_modules/lodash/_baseClone.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseClone.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Stack */"../node_modules/lodash/_Stack.js"),n=o(/*! ./_arrayEach */"../node_modules/lodash/_arrayEach.js"),i=o(/*! ./_assignValue */"../node_modules/lodash/_assignValue.js"),a=o(/*! ./_baseAssign */"../node_modules/lodash/_baseAssign.js"),l=o(/*! ./_baseAssignIn */"../node_modules/lodash/_baseAssignIn.js"),s=o(/*! ./_cloneBuffer */"../node_modules/lodash/_cloneBuffer.js"),c=o(/*! ./_copyArray */"../node_modules/lodash/_copyArray.js"),d=o(/*! ./_copySymbols */"../node_modules/lodash/_copySymbols.js"),u=o(/*! ./_copySymbolsIn */"../node_modules/lodash/_copySymbolsIn.js"),p=o(/*! ./_getAllKeys */"../node_modules/lodash/_getAllKeys.js"),h=o(/*! ./_getAllKeysIn */"../node_modules/lodash/_getAllKeysIn.js"),f=o(/*! ./_getTag */"../node_modules/lodash/_getTag.js"),m=o(/*! ./_initCloneArray */"../node_modules/lodash/_initCloneArray.js"),y=o(/*! ./_initCloneByTag */"../node_modules/lodash/_initCloneByTag.js"),g=o(/*! ./_initCloneObject */"../node_modules/lodash/_initCloneObject.js"),v=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),_=o(/*! ./isBuffer */"../node_modules/lodash/isBuffer.js"),b=o(/*! ./isMap */"../node_modules/lodash/isMap.js"),T=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),S=o(/*! ./isSet */"../node_modules/lodash/isSet.js"),C=o(/*! ./keys */"../node_modules/lodash/keys.js"),w="[object Arguments]",E="[object Function]",I="[object Object]",x={};x[w]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object DataView]"]=x["[object Boolean]"]=x["[object Date]"]=x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Map]"]=x["[object Number]"]=x[I]=x["[object RegExp]"]=x["[object Set]"]=x["[object String]"]=x["[object Symbol]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x["[object Error]"]=x[E]=x["[object WeakMap]"]=!1,e.exports=function e(t,o,R,O,P,D){var N,k=1&o,L=2&o,F=4&o;if(R&&(N=P?R(t,O,P,D):R(t)),void 0!==N)return N;if(!T(t))return t;var A=v(t);if(A){if(N=m(t),!k)return c(t,N)}else{var V=f(t),j=V==E||"[object GeneratorFunction]"==V;if(_(t))return s(t,k);if(V==I||V==w||j&&!P){if(N=L||j?{}:g(t),!k)return L?u(t,l(N,t)):d(t,a(N,t))}else{if(!x[V])return P?t:{};N=y(t,V,k)}}D||(D=new r);var B=D.get(t);if(B)return B;if(D.set(t,N),S(t))return t.forEach((function(r){N.add(e(r,o,R,r,t,D))})),N;if(b(t))return t.forEach((function(r,n){N.set(n,e(r,o,R,n,t,D))})),N;var M=F?L?h:p:L?keysIn:C,U=A?void 0:M(t);return n(U||t,(function(r,n){U&&(r=t[n=r]),i(N,n,e(r,o,R,n,t,D))})),N}},"../node_modules/lodash/_baseCreate.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_baseCreate.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),n=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(n)return n(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();e.exports=i},"../node_modules/lodash/_baseDifference.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_baseDifference.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_SetCache */"../node_modules/lodash/_SetCache.js"),n=o(/*! ./_arrayIncludes */"../node_modules/lodash/_arrayIncludes.js"),i=o(/*! ./_arrayIncludesWith */"../node_modules/lodash/_arrayIncludesWith.js"),a=o(/*! ./_arrayMap */"../node_modules/lodash/_arrayMap.js"),l=o(/*! ./_baseUnary */"../node_modules/lodash/_baseUnary.js"),s=o(/*! ./_cacheHas */"../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,o,c){var d=-1,u=n,p=!0,h=e.length,f=[],m=t.length;if(!h)return f;o&&(t=a(t,l(o))),c?(u=i,p=!1):t.length>=200&&(u=s,p=!1,t=new r(t));e:for(;++d<h;){var y=e[d],g=null==o?y:o(y);if(y=c||0!==y?y:0,p&&g==g){for(var v=m;v--;)if(t[v]===g)continue e;f.push(y)}else u(t,g,c)||f.push(y)}return f}},"../node_modules/lodash/_baseEach.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_baseEach.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseForOwn */"../node_modules/lodash/_baseForOwn.js"),n=o(/*! ./_createBaseEach */"../node_modules/lodash/_createBaseEach.js")(r);e.exports=n},"../node_modules/lodash/_baseFindIndex.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_baseFindIndex.js ***!
  \************************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o,r){for(var n=e.length,i=o+(r?1:-1);r?i--:++i<n;)if(t(e[i],i,e))return i;return-1}},"../node_modules/lodash/_baseFlatten.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_baseFlatten.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayPush */"../node_modules/lodash/_arrayPush.js"),n=o(/*! ./_isFlattenable */"../node_modules/lodash/_isFlattenable.js");e.exports=function e(t,o,i,a,l){var s=-1,c=t.length;for(i||(i=n),l||(l=[]);++s<c;){var d=t[s];o>0&&i(d)?o>1?e(d,o-1,i,a,l):r(l,d):a||(l[l.length]=d)}return l}},"../node_modules/lodash/_baseFor.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_baseFor.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_createBaseFor */"../node_modules/lodash/_createBaseFor.js")();e.exports=r},"../node_modules/lodash/_baseForOwn.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_baseForOwn.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseFor */"../node_modules/lodash/_baseFor.js"),n=o(/*! ./keys */"../node_modules/lodash/keys.js");e.exports=function(e,t){return e&&r(e,t,n)}},"../node_modules/lodash/_baseGet.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_baseGet.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_castPath */"../node_modules/lodash/_castPath.js"),n=o(/*! ./_toKey */"../node_modules/lodash/_toKey.js");e.exports=function(e,t){for(var o=0,i=(t=r(t,e)).length;null!=e&&o<i;)e=e[n(t[o++])];return o&&o==i?e:void 0}},"../node_modules/lodash/_baseGetAllKeys.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_baseGetAllKeys.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayPush */"../node_modules/lodash/_arrayPush.js"),n=o(/*! ./isArray */"../node_modules/lodash/isArray.js");e.exports=function(e,t,o){var i=t(e);return n(e)?i:r(i,o(e))}},"../node_modules/lodash/_baseGetTag.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_baseGetTag.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=o(/*! ./_getRawTag */"../node_modules/lodash/_getRawTag.js"),i=o(/*! ./_objectToString */"../node_modules/lodash/_objectToString.js"),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?n(e):i(e)}},"../node_modules/lodash/_baseHas.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_baseHas.js ***!
  \******************************************/
/*! no static exports found */function(e,t){var o=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&o.call(e,t)}},"../node_modules/lodash/_baseHasIn.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseHasIn.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},"../node_modules/lodash/_baseInRange.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_baseInRange.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){var o=Math.max,r=Math.min;e.exports=function(e,t,n){return e>=r(t,n)&&e<o(t,n)}},"../node_modules/lodash/_baseIndexOf.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_baseIndexOf.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseFindIndex */"../node_modules/lodash/_baseFindIndex.js"),n=o(/*! ./_baseIsNaN */"../node_modules/lodash/_baseIsNaN.js"),i=o(/*! ./_strictIndexOf */"../node_modules/lodash/_strictIndexOf.js");e.exports=function(e,t,o){return t==t?i(e,t,o):r(e,n,o)}},"../node_modules/lodash/_baseIsArguments.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_baseIsArguments.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return n(e)&&"[object Arguments]"==r(e)}},"../node_modules/lodash/_baseIsEqual.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_baseIsEqual.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsEqualDeep */"../node_modules/lodash/_baseIsEqualDeep.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function e(t,o,i,a,l){return t===o||(null==t||null==o||!n(t)&&!n(o)?t!=t&&o!=o:r(t,o,i,a,e,l))}},"../node_modules/lodash/_baseIsEqualDeep.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_baseIsEqualDeep.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Stack */"../node_modules/lodash/_Stack.js"),n=o(/*! ./_equalArrays */"../node_modules/lodash/_equalArrays.js"),i=o(/*! ./_equalByTag */"../node_modules/lodash/_equalByTag.js"),a=o(/*! ./_equalObjects */"../node_modules/lodash/_equalObjects.js"),l=o(/*! ./_getTag */"../node_modules/lodash/_getTag.js"),s=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),c=o(/*! ./isBuffer */"../node_modules/lodash/isBuffer.js"),d=o(/*! ./isTypedArray */"../node_modules/lodash/isTypedArray.js"),u="[object Arguments]",p="[object Array]",h="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,o,m,y,g){var v=s(e),_=s(t),b=v?p:l(e),T=_?p:l(t),S=(b=b==u?h:b)==h,C=(T=T==u?h:T)==h,w=b==T;if(w&&c(e)){if(!c(t))return!1;v=!0,S=!1}if(w&&!S)return g||(g=new r),v||d(e)?n(e,t,o,m,y,g):i(e,t,b,o,m,y,g);if(!(1&o)){var E=S&&f.call(e,"__wrapped__"),I=C&&f.call(t,"__wrapped__");if(E||I){var x=E?e.value():e,R=I?t.value():t;return g||(g=new r),y(x,R,o,m,g)}}return!!w&&(g||(g=new r),a(e,t,o,m,y,g))}},"../node_modules/lodash/_baseIsMap.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseIsMap.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getTag */"../node_modules/lodash/_getTag.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return n(e)&&"[object Map]"==r(e)}},"../node_modules/lodash/_baseIsNaN.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseIsNaN.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return e!=e}},"../node_modules/lodash/_baseIsNative.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_baseIsNative.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isFunction */"../node_modules/lodash/isFunction.js"),n=o(/*! ./_isMasked */"../node_modules/lodash/_isMasked.js"),i=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),a=o(/*! ./_toSource */"../node_modules/lodash/_toSource.js"),l=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,d=s.toString,u=c.hasOwnProperty,p=RegExp("^"+d.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||n(e))&&(r(e)?p:l).test(a(e))}},"../node_modules/lodash/_baseIsSet.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseIsSet.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getTag */"../node_modules/lodash/_getTag.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return n(e)&&"[object Set]"==r(e)}},"../node_modules/lodash/_baseIsTypedArray.js":
/*!***************************************************!*\
  !*** ../node_modules/lodash/_baseIsTypedArray.js ***!
  \***************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./isLength */"../node_modules/lodash/isLength.js"),i=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&n(e.length)&&!!a[r(e)]}},"../node_modules/lodash/_baseKeys.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_baseKeys.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_isPrototype */"../node_modules/lodash/_isPrototype.js"),n=o(/*! ./_nativeKeys */"../node_modules/lodash/_nativeKeys.js"),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return n(e);var t=[];for(var o in Object(e))i.call(e,o)&&"constructor"!=o&&t.push(o);return t}},"../node_modules/lodash/_baseKeysIn.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_baseKeysIn.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),n=o(/*! ./_isPrototype */"../node_modules/lodash/_isPrototype.js"),i=o(/*! ./_nativeKeysIn */"../node_modules/lodash/_nativeKeysIn.js"),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=n(e),o=[];for(var l in e)("constructor"!=l||!t&&a.call(e,l))&&o.push(l);return o}},"../node_modules/lodash/_baseMerge.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseMerge.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Stack */"../node_modules/lodash/_Stack.js"),n=o(/*! ./_assignMergeValue */"../node_modules/lodash/_assignMergeValue.js"),i=o(/*! ./_baseFor */"../node_modules/lodash/_baseFor.js"),a=o(/*! ./_baseMergeDeep */"../node_modules/lodash/_baseMergeDeep.js"),l=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),s=o(/*! ./keysIn */"../node_modules/lodash/keysIn.js"),c=o(/*! ./_safeGet */"../node_modules/lodash/_safeGet.js");e.exports=function e(t,o,d,u,p){t!==o&&i(o,(function(i,s){if(l(i))p||(p=new r),a(t,o,s,d,e,u,p);else{var h=u?u(c(t,s),i,s+"",t,o,p):void 0;void 0===h&&(h=i),n(t,s,h)}}),s)}},"../node_modules/lodash/_baseMergeDeep.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_baseMergeDeep.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assignMergeValue */"../node_modules/lodash/_assignMergeValue.js"),n=o(/*! ./_cloneBuffer */"../node_modules/lodash/_cloneBuffer.js"),i=o(/*! ./_cloneTypedArray */"../node_modules/lodash/_cloneTypedArray.js"),a=o(/*! ./_copyArray */"../node_modules/lodash/_copyArray.js"),l=o(/*! ./_initCloneObject */"../node_modules/lodash/_initCloneObject.js"),s=o(/*! ./isArguments */"../node_modules/lodash/isArguments.js"),c=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),d=o(/*! ./isArrayLikeObject */"../node_modules/lodash/isArrayLikeObject.js"),u=o(/*! ./isBuffer */"../node_modules/lodash/isBuffer.js"),p=o(/*! ./isFunction */"../node_modules/lodash/isFunction.js"),h=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),f=o(/*! ./isPlainObject */"../node_modules/lodash/isPlainObject.js"),m=o(/*! ./isTypedArray */"../node_modules/lodash/isTypedArray.js"),y=o(/*! ./_safeGet */"../node_modules/lodash/_safeGet.js"),g=o(/*! ./toPlainObject */"../node_modules/lodash/toPlainObject.js");e.exports=function(e,t,o,v,_,b,T){var S=y(e,o),C=y(t,o),w=T.get(C);if(w)r(e,o,w);else{var E=b?b(S,C,o+"",e,t,T):void 0,I=void 0===E;if(I){var x=c(C),R=!x&&u(C),O=!x&&!R&&m(C);E=C,x||R||O?c(S)?E=S:d(S)?E=a(S):R?(I=!1,E=n(C,!0)):O?(I=!1,E=i(C,!0)):E=[]:f(C)||s(C)?(E=S,s(S)?E=g(S):h(S)&&!p(S)||(E=l(C))):I=!1}I&&(T.set(C,E),_(E,C,v,b,T),T.delete(C)),r(e,o,E)}}},"../node_modules/lodash/_baseRest.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_baseRest.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./identity */"../node_modules/lodash/identity.js"),n=o(/*! ./_overRest */"../node_modules/lodash/_overRest.js"),i=o(/*! ./_setToString */"../node_modules/lodash/_setToString.js");e.exports=function(e,t){return i(n(e,t,r),e+"")}},"../node_modules/lodash/_baseSet.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_baseSet.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assignValue */"../node_modules/lodash/_assignValue.js"),n=o(/*! ./_castPath */"../node_modules/lodash/_castPath.js"),i=o(/*! ./_isIndex */"../node_modules/lodash/_isIndex.js"),a=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),l=o(/*! ./_toKey */"../node_modules/lodash/_toKey.js");e.exports=function(e,t,o,s){if(!a(e))return e;for(var c=-1,d=(t=n(t,e)).length,u=d-1,p=e;null!=p&&++c<d;){var h=l(t[c]),f=o;if(c!=u){var m=p[h];void 0===(f=s?s(m,h,p):void 0)&&(f=a(m)?m:i(t[c+1])?[]:{})}r(p,h,f),p=p[h]}return e}},"../node_modules/lodash/_baseSetToString.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_baseSetToString.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./constant */"../node_modules/lodash/constant.js"),n=o(/*! ./_defineProperty */"../node_modules/lodash/_defineProperty.js"),i=o(/*! ./identity */"../node_modules/lodash/identity.js"),a=n?function(e,t){return n(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=a},"../node_modules/lodash/_baseSlice.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseSlice.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o){var r=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(o=o>n?n:o)<0&&(o+=n),n=t>o?0:o-t>>>0,t>>>=0;for(var i=Array(n);++r<n;)i[r]=e[r+t];return i}},"../node_modules/lodash/_baseTimes.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseTimes.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){for(var o=-1,r=Array(e);++o<e;)r[o]=t(o);return r}},"../node_modules/lodash/_baseToString.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_baseToString.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=o(/*! ./_arrayMap */"../node_modules/lodash/_arrayMap.js"),i=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),a=o(/*! ./isSymbol */"../node_modules/lodash/isSymbol.js"),l=r?r.prototype:void 0,s=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return n(t,e)+"";if(a(t))return s?s.call(t):"";var o=t+"";return"0"==o&&1/t==-1/0?"-0":o}},"../node_modules/lodash/_baseUnary.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseUnary.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return function(t){return e(t)}}},"../node_modules/lodash/_baseUniq.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_baseUniq.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_SetCache */"../node_modules/lodash/_SetCache.js"),n=o(/*! ./_arrayIncludes */"../node_modules/lodash/_arrayIncludes.js"),i=o(/*! ./_arrayIncludesWith */"../node_modules/lodash/_arrayIncludesWith.js"),a=o(/*! ./_cacheHas */"../node_modules/lodash/_cacheHas.js"),l=o(/*! ./_createSet */"../node_modules/lodash/_createSet.js"),s=o(/*! ./_setToArray */"../node_modules/lodash/_setToArray.js");e.exports=function(e,t,o){var c=-1,d=n,u=e.length,p=!0,h=[],f=h;if(o)p=!1,d=i;else if(u>=200){var m=t?null:l(e);if(m)return s(m);p=!1,d=a,f=new r}else f=t?[]:h;e:for(;++c<u;){var y=e[c],g=t?t(y):y;if(y=o||0!==y?y:0,p&&g==g){for(var v=f.length;v--;)if(f[v]===g)continue e;t&&f.push(g),h.push(y)}else d(f,g,o)||(f!==h&&f.push(g),h.push(y))}return h}},"../node_modules/lodash/_baseUnset.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_baseUnset.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_castPath */"../node_modules/lodash/_castPath.js"),n=o(/*! ./last */"../node_modules/lodash/last.js"),i=o(/*! ./_parent */"../node_modules/lodash/_parent.js"),a=o(/*! ./_toKey */"../node_modules/lodash/_toKey.js");e.exports=function(e,t){return t=r(t,e),null==(e=i(e,t))||delete e[a(n(t))]}},"../node_modules/lodash/_baseXor.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_baseXor.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseDifference */"../node_modules/lodash/_baseDifference.js"),n=o(/*! ./_baseFlatten */"../node_modules/lodash/_baseFlatten.js"),i=o(/*! ./_baseUniq */"../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,o){var a=e.length;if(a<2)return a?i(e[0]):[];for(var l=-1,s=Array(a);++l<a;)for(var c=e[l],d=-1;++d<a;)d!=l&&(s[l]=r(s[l]||c,e[d],t,o));return i(n(s,1),t,o)}},"../node_modules/lodash/_cacheHas.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_cacheHas.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){return e.has(t)}},"../node_modules/lodash/_castFunction.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_castFunction.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./identity */"../node_modules/lodash/identity.js");e.exports=function(e){return"function"==typeof e?e:r}},"../node_modules/lodash/_castPath.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_castPath.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),n=o(/*! ./_isKey */"../node_modules/lodash/_isKey.js"),i=o(/*! ./_stringToPath */"../node_modules/lodash/_stringToPath.js"),a=o(/*! ./toString */"../node_modules/lodash/toString.js");e.exports=function(e,t){return r(e)?e:n(e,t)?[e]:i(a(e))}},"../node_modules/lodash/_cloneArrayBuffer.js":
/*!***************************************************!*\
  !*** ../node_modules/lodash/_cloneArrayBuffer.js ***!
  \***************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Uint8Array */"../node_modules/lodash/_Uint8Array.js");e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},"../node_modules/lodash/_cloneBuffer.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_cloneBuffer.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){(function(e){var r=o(/*! ./_root */"../node_modules/lodash/_root.js"),n=t&&!t.nodeType&&t,i=n&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===n?r.Buffer:void 0,l=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var o=e.length,r=l?l(o):new e.constructor(o);return e.copy(r),r}}).call(this,o(/*! ./../webpack/buildin/module.js */"../node_modules/webpack/buildin/module.js")(e))},"../node_modules/lodash/_cloneDataView.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_cloneDataView.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_cloneArrayBuffer */"../node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}},"../node_modules/lodash/_cloneRegExp.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_cloneRegExp.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){var o=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,o.exec(e));return t.lastIndex=e.lastIndex,t}},"../node_modules/lodash/_cloneSymbol.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_cloneSymbol.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=r?r.prototype:void 0,i=n?n.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},"../node_modules/lodash/_cloneTypedArray.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_cloneTypedArray.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_cloneArrayBuffer */"../node_modules/lodash/_cloneArrayBuffer.js");e.exports=function(e,t){var o=t?r(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}},"../node_modules/lodash/_copyArray.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_copyArray.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){var o=-1,r=e.length;for(t||(t=Array(r));++o<r;)t[o]=e[o];return t}},"../node_modules/lodash/_copyObject.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_copyObject.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assignValue */"../node_modules/lodash/_assignValue.js"),n=o(/*! ./_baseAssignValue */"../node_modules/lodash/_baseAssignValue.js");e.exports=function(e,t,o,i){var a=!o;o||(o={});for(var l=-1,s=t.length;++l<s;){var c=t[l],d=i?i(o[c],e[c],c,o,e):void 0;void 0===d&&(d=e[c]),a?n(o,c,d):r(o,c,d)}return o}},"../node_modules/lodash/_copySymbols.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_copySymbols.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),n=o(/*! ./_getSymbols */"../node_modules/lodash/_getSymbols.js");e.exports=function(e,t){return r(e,n(e),t)}},"../node_modules/lodash/_copySymbolsIn.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_copySymbolsIn.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),n=o(/*! ./_getSymbolsIn */"../node_modules/lodash/_getSymbolsIn.js");e.exports=function(e,t){return r(e,n(e),t)}},"../node_modules/lodash/_coreJsData.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_coreJsData.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_root */"../node_modules/lodash/_root.js")["__core-js_shared__"];e.exports=r},"../node_modules/lodash/_createAssigner.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_createAssigner.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseRest */"../node_modules/lodash/_baseRest.js"),n=o(/*! ./_isIterateeCall */"../node_modules/lodash/_isIterateeCall.js");e.exports=function(e){return r((function(t,o){var r=-1,i=o.length,a=i>1?o[i-1]:void 0,l=i>2?o[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,l&&n(o[0],o[1],l)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var s=o[r];s&&e(t,s,r,a)}return t}))}},"../node_modules/lodash/_createBaseEach.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_createBaseEach.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js");e.exports=function(e,t){return function(o,n){if(null==o)return o;if(!r(o))return e(o,n);for(var i=o.length,a=t?i:-1,l=Object(o);(t?a--:++a<i)&&!1!==n(l[a],a,l););return o}}},"../node_modules/lodash/_createBaseFor.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_createBaseFor.js ***!
  \************************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return function(t,o,r){for(var n=-1,i=Object(t),a=r(t),l=a.length;l--;){var s=a[e?l:++n];if(!1===o(i[s],s,i))break}return t}}},"../node_modules/lodash/_createSet.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_createSet.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Set */"../node_modules/lodash/_Set.js"),n=o(/*! ./noop */"../node_modules/lodash/noop.js"),i=o(/*! ./_setToArray */"../node_modules/lodash/_setToArray.js"),a=r&&1/i(new r([,-0]))[1]==1/0?function(e){return new r(e)}:n;e.exports=a},"../node_modules/lodash/_customOmitClone.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_customOmitClone.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isPlainObject */"../node_modules/lodash/isPlainObject.js");e.exports=function(e){return r(e)?void 0:e}},"../node_modules/lodash/_defineProperty.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_defineProperty.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js"),n=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=n},"../node_modules/lodash/_equalArrays.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_equalArrays.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_SetCache */"../node_modules/lodash/_SetCache.js"),n=o(/*! ./_arraySome */"../node_modules/lodash/_arraySome.js"),i=o(/*! ./_cacheHas */"../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,o,a,l,s){var c=1&o,d=e.length,u=t.length;if(d!=u&&!(c&&u>d))return!1;var p=s.get(e);if(p&&s.get(t))return p==t;var h=-1,f=!0,m=2&o?new r:void 0;for(s.set(e,t),s.set(t,e);++h<d;){var y=e[h],g=t[h];if(a)var v=c?a(g,y,h,t,e,s):a(y,g,h,e,t,s);if(void 0!==v){if(v)continue;f=!1;break}if(m){if(!n(t,(function(e,t){if(!i(m,t)&&(y===e||l(y,e,o,a,s)))return m.push(t)}))){f=!1;break}}else if(y!==g&&!l(y,g,o,a,s)){f=!1;break}}return s.delete(e),s.delete(t),f}},"../node_modules/lodash/_equalByTag.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_equalByTag.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=o(/*! ./_Uint8Array */"../node_modules/lodash/_Uint8Array.js"),i=o(/*! ./eq */"../node_modules/lodash/eq.js"),a=o(/*! ./_equalArrays */"../node_modules/lodash/_equalArrays.js"),l=o(/*! ./_mapToArray */"../node_modules/lodash/_mapToArray.js"),s=o(/*! ./_setToArray */"../node_modules/lodash/_setToArray.js"),c=r?r.prototype:void 0,d=c?c.valueOf:void 0;e.exports=function(e,t,o,r,c,u,p){switch(o){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!u(new n(e),new n(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=l;case"[object Set]":var f=1&r;if(h||(h=s),e.size!=t.size&&!f)return!1;var m=p.get(e);if(m)return m==t;r|=2,p.set(e,t);var y=a(h(e),h(t),r,c,u,p);return p.delete(e),y;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},"../node_modules/lodash/_equalObjects.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_equalObjects.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getAllKeys */"../node_modules/lodash/_getAllKeys.js"),n=Object.prototype.hasOwnProperty;e.exports=function(e,t,o,i,a,l){var s=1&o,c=r(e),d=c.length;if(d!=r(t).length&&!s)return!1;for(var u=d;u--;){var p=c[u];if(!(s?p in t:n.call(t,p)))return!1}var h=l.get(e);if(h&&l.get(t))return h==t;var f=!0;l.set(e,t),l.set(t,e);for(var m=s;++u<d;){var y=e[p=c[u]],g=t[p];if(i)var v=s?i(g,y,p,t,e,l):i(y,g,p,e,t,l);if(!(void 0===v?y===g||a(y,g,o,i,l):v)){f=!1;break}m||(m="constructor"==p)}if(f&&!m){var _=e.constructor,b=t.constructor;_!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b)&&(f=!1)}return l.delete(e),l.delete(t),f}},"../node_modules/lodash/_flatRest.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_flatRest.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./flatten */"../node_modules/lodash/flatten.js"),n=o(/*! ./_overRest */"../node_modules/lodash/_overRest.js"),i=o(/*! ./_setToString */"../node_modules/lodash/_setToString.js");e.exports=function(e){return i(n(e,void 0,r),e+"")}},"../node_modules/lodash/_freeGlobal.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_freeGlobal.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){(function(t){var o="object"==typeof t&&t&&t.Object===Object&&t;e.exports=o}).call(this,o(/*! ./../webpack/buildin/global.js */"../node_modules/webpack/buildin/global.js"))},"../node_modules/lodash/_getAllKeys.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_getAllKeys.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetAllKeys */"../node_modules/lodash/_baseGetAllKeys.js"),n=o(/*! ./_getSymbols */"../node_modules/lodash/_getSymbols.js"),i=o(/*! ./keys */"../node_modules/lodash/keys.js");e.exports=function(e){return r(e,i,n)}},"../node_modules/lodash/_getAllKeysIn.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_getAllKeysIn.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetAllKeys */"../node_modules/lodash/_baseGetAllKeys.js"),n=o(/*! ./_getSymbolsIn */"../node_modules/lodash/_getSymbolsIn.js"),i=o(/*! ./keysIn */"../node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,i,n)}},"../node_modules/lodash/_getMapData.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_getMapData.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_isKeyable */"../node_modules/lodash/_isKeyable.js");e.exports=function(e,t){var o=e.__data__;return r(t)?o["string"==typeof t?"string":"hash"]:o.map}},"../node_modules/lodash/_getNative.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_getNative.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsNative */"../node_modules/lodash/_baseIsNative.js"),n=o(/*! ./_getValue */"../node_modules/lodash/_getValue.js");e.exports=function(e,t){var o=n(e,t);return r(o)?o:void 0}},"../node_modules/lodash/_getPrototype.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_getPrototype.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_overArg */"../node_modules/lodash/_overArg.js")(Object.getPrototypeOf,Object);e.exports=r},"../node_modules/lodash/_getRawTag.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_getRawTag.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=Object.prototype,i=n.hasOwnProperty,a=n.toString,l=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,l),o=e[l];try{e[l]=void 0;var r=!0}catch(e){}var n=a.call(e);return r&&(t?e[l]=o:delete e[l]),n}},"../node_modules/lodash/_getSymbols.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_getSymbols.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayFilter */"../node_modules/lodash/_arrayFilter.js"),n=o(/*! ./stubArray */"../node_modules/lodash/stubArray.js"),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,l=a?function(e){return null==e?[]:(e=Object(e),r(a(e),(function(t){return i.call(e,t)})))}:n;e.exports=l},"../node_modules/lodash/_getSymbolsIn.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_getSymbolsIn.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayPush */"../node_modules/lodash/_arrayPush.js"),n=o(/*! ./_getPrototype */"../node_modules/lodash/_getPrototype.js"),i=o(/*! ./_getSymbols */"../node_modules/lodash/_getSymbols.js"),a=o(/*! ./stubArray */"../node_modules/lodash/stubArray.js"),l=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=n(e);return t}:a;e.exports=l},"../node_modules/lodash/_getTag.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/_getTag.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_DataView */"../node_modules/lodash/_DataView.js"),n=o(/*! ./_Map */"../node_modules/lodash/_Map.js"),i=o(/*! ./_Promise */"../node_modules/lodash/_Promise.js"),a=o(/*! ./_Set */"../node_modules/lodash/_Set.js"),l=o(/*! ./_WeakMap */"../node_modules/lodash/_WeakMap.js"),s=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),c=o(/*! ./_toSource */"../node_modules/lodash/_toSource.js"),d=c(r),u=c(n),p=c(i),h=c(a),f=c(l),m=s;(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||n&&"[object Map]"!=m(new n)||i&&"[object Promise]"!=m(i.resolve())||a&&"[object Set]"!=m(new a)||l&&"[object WeakMap]"!=m(new l))&&(m=function(e){var t=s(e),o="[object Object]"==t?e.constructor:void 0,r=o?c(o):"";if(r)switch(r){case d:return"[object DataView]";case u:return"[object Map]";case p:return"[object Promise]";case h:return"[object Set]";case f:return"[object WeakMap]"}return t}),e.exports=m},"../node_modules/lodash/_getValue.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_getValue.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},"../node_modules/lodash/_hasPath.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_hasPath.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_castPath */"../node_modules/lodash/_castPath.js"),n=o(/*! ./isArguments */"../node_modules/lodash/isArguments.js"),i=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),a=o(/*! ./_isIndex */"../node_modules/lodash/_isIndex.js"),l=o(/*! ./isLength */"../node_modules/lodash/isLength.js"),s=o(/*! ./_toKey */"../node_modules/lodash/_toKey.js");e.exports=function(e,t,o){for(var c=-1,d=(t=r(t,e)).length,u=!1;++c<d;){var p=s(t[c]);if(!(u=null!=e&&o(e,p)))break;e=e[p]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&l(d)&&a(p,d)&&(i(e)||n(e))}},"../node_modules/lodash/_hashClear.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_hashClear.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_nativeCreate */"../node_modules/lodash/_nativeCreate.js");e.exports=function(){this.__data__=r?r(null):{},this.size=0}},"../node_modules/lodash/_hashDelete.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_hashDelete.js ***!
  \*********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},"../node_modules/lodash/_hashGet.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_hashGet.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_nativeCreate */"../node_modules/lodash/_nativeCreate.js"),n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var o=t[e];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(t,e)?t[e]:void 0}},"../node_modules/lodash/_hashHas.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_hashHas.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_nativeCreate */"../node_modules/lodash/_nativeCreate.js"),n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:n.call(t,e)}},"../node_modules/lodash/_hashSet.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_hashSet.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_nativeCreate */"../node_modules/lodash/_nativeCreate.js");e.exports=function(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},"../node_modules/lodash/_initCloneArray.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_initCloneArray.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){var o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},"../node_modules/lodash/_initCloneByTag.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_initCloneByTag.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_cloneArrayBuffer */"../node_modules/lodash/_cloneArrayBuffer.js"),n=o(/*! ./_cloneDataView */"../node_modules/lodash/_cloneDataView.js"),i=o(/*! ./_cloneRegExp */"../node_modules/lodash/_cloneRegExp.js"),a=o(/*! ./_cloneSymbol */"../node_modules/lodash/_cloneSymbol.js"),l=o(/*! ./_cloneTypedArray */"../node_modules/lodash/_cloneTypedArray.js");e.exports=function(e,t,o){var s=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new s(+e);case"[object DataView]":return n(e,o);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return l(e,o);case"[object Map]":return new s;case"[object Number]":case"[object String]":return new s(e);case"[object RegExp]":return i(e);case"[object Set]":return new s;case"[object Symbol]":return a(e)}}},"../node_modules/lodash/_initCloneObject.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_initCloneObject.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseCreate */"../node_modules/lodash/_baseCreate.js"),n=o(/*! ./_getPrototype */"../node_modules/lodash/_getPrototype.js"),i=o(/*! ./_isPrototype */"../node_modules/lodash/_isPrototype.js");e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(n(e))}},"../node_modules/lodash/_isFlattenable.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_isFlattenable.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Symbol */"../node_modules/lodash/_Symbol.js"),n=o(/*! ./isArguments */"../node_modules/lodash/isArguments.js"),i=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),a=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||n(e)||!!(a&&e&&e[a])}},"../node_modules/lodash/_isIndex.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_isIndex.js ***!
  \******************************************/
/*! no static exports found */function(e,t){var o=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&o.test(e))&&e>-1&&e%1==0&&e<t}},"../node_modules/lodash/_isIterateeCall.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_isIterateeCall.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./eq */"../node_modules/lodash/eq.js"),n=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js"),i=o(/*! ./_isIndex */"../node_modules/lodash/_isIndex.js"),a=o(/*! ./isObject */"../node_modules/lodash/isObject.js");e.exports=function(e,t,o){if(!a(o))return!1;var l=typeof t;return!!("number"==l?n(o)&&i(t,o.length):"string"==l&&t in o)&&r(o[t],e)}},"../node_modules/lodash/_isKey.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/_isKey.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),n=o(/*! ./isSymbol */"../node_modules/lodash/isSymbol.js"),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var o=typeof e;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=e&&!n(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}},"../node_modules/lodash/_isKeyable.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/_isKeyable.js ***!
  \********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},"../node_modules/lodash/_isMasked.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_isMasked.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_coreJsData */"../node_modules/lodash/_coreJsData.js"),n=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!n&&n in e}},"../node_modules/lodash/_isPrototype.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_isPrototype.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){var o=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||o)}},"../node_modules/lodash/_listCacheClear.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_listCacheClear.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){e.exports=function(){this.__data__=[],this.size=0}},"../node_modules/lodash/_listCacheDelete.js":
/*!**************************************************!*\
  !*** ../node_modules/lodash/_listCacheDelete.js ***!
  \**************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assocIndexOf */"../node_modules/lodash/_assocIndexOf.js"),n=Array.prototype.splice;e.exports=function(e){var t=this.__data__,o=r(t,e);return!(o<0||(o==t.length-1?t.pop():n.call(t,o,1),--this.size,0))}},"../node_modules/lodash/_listCacheGet.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_listCacheGet.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assocIndexOf */"../node_modules/lodash/_assocIndexOf.js");e.exports=function(e){var t=this.__data__,o=r(t,e);return o<0?void 0:t[o][1]}},"../node_modules/lodash/_listCacheHas.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_listCacheHas.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assocIndexOf */"../node_modules/lodash/_assocIndexOf.js");e.exports=function(e){return r(this.__data__,e)>-1}},"../node_modules/lodash/_listCacheSet.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_listCacheSet.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assocIndexOf */"../node_modules/lodash/_assocIndexOf.js");e.exports=function(e,t){var o=this.__data__,n=r(o,e);return n<0?(++this.size,o.push([e,t])):o[n][1]=t,this}},"../node_modules/lodash/_mapCacheClear.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_mapCacheClear.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_Hash */"../node_modules/lodash/_Hash.js"),n=o(/*! ./_ListCache */"../node_modules/lodash/_ListCache.js"),i=o(/*! ./_Map */"../node_modules/lodash/_Map.js");e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||n),string:new r}}},"../node_modules/lodash/_mapCacheDelete.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_mapCacheDelete.js ***!
  \*************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getMapData */"../node_modules/lodash/_getMapData.js");e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},"../node_modules/lodash/_mapCacheGet.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_mapCacheGet.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getMapData */"../node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).get(e)}},"../node_modules/lodash/_mapCacheHas.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_mapCacheHas.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getMapData */"../node_modules/lodash/_getMapData.js");e.exports=function(e){return r(this,e).has(e)}},"../node_modules/lodash/_mapCacheSet.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_mapCacheSet.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getMapData */"../node_modules/lodash/_getMapData.js");e.exports=function(e,t){var o=r(this,e),n=o.size;return o.set(e,t),this.size+=o.size==n?0:1,this}},"../node_modules/lodash/_mapToArray.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_mapToArray.js ***!
  \*********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach((function(e,r){o[++t]=[r,e]})),o}},"../node_modules/lodash/_memoizeCapped.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_memoizeCapped.js ***!
  \************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./memoize */"../node_modules/lodash/memoize.js");e.exports=function(e){var t=r(e,(function(e){return 500===o.size&&o.clear(),e})),o=t.cache;return t}},"../node_modules/lodash/_nativeCreate.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_nativeCreate.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_getNative */"../node_modules/lodash/_getNative.js")(Object,"create");e.exports=r},"../node_modules/lodash/_nativeKeys.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_nativeKeys.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_overArg */"../node_modules/lodash/_overArg.js")(Object.keys,Object);e.exports=r},"../node_modules/lodash/_nativeKeysIn.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_nativeKeysIn.js ***!
  \***********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var o in Object(e))t.push(o);return t}},"../node_modules/lodash/_nodeUtil.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_nodeUtil.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){(function(e){var r=o(/*! ./_freeGlobal */"../node_modules/lodash/_freeGlobal.js"),n=t&&!t.nodeType&&t,i=n&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===n&&r.process,l=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=l}).call(this,o(/*! ./../webpack/buildin/module.js */"../node_modules/webpack/buildin/module.js")(e))},"../node_modules/lodash/_objectToString.js":
/*!*************************************************!*\
  !*** ../node_modules/lodash/_objectToString.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){var o=Object.prototype.toString;e.exports=function(e){return o.call(e)}},"../node_modules/lodash/_overArg.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_overArg.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){return function(o){return e(t(o))}}},"../node_modules/lodash/_overRest.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_overRest.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_apply */"../node_modules/lodash/_apply.js"),n=Math.max;e.exports=function(e,t,o){return t=n(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,l=n(i.length-t,0),s=Array(l);++a<l;)s[a]=i[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=i[a];return c[t]=o(s),r(e,this,c)}}},"../node_modules/lodash/_parent.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/_parent.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGet */"../node_modules/lodash/_baseGet.js"),n=o(/*! ./_baseSlice */"../node_modules/lodash/_baseSlice.js");e.exports=function(e,t){return t.length<2?e:r(e,n(t,0,-1))}},"../node_modules/lodash/_root.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/_root.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_freeGlobal */"../node_modules/lodash/_freeGlobal.js"),n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")();e.exports=i},"../node_modules/lodash/_safeGet.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/_safeGet.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){if("__proto__"!=t)return e[t]}},"../node_modules/lodash/_setCacheAdd.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_setCacheAdd.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},"../node_modules/lodash/_setCacheHas.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_setCacheHas.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../node_modules/lodash/_setToArray.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_setToArray.js ***!
  \*********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=-1,o=Array(e.size);return e.forEach((function(e){o[++t]=e})),o}},"../node_modules/lodash/_setToString.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_setToString.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseSetToString */"../node_modules/lodash/_baseSetToString.js"),n=o(/*! ./_shortOut */"../node_modules/lodash/_shortOut.js")(r);e.exports=n},"../node_modules/lodash/_shortOut.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_shortOut.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){var o=Date.now;e.exports=function(e){var t=0,r=0;return function(){var n=o(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},"../node_modules/lodash/_stackClear.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/_stackClear.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_ListCache */"../node_modules/lodash/_ListCache.js");e.exports=function(){this.__data__=new r,this.size=0}},"../node_modules/lodash/_stackDelete.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/_stackDelete.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}},"../node_modules/lodash/_stackGet.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_stackGet.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return this.__data__.get(e)}},"../node_modules/lodash/_stackHas.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_stackHas.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return this.__data__.has(e)}},"../node_modules/lodash/_stackSet.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_stackSet.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_ListCache */"../node_modules/lodash/_ListCache.js"),n=o(/*! ./_Map */"../node_modules/lodash/_Map.js"),i=o(/*! ./_MapCache */"../node_modules/lodash/_MapCache.js");e.exports=function(e,t){var o=this.__data__;if(o instanceof r){var a=o.__data__;if(!n||a.length<199)return a.push([e,t]),this.size=++o.size,this;o=this.__data__=new i(a)}return o.set(e,t),this.size=o.size,this}},"../node_modules/lodash/_strictIndexOf.js":
/*!************************************************!*\
  !*** ../node_modules/lodash/_strictIndexOf.js ***!
  \************************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o){for(var r=o-1,n=e.length;++r<n;)if(e[r]===t)return r;return-1}},"../node_modules/lodash/_stringToPath.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/_stringToPath.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=o(/*! ./_memoizeCapped */"../node_modules/lodash/_memoizeCapped.js")((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(r,(function(e,o,r,i){t.push(r?i.replace(n,"$1"):o||e)})),t}));e.exports=i},"../node_modules/lodash/_toKey.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/_toKey.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isSymbol */"../node_modules/lodash/isSymbol.js");e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},"../node_modules/lodash/_toSource.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/_toSource.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){var o=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return o.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},"../node_modules/lodash/assign.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/assign.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_assignValue */"../node_modules/lodash/_assignValue.js"),n=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),i=o(/*! ./_createAssigner */"../node_modules/lodash/_createAssigner.js"),a=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js"),l=o(/*! ./_isPrototype */"../node_modules/lodash/_isPrototype.js"),s=o(/*! ./keys */"../node_modules/lodash/keys.js"),c=Object.prototype.hasOwnProperty,d=i((function(e,t){if(l(t)||a(t))n(t,s(t),e);else for(var o in t)c.call(t,o)&&r(e,o,t[o])}));e.exports=d},"../node_modules/lodash/clone.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/clone.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseClone */"../node_modules/lodash/_baseClone.js");e.exports=function(e){return r(e,4)}},"../node_modules/lodash/cloneDeep.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/cloneDeep.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseClone */"../node_modules/lodash/_baseClone.js");e.exports=function(e){return r(e,5)}},"../node_modules/lodash/constant.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/constant.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return function(){return e}}},"../node_modules/lodash/create.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/create.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseAssign */"../node_modules/lodash/_baseAssign.js"),n=o(/*! ./_baseCreate */"../node_modules/lodash/_baseCreate.js");e.exports=function(e,t){var o=n(e);return null==t?o:r(o,t)}},"../node_modules/lodash/debounce.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/debounce.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),n=o(/*! ./now */"../node_modules/lodash/now.js"),i=o(/*! ./toNumber */"../node_modules/lodash/toNumber.js"),a=Math.max,l=Math.min;e.exports=function(e,t,o){var s,c,d,u,p,h,f=0,m=!1,y=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var o=s,r=c;return s=c=void 0,f=t,u=e.apply(r,o)}function _(e){var o=e-h;return void 0===h||o>=t||o<0||y&&e-f>=d}function b(){var e=n();if(_(e))return T(e);p=setTimeout(b,function(e){var o=t-(e-h);return y?l(o,d-(e-f)):o}(e))}function T(e){return p=void 0,g&&s?v(e):(s=c=void 0,u)}function S(){var e=n(),o=_(e);if(s=arguments,c=this,h=e,o){if(void 0===p)return function(e){return f=e,p=setTimeout(b,t),m?v(e):u}(h);if(y)return p=setTimeout(b,t),v(h)}return void 0===p&&(p=setTimeout(b,t)),u}return t=i(t)||0,r(o)&&(m=!!o.leading,d=(y="maxWait"in o)?a(i(o.maxWait)||0,t):d,g="trailing"in o?!!o.trailing:g),S.cancel=function(){void 0!==p&&clearTimeout(p),f=0,s=h=c=p=void 0},S.flush=function(){return void 0===p?u:T(n())},S}},"../node_modules/lodash/eq.js":
/*!************************************!*\
  !*** ../node_modules/lodash/eq.js ***!
  \************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},"../node_modules/lodash/flatten.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/flatten.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseFlatten */"../node_modules/lodash/_baseFlatten.js");e.exports=function(e){return null!=e&&e.length?r(e,1):[]}},"../node_modules/lodash/forEach.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/forEach.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayEach */"../node_modules/lodash/_arrayEach.js"),n=o(/*! ./_baseEach */"../node_modules/lodash/_baseEach.js"),i=o(/*! ./_castFunction */"../node_modules/lodash/_castFunction.js"),a=o(/*! ./isArray */"../node_modules/lodash/isArray.js");e.exports=function(e,t){return(a(e)?r:n)(e,i(t))}},"../node_modules/lodash/forOwn.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/forOwn.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseForOwn */"../node_modules/lodash/_baseForOwn.js"),n=o(/*! ./_castFunction */"../node_modules/lodash/_castFunction.js");e.exports=function(e,t){return e&&r(e,n(t))}},"../node_modules/lodash/get.js":
/*!*************************************!*\
  !*** ../node_modules/lodash/get.js ***!
  \*************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGet */"../node_modules/lodash/_baseGet.js");e.exports=function(e,t,o){var n=null==e?void 0:r(e,t);return void 0===n?o:n}},"../node_modules/lodash/has.js":
/*!*************************************!*\
  !*** ../node_modules/lodash/has.js ***!
  \*************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseHas */"../node_modules/lodash/_baseHas.js"),n=o(/*! ./_hasPath */"../node_modules/lodash/_hasPath.js");e.exports=function(e,t){return null!=e&&n(e,t,r)}},"../node_modules/lodash/hasIn.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/hasIn.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseHasIn */"../node_modules/lodash/_baseHasIn.js"),n=o(/*! ./_hasPath */"../node_modules/lodash/_hasPath.js");e.exports=function(e,t){return null!=e&&n(e,t,r)}},"../node_modules/lodash/identity.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/identity.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return e}},"../node_modules/lodash/inRange.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/inRange.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseInRange */"../node_modules/lodash/_baseInRange.js"),n=o(/*! ./toFinite */"../node_modules/lodash/toFinite.js"),i=o(/*! ./toNumber */"../node_modules/lodash/toNumber.js");e.exports=function(e,t,o){return t=n(t),void 0===o?(o=t,t=0):o=n(o),e=i(e),r(e,t,o)}},"../node_modules/lodash/isArguments.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/isArguments.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsArguments */"../node_modules/lodash/_baseIsArguments.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js"),i=Object.prototype,a=i.hasOwnProperty,l=i.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(e){return n(e)&&a.call(e,"callee")&&!l.call(e,"callee")};e.exports=s},"../node_modules/lodash/isArray.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/isArray.js ***!
  \*****************************************/
/*! no static exports found */function(e,t){var o=Array.isArray;e.exports=o},"../node_modules/lodash/isArrayLike.js":
/*!*********************************************!*\
  !*** ../node_modules/lodash/isArrayLike.js ***!
  \*********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isFunction */"../node_modules/lodash/isFunction.js"),n=o(/*! ./isLength */"../node_modules/lodash/isLength.js");e.exports=function(e){return null!=e&&n(e.length)&&!r(e)}},"../node_modules/lodash/isArrayLikeObject.js":
/*!***************************************************!*\
  !*** ../node_modules/lodash/isArrayLikeObject.js ***!
  \***************************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return n(e)&&r(e)}},"../node_modules/lodash/isBuffer.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/isBuffer.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){(function(e){var r=o(/*! ./_root */"../node_modules/lodash/_root.js"),n=o(/*! ./stubFalse */"../node_modules/lodash/stubFalse.js"),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,l=a&&a.exports===i?r.Buffer:void 0,s=(l?l.isBuffer:void 0)||n;e.exports=s}).call(this,o(/*! ./../webpack/buildin/module.js */"../node_modules/webpack/buildin/module.js")(e))},"../node_modules/lodash/isEmpty.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/isEmpty.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseKeys */"../node_modules/lodash/_baseKeys.js"),n=o(/*! ./_getTag */"../node_modules/lodash/_getTag.js"),i=o(/*! ./isArguments */"../node_modules/lodash/isArguments.js"),a=o(/*! ./isArray */"../node_modules/lodash/isArray.js"),l=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js"),s=o(/*! ./isBuffer */"../node_modules/lodash/isBuffer.js"),c=o(/*! ./_isPrototype */"../node_modules/lodash/_isPrototype.js"),d=o(/*! ./isTypedArray */"../node_modules/lodash/isTypedArray.js"),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(l(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||d(e)||i(e)))return!e.length;var t=n(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var o in e)if(u.call(e,o))return!1;return!0}},"../node_modules/lodash/isEqual.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/isEqual.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsEqual */"../node_modules/lodash/_baseIsEqual.js");e.exports=function(e,t){return r(e,t)}},"../node_modules/lodash/isFunction.js":
/*!********************************************!*\
  !*** ../node_modules/lodash/isFunction.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./isObject */"../node_modules/lodash/isObject.js");e.exports=function(e){if(!n(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},"../node_modules/lodash/isLength.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/isLength.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},"../node_modules/lodash/isMap.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/isMap.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsMap */"../node_modules/lodash/_baseIsMap.js"),n=o(/*! ./_baseUnary */"../node_modules/lodash/_baseUnary.js"),i=o(/*! ./_nodeUtil */"../node_modules/lodash/_nodeUtil.js"),a=i&&i.isMap,l=a?n(a):r;e.exports=l},"../node_modules/lodash/isNumber.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/isNumber.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return"number"==typeof e||n(e)&&"[object Number]"==r(e)}},"../node_modules/lodash/isObject.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/isObject.js ***!
  \******************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},"../node_modules/lodash/isObjectLike.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/isObjectLike.js ***!
  \**********************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},"../node_modules/lodash/isPlainObject.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/isPlainObject.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./_getPrototype */"../node_modules/lodash/_getPrototype.js"),i=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js"),a=Function.prototype,l=Object.prototype,s=a.toString,c=l.hasOwnProperty,d=s.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=n(e);if(null===t)return!0;var o=c.call(t,"constructor")&&t.constructor;return"function"==typeof o&&o instanceof o&&s.call(o)==d}},"../node_modules/lodash/isSet.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/isSet.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsSet */"../node_modules/lodash/_baseIsSet.js"),n=o(/*! ./_baseUnary */"../node_modules/lodash/_baseUnary.js"),i=o(/*! ./_nodeUtil */"../node_modules/lodash/_nodeUtil.js"),a=i&&i.isSet,l=a?n(a):r;e.exports=l},"../node_modules/lodash/isSymbol.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/isSymbol.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseGetTag */"../node_modules/lodash/_baseGetTag.js"),n=o(/*! ./isObjectLike */"../node_modules/lodash/isObjectLike.js");e.exports=function(e){return"symbol"==typeof e||n(e)&&"[object Symbol]"==r(e)}},"../node_modules/lodash/isTypedArray.js":
/*!**********************************************!*\
  !*** ../node_modules/lodash/isTypedArray.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseIsTypedArray */"../node_modules/lodash/_baseIsTypedArray.js"),n=o(/*! ./_baseUnary */"../node_modules/lodash/_baseUnary.js"),i=o(/*! ./_nodeUtil */"../node_modules/lodash/_nodeUtil.js"),a=i&&i.isTypedArray,l=a?n(a):r;e.exports=l},"../node_modules/lodash/keys.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/keys.js ***!
  \**************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayLikeKeys */"../node_modules/lodash/_arrayLikeKeys.js"),n=o(/*! ./_baseKeys */"../node_modules/lodash/_baseKeys.js"),i=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js");e.exports=function(e){return i(e)?r(e):n(e)}},"../node_modules/lodash/keysIn.js":
/*!****************************************!*\
  !*** ../node_modules/lodash/keysIn.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayLikeKeys */"../node_modules/lodash/_arrayLikeKeys.js"),n=o(/*! ./_baseKeysIn */"../node_modules/lodash/_baseKeysIn.js"),i=o(/*! ./isArrayLike */"../node_modules/lodash/isArrayLike.js");e.exports=function(e){return i(e)?r(e,!0):n(e)}},"../node_modules/lodash/last.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/last.js ***!
  \**************************************/
/*! no static exports found */function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},"../node_modules/lodash/memoize.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/memoize.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_MapCache */"../node_modules/lodash/_MapCache.js");function n(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var o=function(){var r=arguments,n=t?t.apply(this,r):r[0],i=o.cache;if(i.has(n))return i.get(n);var a=e.apply(this,r);return o.cache=i.set(n,a)||i,a};return o.cache=new(n.Cache||r),o}n.Cache=r,e.exports=n},"../node_modules/lodash/merge.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/merge.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseMerge */"../node_modules/lodash/_baseMerge.js"),n=o(/*! ./_createAssigner */"../node_modules/lodash/_createAssigner.js")((function(e,t,o){r(e,t,o)}));e.exports=n},"../node_modules/lodash/mergeWith.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/mergeWith.js ***!
  \*******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseMerge */"../node_modules/lodash/_baseMerge.js"),n=o(/*! ./_createAssigner */"../node_modules/lodash/_createAssigner.js")((function(e,t,o,n){r(e,t,o,n)}));e.exports=n},"../node_modules/lodash/noop.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/noop.js ***!
  \**************************************/
/*! no static exports found */function(e,t){e.exports=function(){}},"../node_modules/lodash/now.js":
/*!*************************************!*\
  !*** ../node_modules/lodash/now.js ***!
  \*************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_root */"../node_modules/lodash/_root.js");e.exports=function(){return r.Date.now()}},"../node_modules/lodash/omit.js":
/*!**************************************!*\
  !*** ../node_modules/lodash/omit.js ***!
  \**************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayMap */"../node_modules/lodash/_arrayMap.js"),n=o(/*! ./_baseClone */"../node_modules/lodash/_baseClone.js"),i=o(/*! ./_baseUnset */"../node_modules/lodash/_baseUnset.js"),a=o(/*! ./_castPath */"../node_modules/lodash/_castPath.js"),l=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),s=o(/*! ./_customOmitClone */"../node_modules/lodash/_customOmitClone.js"),c=o(/*! ./_flatRest */"../node_modules/lodash/_flatRest.js"),d=o(/*! ./_getAllKeysIn */"../node_modules/lodash/_getAllKeysIn.js"),u=c((function(e,t){var o={};if(null==e)return o;var c=!1;t=r(t,(function(t){return t=a(t,e),c||(c=t.length>1),t})),l(e,d(e),o),c&&(o=n(o,7,s));for(var u=t.length;u--;)i(o,t[u]);return o}));e.exports=u},"../node_modules/lodash/set.js":
/*!*************************************!*\
  !*** ../node_modules/lodash/set.js ***!
  \*************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseSet */"../node_modules/lodash/_baseSet.js");e.exports=function(e,t,o){return null==e?e:r(e,t,o)}},"../node_modules/lodash/stubArray.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/stubArray.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(){return[]}},"../node_modules/lodash/stubFalse.js":
/*!*******************************************!*\
  !*** ../node_modules/lodash/stubFalse.js ***!
  \*******************************************/
/*! no static exports found */function(e,t){e.exports=function(){return!1}},"../node_modules/lodash/toFinite.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/toFinite.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./toNumber */"../node_modules/lodash/toNumber.js");e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},"../node_modules/lodash/toLower.js":
/*!*****************************************!*\
  !*** ../node_modules/lodash/toLower.js ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./toString */"../node_modules/lodash/toString.js");e.exports=function(e){return r(e).toLowerCase()}},"../node_modules/lodash/toNumber.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/toNumber.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./isObject */"../node_modules/lodash/isObject.js"),n=o(/*! ./isSymbol */"../node_modules/lodash/isSymbol.js"),i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(n(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var o=l.test(e);return o||s.test(e)?c(e.slice(2),o?2:8):a.test(e)?NaN:+e}},"../node_modules/lodash/toPlainObject.js":
/*!***********************************************!*\
  !*** ../node_modules/lodash/toPlainObject.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_copyObject */"../node_modules/lodash/_copyObject.js"),n=o(/*! ./keysIn */"../node_modules/lodash/keysIn.js");e.exports=function(e){return r(e,n(e))}},"../node_modules/lodash/toString.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/toString.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseToString */"../node_modules/lodash/_baseToString.js");e.exports=function(e){return null==e?"":r(e)}},"../node_modules/lodash/uniqWith.js":
/*!******************************************!*\
  !*** ../node_modules/lodash/uniqWith.js ***!
  \******************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseUniq */"../node_modules/lodash/_baseUniq.js");e.exports=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?r(e,void 0,t):[]}},"../node_modules/lodash/unset.js":
/*!***************************************!*\
  !*** ../node_modules/lodash/unset.js ***!
  \***************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_baseUnset */"../node_modules/lodash/_baseUnset.js");e.exports=function(e,t){return null==e||r(e,t)}},"../node_modules/lodash/xor.js":
/*!*************************************!*\
  !*** ../node_modules/lodash/xor.js ***!
  \*************************************/
/*! no static exports found */function(e,t,o){var r=o(/*! ./_arrayFilter */"../node_modules/lodash/_arrayFilter.js"),n=o(/*! ./_baseRest */"../node_modules/lodash/_baseRest.js"),i=o(/*! ./_baseXor */"../node_modules/lodash/_baseXor.js"),a=o(/*! ./isArrayLikeObject */"../node_modules/lodash/isArrayLikeObject.js"),l=n((function(e){return i(r(e,a))}));e.exports=l},"../node_modules/nanoid/format.js":
/*!****************************************!*\
  !*** ../node_modules/nanoid/format.js ***!
  \****************************************/
/*! no static exports found */function(e,t){e.exports=function(e,t,o){var r=(2<<Math.log(t.length-1)/Math.LN2)-1,n=Math.ceil(1.6*r*o/t.length);o=+o;for(var i="";;)for(var a=e(n),l=0;l<n;l++){var s=a[l]&r;if(t[s]&&(i+=t[s]).length===o)return i}}},"../node_modules/object-assign/index.js":
/*!**********************************************!*\
  !*** ../node_modules/object-assign/index.js ***!
  \**********************************************/
/*! no static exports found */function(e,t,o){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},o=0;o<10;o++)t["_"+String.fromCharCode(o)]=o;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var o,a,l=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var c in o=Object(arguments[s]))n.call(o,c)&&(l[c]=o[c]);if(r){a=r(o);for(var d=0;d<a.length;d++)i.call(o,a[d])&&(l[a[d]]=o[a[d]])}}return l}},"../node_modules/process/browser.js":
/*!******************************************!*\
  !*** ../node_modules/process/browser.js ***!
  \******************************************/
/*! no static exports found */function(e,t){var o,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(t){try{return o.call(null,e,0)}catch(t){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,c=[],d=!1,u=-1;function p(){d&&s&&(d=!1,s.length?c=s.concat(c):u=-1,c.length&&h())}function h(){if(!d){var e=l(p);d=!0;for(var t=c.length;t;){for(s=c,c=[];++u<t;)s&&s[u].run();u=-1,t=c.length}s=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];c.push(new f(e,t)),1!==c.length||d||l(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},"../node_modules/shortid/index.js":
/*!****************************************!*\
  !*** ../node_modules/shortid/index.js ***!
  \****************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=o(/*! ./lib/index */"../node_modules/shortid/lib/index.js")},"../node_modules/shortid/lib/alphabet.js":
/*!***********************************************!*\
  !*** ../node_modules/shortid/lib/alphabet.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r,n,i,a=o(/*! ./random/random-from-seed */"../node_modules/shortid/lib/random/random-from-seed.js"),l="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function s(){i=!1}function c(e){if(e){if(e!==r){if(e.length!==l.length)throw new Error("Custom alphabet for shortid must be "+l.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,o){return t!==o.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+l.length+" unique characters. These characters were not unique: "+t.join(", "));r=e,s()}}else r!==l&&(r=l,s())}function d(){return i||(i=function(){r||c(l);for(var e,t=r.split(""),o=[],n=a.nextValue();t.length>0;)n=a.nextValue(),e=Math.floor(n*t.length),o.push(t.splice(e,1)[0]);return o.join("")}())}e.exports={get:function(){return r||l},characters:function(e){return c(e),r},seed:function(e){a.seed(e),n!==e&&(s(),n=e)},lookup:function(e){return d()[e]},shuffled:d}},"../node_modules/shortid/lib/build.js":
/*!********************************************!*\
  !*** ../node_modules/shortid/lib/build.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r,n,i=o(/*! ./generate */"../node_modules/shortid/lib/generate.js"),a=(o(/*! ./alphabet */"../node_modules/shortid/lib/alphabet.js"),1459707606518);e.exports=function(e){var t="",o=Math.floor(.001*(Date.now()-a));return o===n?r++:(r=0,n=o),t+=i(6),t+=i(e),r>0&&(t+=i(r)),t+i(o)}},"../node_modules/shortid/lib/generate.js":
/*!***********************************************!*\
  !*** ../node_modules/shortid/lib/generate.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./alphabet */"../node_modules/shortid/lib/alphabet.js"),n=o(/*! ./random/random-byte */"../node_modules/shortid/lib/random/random-byte-browser.js"),i=o(/*! nanoid/format */"../node_modules/nanoid/format.js");e.exports=function(e){for(var t,o=0,a="";!t;)a+=i(n,r.get(),1),t=e<Math.pow(16,o+1),o++;return a}},"../node_modules/shortid/lib/index.js":
/*!********************************************!*\
  !*** ../node_modules/shortid/lib/index.js ***!
  \********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./alphabet */"../node_modules/shortid/lib/alphabet.js"),n=o(/*! ./build */"../node_modules/shortid/lib/build.js"),i=o(/*! ./is-valid */"../node_modules/shortid/lib/is-valid.js"),a=o(/*! ./util/cluster-worker-id */"../node_modules/shortid/lib/util/cluster-worker-id-browser.js")||0;function l(){return n(a)}e.exports=l,e.exports.generate=l,e.exports.seed=function(t){return r.seed(t),e.exports},e.exports.worker=function(t){return a=t,e.exports},e.exports.characters=function(e){return void 0!==e&&r.characters(e),r.shuffled()},e.exports.isValid=i},"../node_modules/shortid/lib/is-valid.js":
/*!***********************************************!*\
  !*** ../node_modules/shortid/lib/is-valid.js ***!
  \***********************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=o(/*! ./alphabet */"../node_modules/shortid/lib/alphabet.js");e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6||new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e))}},"../node_modules/shortid/lib/random/random-byte-browser.js":
/*!*****************************************************************!*\
  !*** ../node_modules/shortid/lib/random/random-byte-browser.js ***!
  \*****************************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r,n="object"==typeof window&&(window.crypto||window.msCrypto);r=n&&n.getRandomValues?function(e){return n.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],o=0;o<e;o++)t.push(Math.floor(256*Math.random()));return t},e.exports=r},"../node_modules/shortid/lib/random/random-from-seed.js":
/*!**************************************************************!*\
  !*** ../node_modules/shortid/lib/random/random-from-seed.js ***!
  \**************************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=1;e.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(e){r=e}}},"../node_modules/shortid/lib/util/cluster-worker-id-browser.js":
/*!*********************************************************************!*\
  !*** ../node_modules/shortid/lib/util/cluster-worker-id-browser.js ***!
  \*********************************************************************/
/*! no static exports found */function(e,t,o){"use strict";e.exports=0},"../node_modules/steamer-browserutils/dist/index.umd.js":
/*!**************************************************************!*\
  !*** ../node_modules/steamer-browserutils/dist/index.umd.js ***!
  \**************************************************************/
/*! no static exports found */function(e,t,o){!function(e){"use strict";function t(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}function o(e){return t("Array",e)}function r(e){return t("Date",e)}function n(e){return t("Object",e)}function i(e){return n(e)?JSON.stringify(e):e}var a=void 0!==a?a:{};"undefined"!=typeof window?a=window:"undefined"!=typeof self&&(a=self);var l=a;function s(e,t,o,r,n){var a=new Date;a.setTime(a.getTime()+(o?864e5*o:2592e6)),l.document&&(document.cookie=e+"="+encodeURIComponent(i(t))+";expires="+a.toGMTString()+";path="+(r||"/")+";"+(n?"domain="+n+";":""))}function c(e,t,o){var r=new Date(0);l.document&&(document.cookie=e+"=;expires="+r.toUTCString()+";path="+(t||"/")+";"+(o?"domain="+o+";":""))}function d(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),o="";return l.document&&(o=l.document.cookie.match(t)),(o?o[1]:"")||null}var u=function(){return l.location.hash},p=function(){return l.location.search};e.extend=function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(var a in t)if(t.hasOwnProperty(a)){var l=n(t[a]),s=o(t[a]);l||s?i&&(l?(r[a]={},e(t[a],r[a],i-1)):s&&(r[a]=[],e(t[a],r[a],i-1))):r[a]=t[a]}},e.setCookie=s,e.delCookie=c,e.getCookie=d,e.formatDate=function(e,t){if(e){var o=t,n=r(e)?e:new Date(e),i={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours()%12==0?12:n.getHours()%12,"H+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};for(var a in/(y+)/.test(o)&&(o=o.replace(RegExp.$1,String(n.getFullYear()).substr(4-RegExp.$1.length))),/(E+)/.test(o)&&(o=o.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+{0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"}[String(n.getDay())])),i)new RegExp("("+a+")").test(o)&&(o=o.replace(RegExp.$1,1===RegExp.$1.length?i[a]:("00"+i[a]).substr(String(i[a]).length)));return o}},e.setItem=function(e,t){var o=i(t);void 0!==l.Storage?localStorage.setItem(e,o):s(e,o)},e.getItem=function(e){return void 0!==l.Storage?localStorage.getItem(e):d(e)},e.delItem=function(e){void 0!==l.Storage?delete localStorage[e]:c(e)},e.callApi=function(e){if(l.document){var t=document.createElement("iframe");t.src=e,t.height=0,t.width=0,t.style.cssText="display: none",document.body.appendChild(t),setTimeout((function(){document.body.removeChild(t),t=null}),2e3)}},e.encodeHTML=function(e){return e&&0!==e.length?e.replace(/&/g,"&#38;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br>"):""},e.decodeHTML=function(e){return 0===e.length?"":e.replace(/&#38;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&nbsp;/g," ").replace(/<br>/g,"\n")},e.isType=t,e.isBoolean=function(e){return t("Boolean",e)},e.isNumber=function(e){return t("Number",e)},e.isString=function(e){return t("String",e)},e.isFunction=function(e){return t("Function",e)},e.isArray=o,e.isDate=r,e.isRegExp=function(e){return t("RegExp",e)},e.isObject=n,e.isError=function(e){return t("Error",e)},e.getHash=function(e){var t="";return l.location&&(t=u().match(new RegExp("(#|&)"+e+"=([^&#]*)(#|&|$)"))),t?decodeURIComponent(t[2]):""},e.getUrlParam=function(e){var t="",o=l.location;return o&&(t=p().match(new RegExp("(\\?|#|&)"+e+"=([^&]*)(#|&|$)"))),!t&&o&&(t=u().match(new RegExp("(#|&)"+e+"=([^&#]*)(#|&|$)"))),t?decodeURIComponent(t[2]):""},e.getQuery=function(e){var t="";return l.location&&(t=p().match(new RegExp("(\\?|&)"+e+"=([^&]*)(#|&|$)"))),t?decodeURIComponent(t[2]):""},e._stringify=i,e._parse=function(e){return n(e)?e:JSON.parse(e)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},"../node_modules/util/node_modules/inherits/inherits_browser.js":
/*!**********************************************************************!*\
  !*** ../node_modules/util/node_modules/inherits/inherits_browser.js ***!
  \**********************************************************************/
/*! no static exports found */function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var o=function(){};o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e}},"../node_modules/util/support/isBufferBrowser.js":
/*!*******************************************************!*\
  !*** ../node_modules/util/support/isBufferBrowser.js ***!
  \*******************************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"../node_modules/util/util.js":
/*!************************************!*\
  !*** ../node_modules/util/util.js ***!
  \************************************/
/*! no static exports found */function(e,t,o){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),o={},r=0;r<t.length;r++)o[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return o},n=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],o=0;o<arguments.length;o++)t.push(l(arguments[o]));return t.join(" ")}o=1;for(var r=arguments,i=r.length,a=String(e).replace(n,(function(e){if("%%"===e)return"%";if(o>=i)return e;switch(e){case"%s":return String(r[o++]);case"%d":return Number(r[o++]);case"%j":try{return JSON.stringify(r[o++])}catch(e){return"[Circular]"}default:return e}})),s=r[o];o<i;s=r[++o])m(s)||!b(s)?a+=" "+s:a+=" "+l(s);return a},t.deprecate=function(o,r){if(void 0!==e&&!0===e.noDeprecation)return o;if(void 0===e)return function(){return t.deprecate(o,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),n=!0}return o.apply(this,arguments)}};var i,a={};function l(e,o){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(o)?r.showHidden=o:o&&t._extend(r,o),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),d(r,e,r.depth)}function s(e,t){var o=l.styles[t];return o?"["+l.colors[o][0]+"m"+e+"["+l.colors[o][1]+"m":e}function c(e,t){return e}function d(e,o,r){if(e.customInspect&&o&&C(o.inspect)&&o.inspect!==t.inspect&&(!o.constructor||o.constructor.prototype!==o)){var n=o.inspect(r,e);return g(n)||(n=d(e,n,r)),n}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(g(t)){var o="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(o,"string")}return y(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,o);if(i)return i;var a=Object.keys(o),l=function(e){var t={};return e.forEach((function(e,o){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(o)),S(o)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(o);if(0===a.length){if(C(o)){var s=o.name?": "+o.name:"";return e.stylize("[Function"+s+"]","special")}if(_(o))return e.stylize(RegExp.prototype.toString.call(o),"regexp");if(T(o))return e.stylize(Date.prototype.toString.call(o),"date");if(S(o))return u(o)}var c,b="",w=!1,E=["{","}"];return h(o)&&(w=!0,E=["[","]"]),C(o)&&(b=" [Function"+(o.name?": "+o.name:"")+"]"),_(o)&&(b=" "+RegExp.prototype.toString.call(o)),T(o)&&(b=" "+Date.prototype.toUTCString.call(o)),S(o)&&(b=" "+u(o)),0!==a.length||w&&0!=o.length?r<0?_(o)?e.stylize(RegExp.prototype.toString.call(o),"regexp"):e.stylize("[Object]","special"):(e.seen.push(o),c=w?function(e,t,o,r,n){for(var i=[],a=0,l=t.length;a<l;++a)x(t,String(a))?i.push(p(e,t,o,r,String(a),!0)):i.push("");return n.forEach((function(n){n.match(/^\d+$/)||i.push(p(e,t,o,r,n,!0))})),i}(e,o,r,l,a):a.map((function(t){return p(e,o,r,l,t,w)})),e.seen.pop(),function(e,t,o){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?o[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+o[1]:o[0]+t+" "+e.join(", ")+" "+o[1]}(c,b,E)):E[0]+b+E[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,o,r,n,i){var a,l,s;if((s=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?l=s.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):s.set&&(l=e.stylize("[Setter]","special")),x(r,n)||(a="["+n+"]"),l||(e.seen.indexOf(s.value)<0?(l=m(o)?d(e,s.value,null):d(e,s.value,o-1)).indexOf("\n")>-1&&(l=i?l.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+l.split("\n").map((function(e){return"   "+e})).join("\n")):l=e.stylize("[Circular]","special")),v(a)){if(i&&n.match(/^\d+$/))return l;(a=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+l}function h(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function y(e){return"number"==typeof e}function g(e){return"string"==typeof e}function v(e){return void 0===e}function _(e){return b(e)&&"[object RegExp]"===w(e)}function b(e){return"object"==typeof e&&null!==e}function T(e){return b(e)&&"[object Date]"===w(e)}function S(e){return b(e)&&("[object Error]"===w(e)||e instanceof Error)}function C(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(o){if(v(i)&&(i=e.env.NODE_DEBUG||""),o=o.toUpperCase(),!a[o])if(new RegExp("\\b"+o+"\\b","i").test(i)){var r=e.pid;a[o]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",o,r,e)}}else a[o]=function(){};return a[o]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=_,t.isObject=b,t.isDate=T,t.isError=S,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=o(/*! ./support/isBuffer */"../node_modules/util/support/isBufferBrowser.js");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),I[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=o(/*! inherits */"../node_modules/util/node_modules/inherits/inherits_browser.js"),t._extend=function(e,t){if(!t||!b(t))return e;for(var o=Object.keys(t),r=o.length;r--;)e[o[r]]=t[o[r]];return e};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var o=new Error("Promise was rejected with a falsy value");o.reason=e,e=o}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(R&&e[R]){var t;if("function"!=typeof(t=e[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,o,r=new Promise((function(e,r){t=e,o=r})),n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);n.push((function(e,r){e?o(e):t(r)}));try{e.apply(this,n)}catch(e){o(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),R&&Object.defineProperty(t,R,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=R,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function o(){for(var o=[],r=0;r<arguments.length;r++)o.push(arguments[r]);var n=o.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return n.apply(i,arguments)};t.apply(this,o).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(O,t,a)}))}return Object.setPrototypeOf(o,Object.getPrototypeOf(t)),Object.defineProperties(o,r(t)),o}}).call(this,o(/*! ./../process/browser.js */"../node_modules/process/browser.js"))},"../node_modules/webpack/buildin/global.js":
/*!*************************************************!*\
  !*** ../node_modules/webpack/buildin/global.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},"../node_modules/webpack/buildin/module.js":
/*!*************************************************!*\
  !*** ../node_modules/webpack/buildin/module.js ***!
  \*************************************************/
/*! no static exports found */function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./app/collaborator-user-manager.ts":
/*!******************************************!*\
  !*** ./app/collaborator-user-manager.ts ***!
  \******************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserLeaveEvent=t.UserEnterEvent=void 0;var n=r(o(/*! ../event/event */"./event/event.ts")),i=function(){function e(e){this.app=e,this._event=new n.default,this.userList=[]}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.onUserEnter=function(e){this._event.emit(t.UserEnterEvent,e),this.userList.unshift(e),window.clientVars.invitedUserInfos=this.userList},e.prototype.onUserLeave=function(e){this._event.emit(t.UserLeaveEvent,e);var o=-1;this.userList.forEach((function(t,r,n){t.userId===e.userId&&(o=r)})),o>=0&&this.userList.splice(o,1),window.clientVars.invitedUserInfos=this.userList},e}();t.default=i,t.UserEnterEvent="UserEnterEvent",t.UserLeaveEvent="UserLeaveEvent"},"./app/cooperation-lock.ts":
/*!*********************************!*\
  !*** ./app/cooperation-lock.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(o(/*! ../event/event */"./event/event.ts")),i=r(o(/*! ../common/log-utils */"./common/log-utils.ts")),a=r(o(/*! ../middlebridge/core */"./middlebridge/core.ts")),l=o(/*! steamer-browserutils */"../node_modules/steamer-browserutils/dist/index.umd.js"),s=function(){function e(e){var t=this;this._enabled=!0,this._lockInfo={},this.app=e,this._event=new n.default,this.app.onReady((function(){t.app.privilege.readable&&(t._uid=t.app.docStore.userId.replace("p.","").replace("g.",""))})),this.app.event.on("online",(function(){t.enabled&&t.getAllLockInfo()})),l.getCookie("dev_route_id")&&(a.default.window.lockManager=this)}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},enumerable:!1,configurable:!0}),e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.getAllLockInfo=function(e){if(this._enabled){if(i.default.info("[lock] get all lock info"),!this.app.privilege.editable)return i.default.info("[lock] get all lock info failed, reason: no privilege"),void(e&&e(!1,{message:"no priviledge"}));var t=this.app.socket.sendMessage("GET_FULL_LOCK",0,JSON.stringify({}),{timeout:15e3,maxRetryCount:3},(function(t,o,r,n){if(console.log(t,o,r,n),0===n.errCode&&n.response&&n.response.onpost&&0===n.response.onpost.result)i.default.info("[lock] get all lock info succeeded"),e&&e(!0);else{var a=n.errCode,l=n.response&&n.response.onpost&&n.response.onpost.result;i.default.info("[lock] get all lock info failed, reason: post error "+a+", retCode "+l),e&&e(!1,{errorCode:a,message:"post error "+a+", retCode "+l})}}));if(t&&0!==t.errCode){var o=t.errCode;i.default.info("[lock] get all lock info failed, reason: send error "+o),e&&e(!1,{errorCode:o,message:"send error "+o})}}},e.prototype.lockById=function(e,t){if(this._enabled){if(!this.app.privilege.editable)return i.default.info("[lock] lock slide id "+e+" failed, reason: no privilege"),void(t&&t(!1,{message:"no privilege"}));var o=this._lockInfo[e];if(o)return i.default.info("[lock] lock slide id "+e+" failed, reason: benn locked"),void(t&&t(!1,{message:"the slide has been locked by "+(o.uid===this._uid?"you":"other")}));var r={timeout:15e3,maxRetryCount:3,pageId:e},n=this.app.socket.sendMessage("LOCK",0,JSON.stringify({}),r,(function(o,r,n,a){if(console.log(o,r,n,a),0===a.errCode&&a.response&&a.response.onpost&&0===a.response.onpost.result)i.default.info("[lock] lock slide id "+e+" succeeded"),t&&t(!0);else{var l=a.errCode,s=a.response&&a.response.onpost&&a.response.onpost.result;i.default.info("[lock] lock slide id "+e+" failed, reason: post error "+l+", retCode "+s),t&&t(!1,{errorCode:l,retCode:s,message:"post error "+l+", retCode "+s})}}));if(n&&0!==n.errCode){var a=n.errCode;i.default.info("[lock] lock slide id "+e+" failed, reason: send error "+a),t&&t(!1,{errorCode:a,message:"send error "+a})}}else i.default.info("[lock] unable to lock slide id "+e)},e.prototype.lockByIndex=function(e,t){if(this._enabled){if(!this.app.privilege.editable)return i.default.info("[lock] lock slide at index "+e+" failed, reason: no privilege"),void(t&&t(!1,{message:"no privilege"}));var o=this.app.presentationStore.presentation.slideList[e];if(!o)return i.default.info("[lock] lock slide at index "+e+" failed, reason: not found"),void(t&&t(!1,{message:"slide at "+e+" is not found"}));i.default.info("[lock] lock slide at index "+e+", id is "+o.id),this.lockById(o.id,t)}},e.prototype.unlockById=function(e,t){if(this._enabled){if(i.default.info("[lock] unlock slide id "+e),!this.app.privilege.editable)return i.default.info("[lock] unlock slide id "+e+" failed, reason: no privilege"),void(t&&t(!1,{message:"no privilege"}));var o=this._lockInfo[e];if(o&&o.uid!==this._uid)return i.default.info("[lock] unlock slide id "+e+" failed, reason: benn locked by others"),void(t&&t(!1,{message:"cannot unlock slide locked by others"}));var r={timeout:15e3,maxRetryCount:3,pageId:e},n=this.app.socket.sendMessage("UNLOCK",0,JSON.stringify({}),r,(function(o,r,n,a){if(console.log(o,r,n,a),0===a.errCode&&a.response&&a.response.onpost&&0===a.response.onpost.result)i.default.info("[lock] unlock slide id "+e+" succeeded"),t&&t(!0);else{var l=a.errCode,s=a.response&&a.response.onpost&&a.response.onpost.result;i.default.info("[lock] unlock slide id "+e+" failed, reason: post error "+l+", retCode "+s),t&&t(!1,{errorCode:l,retCode:s,message:"post error "+l+", retCode "+s})}}));if(n&&0!==n.errCode){var a=n.errCode;i.default.info("[lock] unlock slide id "+e+" failed, reason: send error "+a),t&&t(!1,{errorCode:a,message:"send error "+a})}}},e.prototype.unlockByIndex=function(e,t){if(this._enabled){if(i.default.info("[lock] unlock slide at index "+e),!this.app.privilege.editable)return i.default.info("[lock] unlock slide at index "+e+" failed, reason: no privilege"),void(t&&t(!1,{message:"no privilege"}));var o=this.app.presentationStore.presentation.slideList[e];if(!o)return i.default.info("[lock] unlock slide at index "+e+" failed, reason: not found"),void(t&&t(!1,{message:"slide at "+e+" is not found"}));this.unlockById(o.id)}},e.prototype.onLock=function(e){var t=this;if(this._enabled&&this.app.privilege.editable){var o=this._lockInfo;this._lockInfo={},this._myLockSlideId=void 0;var r=[],n=[];Object.keys(e).forEach((function(i){var a=e[i],l=String(a.userId);t._lockInfo[i]={uid:l},r.push(l),l===t._uid&&(t._myLockSlideId=i),o[i]||n.push(i)})),r.length>0&&n.length>0&&this.app.userManager.userInfosFromUids(r,(function(e,o,r){t.event.emit("userInfoUpdate")})),n.length>0&&(i.default.info("[lock] receive lock: "+n.join(",")),this.event.emit("lock",this.lockInfo));var a=[];if(Object.keys(o).forEach((function(e){t._lockInfo[e]||a.push(e)})),a.length>0){i.default.info("[lock] receive unlock: "+a.join(","));var l=this.mapIdToIndex;this.event.emit("unlock",a.map((function(e){return{slide:{id:e,index:l[e]}}})))}this._myLockSlideId||this.clearUnlockTimer(),this.checkNeedTimeoutLock(n.length>0)}},e.prototype.onUnlock=function(e){if(this._enabled&&this.app.privilege.editable){var t=this.mapIdToIndex,o=e.pageid;i.default.info("[lock] receive unlock: "+o),delete this._lockInfo[o],this._myLockSlideId===o&&(this._myLockSlideId=void 0),this.event.emit("unlock",[{slide:{id:o,index:t[o]}}]),this._myLockSlideId||this.clearUnlockTimer(),this.checkNeedTimeoutLock(!1)}},e.prototype.onUserLeave=function(e){var t=this,o=e.userId.replace("p.","").replace("g.",""),r=Object.keys(this._lockInfo).find((function(e){return t._lockInfo[e].uid===o}));if(r){var n=this.mapIdToIndex;i.default.info("[lock] receive user leave to unlock: "+r),delete this._lockInfo[r],this.event.emit("unlock",[{slide:{id:r,index:n[r]}}])}},Object.defineProperty(e.prototype,"lockInfo",{get:function(){var e=this,t=this.mapIdToIndex,o=[];return Object.keys(this._lockInfo).forEach((function(r){var n=e._lockInfo[r],i=t[r],a=e.getCachedUserInfo(n.uid);o.push({slide:{id:r,index:i},user:{uid:n.uid,isSelf:n.uid===e._uid,avatar:a&&a.userPic,name:a&&a.markName}})})),o},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"myLockInfo",{get:function(){if(this._myLockSlideId){var e=this.mapIdToIndex;return{slide:{id:this._myLockSlideId,index:e[this._myLockSlideId]}}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapIdToIndex",{get:function(){var e={};return this.app.presentationStore.presentation&&this.app.presentationStore.presentation.slideList&&this.app.presentationStore.presentation.slideList.forEach((function(t,o){e[t.id]=o})),e},enumerable:!1,configurable:!0}),e.prototype.getLockInfoByIndex=function(e){var t=this.app.presentationStore.presentation.slideList[e];return t&&this.getLockInfoById(t.id)},e.prototype.getLockInfoById=function(e){var t=this._lockInfo[e];if(t){var o=this.getCachedUserInfo(t.uid);return{user:{uid:t.uid,isSelf:t.uid===this._uid,avatar:o&&o.userPic,name:o&&o.markName}}}},e.prototype.getCachedUserInfo=function(e){return this.app.userManager.userInfoFromCache(e)},e.prototype.checkNeedTimeoutLock=function(e){Object.keys(this._lockInfo).length>0?this.startCheckTimeoutLockLoop(e):this.stopCheckTimeoutLockLoop()},e.prototype.startCheckTimeoutLockLoop=function(t){var o=this;t&&clearInterval(this._timeoutLockLoop),this._timeoutLockLoop&&!t||(this._timeoutLockLoop=setInterval((function(){i.default.info("[lock] timeout lock check"),o.getAllLockInfo()}),e.TIMEOUT_LOCK_CHECK_INTERVAL))},e.prototype.stopCheckTimeoutLockLoop=function(){this._timeoutLockLoop&&(clearInterval(this._timeoutLockLoop),this._timeoutLockLoop=null)},e.prototype.unlockMyLock=function(){this._enabled&&this._myLockSlideId&&this.unlockById(this._myLockSlideId)},e.prototype.unlockMyLockInFuture=function(){var t=this;if(this._enabled){var o=e.UNLOCK_INTERVAL;this._unlockTimer&&clearTimeout(this._unlockTimer),this._unlockTimer=setTimeout((function(){t._myLockSlideId&&(t.unlockById(t._myLockSlideId),clearTimeout(t._unlockTimer),t._unlockTimer=null)}),o)}},e.prototype.clearUnlockTimer=function(){this._unlockTimer&&(clearTimeout(this._unlockTimer),this._unlockTimer=null)},e.TIMEOUT_LOCK_CHECK_INTERVAL=6e4,e.UNLOCK_INTERVAL=6e4,e}();t.default=s},"./app/cursor-manager.ts":
/*!*******************************!*\
  !*** ./app/cursor-manager.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CursorInfo=void 0;var i=n(o(/*! ../event/event */"./event/event.ts")),a=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),l=n(o(/*! lodash/debounce */"../node_modules/lodash/debounce.js")),s=n(o(/*! lodash/isEmpty */"../node_modules/lodash/isEmpty.js")),c=n(o(/*! lodash/xor */"../node_modules/lodash/xor.js")),d=function(){};t.CursorInfo=d;var u=function(){function e(t){var o=this;this._cursors={},this.debouncedUpdateCursor=l.default((function(e,t){o.compareAndUpdateMyCursor(e)&&o.sendCursorInfo(e,void 0,t)}),100),this._app=t,this._event=new i.default,this._colorCandidateList=e.colorList.slice(0),this._colorMap={}}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.updateCursor=function(e,t){this.debouncedUpdateCursor(e,t)},e.prototype.sendMyCursorToUser=function(e,t){this._myCursor&&this.sendCursorInfo(this._myCursor,e,t)},e.prototype.sendCursorInfo=function(e,t,o){if(this._app.socket.opened&&!(this.isGuest(this._app.docStore.userId)||t&&this.isGuest(t))){a.default.info("[cursor] send cursor for "+e.selection.length+" element(s)");var n=r(r({userId:this._app.docStore.userId},e),{targetUserId:t});this._app.socket.sendMessage("CURSOR_MESSAGE",0,JSON.stringify(n),void 0,(function(e,t,r,n){if(0===n.errCode&&n.response&&n.response.onpost&&0===n.response.onpost.result)a.default.info("[cursor] send cursor info succeeded"),o&&o(!0);else{var i=n.errCode,l=n.response&&n.response.onpost&&n.response.onpost.result;a.default.info("[cursor] send cursor info failed, reason: post error "+i+", retCode "+l),o&&o(!1,{errorCode:i,message:"post error "+i+", retCode "+l})}}))}},Object.defineProperty(e.prototype,"elementCursors",{get:function(){var e=this;return Object.keys(this._cursors).reduce((function(t,o){return o===e._app.docStore.userId||e._cursors[o].selection.forEach((function(r){t[r]=t[r]||[],t[r].push({userId:o,color:e.getColorForId(o)})})),t}),{})},enumerable:!1,configurable:!0}),e.prototype.onUserEnter=function(e){var t=e.userId;this._myCursor&&this.sendMyCursorToUser(t)},e.prototype.onUserLeave=function(e){var t=e.userId;delete this._cursors[t],this.event.emit("update",{isNew:!1})},e.prototype.compareAndUpdateMyCursor=function(e){return!this.isSameCursorInfo(e,this._myCursor)&&(this._myCursor=e,!0)},e.prototype.isSameCursorInfo=function(e,t){return!e&&!t||!(!e||!t)&&s.default(c.default(e.selection,t.selection))},e.prototype.handleCursorInfo=function(e){var t=e.userId,o=e.targetUserId,r=e.selection;if(a.default.info("[cursor] handle cursor info from "+t),!this.isGuest(this._app.docStore.userId)&&t!==this._app.docStore.userId&&(!o||o===this._app.docStore.userId)&&t){var n={selection:r};this.isSameCursorInfo(this._cursors[t],n)||(a.default.info("[cursor] cursor changed"),0===r.length?delete this._cursors[t]:this._cursors[t]=n,this.event.emit("update",{isNew:!o}))}},e.prototype.getColorForId=function(t){if(!this._colorMap[t]){0===this._colorCandidateList.length&&(this._colorCandidateList=e.colorList.slice(0));var o=Math.floor(Math.random()*this._colorCandidateList.length);this._colorMap[t]=this._colorCandidateList[o],this._colorCandidateList.splice(o,1)}return this._colorMap[t]},e.prototype.getUserName=function(e){var t=e.replace("p.","").replace("g.",""),o=this._app.userManager.userInfoFromCache(t);return o?o.markName:void 0},e.prototype.isGuest=function(e){return!!e&&0===e.indexOf("g.")},e.colorList=["#B30000","#E6118F","#F1633A","#3646A0","#3184E9","#09A9B9","#822F1D","#C67600","#FFB400","#0D6C54","#918B3D","#7BB725"],e}();t.default=u},"./app/error-code.ts":
/*!***************************!*\
  !*** ./app/error-code.ts ***!
  \***************************/
/*! no static exports found */function(e,t,o){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GetSlideAppErrorByCode=t.ServerErrorCode=t.SlideAppErrorCodeMap=t.SlideAppError=void 0,function(e){e[e.None=0]="None",e[e.Unknown=1]="Unknown",e[e.ServerError=2]="ServerError",e[e.ConnectTimeout=3]="ConnectTimeout",e[e.ServerTimeout=4]="ServerTimeout",e[e.LoginExpired=5]="LoginExpired",e[e.AuthExpired=6]="AuthExpired",e[e.SizeLimit=7]="SizeLimit",e[e.DataError=8]="DataError",e[e.FrequencyLimit=9]="FrequencyLimit",e[e.SecurityStrike=10]="SecurityStrike",e[e.FullRoom=11]="FullRoom",e[e.AppVersionError=12]="AppVersionError",e[e.FetchMissingFailed=13]="FetchMissingFailed",e[e.ServerNoResponse=14]="ServerNoResponse",e[e.ServerAndDataError=15]="ServerAndDataError",e[e.Cancel=16]="Cancel",e[e.CommitingCancel=17]="CommitingCancel"}(r=t.SlideAppError||(t.SlideAppError={})),t.SlideAppErrorCodeMap={6e4:r.ServerError,60001:r.ServerError,60002:r.ConnectTimeout,60003:r.DataError,60004:r.ServerTimeout,60005:r.ServerTimeout,60006:r.LoginExpired,60007:r.AuthExpired,60008:r.SizeLimit,60009:r.None,60010:r.FullRoom,60011:r.ServerTimeout,60013:r.ServerTimeout,60014:r.FrequencyLimit,60015:r.AuthExpired,60016:r.DataError,60017:r.DataError,60018:r.ServerTimeout,60019:r.ServerTimeout,60020:r.ServerTimeout,60021:r.ServerTimeout,60022:r.ServerTimeout,4e4:r.ServerAndDataError,40001:r.DataError,40002:r.DataError,40003:r.DataError,40004:r.AuthExpired,40005:r.ServerAndDataError,40006:r.ServerAndDataError,40007:r.DataError,40020:r.ServerAndDataError,40021:r.ServerAndDataError,40022:r.ServerAndDataError,40023:r.ServerAndDataError,40024:r.AppVersionError,40025:r.SecurityStrike,40026:r.SizeLimit,40027:r.DataError,40028:r.SizeLimit,40029:r.AppVersionError,40030:r.DataError,1e4:r.ServerAndDataError,10001:r.ServerAndDataError,41001:r.ServerAndDataError,41002:r.ServerAndDataError,70001:r.FullRoom,999999:r.Cancel,999998:r.CommitingCancel},function(e){e[e.COMMIT_ERROR_FOLLOW_FAILED=40005]="COMMIT_ERROR_FOLLOW_FAILED",e[e.COMMIT_ERROR_BASEREV_LIMIT_ERROR=40027]="COMMIT_ERROR_BASEREV_LIMIT_ERROR",e[e.COMMIT_ERROR_CANCEL_SENDING=999999]="COMMIT_ERROR_CANCEL_SENDING",e[e.COMMIT_ERROR_CANCEL_WAITING=999998]="COMMIT_ERROR_CANCEL_WAITING"}(t.ServerErrorCode||(t.ServerErrorCode={})),t.GetSlideAppErrorByCode=function(e){var o=t.SlideAppErrorCodeMap[String(e)];return void 0!==o?o:r.Unknown}},"./app/revision-manager.ts":
/*!*********************************!*\
  !*** ./app/revision-manager.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchMissingChanges=t.handleFetchChangesResponse=t.handleChanges=t.RevisionOffline2Online=t.RevisionOnline2Offline=t.RevisionUpdateBaseRevison=t.RevisionCommitFailEvent=t.RevisionCommitSucceedEvent=void 0;var n=o(/*! ../network/services/api */"./network/services/api.ts"),i=o(/*! ./user-change */"./app/user-change.ts"),a=r(o(/*! ../event/event */"./event/event.ts")),l=r(o(/*! ../common/log-utils */"./common/log-utils.ts")),s=o(/*! ./error-code */"./app/error-code.ts"),c=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),d=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts"),u=o(/*! ../common/utils */"./common/utils.ts");t.RevisionCommitSucceedEvent="revisionCommitSucceed",t.RevisionCommitFailEvent="revisionCommitFail",t.RevisionUpdateBaseRevison="revisionUpdateBaseRevison",t.RevisionOnline2Offline="RevisionOnline2Offline",t.RevisionOffline2Online="RevisionOffline2Online";var p,h=function(){function e(){this.queue=[]}return e.prototype.push=function(e){this.queue.push(e)},e.prototype.shift=function(){return this.queue.shift()||null},Object.defineProperty(e.prototype,"last",{get:function(){return this.queue.length>0?this.queue[this.queue.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.queue=[]},e.prototype.isEmpty=function(){return 0===this.queue.length},e.prototype.updateBaseRevision=function(e){this.queue.forEach((function(t){t.baseRevision=e}))},Object.defineProperty(e.prototype,"length",{get:function(){return this.queue.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"changes",{get:function(){return this.queue.slice(0)},enumerable:!1,configurable:!0}),e}();function f(e,t,o,r,n,i,a,s){void 0===s&&o>t?(r.push.apply(r,n),y(e,t+1,o,i)):void 0!==s&&s<=o&&s>t?(r.push.apply(r,n),y(e,t+1,s,i)):(l.default.info("[rev] [fetch] fetchd changes from "+a+" to "+t),i(!0,n))}function m(e,t,o,r,n,i,a){if(e&&200===e.status&&e.data){var s=e&&e.data;if(0===s.retcode){var c=s.result,d=c.to,u=c.rev,h=c.changes;if(0===h.length)return void r(!1,void 0,{code:p.ResultError,message:"retcode="+s.retcode,retcode:s.retcode});f(t,d,u,o,h.map((function(e){var t=e.data;return{revision:t.newRev,changeset:t.changeset,commitId:t.commitId,revert:t.revert}})),r,n,i)}else l.default.info("[rev] [fetch] fetch missing changes from "+n+" to "+(i||"lastest")+" error, "+s.retcode),r(!1,void 0,{code:p.CGIError,message:"retcode="+s.retcode,retcode:s.retcode})}else a&&a(!1,void 0,{code:p.ResponseError,message:e&&e.statusText||"response is void"})}function y(e,t,o,r){var i=[],a=function(e,t,o){Array.isArray(t)&&i.push.apply(i,t),r&&r(e,e?i:void 0,o)};l.default.info("[rev] [fetch] fetch changes from "+t+" to "+(o||"lastest")),void 0!==o&&o<t?a(!1,void 0,{code:p.ParamError,message:"to is less than from",retcode:0}):n.fetchChanges(e,t,o,15e3).then((function(n){m(n,e,i,a,t,o,r)})).catch((function(e){l.default.info("[rev] [fetch] fetch missing changes from "+t+" to "+(o||"lastest")+" error, "+e.message),a(!1,void 0,{code:p.Timeout,message:e.message||"fetch missing changes error",retcode:0})}))}!function(e){e[e.ResponseError=1]="ResponseError",e[e.CGIError=2]="CGIError",e[e.ResultError=3]="ResultError",e[e.ParamError=4]="ParamError",e[e.Timeout=5]="Timeout"}(p||(p={})),t.handleChanges=f,t.handleFetchChangesResponse=m,t.fetchMissingChanges=y;var g=function(){function e(){this.duplicateCache=new Map}return e.prototype.setCommitRecord=function(e,t){e>0&&this.duplicateCache.set(e,t)},e.prototype.isDuplicate=function(e,t){if(e>0&&this.duplicateCache.has(e)){var o=this.duplicateCache.get(e);if(o===t||o===t-1)return l.default.info("[rev] ["+e+"] is duplicate"+(o===t-1?", +1":"")),!0;l.default.warn("[rev] ["+e+"] duplicate is not excepted , old:"+o+", new:"+t)}return!1},e}(),v=function(){function e(e,t){var o=this;this.__retryTime=0,this.__retryPostCount=0,this.__retryCommitCount=0,this.__retryFetchCount=0,this.__blockBaseTimestamp=0,this.pushChangesCache=[],this.fetchingMissingChanges=!1,this._revision=0,this._event=new a.default,this.app=e,this._globalPadId="",this._subId="",this._uuId="",this.app.event.on("ready",(function(){o._revision=o.app.docStore.baseRevision,o._globalPadId=o.app&&o.app.docStore&&o.app.docStore.globalPadId,o._uuId=o.app&&o.app.docStore&&o.app.docStore.userId,o._subId=o.app&&o.app.docStore&&o.app.docStore.subId,o.app.socket.opened&&o.startMessageLoop()})),this.app.event.on("online",(function(){o.startMessageLoop()})),this.app.event.on("offline",(function(){o.stopMessageLoop()})),this.handler=t,this.waitingQueue=new h,this.duplicateCache=new g}return Object.defineProperty(e.prototype,"revision",{get:function(){return this._revision},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.startMessageLoop=function(){this.loopTimeout||(l.default.info("[rev] start message loop"),this.loop())},e.prototype.stopMessageLoop=function(){l.default.info("[rev] stop message loop"),this.loopTimeout&&clearTimeout(this.loopTimeout),this.loopTimeout=null,this.commitingChange&&(this.commitingChange.lastSendTime=0,this.retryCommit(3e3))},e.prototype.loop=function(){var t=this;this.loopTimeout||(this.loopTimeout=setTimeout((function(){if("OPENED"===t.app.socket.roomState&&!t.fetchingMissingChanges){var o=(new Date).getTime(),r=t.__retryTime>0&&o>=t.__retryTime&&t.commitingChange,n=t.__blockBaseTimestamp>0&&o-t.__blockBaseTimestamp>e.BLOCK_CHECK_INTERVAL;if(t.online2OfflineCheck(o,t.commitingChange),r)t.__retryTime=0,l.default.info("[rev] start retry commit"),t.commitUserChange(t.commitingChange);else if(t.commitingChange||t.waitingQueue.isEmpty())t.commitingChange&&n&&(l.default.info("[rev] ["+t.commitingChange.commitId+"] detect blocking change, re-commit"),t.commitUserChange(t.commitingChange));else{t.__retryTime=0;var i=t.waitingQueue.shift();i&&t.commitUserChange(i)}}t.loopTimeout=null,t.loop()}),e.MESSAGE_LOOP_INTERVAL))},e.prototype.online2OfflineCheck=function(o,r){r&&o-r.lastSendTime>e.MAX_TIMEOUT_4_ONLINE_2_OFFLINE&&(this.event.emit(t.RevisionOnline2Offline),l.default.info("[rev] commiting change consume max time , online 2 offline"))},e.prototype.updateBaseRevision=function(e){var o=this;l.default.info("[rev] update base revision "+this._revision+" to "+e+", call stack from "+u.getCallStack()),e<=this._revision?l.default.warn("[rev] update base rev "+e+" is small than current rev "+this._revision):(this._revision=e,this.commitingChange&&(this.commitingChange.lastSendTime=0,this.commitingChange.baseRevision=e,this.duplicateCache.setCommitRecord(this.commitingChange.commitId,this.commitingChange.baseRevision)),this.waitingQueue.updateBaseRevision(e),this.waitingQueue.changes.forEach((function(e){o.duplicateCache.setCommitRecord(e.commitId,e.baseRevision)})),this.event.emit(t.RevisionUpdateBaseRevison,e))},e.prototype.fetchAndApplyMissingChanges=function(e,t,o){var r=this;if(this.fetchingMissingChanges)return!1;var n=function(e,t,o){r.fetchingMissingChanges||(r.fetchingMissingChanges=!0,y(r._globalPadId,e,t,(function(e,t,n){if(r.fetchingMissingChanges=!1,e){var i=function(e){for(var t=0,o=0;o<e.length;o++){var r=e[o];if(0===o)t=r.revision;else{if(r.revision!==t+1)return!1;t=r.revision}}return!0}(t);o(i,t,i?void 0:{code:p.ResultError,message:"revisions are not continuous"})}else o(!1,void 0,n)})))},i=function(i){l.default.error("[rev] fetch & apply failed, error: "+(i&&i.code)+", message: "+(i&&i.message));var c=i?i.code:void 0,d=i?i.retcode:void 0,u=c===p.ResultError,h=c===p.Timeout,f=c===p.CGIError&&(100003===d||200200===d);"SHUTDOWN"===r.app.socket.roomState?(l.default.error("[rev] retry fetch & apply failed, already shutdown"),r.__retryFetchCount=0,o&&o(!1)):u||h||f?function(i){r.__retryFetchCount<3?(r.__retryFetchCount+=1,l.default.info("[rev] retry fetch & apply, limit ("+r.__retryFetchCount+" / 3)"),n(e,t,a)):(l.default.error("[rev] retry fetch & apply failed"),r.__retryFetchCount=0,o&&o(!1),r.emitError({error:s.SlideAppError.FetchMissingFailed,code:i&&i.code,message:i&&i.message}))}(i):(o&&o(!1),r.emitError({error:s.SlideAppError.FetchMissingFailed,code:i&&i.code,message:i&&i.message}))},a=function(e,t,n){e?function(e){o&&o(!0,e),r.applyUserChanges(e),l.default.info("[rev] fetch & apply missing changes succeeded"),r.__retryFetchCount=0}(t):i(n)};return l.default.info("[rev] start fetch & apply missing changes from "+e+" to "+(t||"lastest")),n(e,t,a),!0},e.prototype.sendChangeset=function(e,t,o,r){var n;l.default.info("[rev] add changeset, seq:"+t);var a=this.waitingQueue.last;if(null==a?void 0:a.appendChangeset(e,o,null===(n=this.handler)||void 0===n?void 0:n.handleCombineChangeset))l.default.info("[CS]:[rev] merge changeset to last waiting change seq:"+a.commitId+", size is "+a.length),r&&r(a.commitId,a.changeset);else{var s=new i.UpstreamUserChange({baseRevision:this.revision,changeset:e,subId:this.app.docStore.subId,uuId:this.app.docStore.userId},o);s.commitId=t,null==r||r(t,e),this.waitingQueue.push(s)}this.event.emit("queue",{changeset:e}),this.app.setDocVisible()},e.prototype.commitUserChange=function(e){for(var t=-1,o=0;o<e.changeset.length;o++){var r=e.changeset[o],n=c.findChangedSlideInfoByPatch(r);if(n&&n.changeInSlide&&"slide"===n.type){t=n.indexs[0];break}}var i=void 0;-1!==t&&(i=this.app.presentationStore.presentation.slideList[t].id),e.lastSendTime=(new Date).getTime();var a={timeout:15e3,maxRetryCount:3,waitAcceptCmd:["ACCEPT_COMMIT","COMMIT_ERROR","TASK_DUPLICATE"],pageId:i},s=this.app.socket.sendMessage("USER_CHANGES",e.commitId,e.message,a,this.onCommitChangeset.bind(this),this.onCommitChangesetAccept.bind(this));this.commitingChange=e,this.duplicateCache.setCommitRecord(s.seq,this.commitingChange.baseRevision),this.__blockBaseTimestamp=(new Date).getTime(),s&&0!==s.errCode&&this.handleRoomErrorCode(0,"",s),l.default.info("[rev] ["+s.seq+"] start commit user change",e.changeset)},e.prototype.onCommitChangeset=function(e,t,o,r){0===r.errCode&&r.response&&r.response.onpost&&0===r.response.onpost.result?this.__retryPostCount=0:(l.default.error("[rev] ["+e+"] send changeset failed"),this.handleCommitOnSendError(e,t,r))},e.prototype.onCommitChangesetAccept=function(e,t,o,r,n){if("USER_CHANGES"===t)switch(r){case"ACCEPT_COMMIT":this.handleAcceptCommit(e,t,n);break;case"COMMIT_ERROR":this.handleCommitError(e,t,n);break;case"TASK_DUPLICATE":this.handleTaskDuplicate(e,t,n);break;default:n.errCode&&l.default.info("[rev] ["+e+"] other send ack, result: "+JSON.stringify(n))}},e.prototype.handleCommitOnSendError4Retry=function(e,t,o){if(this.__retryPostCount<3){this.__retryPostCount++,l.default.info("[rev] retry commit for post error, limit ("+this.__retryPostCount+" / 3)"),this.app.socket.cancelMessageBySeq(e);var r=this.retryTimeByCount(this.__retryPostCount);o.response.onpost&&o.response.onpost.retry_interval&&(r=o.response.onpost.retry_interval),this.retryCommit(r),this.__blockBaseTimestamp=0}else l.default.info("[rev] commit failed for reaching post retry limit"),this.__retryPostCount=0,this.doCommitingChangeCallback(!1,{error:s.GetSlideAppErrorByCode(t),reason:t}),this.shutDown(String(t)),this.emitError({error:s.GetSlideAppErrorByCode(t),code:t,shutDown:!0}),this.reportFailed(!0),this.__blockBaseTimestamp=0},e.prototype.handleCommitOnSendError4NotRetry=function(e){l.default.info("[rev] commit failed for no need to retry post"),this.doCommitingChangeCallback(!1,{error:s.GetSlideAppErrorByCode(e),reason:e}),this.shutDown(String(e)),this.emitError({error:s.GetSlideAppErrorByCode(e),code:e,shutDown:!0}),this.reportFailed(!0),this.__blockBaseTimestamp=0},e.prototype.handleCommitOnSendError=function(e,t,o){if(o&&o.response&&o.response.onpost&&0!==o.response.onpost.result){var r=o.response.onpost.result;l.default.error("[rev] ["+e+"] send changeset failed, error code: "+r),[60002,60004,60005,60011,60013,60014,60021,60022].indexOf(r)>-1?this.handleCommitOnSendError4Retry(e,r,o):[60003,60008,60016,60007,60015,60017].indexOf(r)>-1?this.handleCommitOnSendError4NotRetry(r):l.default.info("[rev] commit failed: default handle")}else this.handleRoomErrorCode(e,t,o)},e.prototype.acceptCommit=function(e){this.__retryTime=0,this.__retryCommitCount=0,this.updateBaseRevision(e),this.doCommitingChangeCallback(!0,{revision:e}),this.event.emit(t.RevisionCommitSucceedEvent)},e.prototype.resetCommit=function(e){this.__retryTime=0,this.__retryCommitCount=0;var o={};null!=e&&(o.revision=e),this.doCommitingChangeCallback(!0,o),this.event.emit(t.RevisionCommitSucceedEvent)},e.prototype.isDuplicateMessage=function(e,t){return this.duplicateCache.isDuplicate(e,t)},e.prototype.handleAcceptCommit=function(e,t,o){if(0===o.errCode&&o.response){var r=o.response.new_rev;o.response.body.data.commitId,this.acceptCommit(r),this.__blockBaseTimestamp=0}else this.handleRoomErrorCode(e,t,o)},e.prototype.handleCommitError4Fetch=function(e,t){var o=this;this.__blockBaseTimestamp=0,l.default.info("[rev] check missing changeset, last: "+e+", current: "+this.revision),e>this.revision&&this.fetchAndApplyMissingChanges(this.revision+1,e,(function(e){e||(o.doCommitingChangeCallback(!1,{error:s.SlideAppError.FetchMissingFailed,reason:t}),o.reportFailed(!1),l.default.info("[rev] set block base ts for fetching missing failed"),o.__blockBaseTimestamp=(new Date).getTime())}))},e.prototype.handleCommitError4Retry=function(e,t,o){if(this.__retryCommitCount<3){this.__retryCommitCount+=1,l.default.info("[rev] retry commit for commit error, limit ("+this.__retryCommitCount+" / 3)"),this.app.socket.cancelMessageBySeq(e);var r=this.retryTimeByCount(this.__retryCommitCount);t.response.body&&t.response.body.data&&t.response.body.data.retry_interval&&(r=t.response.body.data.retry_interval),this.retryCommit(r),this.__blockBaseTimestamp=0}else l.default.info("[rev] commit failed for reaching retry limit"),this.doCommitingChangeCallback(!1,{error:s.GetSlideAppErrorByCode(o),reason:o,cause:d.CommitErrorCause.ServerRefuse}),this.shutDown(String(o)),this.emitError({error:s.GetSlideAppErrorByCode(o),code:o,shutDown:!0}),this.reportFailed(!0),this.__blockBaseTimestamp=0},e.prototype.handleCommitError4Default=function(e){l.default.info("[rev] commit failed for no need to retry"),this.doCommitingChangeCallback(!1,{error:s.GetSlideAppErrorByCode(e),reason:e,cause:d.CommitErrorCause.ServerRefuse}),this.shutDown(String(e)),this.emitError({error:s.GetSlideAppErrorByCode(e),code:e,shutDown:!0}),this.reportFailed(!0),this.__blockBaseTimestamp=0},e.prototype.handleCommitError=function(e,t,o){if(0===o.errCode&&o.response){var r=o.response.body,n=r&&r.data,i=n&&n.reason||0,a=n&&n.msg||"",s=n.head;l.default.error("[rev] ["+e+"] commit error, reason: "+i+", message: "+a),[40021,40027].indexOf(i)>-1?this.handleCommitError4Fetch(s,i):[60018,60019,60020,40006].indexOf(i)>-1?this.handleCommitError4Retry(e,o,i):this.handleCommitError4Default(i)}else this.handleRoomErrorCode(e,t,o)},e.prototype.handleTaskDuplicate=function(e,t,o){if(l.default.info("[rev] ["+e+"] tast duplicate"),0===o.errCode&&o.response){var r=this.commitingChange;r&&e===r.commitId?this.resetCommit():l.default.info("[rev] ["+e+"] no match for sending")}else this.handleRoomErrorCode(e,t,o)},e.prototype.handleRoomErrorCode=function(e,t,o){switch(l.default.info("[rev] handle room error: "+o.errCode),o.errCode){case 101:case 104:case 106:this.retryCommit(3e3),this.__blockBaseTimestamp=0;break;case 102:this.doCommitingChangeCallback(!1,{error:s.SlideAppError.DataError,reason:o.errCode}),this.emitError({error:s.SlideAppError.DataError,code:o.errCode}),this.reportFailed(!1),this.__blockBaseTimestamp=(new Date).getTime();break;case 103:case 105:break;default:this.doCommitingChangeCallback(!1,{error:s.SlideAppError.Unknown,reason:o.errCode}),this.emitError({error:s.SlideAppError.Unknown,code:o.errCode}),this.reportFailed(!1),this.__blockBaseTimestamp=(new Date).getTime()}},e.prototype.handleNewChanges=function(e){var t=e.body&&e.body.data,o=e.new_rev,r=t.changeset||"[]",n=t.revert||!1,i=t.commitId||0;if(r){l.default.info("[CS][rev] ["+i+"] receive new changes, new rev: "+o);var a={revision:o,changeset:r,revert:n,commitId:i};this.pushChangesCache.push(a),this.checkRemoteChanges()}},e.prototype.checkRemoteChanges=function(){var e=this;if(this.fetchingMissingChanges)l.default.info("[rev] is fetchingMissingChanges, can't check remote changes");else if(this.pushChangesCache.length>0){this.pushChangesCache=this.pushChangesCache.sort((function(e,t){return e.revision-t.revision}));for(var t=this.pushChangesCache.length,o=0;o<t;o++){var r=this.pushChangesCache[o];if(r.revision===this.revision+1)this.applyUserChange(r);else if(r.revision>this.revision+1){this.fetchAndApplyMissingChanges(this.revision+1,r.revision-1,(function(t){t&&e.checkRemoteChanges()}));break}}this.pushChangesCache.splice(0,o)}},e.prototype.applyUserChange=function(e){var t=e.revision<=this.revision;if(l.default.info("[rev] ["+e.commitId+"] apply user change, rev: "+e.revision+", cur rev: "+this.revision+(t?", ignore":"")),!t){var o=this.isDuplicateMessage(e.commitId,e.revision);if(o&&(l.default.info("[rev] ["+e.commitId+"] received user change is duplicate"),this.commitingChange&&e.commitId===this.commitingChange.commitId&&(l.default.info("[rev] ["+e.commitId+"] reset commit"),this.resetCommit(e.revision))),this.updateBaseRevision(e.revision),o)this.retryCommit(0);else{this.cancelAllCommit();var r={changeset:JSON.parse(e.changeset),revision:e.revision};this.handler&&this.handler.handleNewUserChangesets&&this.handler.handleNewUserChangesets([r])}}},e.prototype.applyUserChanges=function(e){var t=this,o=e.map((function(e){return e.commitId+"("+e.revision+")"})).join(","),r=e.reduce((function(e,t){return Math.max(e,t.revision)}),0),n=r<=this.revision;if(l.default.info("[rev] apply multi user changes: "+o+", cur rev: "+this.revision+(n?", ignore":"")),!n){var i=e.filter((function(e){return t.isDuplicateMessage(e.commitId,e.revision)}));i.length>0&&i.forEach((function(o){l.default.info("[rev] ["+o.commitId+"] received user change is duplicate"),t.commitingChange&&o.commitId===t.commitingChange.commitId&&(l.default.info("[rev] ["+o.commitId+"] reset commit"),t.resetCommit(o.revision)),e.splice(e.indexOf(o),1)}));var a=e.filter((function(e){return e.revision>t.revision}));if(this.updateBaseRevision(r),0!==a.length){this.cancelAllCommit();var s=a.map((function(e){return{changeset:JSON.parse(e.changeset),revision:e.revision}}));this.handler&&this.handler.handleNewUserChangesets&&this.handler.handleNewUserChangesets(s)}else this.retryCommit(0)}},e.prototype.retryCommit=function(e){l.default.info("[rev] retry commit after "+e+"ms"),this.__retryTime=(new Date).getTime()+e},e.prototype.doCommitingChangeCallback=function(e,o){var r=this.commitingChange;this.commitingChange=null,e?(r&&(r.lastSendTime=0),this.event.emit(t.RevisionOffline2Online)):this.cancelAllCommit(),r&&r.finish(e,o)},e.prototype.updateLastRevision=function(e){var t=this;l.default.info("[rev] update last revision to "+e+", current is "+this._revision),this.revision<e&&this.fetchAndApplyMissingChanges(this.revision+1,e,(function(e){e&&t.commitingChange}))},e.prototype.cancelAllCommit=function(){l.default.info("[rev] cancel all commit"),this.__retryTime=0,this.__retryCommitCount=0,this.__blockBaseTimestamp=0;var e=this.commitingChange;this.commitingChange&&(this.commitingChange.lastSendTime=0,this.app.socket.cancelMessageBySeq(this.commitingChange.commitId),this.commitingChange=null);for(var t=0;t<this.waitingQueue.length;t++){var o=this.waitingQueue.shift();o&&o.finish(!1,{error:s.GetSlideAppErrorByCode(999998),reason:999998})}this.waitingQueue.clear(),e&&e.finish(!1,{error:s.GetSlideAppErrorByCode(999999),reason:999999})},Object.defineProperty(e.prototype,"queuingChanges",{get:function(){return this.commitingChange?[this.commitingChange].concat(this.waitingQueue.changes):this.waitingQueue.changes},enumerable:!1,configurable:!0}),e.prototype.shutDown=function(e){this.app.socket.close(e)},e.prototype.emitError=function(e){l.default.error("[rev] error: "+e.error+", code: "+e.code+", message: "+e.message+", shutdown: "+(e.shutDown||!1)),this.event.emit(t.RevisionCommitFailEvent,{error:e.error,code:e.code||0,message:e.message||"",shutDown:e.shutDown||!1})},e.prototype.reportFailed=function(e){l.default.tdw&&l.default.tdw({opername:"quality_slide",module:"cs",action:"send"}),e&&l.default.tdw&&l.default.tdw({opername:"quality_slide",module:"ws",action:"connect"})},e.prototype.retryTimeByCount=function(e){switch(e){case 0:case 1:return 3e3;case 2:return 5e3;default:return 8e3}},e.MESSAGE_LOOP_INTERVAL=500,e.BLOCK_CHECK_INTERVAL=5e4,e.MAX_TIMEOUT_4_ONLINE_2_OFFLINE=45e3,e}();t.default=v},"./app/search-manager.ts":
/*!*******************************!*\
  !*** ./app/search-manager.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(/*! ../component */"./component/index.ts"),a=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),l=o(/*! .. */"./index.ts"),s=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),c=o(/*! ../component/note */"./component/note.ts"),d=n(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),u=function(){function e(){}return e.searchText=function(e,t){var o=this;if(!e)return a.default.error("查找异常"),[];e=e.toLocaleLowerCase();var r=new Array;t?t.forEach((function(e){-1==r.indexOf(e)&&o.recurseAllComponents(r,e)})):this.recurseAllComponents(r,l.Store.presentation);var n=new Array;return r.reduce((function(t,o){if(o instanceof i.Shape||o instanceof c.Note){var r=o.paragraphTextArray,n=new Array;r.reduce((function(t,o,r){var n=-1;for(o=o.toLocaleLowerCase();-1!=(n=o.indexOf(e,n));)t.push({offset:n,paragraph:r}),n+=e.length;return t}),n),n.length>0&&t.push({component:o,uniqueID:o.uniqueID,result:n})}else if(o instanceof i.Table){var a=o.cellTextArray,l=new Array;a.forEach((function(t){t.paragraphTextArray.forEach((function(o,r){var n=-1;for(o=o.toLocaleLowerCase();-1!=(n=o.indexOf(e,n));)l.push({cell:{row:t.row,col:t.col},offset:n,paragraph:r}),n+=e.length}))})),l.length>0&&t.push({component:o,uniqueID:o.uniqueID,result:l})}return t}),n),n},e.recurseAllComponents=function(e,t){var o=this;(t instanceof i.Shape||t instanceof i.Table)&&-1===e.indexOf(t)&&e.push(t),t.children&&t.children.length>0&&t.children.forEach((function(t){o.recurseAllComponents(e,t)})),t instanceof l.Slide&&t.noteData&&t.noteData.note&&-1===e.indexOf(t.noteData.note)&&e.push(t.noteData.note)},e.searchTextInChangesets=function(e,t,o){var r=this,n=(new Array,new Set);n.add(l.Store.presentation);var i=!1;return t.forEach((function(t){t.forEach((function(t){var a=t.map((function(e){return"remove"===e.op&&""===e.tid&&1===e.pid.split("|").length?e.pid:void 0})).filter((function(e){return void 0!==e}));a.length>0&&a.forEach((function(e){i=r.removeSearchResultWithSlide(o,e)||i}));var c=s.findChangedSlideInfoByPatch(t);if(c)if(c.changeInSlide){var d=l.Store.presentation.children[c.indexs[0]],u=r.searchText(e,[d]);i=r.replaceSearchResultWithSlide(u,o,d.id)||i,n.add(d)}else c.indexs.forEach((function(t){var a=l.Store.presentation.children[t],s=r.searchText(e,[a]);i=r.replaceSearchResultWithSlide(s,o,a.id)||i,n.add(a)}))}))})),i},e.replaceSearchResultWithSlide=function(e,t,o){var n=t.filter((function(e,t){return e.uniqueID.indexOf(o)>=0})),i=!1,a=l.Store.presentation.children.findIndex((function(e){return e.id===o})),s=-1;n.length>0?(s=t.indexOf(n[0]),t.splice(t.indexOf(n[0]),n.length),i=e.length!==n.length||e.some((function(e){return!n.some((function(t){return t.uniqueID===e.uniqueID&&d.default(t.result,e.result)}))}))):i=e.length>0;var c=t.findIndex((function(e,t){return l.Store.presentation.children.findIndex((function(t){return e.uniqueID.indexOf(t.id)>=0}))>a}));return!i&&n.length>0&&-1!=s&&c!==s&&(i=!0),e.length>0&&t.splice.apply(t,r([c,0],e)),i},e.removeSearchResultWithSlide=function(e,t){var o=e.filter((function(e,o){return e.uniqueID.indexOf(t)>=0}));return o.length>0&&(e.splice(e.indexOf(o[0]),o.length),!0)},e}();t.default=u},"./app/slide-app.ts":
/*!**************************!*\
  !*** ./app/slide-app.ts ***!
  \**************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var i=n(o(/*! ../network/socket/socket */"./network/socket/socket.ts")),a=n(o(/*! ./revision-manager */"./app/revision-manager.ts")),l=n(o(/*! ./cooperation-lock */"./app/cooperation-lock.ts")),s=o(/*! ../store/presentation-store */"./store/presentation-store.ts"),c=n(o(/*! ../store/doc-store */"./store/doc-store.ts")),d=n(o(/*! ./user-manager */"./app/user-manager.ts")),u=n(o(/*! ./title-manager */"./app/title-manager.ts")),p=n(o(/*! ./cursor-manager */"./app/cursor-manager.ts")),h=n(o(/*! ./collaborator-user-manager */"./app/collaborator-user-manager.ts")),f=n(o(/*! ../event/event */"./event/event.ts")),m=n(o(/*! ../middlebridge/core */"./middlebridge/core.ts")),y=o(/*! ../network/services/api */"./network/services/api.ts"),g=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),v=o(/*! @tencent/tencent-doc-report */"../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),_=o(/*! ./error-code */"./app/error-code.ts"),b=n(o(/*! ../report/reporter */"./report/reporter.ts")),T=o(/*! ../common/utils */"./common/utils.ts"),S=n(o(/*! ../store/offline-editor/persistent-manager */"./store/offline-editor/persistent-manager.ts")),C=o(/*! ../common/common-constants */"./common/common-constants.ts"),w=function(){function e(){this._ready=!1,this._online=!1,this._privilege={readable:!1,editable:!1,copyable:!1,exportable:!1,printable:!1,canGenerateCopies:!1},this.init()}return e.prototype.responseError=function(){var e=m.default.window.clientVars;void 0!==e.__responseException&&(g.default.tdw&&g.default.tdw({opername:"quality_slide",module:"clientvars",action:"get",ver5:e.__httpStatus}),g.default.error("[app]get clientvar http status "+e.__httpStatus))},e.prototype.createPresentationWithChangeset=function(){return o(/*! ../store/offline-editor/data/combinePresentation.json */"./store/offline-editor/data/combinePresentation.json")},e.prototype.createSlideEmptyTemplate=function(){return o(/*! ../store/offline-editor/data/newSlideTemplate.json */"./store/offline-editor/data/newSlideTemplate.json")},e.prototype.createCurClientVars=function(){if(this.docStore.info){var e=T.cloneDeep(this.docStore.info);e.collab_client_vars.rev=this.revisionManager.revision;var t=JSON.stringify(this.presentationStore.presentation);return e.collab_client_vars.initialAttributedText.text=t,e}},e.prototype.initialize=function(){v.resetDefaultTdwData(),m.default.window.clientVars&&this.initializeDataWithClientVars(m.default.window.clientVars)},e.prototype.initializeData=function(){var e=this;m.default.window.clientVars?this.initialize():(window.addEventListener("dataReady",(function(){e.initialize()})),window.addEventListener("dataError",(function(){e.responseError()})))},e.prototype.initializeWebSocket=function(){if(this.privilege.readable)try{this.docStore.info?(this.socket.open(this.docStore.info.collab_client_vars,this.docStore.info.userId),g.default.info("[app] slide app socket initialized")):g.default.error("[app] slide app no socket for docStore.info is undefined")}catch(e){g.default.error(e)}else g.default.info("[app] slide app no socket for unreadable privilege")},e.prototype.initializeDataWithClientVars=function(e){var t=this;v.resetDefaultTdwData(),window.PALog&&window.PALog("SlideApp initialize begin"),this.initializeTime=(new Date).getTime()-window.performance.timing.navigationStart;var o=e;if(o.__tdw&&g.default.info("[app] slide data fetching cost time: "+o.__tdw.elapsedTime),o.collab_client_vars){var r=o.collab_client_vars.initialAttributedText.text;this.presentationStore.loadNewPresentation(r,!0)}this.docStore.info=o,this._privilege.readable=0===o.__retcode||o.isOwner||!1,this._privilege.editable=o.isOwner||!o.isOverConNum&&0!=(2&o.rightFlag),this._privilege.copyable=!!this._privilege.editable||!(o.advPolicy&&o.advPolicy.view_forbid_copy_print),this._privilege.exportable=this._privilege.copyable,this._privilege.printable=this._privilege.copyable,this._privilege.canGenerateCopies=this._privilege.copyable,g.default.info("[app] slide app data initialized"),g.default.info("[app] doc url: "+window.location.href),g.default.info("[app] global pad id: "+this.docStore.globalPadId),g.default.info("[app] slide data retcode: "+o.__retcode),this._ready=!0,g.default.info("[app] slide app initialized"),this.event.emit("ready"),T.isDevelopment()&&(window.slideApp=this),this.privilege.readable&&y.getDocInfo(this.docStore.domainId,this.docStore.padId).then((function(e){var o=e.data;0===o.retcode&&(t.docStore.extra=o,t.docStore.collected=o.is_collected,t.docStore.isAddedMy=o.is_added_my,g.default.info("[app] slide app doc extra info fetched"),t.event.emit("docExtraInfoReady"))})).catch((function(){})),window.PALog&&window.PALog("SlideApp initialize end"),b.default.startCommitReport();var n=T.visibilityEventAndStateName();m.default.window.addEventListener(n.event,(function(){"hidden"===document[n.state]?b.default.stopCommitReport():b.default.startCommitReport()})),void 0!==o.__jsonException&&g.default.error("[app] data error "+o.__rawData)},e.prototype.init=function(){window.PALog&&window.PALog("SlideApp init begin"),this._event=new f.default,this.socket=new i.default(this),this.persistentManager=new S.default(this,C.CommonConstants.USER_AGENT),this.presentationStore=new s.PresentationStore(this),this.docStore=new c.default,this.revisionManager=new a.default(this,this.presentationStore.changeSetManager),this.lockManager=new l.default(this),this.userManager=new d.default(this),this.titleManager=new u.default(this),this.cursorManager=new p.default(this),this.collaboratorUserManager=new h.default(this),window.PALog&&window.PALog("SlideApp init end")},Object.defineProperty(e.prototype,"privilege",{get:function(){return r({},this._privilege)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docId",{get:function(){if(void 0===this._docId){var e=/^\/slide\/([^\/]+?)\/?$/.exec(location.pathname),t=e&&e.length>1?e[1]:"";this._docId=t}return this._docId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return this._ready},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOnline",{get:function(){return this._online},enumerable:!1,configurable:!0}),e.prototype.onReady=function(e){if(this.isReady)e&&e();else var t=this.event.on("ready",(function(){e&&e(),t()}))},Object.defineProperty(e.prototype,"editable",{get:function(){return this._privilege.editable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"copyable",{get:function(){return this._privilege.copyable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readable",{get:function(){return this._privilege.readable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.setDocVisible=function(){var e=this;this.docStore.visible||y.transDocVisible(this.docStore.domainId,this.docStore.padId,3e4).then((function(t){t&&t.data?0===t.data.retcode&&(e.docStore.visible=!0,m.default.window.SLR&&m.default.window.SLR.dispatch("DOC_HUMTRANS_DONE")):(g.default.error("[app] set doc visible failed, response: "+(t?t.status:"null")),e.event.emit("setVisibleFailed"))})).catch((function(t){t&&(g.default.error("[app] set doc visible failed, error: "+t.message),e.event.emit("setVisibleFailed"))}))},e.prototype.handleMessageFromServer=function(e,t){this.event.emit("receiveSocketMessage",e,t)},e.prototype.handleUserEnter=function(e){this.collaboratorUserManager.onUserEnter(e),this.userManager.userEnter(e),this.cursorManager.onUserEnter(e)},e.prototype.handleUserLeave=function(e){this.collaboratorUserManager.onUserLeave(e),this.userManager.userLeave(e),this.lockManager.onUserLeave(e),this.cursorManager.onUserLeave(e)},e.prototype.handleNewChanges=function(e){this.revisionManager.handleNewChanges(e)},e.prototype.handleLastRevision=function(e){this.revisionManager.updateLastRevision(e)},e.prototype.getPadRevision=function(){return this.revisionManager.revision},e.prototype.handleOnline=function(){this._online=!0,g.default.info("[app] online"),this.event.emit("online")},e.prototype.handleOffline=function(){this._online=!1,g.default.info("[app] offline"),this.event.emit("offline")},e.prototype.handleDeletePad=function(){g.default.info("[app] pad deleted."),this.event.emit("deleted")},e.prototype.handleTitleMessage=function(e){this.titleManager.handleTitleMessage(e)},e.prototype.handleRightMessage=function(e){this.event.emit("receiveRightMessage",e)},e.prototype.handleRevertMessage=function(e){g.default.info("[app] receive revert message"),this.event.emit("receiveRevertMessage")},e.prototype.handleShutDown=function(e,t){g.default.error("[app] socket shut down by reason: "+e);var o=Object.keys(_.SlideAppErrorCodeMap).find((function(t){return-1!==e.indexOf(t)})),r=o?parseInt(o,10):t,n=o?_.GetSlideAppErrorByCode(r):_.SlideAppError.Unknown;this.event.emit("socketShutDown",{error:n,code:r,reason:e})},e.prototype.handleLock=function(e){this.lockManager.onLock(e)},e.prototype.handleUnlock=function(e){this.lockManager.onUnlock(e)},e.prototype.handleCursorMessage=function(e){this.cursorManager.handleCursorInfo(e)},e.prototype.handleLiveNotice=function(e){console.log("Live Notice",e),this.event.emit("liveNotice",e)},e}();t.App=w,t.default=w},"./app/title-manager.ts":
/*!******************************!*\
  !*** ./app/title-manager.ts ***!
  \******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TitleChangeEvent=void 0;var n=r(o(/*! ../event/event */"./event/event.ts")),i=o(/*! ../network/services/api */"./network/services/api.ts");t.TitleChangeEvent="titleChange";var a=function(){function e(e){var o=this;this.app=e,this._event=new n.default,this.app.event.on("ready",(function(){o._title=o.app.docStore.title,o.event.emit(t.TitleChangeEvent)}))}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),e.prototype.updateTitle=function(e,o){var r=this;i.updateTitle(e,this.app.docStore.domainId,this.app.docStore.padId).then((function(n){12e3!==parseInt(n.data.retcode,10)&&12e3!==parseInt(n.data.cgicode,10)?(r._title=e,r.app.docStore.title=e,o&&o(null,n),r.event.emit(t.TitleChangeEvent)):o&&o(null,n)})).catch((function(e){o&&o(e,null),console.log("updateTitle error: "+JSON.stringify(e))})),this.app.setDocVisible()},e.prototype.handleTitleMessage=function(e){this._title=e,this.app.docStore.title=e,this.event.emit(t.TitleChangeEvent)},e}();t.default=a},"./app/user-change.ts":
/*!****************************!*\
  !*** ./app/user-change.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpstreamUserChange=void 0;var n=function(){function e(e,t){this.commitId=0,this.changesets=[],this.length=0,this.lastSendTime=0,this.completions=[],this.baseRevision=e.baseRevision,this.changesets.push(e.changeset),this.subId=e.subId,this.uuId=e.uuId,this.completions.push(t),this.length+=this.sizeOfChangeset(e.changeset)}return e.prototype.appendChangeset=function(t,o,r){if(r&&this.changesets.length){var n=this.changesets.pop(),i=r(t,n),a=this.sizeOfChangeset(i);if(a<=e.MAXIMUM_PACKET_LENGTH){var l=this.sizeOfChangeset(n);return this.changesets.push(i),this.length+=-l+a,this.completions.push(o),!0}return this.changesets.push(n),!1}var s=this.sizeOfChangeset(t);return this.length+s<=e.MAXIMUM_PACKET_LENGTH&&(this.changesets.push(t),this.length+=s,this.completions.push(o),!0)},Object.defineProperty(e.prototype,"changeset",{get:function(){return this.changesets.reduce((function(e,t){return e.concat(t)}),[])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){var e={type:"USER_CHANGES",baseRev:this.baseRevision,changeset:this.changeset?JSON.stringify(this.changeset)+"\n":"[]\n",keydata:!1,head:!1,subId:this.subId,oSubId:this.subId,uuId:this.uuId,pver:1};return JSON.stringify(e)},enumerable:!1,configurable:!0}),e.prototype.finish=function(e,t){this.completions.forEach((function(o,n){var i=r({},t);i.index=n,o(e,i)}))},e.prototype.sizeOfChangeset=function(e){return 2*JSON.stringify(e).length},e.MAXIMUM_PACKET_LENGTH=5e5,e}();t.UpstreamUserChange=n},"./app/user-manager.ts":
/*!*****************************!*\
  !*** ./app/user-manager.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserChangeEvent=void 0;var n=o(/*! ../network/services/api */"./network/services/api.ts"),i=r(o(/*! ../event/event */"./event/event.ts")),a=function(){function e(e){this._requestBuffering=!1,this.app=e,this._event=new i.default,this.userList=[],this._requestUserAvatarMarkQueue=new Array}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.userEnter=function(e){var t=!1;e.userId.startsWith("g.")||(this.userList.forEach((function(o,r,n){o.userId===e.userId&&(t=!0)})),t||this.userList.unshift(e),this.checkAndNotifyListeners(e))},e.prototype.userLeave=function(e){var t=-1;this.userList.forEach((function(o,r,n){o.userId===e.userId&&(t=r)})),t>=0&&this.userList.splice(t,1),this.notifyListeners()},e.prototype.checkAndNotifyListeners=function(e){var t=this,o=e;this.userList.forEach((function(e,t,r){e.userId===o.userId&&(o=e)}));var r=!1;this._requestUserAvatarMarkQueue.forEach((function(e){e.userId===o.userId&&(r=!0)})),o.name&&o.userPic||r||this._requestUserAvatarMarkQueue.push(o);var i=function(e){if(null==e||0==e);else{var o=e.rsp;if(o){var r=!1;o.forEach((function(e){t.userList.forEach((function(t,o,n){t.userId.split(".")[1]!==e.uid||t.name&&t.userPic||(t.name=e.markName?e.markName:"",t.userPic=e.userPic?e.userPic:"",r=!0)}))})),r&&t.notifyListeners()}}};this._requestBuffering||(this._requestUserAvatarMarkQueue.length>0?(this._requestBuffering=!0,setTimeout((function(){var e=new Array;t._requestUserAvatarMarkQueue.forEach((function(t){e.push(t.userId.split(".")[1])})),t._requestUserAvatarMarkQueue.splice(0,t._requestUserAvatarMarkQueue.length-1),n.getAvatarRemark(e,i,t.app.docStore.domainId,t.app.docStore.padId),t._requestBuffering=!1}),300)):this.notifyListeners())},e.prototype.notifyListeners=function(){this._event.emit(t.UserChangeEvent)},e.prototype.userInfoFromCache=function(e){var t;if(e&&0!==e.length)return this.userList.forEach((function(o,r,n){if(o.userId.split(".")[1]===e&&o.name&&o.userPic){var i={markName:o.name,uid:o.userId.split(".")[1],userPic:o.userPic};t=i}})),t},e.prototype.userInfosFromUidsWithOthers=function(e,t,o,r){var i=this;if(e&&0!==e.length){var a=new Array,l=new Array;e.forEach((function(e){var t=!1;i.userList.forEach((function(o,r,n){if(o.userId.split(".")[1]===e&&o.name&&o.userPic){var i={markName:o.name,uid:o.userId.split(".")[1],userPic:o.userPic};a.push(i),t=!0}})),t||l.push(e)})),l.length>0?n.getAvatarRemark(l,(function(e){if(e&&!1!==e){var t=e.rsp;t&&t.length>0?(t.forEach((function(e){var t=!1;if(i.userList.forEach((function(o,r,n){o.userId.split(".")[1]===e.uid&&(t=!0,o.name&&o.userPic||(o.name=e.markName?e.markName:"",o.userPic=e.userPic?e.userPic:""))})),!t){var o={name:e.markName?e.markName:"",userId:"p."+e.uid,userPic:e.userPic?e.userPic:""};i.userList.unshift(o)}var r={markName:e.markName?e.markName:"",uid:e.uid,userPic:e.userPic?e.userPic:""};a.push(r),l=[]})),r&&r(a,null,new Error("cgi error"))):r&&r(a,l,new Error("cgi error"))}else r&&r(a,l,new Error("cgi error"))}),t,o):r(a,null,null)}else r&&r(null,null,new Error("uids is empty"))},e.prototype.userInfosFromUids=function(e,t){this.userInfosFromUidsWithOthers(e,this.app.docStore.domainId,this.app.docStore.padId,t)},e}();t.default=a,t.UserChangeEvent="userChange"},"./common/changeset-utils.ts":
/*!***********************************!*\
  !*** ./common/changeset-utils.ts ***!
  \***********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.findDiff=t.getChangesetByRemoveProps=t.getChangesetByUpdateProps=t.filterTestOperationFromPatch=t.parseIDOfComponentsByPatch=t.replacePathWithID=t.mergeConflictWithPatchByRuleOfIndexChangeOnPath=t.mergeConflictWithPatchByRuleOfIndexChangeOnTarget=t.mergeconflictWithChangeSet=t.belongToSameSlide=t.hasConflictWithPatchByRuleOfSameTarget=t.convertPathToPidInComponent=t.addPidForPatch=t.addTidForPatch=t.findChangedComponentByChangeset=t.findChangedSlideInfoByPatch=t._getSlideInfoFromPatch=t._getSlideTypeAndArrayByPath=t.isValidedOperation=t.isValidedPatch=t.isValidedChangeset=t.getTargetComponentByPatch=t.removeOperationByIndex=t._inverseOperation=t.inversePatch=t.inverseChangeset=t.makePatch=t.makeOperation=void 0;var n=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts"),i=o(/*! ../component */"./component/index.ts"),a=o(/*! ./utils */"./common/utils.ts"),l=o(/*! .. */"./index.ts"),s=r(o(/*! ./log-utils */"./common/log-utils.ts")),c=o(/*! ../component/timenode */"./component/timenode.ts"),d=r(o(/*! ../report/reporter */"./report/reporter.ts")),u=r(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),p=r(o(/*! lodash/hasIn */"../node_modules/lodash/hasIn.js")),h=r(o(/*! lodash/isObject */"../node_modules/lodash/isObject.js")),f=r(o(/*! lodash/forOwn */"../node_modules/lodash/forOwn.js")),m=r(o(/*! lodash/forEach */"../node_modules/lodash/forEach.js")),y=r(o(/*! lodash/get */"../node_modules/lodash/get.js"));function g(e){return e}function v(e,t){if(S(e)){var o=a.cloneDeep(t),r=e.map((function(e){return _(e,o)}));return(r=r.reverse()).length>0&&(e.object&&(r.object=e.object),null!=e[0].tid&&(r[0].tid=e[0].tid),null!=e[0].target&&(r[0].target=e[0].target)),r}}function _(e,t){var o;if("add"===e.op)o={op:"remove",path:e.path};else if("remove"===e.op){var r=a.getValueByPointer(t,e.path);o={op:"add",path:e.path,value:a.cloneDeep(r)}}else if("replace"===e.op)r=a.getValueByPointer(t,e.path),o={op:"replace",path:e.path,value:a.cloneDeep(r)};else{if("move"!==e.op)throw new Error("非法operation");o={op:"move",from:e.path,path:e.from,fid:e.fid}}t.applyPatch([e]);var n=I(o.path,o.value,t);return null!=n&&(o.pid=n),o}function b(e,t){var o=e;if(!(t>=o.length)){var r=o.splice(t,1);return 0===t&&o.length>0&&(o[0].tid=r[0].tid,o[0].target=r[0].target),o}}function T(e,t){if(e&&0!==e.length){var o=e[0].target,r=t||l.Store.presentation;return null!=o?a.getValueByPointer(r,o):void 0}}function S(e){return 0!==e.length&&void 0!==e[0].tid&&void 0!==e[0].target&&e.every((function(e){return C(e)}))}function C(e){var t=e.op,o=e.value,r=e.path,n=e.from;return!!("add"===t&&r&&void 0!==o||"remove"===t&&r||"replace"===t&&r&&void 0!==o||"move"===t&&r&&n)}function w(e,t){var o,r;return e.indexOf("slideList")>=0?(o="slide",r=t.slideList):e.indexOf("layoutList")>=0?(o="layout",r=t.layoutList):e.indexOf("masterList")>=0&&(o="master",r=t.masterList),{type:o,slideArray:r}}function E(e,t,o){var r,n,i=void 0;return""===t?(r=e.map((function(e){var t=void 0;switch(e.op){case"move":t=e.fid.split("|")[0],i=e.from;break;case"replace":break;case"add":e.pid&&e.value&&e.value.id&&(t=e.value.id,i=e.path);break;case"remove":e.pid&&(t=e.pid.split("|")[0],i=e.path)}return t})),n=!1):(i=t,r=[o.split("|")[0]],n=!0),{slidePath:i,slideIDs:r,changeInSlide:n}}function I(e,t,o){if(null!=e&&null!=o){var r=o,n="";return e.split("/").forEach((function(e){if(""!==e){var o=r;(r=a.getValueByPointer(r,"/"+e))instanceof i.BaseComponent&&r.id?n=n?n+"|"+r.id:r.id:Array.isArray(o)&&o.length===parseInt(e,10)&&null!=t&&t.hasOwnProperty("id")&&(n?n+="|end":n="end")}})),""!==n?n:void 0}}function x(e,t){var o=e[0],r=o.tid,n=o.target,i=n,a=/\/(\d+)/gi,l=!0;if(null!=n){if(r&&r.length>0&&n&&n.length>0){var c,d=t.convertUniqueIDToIndexStr(r);if(d){var u=n;l=d.split("|").every((function(e){if(null!==(c=a.exec(u))){var t=u.substring(0,c.index+1),n=new RegExp("("+t+")(\\d+)","i");return u=u.replace(n,"$1"+e),o.target=u,!0}return s.default.error("[CS]:索引冲突，tid和target不匹配, tid:"+r+", target:"+u),!1}))}else s.default.info("[CS]:索引冲突，对象已删除, tid:"+r+", target:"+n),l=!1;l&&o.target!==i&&s.default.info("[CS]:索引冲突 merge target 成功，"+i+"->"+o.target)}}else l=!1;return l}function R(e,t){for(var o=function(e,t){return e&&t},r=function(e){return"remove"===e||"replace"===e},i=function(e){return"add"===e||"move"===e},a=0;a<e.length;a++){var l=e[a],c=l.pid,u=l.path,p=u;if(o(c,u)){var h=void 0;try{h=O(c,u,t)}catch(t){b(e,a--),s.default.error("[CS]:索引冲突，pid和path不匹配, pid:"+c+", path:"+u);continue}if(void 0!==h)l.path=h,h!==p&&s.default.info("[CS]:索引冲突 merge path 成功，"+p+"->"+l.path);else{if(r(l.op)){b(e,a--),s.default.info("[CS]:索引冲突，对象已删除, pid:"+c+", path:"+l.path);continue}if(i(l.op)){var f=/\/(\d+)$/i,m=f.exec(u);m&&(h=u.replace(f,"/"+Math.min(parseInt(m[1],10),t.children.length)),l.path=h),s.default.info("[CS]:索引冲突，插入位置变更, pid:"+c+", "+p+"->"+l.path)}}}var y=l.fid,g=l.from;if(o(y,g)){p=g,h=void 0;try{h=O(y,g,t)}catch(t){b(e,a--),s.default.error("[CS]:索引冲突，fid和from不匹配, fid:"+y+", from:"+g);continue}if(void 0===h){b(e,a--),s.default.info("[CS]:索引冲突，对象已删除, fid:"+y+", from:"+l.from);continue}l.from=h,h!==p&&s.default.info("[CS]:索引冲突 merge from 成功，"+p+"->"+l.from)}!t.applyPatch([l])&&d.default.reportChangeSetApplyFailed(n.ChangeSetApplyFailed.ConflictIndex)}}function O(e,t,o){if(o&&void 0!==e){if(""===t||""===e)return"";var r=t,n=o.convertUniqueIDToIndexStr(e);if(n){var i,a=/\/(\d+)/gi;if(!n.split("|").every((function(e){if(null!==(i=a.exec(r))){var t=r.substring(0,i.index+1),o=new RegExp("("+t+")(\\d+)","i");return r=r.replace(o,"$1"+e),!0}return!1})))throw new Error("pid和path不匹配");return r}return""===n?r:void 0}}function P(e,t){void 0===t&&(t=!1);var o=[],r=y.default(e,"[0].tid"),n=function(e,o){return t&&e?e+"|"+o:o};if(null==r)return o;var i=r.split("|");return i&&i.length>1?(o.push(t?r:i[i.length-1]),o):(e.forEach((function(e){if("add"===e.op){var t=y.default(e,"value.id");!t&&e.value&&e.value instanceof c.SeqParTnBase&&(t=e.value.valueId),t&&o.push(n(r,t))}else"move"===e.op?e.fid&&o.push(n(r,e.fid)):e.pid&&o.push(n(r,e.pid))})),o)}window._,t.makeOperation=g,t.makePatch=function(e){return e.map((function(e){return e}))},t.inverseChangeset=function(e,t){var o=a.cloneDeep(t);return e.map((function(e){return function(e){var t=T(e,o);if(t&&t instanceof i.BaseComponent){var r=v(e,t);return t.applyPatch(e)||s.default.error("[CS]:inverse cs, 应用patch异常",e),r}s.default.error("[CS]:inverse cs, 应用patch异常",e)}(e)})).filter((function(e){return void 0!==e&&e.length>0})).reverse()},t.inversePatch=v,t._inverseOperation=_,t.removeOperationByIndex=b,t.getTargetComponentByPatch=T,t.isValidedChangeset=function(e){var t=e.every((function(e){return S(e)}));if((a.isDevelopment()||a.isLocalDebug())&&!t)throw new Error("changeset 无效，请记录操作步骤并呼叫rongod,\\n");return t},t.isValidedPatch=S,t.isValidedOperation=C,t._getSlideTypeAndArrayByPath=w,t._getSlideInfoFromPatch=E,t.findChangedSlideInfoByPatch=function(e,t){if(e&&0!==e.length){var o,r=e[0].tid,n=e[0].target,i=t||l.Store.presentation;if(null!=n&&null!=r){var a=E(e,n,r),s=a.slidePath,c=a.slideIDs,d=a.changeInSlide;if(s){var u=w(s,i),p=u.type,h=u.slideArray;if(p&&h&&0!==(o=c.map((function(e){return h.findIndex((function(t){return y.default(t,"id")===e}))})).filter((function(e){return-1!==e}))).length)return{changeInSlide:d,indexs:o,type:p}}}}},t.findChangedComponentByChangeset=function(e){var t=new Set;return e?(e.forEach((function(e){P(e,!0).forEach((function(e){t.add(e)}))})),t):t},t.addTidForPatch=function(e,t){if(null==t)return s.default.error("addTidForPatch component 异常",t),!1;if(e&&0===e.length)return s.default.error("addTidForPatch patch 异常 ",e),!1;var o=t.uniqueID||"";return e[0].tid=o,!0},t.addPidForPatch=function(e,t){var o=a.cloneDeep(t);e.forEach((function(e){var t=I(e.path,e.value,o);t&&(e.pid=t),o.applyPatch([e])}))},t.convertPathToPidInComponent=I,t.hasConflictWithPatchByRuleOfSameTarget=function(e,t){var o=e[0],r=t[0];if(o.tid&&o.tid.split("|").length>1&&o.tid===r.tid){var n=e.some((function(e){return-1!==e.path.indexOf("paragraphList")})),i=t.some((function(e){return-1!==e.path.indexOf("paragraphList")}));if(n&&i)return s.default.info("[CS]:存在操作相同节点的冲突 "+o.target,e,t),!0;var a=e.some((function(e){return-1!==e.path.indexOf("/graphicData/tbl/tblRowList")})),l=t.some((function(e){return-1!==e.path.indexOf("/graphicData/tbl/tblRowList")}));if(a&&l)return s.default.info("[CS]:存在操作相同节点的冲突 "+o.target,e,t),!0}return!1},t.belongToSameSlide=function(e,t){var o=e[0],r=t[0];if(o.tid&&r.tid){var n=o.tid.split("|"),i=r.tid.split("|");if(n.length>1&&i.length>1&&n[0]===i[0])return s.default.debug("[CS]:p1和p2的target属于同一页 "+o.target,e,t),!0}return!1},t.mergeconflictWithChangeSet=function(e,t){for(var o=0;o<e.length;o++){var r=e[o];x(r,t)?(R(r,T(r,t)),0!==r.length||e.splice(o--,1)):e.splice(o--,1)}},t.mergeConflictWithPatchByRuleOfIndexChangeOnTarget=x,t.mergeConflictWithPatchByRuleOfIndexChangeOnPath=R,t.replacePathWithID=O,t.parseIDOfComponentsByPatch=P,t.filterTestOperationFromPatch=function(e){return e?e.filter((function(e){return"test"!==e.op})):[]};var D=function(e){return"object"==typeof e&&null!==e},N=function(e){return D(e)&&Object.keys(e).length>0};t.getChangesetByUpdateProps=function(e,t,o,r){void 0===r&&(r="");var n=[];return void 0===e?s.default.error("参数错误"):D(e)&&D(t)?n=n.concat(function e(t,o,r,n){void 0===n&&(n="");var i=[];return"object"==typeof t&&m.default(t,(function(l,s){var c=n+"/"+s,d=r&&r(o[s],l,s,o,t,null,(function(e){i.push({op:"remove",path:n+"/"+e})}));if(void 0!==d)i.push({op:p.default(o,s)?"replace":"add",path:c,value:a.cloneDeep(d)});else if(void 0===l);else if(p.default(o,s)){var u=o[s];D(l)&&D(u)?i=i.concat(e(l,u,r,c)):l!==u&&i.push({op:"replace",path:c,value:a.cloneDeep(l)})}else i.push({op:"add",path:c,value:a.cloneDeep(l)})})),i}(e,t,o,r)):r.length>0?n.push({op:void 0===t?"add":"replace",path:r,value:a.cloneDeep(e)}):s.default.error("参数错误"),n},t.getChangesetByRemoveProps=function(e,t,o){void 0===o&&(o="");var r=[];return void 0===e?s.default.error("参数错误"):N(e)&&"object"==typeof t&&null!==t?r=r.concat(function e(t,o,r){void 0===r&&(r="");var n=[];return"object"==typeof t&&m.default(t,(function(t,i){var a=r+"/"+i;if(p.default(o,i)){var l=o[i];N(t)&&N(l)?n=n.concat(e(t,l,a)):void 0!==t&&n.push({op:"remove",path:a})}})),n}(e,t,o)):o.length>0&&void 0!==t?r.push({op:"remove",path:o}):s.default.error("参数错误"),r.reverse()},t.findDiff=function e(t,o,r){var n;if(void 0===r&&(r=""),Array.isArray(t)&&Array.isArray(o)){if(t.length!==o.length)return{equal:!1,obj1:t,obj2:o,path:r};n={equal:!0,obj1:t,obj2:o,path:r},t.some((function(t,i){var a=r+"/"+i;return!(n=e(t,o[i],a)).equal}))}else h.default(t)&&h.default(o)?(n={equal:!0,obj1:t,obj2:o,path:r},f.default(t,(function(i,a){var l=r+"/"+a;return(n=p.default(o,a)?e(i,o[a],l):{equal:!1,obj1:t,obj2:o,path:l}).equal}))):n="function"==typeof t?{equal:!0,obj1:t,obj2:o,path:r}:{equal:!!u.default(t,o),obj1:t,obj2:o,path:r};return n}},"./common/common-constants.ts":
/*!************************************!*\
  !*** ./common/common-constants.ts ***!
  \************************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonConstants=void 0,t.CommonConstants={USER_AGENT:window&&window.navigator&&window.navigator.userAgent}},"./common/defaultTblStyle.json":
/*!*************************************!*\
  !*** ./common/defaultTblStyle.json ***!
  \*************************************/
/*! exports provided: tblStyleList, default */function(e){e.exports=JSON.parse('{"tblStyleList":{"def":"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}","tableStyleEntryList":[{"styleId":"{58542034-FE4F-4ADA-92B8-4CA66D0F0DF3}","styleName":"腾讯文档-基本","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"000000","colorType":"rgb"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"999999","colorType":"rgb"}}}}},"fill":{"solidFill":{"color":{"colorValue":"FFFFFF","colorType":"rgb"}}}}}},{"styleId":"{2D5ABB26-0587-4C30-8999-92F81FD0307C}","styleName":"无样式，无网格","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"noFill":1}}}},{"styleId":"{5940675A-B579-460E-94D1-54222C63F5DA}","styleName":"无样式，网格型","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{3C2FFA5D-87B4-456A-9821-1D502468CF0F}","styleName":"主题样式 1 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},{"styleId":"{284E427A-3D55-4303-BF80-6455036E1DE7}","styleName":"主题样式 1 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent2","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},{"styleId":"{69C7853C-536D-4A76-A0AE-DD22124D55A5}","styleName":"主题样式 1 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent3","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},{"styleId":"{775DCB02-9BB8-47FD-8907-85C794F793BA}","styleName":"主题样式 1 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent4","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},{"styleId":"{35758FB7-9AC5-4552-8A53-C91805E547FA}","styleName":"主题样式 1 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent5","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},{"styleId":"{08FB837D-C827-4EFA-A057-4D05807E0F7C}","styleName":"主题样式 1 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideV":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":40000}}}}},"band1V":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":2,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideH":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":2,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":2,"color":{"colorValue":"accent6","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},{"styleId":"{D113A9D2-9D6B-4929-AA2D-F23B5EE8CBE7}","styleName":"主题样式 2 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{18603FDC-E32A-4AB5-989C-0864C3EAD2B8}","styleName":"主题样式 2 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{306799F8-075E-4A3A-A7F6-7FBC6576F1A4}","styleName":"主题样式 2 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{E269D01E-BC32-4049-B463-5C60D7B0CCD2}","styleName":"主题样式 2 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{327F97BB-C833-4FB7-BDE5-3F7075034690}","styleName":"主题样式 2 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{638B1855-1B75-4FBE-930C-398BA8C253C6}","styleName":"主题样式 2 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme","tint":50000}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme","tint":50000}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme","tint":50000}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme","tint":50000}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"lnRef":{"idx":2,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":3,"color":{"colorValue":"lt1","colorType":"scheme"}}}},"fill":{"noFill":1}}}},{"styleId":"{9D7B26C5-4107-4FEC-AEDC-1716B250A1EF}","styleName":"浅色样式 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{3B4B98B0-60AC-42C2-AFA5-B58CD77FA1E5}","styleName":"浅色样式 1 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{0E3FDE45-AF77-4B5C-9715-49D594BDF05E}","styleName":"浅色样式 1 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{C083E6E3-FA7D-4D7B-A595-EF9225AFEA82}","styleName":"浅色样式 1 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{D27102A9-8310-4765-A935-A1911B00CA55}","styleName":"浅色样式 1 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{5FD0F851-EC5A-4D38-B0AD-8093EC10F338}","styleName":"浅色样式 1 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{68D230F3-CF80-4859-8CE7-A43EE81993B5}","styleName":"浅色样式 1 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{7E9639D4-E3E2-4D34-9284-5A2195B3D0D7}","styleName":"浅色样式 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"tx1","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{69012ECD-51FC-41F1-AA8D-1B2483CD663E}","styleName":"浅色样式 2 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{72833802-FEF1-4C79-8D5D-14CF1EAF98D9}","styleName":"浅色样式 2 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{F2DE63D5-997A-4646-A377-4702673A728D}","styleName":"浅色样式 2 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{17292A2E-F333-43FB-9621-5CBBE7FDCDCB}","styleName":"浅色样式 2 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{5A111915-BE36-4E01-A7E5-04B1672EAD32}","styleName":"浅色样式 2 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{912C8C85-51F0-491E-9774-3900AFEF0FD7}","styleName":"浅色样式 2 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"tcBdr":{"bottom":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"top":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},"band1V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},"band2V":{"tcStyle":{"tcBdr":{"left":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}},"right":{"lnRef":{"idx":1,"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"bg1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}}}},{"styleId":"{616DA210-FB5B-4158-B5E0-FEB733F419BA}","styleName":"浅色样式 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{BC89EF96-8CEA-46FF-86C4-4CE0E7609802}","styleName":"浅色样式 3 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{5DA37D80-6434-44D0-A028-1B22A696006F}","styleName":"浅色样式 3 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{8799B23B-EC83-4686-B30A-512413B5E67A}","styleName":"浅色样式 3 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{ED083AE6-46FA-4A59-8FB0-9F97EB10719F}","styleName":"浅色样式 3 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{BDBED569-4797-4DF1-A0F4-6AAB3CD982D8}","styleName":"浅色样式 3 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{E8B1032C-EA38-4F05-BA0D-38AFFFC7BED3}","styleName":"浅色样式 3 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"tx1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","alpha":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"noFill":1}}}},{"styleId":"{793D81CF-94F2-401A-BA57-92F5A7B2D0C5}","styleName":"中度样式 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{B301B821-A1FF-4177-AEE7-76D212191A09}","styleName":"中度样式 1 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},{"styleId":"{9DCAF9ED-07DC-4A11-8D7F-57B35C25682E}","styleName":"中度样式 1 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},{"styleId":"{1FECB4D8-DB02-4DC6-A0A2-4F2EBAE1DC90}","styleName":"中度样式 1 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},{"styleId":"{1E171933-4619-4E11-9A3F-F7608DF75F80}","styleName":"中度样式 1 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},{"styleId":"{FABFCF23-3B69-468F-B69F-88F6DE6A72F2}","styleName":"中度样式 1 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},{"styleId":"{10A1B5D5-9B99-4C35-A422-299274C87663}","styleName":"中度样式 1 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},{"styleId":"{073A0DAA-6AF3-43AB-8588-CEC1D06C72B9}","styleName":"中度样式 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}","styleName":"中度样式 2 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},{"styleId":"{21E4AEA4-8DFA-4A89-87EB-49C32662AFE0}","styleName":"中度样式 2 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},{"styleId":"{F5AB1C69-6EDB-4FF4-983F-18BD219EF322}","styleName":"中度样式 2 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},{"styleId":"{00A15C55-8517-42AA-B614-E9B94910E393}","styleName":"中度样式 2 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},{"styleId":"{7DF18680-E054-41AD-8BC1-D1AEF772440D}","styleName":"中度样式 2 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},{"styleId":"{93296810-A885-4BE3-A3E7-6D5BEEA58F35}","styleName":"中度样式 2 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":38100,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},{"styleId":"{8EC20E35-A176-4012-BC5E-935CFFF8708E}","styleName":"中度样式 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor"}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{6E25E649-3F16-4E02-A733-19D2CDBF48F0}","styleName":"中度样式 3 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}}},{"styleId":"{85BE263C-DBD7-4A20-BB59-AAB30ACAA65A}","styleName":"中度样式 3 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},{"styleId":"{EB344D84-9AFB-497E-A393-DC336BA19D2E}","styleName":"中度样式 3 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}}},{"styleId":"{EB9631B5-78F2-41C9-869B-9F39066F8104}","styleName":"中度样式 3 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},{"styleId":"{74C1A8A3-306A-4EB7-A6B1-4F7E0EB9C5D6}","styleName":"中度样式 3 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}}},{"styleId":"{2A488322-F2BA-4B5B-9748-0D474271808F}","styleName":"中度样式 3 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"lastCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"firstCol":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}},{"styleId":"{D7AC3CCA-C797-4891-BE02-D94E43425B78}","styleName":"中度样式 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}}},{"styleId":"{69CF1AB2-1976-4502-BF36-3FF5EA218861}","styleName":"中度样式 4 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}}},{"styleId":"{8A107856-5554-42FB-B03E-39F5DBC370BA}","styleName":"中度样式 4 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","tint":20000}}}}}},{"styleId":"{0505E3EF-67EA-436B-97B2-0124C06EBD24}","styleName":"中度样式 4 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}}},{"styleId":"{C4B1156A-380E-4F78-BDF5-A606A8083BF9}","styleName":"中度样式 4 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","tint":20000}}}}}},{"styleId":"{22838BEF-8BB2-4498-84A7-C5851F593DF1}","styleName":"中度样式 4 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}}},{"styleId":"{16D9F66E-5EB9-4882-86FB-DCBF35E3C3E4}","styleName":"中度样式 4 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideH":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"insideV":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"left":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"right":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}},"top":{"ln":{"cmpd":"sng","width":12700,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","tint":20000}}}}}},{"styleId":"{E8034E78-7F5D-4C2E-B375-FC64B27BC917}","styleName":"深色样式 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":60000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{125E5076-3810-47DD-B79F-674D7AD40C01}","styleName":"深色样式 1 - 强调 1","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{37CE84F3-28C3-443E-9E96-99CF82512B78}","styleName":"深色样式 1 - 强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{D03447BB-5D67-496B-8E87-E561075AD55C}","styleName":"深色样式 1 - 强调 3","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{E929F9F4-4A8F-4326-A1B4-22849713DDAB}","styleName":"深色样式 1 - 强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{8FD4443E-F989-4FC4-A0C8-D5A2AF1F390B}","styleName":"深色样式 1 - 强调 5","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{AF606853-7671-496A-8E4F-DF71F8EC918B}","styleName":"深色样式 1 - 强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","shade":60000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","shade":60000}}}}},"lastCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"left":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","shade":60000}}}}},"firstCol":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"right":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","shade":60000}}}}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme","shade":40000}}}}},"firstRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"bottom":{"ln":{"cmpd":"sng","width":25400,"solidFill":{"color":{"colorValue":"lt1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{5202B0CA-FC54-4496-8BCA-5EF66A818D29}","styleName":"深色样式 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}}},{"styleId":"{0660B408-B3CF-4A94-85FC-2B1E0A45F4A2}","styleName":"深色样式 2 - 强调 1/强调 2","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent1","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent2","colorType":"scheme"}}}}}},{"styleId":"{91EBBBCC-DAD2-459C-BE2E-F6DE35CF9A28}","styleName":"深色样式 2 - 强调 3/强调 4","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent3","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent4","colorType":"scheme"}}}}}},{"styleId":"{46F890A9-2807-4EBB-B81D-B2AA78EC7F39}","styleName":"深色样式 2 - 强调 5/强调 6","wholeTbl":{"tcTxStyle":{"color":{"colorValue":"dk1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"tcBdr":{"bottom":{"ln":{"noFill":1}},"insideH":{"ln":{"noFill":1}},"insideV":{"ln":{"noFill":1}},"left":{"ln":{"noFill":1}},"right":{"ln":{"noFill":1}},"top":{"ln":{"noFill":1}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"band1H":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"band1V":{"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":40000}}}}},"lastCol":{"tcTxStyle":{"b":"on"}},"firstCol":{"tcTxStyle":{"b":"on"}},"lastRow":{"tcTxStyle":{"b":"on"},"tcStyle":{"tcBdr":{"top":{"ln":{"cmpd":"dbl","width":50800,"solidFill":{"color":{"colorValue":"dk1","colorType":"scheme"}}}}},"fill":{"solidFill":{"color":{"colorValue":"accent5","colorType":"scheme","tint":20000}}}}},"firstRow":{"tcTxStyle":{"b":"on","color":{"colorValue":"lt1","colorType":"scheme"},"fontRef":{"idx":"minor","color":{"colorValue":"000000","colorType":"rgb"}}},"tcStyle":{"fill":{"solidFill":{"color":{"colorValue":"accent6","colorType":"scheme"}}}}}}]}}')},"./common/log-utils.ts":
/*!*****************************!*\
  !*** ./common/log-utils.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var n=new(function(){function e(){this.showlog=!1}return e.prototype.debug=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];window.log&&window.log.debug&&(t=window.log).debug.apply(t,r([e],o)),this.showlog&&console.debug.apply(console,r([e],o))},e.prototype.error=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];window.log&&window.log.error&&(t=window.log).error.apply(t,r([e],o)),this.showlog&&console.error.apply(console,r([e],o))},e.prototype.info=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];window.log&&window.log.info&&(t=window.log).info.apply(t,r([e],o)),this.showlog&&console.info.apply(console,r([e],o))},e.prototype.log=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];window.log&&window.log.log&&(t=window.log).log.apply(t,r([e],o)),this.showlog&&console.log.apply(console,r([e],o))},e.prototype.warn=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];window.log&&window.log.warn&&(t=window.log).warn.apply(t,r([e],o)),this.showlog&&console.warn.apply(console,r([e],o))},e}());t.default=n},"./common/rules-merge.ts":
/*!*******************************!*\
  !*** ./common/rules-merge.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MergeRule=void 0;var i=o(/*! ./utils */"./common/utils.ts"),a=n(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),l=n(o(/*! lodash/merge */"../node_modules/lodash/merge.js")),s=n(o(/*! lodash/omit */"../node_modules/lodash/omit.js")),c=n(o(/*! lodash/has */"../node_modules/lodash/has.js")),d=(window._,new Set(["background","solidFill","image","gradFill","noFill","grpFill"])),u=new Set(["solidFill","image","gradFill","noFill","grpFill"]),p=new Set(["paragraphList","spcBef"]),h=new Set(["placeholder"]),f=new Set(["adjList"]),m=function(){function e(e){this.rule=e}return Object.defineProperty(e.prototype,"action",{get:function(){return function(e,t,o,r,n,a,l){return i.cloneDeep(t)}},enumerable:!1,configurable:!0}),e.prototype.filter=function(e){return this.rule.has(e)},e.prototype.merge=function(e,t,o,r,n,i,a){return this.action(e,t,o,r,n,i,a)},e}(),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"action",{get:function(){var e=this;return function(t,o,r,n,l){var s=i.cloneDeep(o);return e.rule.forEach((function(e){n&&a.default(n,e)})),s}},enumerable:!1,configurable:!0}),t}(m),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"action",{get:function(){var e=this;return function(t,o,r,n,s,d,u){var p;return p=null==t?i.cloneDeep(o):null===o?null:"object"==typeof t?l.default(t,o):o,e.rule.forEach((function(e){c.default(n,e)&&e!=r&&(a.default(n,e),"function"==typeof u&&u(e))})),p}},enumerable:!1,configurable:!0}),t}(m),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return function(e,t,o,r,n){var a;return null==e?a=i.cloneDeep(t):(a=i.cloneDeep(e),a=l.default(s.default(a,["type","index"]),t)),a}},enumerable:!1,configurable:!0}),t}(m);t.MergeRule={FillGet:new y(d),FillSet:new g(u),Text:new m(p),Placeholder:new v(h),AdjustPoint:new m(f),rules:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,o,r,n,i,a,l){var s=e.find((function(e){return e.filter(r)}));return s&&s.merge(t,o,r,n,i,a,l)}}}},"./common/tableUtils.ts":
/*!******************************!*\
  !*** ./common/tableUtils.ts ***!
  \******************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableStyleMergeHelper=t.CellProperty=t.BorderType=void 0;var r=o(/*! ./defaultTblStyle.json */"./common/defaultTblStyle.json");t.BorderType={Left:1,Right:2,Top:4,Bottom:8,InsideH:16,InsideV:32};var n=function(){},i=function(){function e(e,t,o,r){this._colIndex=e,this._rowIndex=t,this._colCount=o,this._rowCount=r}return e.prototype.isTopCell=function(){return 0==this._rowIndex},e.prototype.isLeftCell=function(){return 0==this._colIndex},e.prototype.isRightCell=function(){return this._colIndex==this._colCount-1},e.prototype.isBottomCell=function(){return this._rowIndex==this._rowCount-1},e.prototype.isOddRow=function(e,t){return!(e&&this.isTopCell()||t&&this.isBottomCell()||(this._rowIndex+1-(e?1:0))%2!=1)},e.prototype.isEvenRow=function(e,t){return!(e&&this.isTopCell()||t&&this.isBottomCell()||(this._rowIndex+1-(e?1:0))%2!=0)},e.prototype.isOddCol=function(e,t){return!(e&&this.isLeftCell()||t&&this.isRightCell()||(this._colIndex+1-(e?1:0))%2!=1)},e.prototype.isEvenCol=function(e,t){return!(e&&this.isLeftCell()||t&&this.isRightCell()||(this._colIndex+1-(e?1:0))%2!=0)},e}();t.CellProperty=i;var a=function(){function e(){}return e.applyTableSytleToTableCell=function(e,t){if(t&&t.tableStyleEntryList){var o=e.graphicData.tbl.tblPr;if(o){var n=o.styleId,i=1==o.firstRow,a=1==o.lastRow,l=1==o.firstCol,s=1==o.lastCol,c=1==o.bandRow,d=1==o.bandCol,u=t&&t.tableStyleEntryList.find((function(e){return e.styleId==n}));u||(u=r.tblStyleList.tableStyleEntryList.find((function(e){return e.styleId==n}))),u&&(this.applyTableSytleToTableCell_wholeTbl(e,u),this.applyTableSytleToTableCell_band1H(e,c,u),this.applyTableSytleToTableCell_band2H(e,c,u),this.applyTableSytleToTableCell_band1V(e,d,u),this.applyTableSytleToTableCell_band2V(e,d,u),this.applyTableSytleToTableCell_lastCol(e,s,u),this.applyTableSytleToTableCell_firstCol(e,l,u),this.applyTableSytleToTableCell_lastRow(e,a,u),this.applyTableSytleToTableCell_firstRow(e,i,u),this.applyTableSytleToTableCell_border(e))}}},e.applyTableSytleToTableCell_wholeTbl=function(e,o){var r=this;o.wholeTbl&&this.applyTablePartStyleToTableCell(e,(function(e,n){var i=o&&o.wholeTbl;i&&(r.applyTableCellBorder(e,n,i,t.BorderType.InsideH),r.applyTableCellBorder(e,n,i,t.BorderType.InsideV),n.isTopCell()&&r.applyTableCellBorder(e,n,i,t.BorderType.Top),n.isLeftCell()&&r.applyTableCellBorder(e,n,i,t.BorderType.Left),n.isRightCell()&&r.applyTableCellBorder(e,n,i,t.BorderType.Right),n.isBottomCell()&&r.applyTableCellBorder(e,n,i,t.BorderType.Bottom),r.applyTableCellFill(e,i))}))},e.applyTableSytleToTableCell_band1H=function(e,o,r){var n=this;o&&r.band1H&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.band1H;if(r&&i){var a=o.tPr.firstRow&&!!r.firstRow,l=o.tPr.lastRow&&!!r.lastRow;o.isOddRow(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideV),o.isOddRow(a,l)&&o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left),o.isOddRow(a,l)&&o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Right),o.isOddRow(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.Top|t.BorderType.Bottom),o.isOddRow(a,l)&&n.applyTableCellFill(e,i)}}))},e.applyTableSytleToTableCell_band2H=function(e,o,r){var n=this;o&&r.band2H&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.band2H;if(r&&i){var a=o.tPr.firstRow&&!!r.firstRow,l=o.tPr.lastRow&&!!r.lastRow;o.isEvenRow(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideV),o.isEvenRow(a,l)&&o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left),o.isEvenRow(a,l)&&o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Right),o.isEvenRow(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.Top|t.BorderType.Bottom),o.isEvenRow(a,l)&&n.applyTableCellFill(e,i)}}))},e.applyTableSytleToTableCell_band1V=function(e,o,r){var n=this;o&&r.band1V&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.band1V;if(r&&i){var a=o.tPr.firstCol&&!!r.firstCol,l=o.tPr.lastCol&&!!r.lastCol;o.isOddCol(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideH),o.isOddCol(a,l)&&o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top),o.isOddCol(a,l)&&o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Bottom),o.isOddCol(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.Left|t.BorderType.Right),o.isOddCol(a,l)&&n.applyTableCellFill(e,i)}}))},e.applyTableSytleToTableCell_band2V=function(e,o,r){var n=this;o&&r.band2V&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.band2V;if(r&&i){var a=o.tPr.firstCol&&!!r.firstCol,l=o.tPr.lastCol&&!!r.lastCol;o.isEvenCol(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideV),o.isEvenCol(a,l)&&o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top),o.isEvenCol(a,l)&&o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Bottom),o.isEvenCol(a,l)&&n.applyTableCellBorder(e,o,i,t.BorderType.Left|t.BorderType.Right),o.isEvenCol(a,l)&&n.applyTableCellFill(e,i)}}))},e.applyTableSytleToTableCell_lastCol=function(e,o,r){var n=this;o&&r.lastCol&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.lastCol;r&&i&&o.tPr.lastCol&&r.lastCol&&(o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideH),o.isRightCell()&&o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top),o.isRightCell()&&o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Bottom),o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left|t.BorderType.Right),o.isRightCell()&&n.applyTableCellFill(e,i))}))},e.applyTableSytleToTableCell_firstCol=function(e,o,r){var n=this;o&&r.firstCol&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.firstCol;r&&i&&o.tPr.firstCol&&r.firstCol&&(o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideH),o.isLeftCell()&&o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top),o.isLeftCell()&&o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Bottom),o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left|t.BorderType.Right),o.isLeftCell()&&n.applyTableCellFill(e,i))}))},e.applyTableSytleToTableCell_lastRow=function(e,o,r){var n=this;o&&r.lastRow&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.lastRow;r&&i&&o.tPr.lastRow&&r.lastRow&&(o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideV),o.isBottomCell()&&o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left),o.isBottomCell()&&o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Right),o.isBottomCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top|t.BorderType.Bottom),o.isBottomCell()&&n.applyTableCellFill(e,i))}))},e.applyTableSytleToTableCell_firstRow=function(e,o,r){var n=this;o&&r.firstRow&&this.applyTablePartStyleToTableCell(e,(function(e,o){var i=r&&r.firstRow;r&&i&&o.tPr.firstRow&&r.firstRow&&(o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.InsideV),o.isTopCell()&&o.isLeftCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Left),o.isTopCell()&&o.isRightCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Right),o.isTopCell()&&n.applyTableCellBorder(e,o,i,t.BorderType.Top|t.BorderType.Bottom),o.isTopCell()&&n.applyTableCellFill(e,i))}))},e.applyTableSytleToTableCell_border=function(e){this.applyTablePartStyleToTableCell(e,(function(e,t){var o=e.styleTcPr;if(o){if(!e.tcPr)return e.tcPr=e.styleTcPr,void delete e.styleTcPr;var r=e.tcPr;void 0===r.lnT&&(r.lnT=o.lnT),void 0===r.lnL&&(r.lnL=o.lnL),void 0===r.lnR&&(r.lnR=o.lnR),void 0===r.lnB&&(r.lnB=o.lnB),void 0===r.noFill&&void 0===r.gradFill&&void 0===r.solidFill&&void 0===r.image&&(r.noFill=o.noFill,r.gradFill=o.gradFill,r.solidFill=o.solidFill,r.image=o.image),void 0===r.temp_tx_b&&(r.temp_tx_b=o.temp_tx_b),void 0===r.temp_tx_color&&(r.temp_tx_color=o.temp_tx_color),void 0===r.temp_tx_i&&(r.temp_tx_i=o.temp_tx_i),delete e.styleTcPr}}))},e.applyTablePartStyleToTableCell=function(e,t){var o=e&&e.graphicData&&e.graphicData.tbl;if(o&&o.tblRowList&&o.tblColList){var r=new n,a=o.tblPr;a&&(r.firstRow=1==a.firstRow,r.lastRow=1==a.lastRow,r.firstCol=1==a.firstCol,r.lastCol=1==a.lastCol,r.bandRow=1==a.bandRow,r.bandCol=1==a.bandCol);for(var l=o&&o.tblColList&&o.tblColList.length,s=o&&o.tblRowList&&o.tblRowList.length,c=0;c<s;c++){var d=o.tblRowList[c];if(d&&d.tcList)for(var u=0;u<d.tcList.length;u++){var p=d.tcList[u],h=(p.hMerge,p.vMerge,new i(u,c,l,s));h.hMerge=1==p.hMerge,h.vMerge=1==p.vMerge,h.hMerge||h.vMerge||(h.tPr=r,t(p,h))}}}},e.applyTableCellFill=function(e,t){e.styleTcPr||(e.styleTcPr={});var o=e.styleTcPr;if(t.tcTxStyle&&t.tcTxStyle.color&&(o.temp_tx_color=t.tcTxStyle.color,t.tcTxStyle.b&&(o.temp_tx_b="on"==t.tcTxStyle.b?1:0),t.tcTxStyle.i&&(o.temp_tx_i="on"==t.tcTxStyle.i?1:0)),t.tcStyle&&t.tcStyle.fill){var r=t.tcStyle.fill;(r.solidFill||r.gradFill||r.image||null!=r.noFill)&&(o.solidFill=void 0,o.gradFill=void 0,o.image=void 0,o.noFill=void 0),o.solidFill=r.solidFill,o.gradFill=r.gradFill,o.image=r.image,o.noFill=r.noFill}},e.applyTableCellBorder=function(e,o,r,n){e.styleTcPr||(e.styleTcPr={});var i=e.styleTcPr;r.tcStyle&&r.tcStyle.tcBdr&&(this.applyTableCellBorder_InsideH(e,o,r,n),this.applyTableCellBorder_InsideV(e,o,r,n),n&t.BorderType.Left&&r.tcStyle.tcBdr.left&&(i.lnL=r.tcStyle.tcBdr.left.ln),n&t.BorderType.Right&&r.tcStyle.tcBdr.right&&(i.lnR=r.tcStyle.tcBdr.right.ln),n&t.BorderType.Top&&r.tcStyle.tcBdr.top&&(i.lnT=r.tcStyle.tcBdr.top.ln),n&t.BorderType.Bottom&&r.tcStyle.tcBdr.bottom&&(i.lnB=r.tcStyle.tcBdr.bottom.ln))},e.applyTableCellBorder_InsideH=function(e,o,r,n){if(r.tcStyle&&r.tcStyle.tcBdr&&e.styleTcPr){var i=e.styleTcPr;n&t.BorderType.InsideH&&(!o.isTopCell()&&r.tcStyle.tcBdr.insideH&&(i.lnT=r.tcStyle.tcBdr.insideH.ln),!o.isBottomCell()&&r.tcStyle.tcBdr.insideH&&(i.lnB=r.tcStyle.tcBdr.insideH.ln))}},e.applyTableCellBorder_InsideV=function(e,o,r,n){if(r.tcStyle&&r.tcStyle.tcBdr&&e.styleTcPr){var i=e.styleTcPr;n&t.BorderType.InsideV&&(!o.isLeftCell()&&r.tcStyle.tcBdr.insideV&&(i.lnL=r.tcStyle.tcBdr.insideV.ln),!o.isRightCell()&&r.tcStyle.tcBdr.insideV&&(i.lnR=r.tcStyle.tcBdr.insideV.ln))}},e}();t.TableStyleMergeHelper=a},"./common/timingTemplate.json":
/*!************************************!*\
  !*** ./common/timingTemplate.json ***!
  \************************************/
/*! exports provided: timing, fade_in_tn, fade_out_tn, scale, par_indefinite_tn, par_zero_tn, appear, fly_in, pluse, float_in, float_down_in, rotate, cut_in, tavFlagxDict, tavFlagyDict, default */function(e){e.exports=JSON.parse('{"timing":{"tmRoot":{"dur":"indefinite","restart":"never","nodeType":"tmRoot","childTnLst":[{"cTn":{"dur":"indefinite","nodeType":"mainSeq","childTnLst":[]},"nextCondLst":[{"evt":"onNext","delay":"0","tgtEl":{"sldTgt":1}}],"prevCondLst":[{"evt":"onPrev","delay":"0","tgtEl":{"sldTgt":1}}],"type":"tn_seq"}]}},"fade_in_tn":{"presetID":10,"presetClass":"entr","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"0"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"visible"},"type":"tn_set"},{"transition":"in","filter":"fade","cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"}]},"fade_out_tn":{"presetID":10,"presetClass":"exit","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"transition":"out","filter":"fade","cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"},{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"999"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"hidden"},"type":"tn_set"}]},"scale":{"presetID":6,"presetClass":"emph","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"2000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}}},"by":{"x":150000,"y":150000},"type":"tn_animScale"}]},"par_indefinite_tn":{"cTn":{"fill":"hold","stCondLst":[{"delay":"indefinite"}],"childTnLst":[]},"type":"tn_par"},"par_zero_tn":{"cTn":{"fill":"hold","stCondLst":[{"delay":"0"}],"childTnLst":[]},"type":"tn_par"},"appear":{"presetID":1,"presetClass":"entr","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"0"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"hidden"},"type":"tn_set"}]},"fly_in":{"presetID":2,"presetClass":"entr","presetSubtype":4,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_x"]},"type":"tn_anim"},{"cBhvr":{"cTn":{"dur":"1000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_x"],"additive":"base"},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"#ppt_x"}}},{"tm":"100000","val":{"strValue":{"strValue":"#ppt_x"}}}],"type":"tn_anim"},{"cBhvr":{"cTn":{"dur":"1000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_y"],"additive":"base"},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"1+#ppt_h/2"}}},{"tm":"100000","val":{"strValue":{"strValue":"#ppt_y"}}}],"type":"tn_anim"}]},"pluse":{"presetID":26,"presetClass":"emph","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"transition":"out","filter":"fade","cBhvr":{"cTn":{"id":"6","dur":"2000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"},{"cBhvr":{"cTn":{"id":"7","dur":"2000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}}},"by":{"x":105000,"y":105000},"type":"tn_animScale"}]},"float_in":{"presetID":42,"presetClass":"entr","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"transition":"out","filter":"fade","cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"},{"cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_x"]},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"ppt_x"}}},{"tm":"100000","val":{"strValue":{"strValue":"ppt_x"}}}],"type":"tn_anim"},{"cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_y"]},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"ppt_y"}}},{"tm":"100000","val":{"strValue":{"strValue":"ppt_y+.1"}}}],"type":"tn_anim"},{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"999"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"hidden"},"type":"tn_set"}]},"float_down_in":{"presetID":47,"presetClass":"entr","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"0"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"visible"},"type":"tn_set"},{"transition":"in","filter":"fade","cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"},{"cBhvr":{"cTn":{"dur":"1000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_x"]},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"#ppt_x"}}},{"tm":"100000","val":{"strValue":{"strValue":"#ppt_x"}}}],"type":"tn_anim"},{"cBhvr":{"cTn":{"dur":"1000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_y"]},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"#ppt_y-.1"}}},{"tm":"100000","val":{"strValue":{"strValue":"#ppt_y"}}}],"type":"tn_anim"}]},"rotate":{"presetID":8,"presetClass":"emph","presetSubtype":0,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"2000","fill":"hold"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["r"]},"by":21600000,"type":"tn_animRot"}]},"cut_in":{"presetID":12,"presetClass":"entr","presetSubtype":4,"fill":"hold","nodeType":"clickEffect","stCondLst":[{"delay":"0"}],"childTnLst":[{"cBhvr":{"cTn":{"dur":"1","fill":"hold","stCondLst":[{"delay":"0"}]},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["style.visibility"]},"to":{"toStrVal":"visible"},"type":"tn_set"},{"cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}},"attrNameLst":["ppt_y"],"additive":"base"},"calcmode":"lin","valueType":"num","tavlst":[{"tm":"0","val":{"strValue":{"strValue":"#ppt_y+#ppt_h*1.125000"}}},{"tm":"100000","val":{"strValue":{"strValue":"#ppt_y"}}}],"type":"tn_anim"},{"transition":"in","filter":"wipe(up)","cBhvr":{"cTn":{"dur":"1000"},"tgtEl":{"spTgt":{"spid":"0"}}},"type":"tn_animEffect"}]},"tavFlagxDict":{"entr":{"2":{"1":{"first":"#ppt_x","second":"#ppt_x"},"2":{"first":"1+#ppt_w/2","second":"#ppt_x"},"3":{"first":"1+#ppt_w/2","second":"#ppt_x"},"4":{"first":"#ppt_x","second":"#ppt_x"},"6":{"first":"1+#ppt_w/2","second":"#ppt_x"},"8":{"first":"0-#ppt_w/2","second":"#ppt_x"},"9":{"first":"0-#ppt_w/2","second":"#ppt_x"},"12":{"first":"0-#ppt_w/2","second":"#ppt_x"}},"12":{"1":{"first":"#ppt_y-#ppt_h*1.125000","second":"#ppt_y"},"4":{"first":"#ppt_y+#ppt_h*1.125000","second":"#ppt_y"}}},"exit":{"2":{"1":{"first":"ppt_x","second":"ppt_x"},"2":{"first":"ppt_x","second":"1+ppt_w/2"},"3":{"first":"ppt_x","second":"1+ppt_w/2"},"4":{"first":"ppt_x","second":"ppt_x"},"6":{"first":"ppt_x","second":"1+ppt_w/2"},"8":{"first":"ppt_x","second":"0-ppt_w/2"},"9":{"first":"ppt_x","second":"0-ppt_w/2"},"12":{"first":"ppt_x","second":"0-ppt_w/2"}},"12":{"1":{"first":"#ppt_y","second":"#ppt_y-#ppt_h*1.125000"},"4":{"first":"#ppt_y","second":"#ppt_y+#ppt_h*1.125000"}}}},"tavFlagyDict":{"entr":{"2":{"1":{"first":"0-#ppt_h/2","second":"#ppt_y"},"2":{"first":"#ppt_y","second":"#ppt_y"},"3":{"first":"0-#ppt_h/2","second":"#ppt_y"},"4":{"first":"1+#ppt_h/2","second":"#ppt_y"},"6":{"first":"1+#ppt_h/2","second":"#ppt_y"},"8":{"first":"#ppt_y","second":"#ppt_y"},"9":{"first":"0-#ppt_h/2","second":"#ppt_y"},"12":{"first":"1+#ppt_h/2","second":"#ppt_y"}}},"exit":{"2":{"1":{"first":"ppt_y","second":"0-ppt_h/2"},"2":{"first":"ppt_y","second":"ppt_y"},"3":{"first":"ppt_y","second":"0-ppt_h/2"},"4":{"first":"ppt_y","second":"1+ppt_h/2"},"6":{"first":"ppt_y","second":"1+ppt_h/2"},"8":{"first":"ppt_y","second":"ppt_y"},"9":{"first":"ppt_y","second":"0-ppt_h/2"},"12":{"first":"ppt_y","second":"1+ppt_h/2"}}}}}')},"./common/transaction.ts":
/*!*******************************!*\
  !*** ./common/transaction.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.endBatch=t.startBatch=t.transaction=t.UnProcessedResult=void 0;var r=o(/*! .. */"./index.ts"),n=o(/*! ../component */"./component/index.ts"),i=function(){this.inBatch=0,this.pendingUnProcessed=[]},a=function(e,t,o,r,n){void 0===n&&(n=!0),this.undo=e,this.redo=t,this.target=o,this.oldValue=r,this.canUndo=n};t.UnProcessedResult=a;var l=new i;function s(){l.inBatch++}function c(){if(0==--l.inBatch){var e=l.pendingUnProcessed.splice(0);if(0===e.length)return;r.Store.changeSetManager.commitChanges(e),e.forEach((function(e){e.target.notifyChange(e.redo,e.oldValue,n.ChangeCause.Operation)}))}}t.transaction=function(e){s();try{var t=e();t&&l.pendingUnProcessed.push(t)}finally{c()}},t.startBatch=s,t.endBatch=c},"./common/utils.ts":
/*!*************************!*\
  !*** ./common/utils.ts ***!
  \*************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCallStack=t.getTimestamp=t.cloneDeepWith=t.cloneDeep=t.visibilityEventAndStateName=t.isProduction=t.isDevelopment=t.isLocalDebug=t.Hue2RGB=t.HslToRgb=t.RgbToHsl=t.initClientVars=t.convertJSONPathToLodashPath=t.getValueByPointer=t.getAllLeafNodePath=t.findPath=void 0;var i=n(o(/*! ../middlebridge/core */"./middlebridge/core.ts")),a=o(/*! @tencent/tencent-doc-report */"../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),l=n(o(/*! lodash/isArray */"../node_modules/lodash/isArray.js")),s=n(o(/*! lodash/forEach */"../node_modules/lodash/forEach.js")),c=n(o(/*! lodash/isObject */"../node_modules/lodash/isObject.js")),d=n(o(/*! lodash/keys */"../node_modules/lodash/keys.js"));function u(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),6*o<1?e+6*(t-e)*o:2*o<1?t:3*o<2?e+(t-e)*(2/3-o)*6:e}function p(e){for(var t,o=0,r=e.length;o<r;){if(!((t=e.charCodeAt(o))>=48&&t<=57))return!1;o++}return!0}function h(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function f(e,t,o,r){var n;if(t&&(n=r?t(e,o,r):t(e)),void 0!==n)return n;var i=typeof e;if(null==e||"object"!=i&&"function"!=i)return e;var a=Array.isArray(e);n=a?new e.constructor(e.length):"function"==typeof e?e:function(e){return"function"!=typeof e.constructor||function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Object.prototype)}(e)?{}:Object.create(Object.getPrototypeOf(e))}(e);var l=a?void 0:d.default(e);return function(e,t){for(var o=-1,r=null==e?0:e.length;++o<r&&!1!==t(e[o],o););}(l||e,(function(o,r){l&&(o=e[r=o]),function(e,t,o){var r=e[t];Object.hasOwnProperty.call(e,t)&&function(e,t){return e===t||e!=e&&t!=t}(r,o)&&(void 0!==o||t in e)||function(e,t,o){"__proto__"==t?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}(e,t,o)}(n,r,f(o,t,r,e))})),n}t.findPath=function(e,t){if(e===t)return"";var o=function e(t,o){if(t&&"object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){if(t[r]===o)return"/"+r;if(t[r]&&"object"==typeof t[r]){var n=e(t[r],o);if(n)return"/"+r+n}}}(e,t);return o?"/"+o.slice(1):null},t.getAllLeafNodePath=function e(t,o){var r=[];if(l.default(t)){var n=0;s.default(t,(function(t){if(c.default(t)){var i=e(t,"["+n+"]");s.default(i,(function(e){var t=(o||"")+e;r.push(t)}))}else if(void 0!==t){var a=(o||"")+"["+n+"]";r.push(a)}n++})),0===r.length&&r.push(o)}else"{}"==JSON.stringify(t)?r.push(o):c.default(t)?s.default(d.default(t),(function(n){var i=e(t[n],n);s.default(i,(function(e){var t=(o?o+".":"")+e;r.push(t)}))})):r.push(o);return r},t.getValueByPointer=function(e,t){if(""===t)return e;for(var o,r=e,n=(t||"").split("/"),i=1,a=n.length;;){if(o=n[i],i++,null==r)return;if(Array.isArray(r)){if("-"===o)o=r.length;else{if(!p(o))throw new Error("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index");p(o)&&(o=~~o)}if(i>=a){if(o>r.length)return;return r[o]}}else if(o&&-1!==o.indexOf("~")&&(o=h(o)),i>=a)return r[o];r=r[o]}},t.convertJSONPathToLodashPath=function(e){var t=(e||"").split("/"),o=0,r=t.length,n="";return t.forEach((function(e){0!==o?(e&&-1!==e.indexOf("~")&&(e=h(e)),p(e)?(n.length>0&&(n=n.substr(0,n.length-1)),n+="["+e+"]"):n+=e,o!==r-1&&(n+="."),o++):o++})),n},t.initClientVars=function(e){i.default.window.clientVars=i.default.window.clientVars||{},i.default.window.clientVars=r(r(r({},i.default.window.clientVars),e),{padId:e.localPadId})},t.RgbToHsl=function(e){var t,o,r,n,i,a,l,s,c,d,u=0,p=0;return o=e.R/255,r=e.G/255,n=e.B/255,a=Math.min(o,Math.min(r,n)),d=(i=Math.max(o,Math.max(r,n)))-a,t=(i+a)/2,Math.abs(d)<1e-6?(u=0,p=0):(p=t<.5?d/(i+a):d/(2-i-a),l=((i-o)/6+d/2)/d,s=((i-r)/6+d/2)/d,c=((i-n)/6+d/2)/d,Math.abs(o-i)<1e-6?u=c-s:Math.abs(r-i)<1e-6?u=1/3+l-c:Math.abs(n-i)<1e-6&&(u=2/3+s-l),u<0&&(u+=1),u>1&&(u-=1)),{H:360*u,S:255*p,L:255*t}},t.HslToRgb=function(e){var t,o,r=0,n=0,i=0,a=1*e.H/360,l=1*e.S/255,s=1*e.L/255;return 0==l?(r=255*s,n=255*s,i=255*s):(r=255*u(t=2*s-(o=s<.5?s*(1+l):s+l-l*s),o,a+1/3),n=255*u(t,o,a),i=255*u(t,o,a-1/3)),{R:Math.floor(r+.5),G:Math.floor(n+.5),B:Math.floor(i+.5)}},t.Hue2RGB=u,t.isLocalDebug=function(){return"1"===e.env.LOCAL_DEBUG},t.isDevelopment=function(){var e=a.getCookie("dev_route_id"),t=a.getUrlParameter("magic");return e&&t},t.isProduction=function(){return!1},t.visibilityEventAndStateName=function(){var e="",t="";return void 0!==document.hidden?(t="visibilitychange",e="visibilityState"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozVisibilityState"):void 0!==document.msHidden?(t="msvisibilitychange",e="msVisibilityState"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitVisibilityState"),{event:t,state:e}},t.cloneDeep=function(e){return f(e)},t.cloneDeepWith=function(e,t){return f(e,t)},t.getTimestamp=function(){return(new Date).getTime()},t.getCallStack=function(){try{throw new Error("无抛错，仅手动获取调用栈信息")}catch(o){var e=((null==o?void 0:o.stack.split("\n"))||[]).map((function(e){return e.trim()}));try{var t=/.*(ts|js|e)\.([\w.]+)\s\(.*/;return t.test(e[4])?e[4].replace(t,"$2"):"unknown"}catch(e){return"unknown"}}}}).call(this,o(/*! ./../../node_modules/process/browser.js */"../node_modules/process/browser.js"))},"./common/validity-check.ts":
/*!**********************************!*\
  !*** ./common/validity-check.ts ***!
  \**********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkTableData=t.checkSrgbColorInData=t.checkUndefinedInData=void 0;var n=o(/*! ./utils */"./common/utils.ts"),i=r(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),a=r(o(/*! lodash/get */"../node_modules/lodash/get.js")),l=r(o(/*! lodash/set */"../node_modules/lodash/set.js")),s=new Set(["srgb_color"]);t.checkUndefinedInData=function e(t){for(var o in t)if(t.hasOwnProperty(o)){var r="number"==typeof t[o]&&isNaN(t[o]);void 0===t[o]||r?i.default(t,o):"object"==typeof t[o]&&e(t[o])}},t.checkSrgbColorInData=function e(t){for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];s.has(o)&&"string"==typeof r&&r.startsWith("#")&&7===r.length?(l.default(t,"colorType","rgb"),l.default(t,"colorValue",r.substring(1)),i.default(t,o)):"object"==typeof r&&e(r)}return t},t.checkTableData=function(e){e=n.cloneDeep(e);var t=a.default(e,"graphicData.tbl.tblColList"),o=a.default(e,"graphicData.tbl.tblRowList"),r=!0;if(t&&o){var i=t.length;o.forEach((function(e){if(e.tcList){var t=e.tcList.length;(t!==i||e.tcList.some((function(e){return null==e})))&&(r=!1),i=Math.max(i,t)}})),e=n.cloneDeep(e),t=a.default(e,"graphicData.tbl.tblColList"),o=a.default(e,"graphicData.tbl.tblRowList");var l=t.length;if(l<i)for(var s=0;s<i-l;s++)t.push({w:1016e3});o.forEach((function(e){if(e.tcList){var t=e.tcList.length;if(e.tcList&&t<i)for(var o=0;o<i-t;o++)e.tcList.push({textBody:{paragraphList:[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]}})}e.tcList&&e.tcList.forEach((function(t,o){null==t&&(e.tcList[o]={textBody:{paragraphList:[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]}})}))}))}return{valid:r,table:e}}},"./component/base-component.ts":
/*!*************************************!*\
  !*** ./component/base-component.ts ***!
  \*************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=t.ChangeCause=void 0;var n,i=o(/*! util */"../node_modules/util/util.js"),a=r(o(/*! jiff */"../node_modules/jiff/jiff.js")),l=r(o(/*! fast-json-patch */"../node_modules/fast-json-patch/index.mjs")),s=o(/*! ../common/utils */"./common/utils.ts"),c=o(/*! ../common/transaction */"./common/transaction.ts"),d=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),u=r(o(/*! ../common/log-utils */"./common/log-utils.ts"));window._,function(e){e[e.Operation=0]="Operation",e[e.Recv=1]="Recv",e[e.UndoRedo=2]="UndoRedo",e[e.Merge=3]="Merge",e[e.Memory=4]="Memory"}(n=t.ChangeCause||(t.ChangeCause={}));var p=function(){function e(e,t){this.observers=new Array,Object.defineProperties(this,{observers:{enumerable:!1,writable:!0},parentNode:{enumerable:!1,writable:!0}});var o=t||{cloneDeep:!0,genID:!0};null==o.cloneDeep&&(o.cloneDeep=!0),null==o.genID&&(o.genID=!0),this.initialize(e,o)}return Object.defineProperty(e.prototype,"children",{get:function(){var e=this.childNode();return Array.isArray(e)?e:[]},enumerable:!1,configurable:!0}),e.prototype.addObserver=function(e){this.observers.indexOf(e)<0&&this.observers.push(e)},e.prototype.removeObserver=function(e){var t=this.observers.indexOf(e);t>=0&&this.observers.splice(t,1)},e.prototype.notifyChange=function(e,t,o){var r=this;this.observers&&this.observers.forEach((function(a){a&&i.isFunction(a)&&(o===n.Recv||o===n.Merge?setTimeout((function(){a(r,e,{oldValue:t,cause:o})}),0):a(r,e,{oldValue:t,cause:o}))}))},e.prototype._transaction=function(e){var t=this,o=this._rootNode(),r=s.findPath(o,this);return null==r?(u.default.error("[CS]:当前节点已经不存在，所有操作无效, "+this.uniqueID),!1):o&&!o.editable?(u.default.error("[CS]:当前根节点不可编辑，所有操作无效, "+this.uniqueID),!1):(c.transaction((function(){var o=s.cloneDeep(t),n=t._applyAction(e,r,o);if(n.redo.length>0)return new c.UnProcessedResult(n.undo,n.redo,t,o,n.canUndo)})),!0)},e.prototype._applyAction=function(e,t,o){var r=e();return r?(this._processPatch({undo:r.undo,redo:r.redo},t,o,this),null!=r.redo&&null==r.undo&&((new Date).getTime(),r.undo=d.inversePatch(r.redo,o))):((new Date).getTime(),(r=this._createPatch(o,s.cloneDeep(this))).undo&&r.undo.length>0&&r.redo&&r.redo.length>0&&this._processPatch({undo:r.undo,redo:r.redo},t,o,this)),(r.undo&&0==r.undo.length||r.redo&&0==r.redo.length)&&u.default.debug("no change"),r},e.prototype._createPatch=function(e,t){var o=this.diff(e,t);if(!o)return{undo:[],redo:[]};var r=this.inverse(o);return o=d.filterTestOperationFromPatch(o),{undo:r=d.filterTestOperationFromPatch(r),redo:o}},e.prototype.diff=function(e,t){try{return a.default.diff(e,t)}catch(e){return[]}},e.prototype.inverse=function(e){return a.default.inverse(e)},e.prototype._processPatch=function(e,t,o,r){e.redo&&e.redo.length>0&&(e.redo.object=this,this._addTargetPathToPatch(e.redo,t),d.addTidForPatch(e.redo,this),d.addPidForPatch(e.redo,o)),e.undo&&e.undo.length>0&&(e.undo.object=this,this._addTargetPathToPatch(e.undo,t),d.addTidForPatch(e.undo,this),d.addPidForPatch(e.undo,r))},e.prototype._addTargetPathToPatch=function(e,t){e[0].target=t||""},e.prototype.convertUniqueIDToIndexStr=function(e){if(e){var t=e.split("|");if(t.length>1&&!t.slice(0,-1).every((function(e){return"end"!==e})))return;var o=this;if(t.every((function(e,r){var n=o.findNextNodeByID(e);return void 0!==n&&(o=n.nextNode?n.nextNode:o,t[r]=n.index>=0?n.index.toString():"",!0)})))return t.filter((function(e){return""!==e})).join("|")}else if(""===e)return""},e.prototype.findNextNodeByID=function(e){var t,o=this;return void 0===(t=function(){if("end"===e)return{index:o.children.length}}())&&(t=function(){var t=o.children.findIndex((function(t){return t.id===e}));if(-1!==t)return{nextNode:o.children[t],index:t}}()),void 0===t&&(t=function(){var t=o.childNode(e);if(t&&!Array.isArray(t))return{nextNode:t.node,index:null==t.index?-1:t.index}}()),t},e.prototype.applyPatch=function(e){var t=!0;try{l.default.applyPatch(this,l.default.deepClone(e))}catch(o){t=!1,u.default.error("[CS]:Apply patch error",o,e)}return this._checkChildrenAfterApplyPatch(),t},e.prototype._rootNode=function(){return this.parentNode?this.parentNode._rootNode():this},Object.defineProperty(e.prototype,"parentSlideNode",{get:function(){var t=function(o){return o?o instanceof e&&/^slide|layout|master$/g.test(o.type)?o:t(o.parentNode):null};return t(this.parentNode)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueID",{get:function(){for(var t=this,o=this.id;t=t.parentNode;)t instanceof e&&t.id&&(o=t.id+"|"+o);return o},enumerable:!1,configurable:!0}),e}();t.BaseComponent=p},"./component/base-shape.ts":
/*!*********************************!*\
  !*** ./component/base-shape.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseShape=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! ../common/utils */"./common/utils.ts"),l=o(/*! ../common/validity-check */"./common/validity-check.ts"),s=o(/*! ../common/rules-merge */"./common/rules-merge.ts"),c=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),d=o(/*! shortid */"../node_modules/shortid/index.js"),u=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),p=n(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),h=n(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),f=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),m=n(o(/*! lodash/has */"../node_modules/lodash/has.js")),y=(window._,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(e,t){e&&u.default(this,t.cloneDeep?a.cloneDeep(e):e),t.genID&&(this.id=this.generateShapeID()),void 0===this.id&&(this.id=this.generateShapeID())},t.prototype.updateProps=function(e){var t=this;return!!e&&this._transaction((function(){l.checkUndefinedInData(e);var o=c.getChangesetByUpdateProps(e,t,s.MergeRule.rules(s.MergeRule.FillSet,s.MergeRule.AdjustPoint));return p.default(t,e,s.MergeRule.rules(s.MergeRule.FillSet,s.MergeRule.AdjustPoint)),{redo:c.makePatch(o)}}))},t.prototype.removeProps=function(e){var t=this,o=a.getAllLeafNodePath(e,null);return o.reverse(),this._transaction((function(){var r=c.getChangesetByRemoveProps(e,t);return o.forEach((function(e){var o=/\[(\d+)\]$/i.exec(e);if(null!=o){var r=f.default(t,e.substring(0,o.index));r&&r.splice(parseInt(o[1],10),1)}else h.default(t,e)})),{redo:c.makePatch(r)}}))},t.prototype.updateAndRemoveProps=function(e,t){var o=this;return this._transaction((function(){var r=[];if(e&&(l.checkUndefinedInData(e),r=c.getChangesetByUpdateProps(e,o,s.MergeRule.rules(s.MergeRule.FillSet,s.MergeRule.AdjustPoint)),p.default(o,e,s.MergeRule.rules(s.MergeRule.FillSet,s.MergeRule.AdjustPoint))),t){r=r.concat(c.getChangesetByRemoveProps(t,o));var n=a.getAllLeafNodePath(t,null);n&&(n.reverse(),n.forEach((function(e){var t=/\[(\d+)\]$/i.exec(e);if(null!=t){var r=f.default(o,e.substring(0,t.index));r&&r.splice(parseInt(t[1],10),1)}else h.default(o,e)})))}return{redo:c.makePatch(r)}}))},Object.defineProperty(t.prototype,"sourceType",{get:function(){return this.parentSlideNode&&this.parentSlideNode.getSlideType()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlaceholder",{get:function(){return m.default(this,"props.placeholder")&&(null!=this.props.placeholder.type||null!=this.props.placeholder.index)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCustomPlaceholder",{get:function(){if(this.isPlaceholder){if("graphFrame_Tbl"===this.type||"pic"===this.type)return!0;if("shape"===this.type&&this instanceof i.Shape){var e=f.default(this,"props.placeholder.type");if(new Set(["dt","ftr","sldNum","chart","dgm","media","clipArt"]).has(e))return!1;var t=f.default(this,"textBody.paragraphList");return t&&t.some((function(e){return!!e.paragraphItem&&e.paragraphItem.some((function(e){return!!e.text&&e.text.length>0}))}))}}return!1},enumerable:!1,configurable:!0}),t.prototype._checkChildrenAfterApplyPatch=function(){},t.prototype.childNode=function(){},t.prototype.generateShapeID=function(){return"id_"+d.generate()},t}(i.BaseComponent));t.BaseShape=y},"./component/connector.ts":
/*!********************************!*\
  !*** ./component/connector.ts ***!
  \********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Connector=void 0;var n=function(e){function t(t,o){return e.call(this,t,o)||this}return r(t,e),t}(o(/*! . */"./component/index.ts").BaseShape);t.Connector=n},"./component/groupshape.ts":
/*!*********************************!*\
  !*** ./component/groupshape.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GroupShape=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! ./index */"./component/index.ts"),l=o(/*! ../common/utils */"./common/utils.ts"),s=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),c=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),d=o(/*! ../common/transaction */"./common/transaction.ts"),u=n(o(/*! lodash/uniqWith */"../node_modules/lodash/uniqWith.js")),p=n(o(/*! lodash/merge */"../node_modules/lodash/merge.js")),h=n(o(/*! lodash/clone */"../node_modules/lodash/clone.js")),f=n(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),m=n(o(/*! lodash/isNumber */"../node_modules/lodash/isNumber.js")),y=n(o(/*! lodash/inRange */"../node_modules/lodash/inRange.js")),g=n(o(/*! lodash/forOwn */"../node_modules/lodash/forOwn.js")),v=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),_=n(o(/*! lodash/set */"../node_modules/lodash/set.js")),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(t,o){var r=this;e.prototype.initialize.call(this,t,o);var n=v.default(this,"shapeList");this.shapeList=n?n.reduce((function(e,t){var n=a.createElementByType(t,o);return n?(n.parentNode=r,n&&e.push(n),e):e}),[]):[]},t.makeGroupShape=function(e){var o=new t({shapeList:e,type:"groupShape",id:this.prototype.generateShapeID()},{genID:!1}),r=o.calculateGroupFrameAfterGroup(o.shapeList);return _.default(o,"props.frame",r),o},t.prototype.deleteShapes=function(e){var o=this,r=u.default(e,(function(e,t){return!e||!t||e.id===t.id}));if(!function(e){return e.every((function(e){return function(e,o){for(var r=o.parentNode;r&&r instanceof t;){if(r===e)return!0;r=r.parentNode}return!1}(o,e)}))}(r))return s.default.error("要删除的元素不存在"),!1;var n=new Map,i=function(e){var o=e.children.reduce((function(o,a){if(-1===r.indexOf(a)){if(a instanceof t){var l=i(a);return l&&(n.has(e)?n.get(e).push(a):n.set(e,[a])),o&&l}return!1}return n.has(e)?n.get(e).push(a):n.set(e,[a]),o}),!0);return o&&n.delete(e),o};return i(this)&&n.set(this,this.children),d.transaction((function(){n.forEach((function(e,t){t.deleteChildren(e)}))})),!0},t.prototype.deleteChildren=function(e){if(e.length===this.shapeList.length){var o=this.parentNode;o instanceof i.Slide?o.deleteShapes([this]):o instanceof t?o.deleteChildren([this]):s.default.error("父节点不符合预期")}else if(e.length===this.shapeList.length-1){var r=this.shapeList.slice(0).filter((function(t){return-1===e.indexOf(t)}));this.parentNode._replaceGroupShapeWithChild(this,r[0])}else this._deletePartialChildren(e)},t.prototype._replaceGroupShapeWithChild=function(e,t){var o=this;return this._transaction((function(){var r=[],n=t,i=e.convertFrameToUngrouped(n.props.frame);p.default(n.props.frame,i),e.props.background&&!f.default(e.props.background,{})&&_.default(n,"props.background",e.props.background);var a=o.children.indexOf(e);return o.children.splice(a,1,n),n.parentNode=o,r.push(c.makeOperation({op:"replace",path:"/shapeList/"+a,value:n})),{redo:c.makePatch(r)}}))},t.prototype._deletePartialChildren=function(e){var o=this;return this._transaction((function(){var r=[];e.forEach((function(e){var t=o.indexOf(e);o.shapeList.splice(t,1),r.push(c.makeOperation({op:"remove",path:"/shapeList/"+t}))}));var n=o.calculateGroupFrameAfterUpdate();r=r.concat(c.getChangesetByUpdateProps(n,o.props.frame,void 0,"/props/frame")),p.default(o.props.frame,n);for(var i=o.parentNode;null!=i&&i instanceof t;){var a=i.calculateGroupFrameAfterUpdate();i.updateProps({props:{frame:a}}),i=i.parentNode}return{redo:c.makePatch(r)}}))},t.prototype.moveShapes=function(e,t){var o=this,r=u.default(e,(function(e,t){return!e||!t||e.id===t.id}));r.sort((function(e,t){return o.indexOf(e)<=o.indexOf(t)?-1:1}));var n,i=!0;if(r.some((function(e){return o.indexOf(e)<0&&(i=!1,!0)})),!i)return s.default.error("要移动的元素不存在"),!1;if(1===t||-1===t){if((n=r.map((function(e){return o.indexOf(e)+t})))[0]<0)for(var a=0;a<n.length;a++)(0===a||n[a]===n[a-1])&&(n[a]=n[a]+1);else if(n[n.length-1]>=this.shapeList.length)for(a=n.length-1;a>=0;a--)(a===n.length-1||n[a]===n[a+1])&&(n[a]=n[a]-1)}else 0===t?n=r.map((function(e,t){return t})):2===t&&(n=r.map((function(e,t){return o.shapeList.length-1+t-(r.length-1)})));return this._moveShapes(r,n,t)},t.prototype._moveShapes=function(e,t,o){var r=this;return e.length!==t.length?(s.default.error("要移动的shape节点数量和位置数量不匹配"),!1):this._transaction((function(){var n,i,a={redo:[],undo:[]};return-1===o||0===o?(n=e,i=t):(n=h.default(e),i=h.default(t),n.reverse(),i.reverse()),n.forEach((function(e,t){var o="/shapeList/"+r.shapeList.indexOf(e),n="/shapeList/"+i[t];if(o!==n){var l=c.makeOperation({op:"move",from:o,path:n,fid:e.id}),s=c.makeOperation({op:"move",from:n,path:o,fid:e.id});a.redo.push(l),a.undo.splice(0,0,s)}})),e.forEach((function(e){var t=r.indexOf(e);r.shapeList.splice(t,1)})),t.forEach((function(t,o){r.shapeList.splice(t,0,e[o])})),{redo:c.makePatch(a.redo),undo:c.makePatch(a.undo)}}))},t.prototype.calculateGroupFrameAfterGroup=function(e){var t,o,r,n,i,a,l=this;return e.forEach((function(e){var s=v.default(e,"props.frame"),c=l._effectiveFrame(s);t=void 0===t?c.top:Math.min(t,c.top),o=void 0===o?c.left:Math.min(o,c.left),r=void 0===r?c.left:Math.min(r,c.left),n=void 0===n?c.left+c.width:Math.max(n,c.left+c.width),i=void 0===i?c.top:Math.min(i,c.top),a=void 0===a?c.top+c.height:Math.max(a,c.top+c.height)})),this._floorFrame({top:t,left:o,width:n-r,height:a-i,childOffsetLeft:o,childOffsetTop:t,childWidth:n-r,childHeight:a-i})},t.prototype.calculateGroupFrameAfterUpdate=function(){var e=this.calculateGroupFrameAfterGroup(this.shapeList),t=this.convertFrameToUngrouped(e);return p.default(e,t),this._floorFrame(e)},t.prototype._convertRectToUngroup=function(e){var t=this.props.frame,o=null!=e.rotate&&m.default(e.rotate)?e.rotate/6e4:0;if(y.default(o,45,135)||y.default(o,225,315)){var r=e.width*t.height/t.childHeight,n=e.height*t.width/t.childWidth,i=t.top-n/2+(e.top+e.height/2-t.childOffsetTop)*(t.height/t.childHeight),a=t.left-r/2+(e.left+e.width/2-t.childOffsetLeft)*(t.width/t.childWidth);return this._floorFrame({left:a,top:i,width:r,height:n})}var l=t.top+(e.top-t.childOffsetTop)*t.height/t.childHeight,s=t.left+(e.left-t.childOffsetLeft)*t.width/t.childWidth,c=e.width*t.width/t.childWidth,d=e.height*t.height/t.childHeight;return this._floorFrame({left:s,top:l,width:c,height:d})},t.prototype.convertFrameToUngrouped=function(e){var t=this._convertRectToUngroup(e),o=this.props.frame,r=v.default(o,"flipH"),n=v.default(o,"flipV"),i=v.default(o,"rotate");if(1===r&&(t.flipH=e.flipH?0:1,t.left=Math.abs(2*o.left+o.width-(t.left+t.width))),1===n&&(t.flipV=e.flipV?0:1,t.top=Math.abs(2*o.top+o.height-(t.top+t.height))),m.default(i)&&0!==i){var a=this.getCenterPoint(t),l=this.getCenterPoint(o),s=this.rotateAroundPoint(a,l,i/6e4);t.left=s.left-t.width/2,t.top=s.top-t.height/2,t.rotate=m.default(e.rotate)?(e.rotate+i)%216e5:i}return this._floorFrame(t)},t.prototype.getCenterPoint=function(e){return this._floorFrame({left:e.left+e.width/2,top:e.top+e.height/2})},t.prototype.rotateAroundPoint=function(e,t,o){var r=function(e){return Math.PI/180*e};return this._floorFrame({left:(e.left-t.left)*Math.cos(r(o))-(e.top-t.top)*Math.sin(r(o))+t.left,top:(e.left-t.left)*Math.sin(r(o))+(e.top-t.top)*Math.cos(r(o))+t.top})},t.prototype._effectiveFrame=function(e){var t=l.cloneDeep(e);if(m.default(e.rotate)){var o=e.rotate/6e4;(y.default(o,45,135)||y.default(o,225,315))&&(t.left=e.left+(e.width-e.height)/2,t.top=e.top-(e.width-e.height)/2,t.width=e.height,t.height=e.width)}return this._floorFrame(t)},t.prototype._floorFrame=function(e){var t=e;return g.default(t,(function(e,o){m.default(e)&&(t[o]=Math.floor(e))})),t},t.prototype._checkChildrenAfterApplyPatch=function(){for(var e=this.shapeList,t=0;t<e.length;t++){var o=e[t];if(o instanceof i.BaseComponent)o._checkChildrenAfterApplyPatch();else{var r=a.createElementByType(o,{cloneDeep:!1,genID:!1});if(!r)continue;r.parentNode=this,e[t]=r}}},t.prototype.indexOf=function(e){return this.shapeList.indexOf(e)},t.prototype.childNode=function(e){if(!e)return this.shapeList},Object.defineProperty(t.prototype,"children",{get:function(){return this.childNode()},enumerable:!1,configurable:!0}),t}(i.BaseShape);t.GroupShape=b},"./component/index.ts":
/*!****************************!*\
  !*** ./component/index.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||t.hasOwnProperty(o)||r(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.findComponentByID=t.equal=t.createElementByType=void 0,n(o(/*! ./base-component */"./component/base-component.ts"),t),n(o(/*! ./base-shape */"./component/base-shape.ts"),t),n(o(/*! ./slide */"./component/slide.ts"),t),n(o(/*! ./shape */"./component/shape.ts"),t),n(o(/*! ./connector */"./component/connector.ts"),t),n(o(/*! ./table */"./component/table.ts"),t),n(o(/*! ./groupshape */"./component/groupshape.ts"),t),n(o(/*! ./picture */"./component/picture.ts"),t),n(o(/*! ./layout */"./component/layout.ts"),t),n(o(/*! ./master */"./component/master.ts"),t),n(o(/*! ./presentation */"./component/presentation.ts"),t),n(o(/*! ./theme */"./component/theme.ts"),t);var i=o(/*! ./shape */"./component/shape.ts"),a=o(/*! ./picture */"./component/picture.ts"),l=o(/*! ./groupshape */"./component/groupshape.ts"),s=o(/*! ./connector */"./component/connector.ts"),c=o(/*! ./table */"./component/table.ts");t.createElementByType=function(e,t){if(null==e)return null;switch(e.type){case"shape":return new i.Shape(e,t);case"pic":return new a.Picture(e,t);case"groupShape":return new l.GroupShape(e,t);case"cxnSp":return new s.Connector(e,t);case"graphFrame_Tbl":return new c.Table(e,t);default:return null}},t.equal=function(e,t){},t.findComponentByID=function(e,t){return e.find((function(e){return e.id===t}))}},"./component/layout.ts":
/*!*****************************!*\
  !*** ./component/layout.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Layout=void 0;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSlideType=function(){return"layout"},t.prototype.getLayout=function(){return this},t.prototype.getMaster=function(){return this.parentNode&&this.parentNode.findMasterById(this.masterId)},t}(o(/*! . */"./component/index.ts").Slide);t.Layout=n},"./component/master.ts":
/*!*****************************!*\
  !*** ./component/master.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Master=void 0;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSlideType=function(){return"master"},t.prototype.getLayout=function(){},t.prototype.getMaster=function(){return this},t}(o(/*! . */"./component/index.ts").Slide);t.Master=n},"./component/note-data.ts":
/*!********************************!*\
  !*** ./component/note-data.ts ***!
  \********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteData=void 0;var i=o(/*! . */"./component/index.ts"),a=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),l=o(/*! ./note */"./component/note.ts"),s=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),c=function(e){function t(t,o){return e.call(this,t,o)||this}return r(t,e),t.prototype.initialize=function(e,t){var o=t.cloneDeep?s.default(e):e;o.note=new l.Note(e.note?e.note:{},t),o.note.parentNode=this,a.default(this,o)},t.prototype._checkChildrenAfterApplyPatch=function(){this.note instanceof i.BaseComponent?this.note._checkChildrenAfterApplyPatch():(this.note=new l.Note(this.note?this.note:{},{cloneDeep:!1,genID:!1}),this.note.parentNode=this)},Object.defineProperty(t.prototype,"id",{get:function(){return"path_noteData"},enumerable:!1,configurable:!0}),t.prototype.childNode=function(e){if("path_note"===e)return{node:this.note}},t}(i.BaseComponent);t.NoteData=c},"./component/note.ts":
/*!***************************!*\
  !*** ./component/note.ts ***!
  \***************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Note=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),l=o(/*! ../common/validity-check */"./common/validity-check.ts"),s=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),c=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),d=n(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),u=n(o(/*! lodash/hasIn */"../node_modules/lodash/hasIn.js")),p=n(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),h=n(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),f=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),m=n(o(/*! lodash/set */"../node_modules/lodash/set.js")),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(e,t){e&&s.default(this,t.cloneDeep?c.default(e):e),this.textBody||(this.textBody={paragraphList:[]},m.default(this,"textBody.dirty",!0))},t.prototype._checkChildrenAfterApplyPatch=function(){},Object.defineProperty(t.prototype,"id",{get:function(){return"path_note"},enumerable:!1,configurable:!0}),t.prototype.childNode=function(){},Object.defineProperty(t.prototype,"paragraphTextArray",{get:function(){var e=[];return this.textBody&&this.textBody.paragraphList&&(e=this.textBody.paragraphList.map((function(e){return e.paragraphItem?e.paragraphItem.reduce((function(e,t){return t.text?e+t.text:e}),""):""}))),e},enumerable:!1,configurable:!0}),t.prototype.updateParagraphList=function(e,t){var o=this;return void 0===t&&(t={}),!!t&&this._transaction((function(){var r=[],n=l.checkSrgbColorInData(e);return f.default(o,"textBody.dirty")&&(d.default(o,"textBody.dirty"),r.push(a.makeOperation({op:"add",path:"/textBody",value:{paragraphList:[]}}))),u.default(o,"textBody.paragraphList")&&0!==o.textBody.paragraphList.length?p.default(o.textBody.paragraphList,n)||r.push(a.makeOperation({op:"replace",path:"/textBody/paragraphList",value:e})):r.push(a.makeOperation({op:"add",path:"/textBody/paragraphList",value:e})),o.textBody.paragraphList=n,l.checkUndefinedInData(t),o.textBody.props?r=r.concat(a.getChangesetByUpdateProps(t,o.textBody.props,void 0,"/textBody/props")):r.push(a.makeOperation({op:"add",path:"/textBody/props",value:t})),o.textBody.props?h.default(o.textBody.props,t):o.textBody.props=t,{redo:a.makePatch(r)}}))},t}(i.BaseComponent);t.Note=y},"./component/picture.ts":
/*!******************************!*\
  !*** ./component/picture.ts ***!
  \******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.Picture=void 0;var n=function(e){function t(t,o){return e.call(this,t,o)||this}return r(t,e),t}(o(/*! . */"./component/index.ts").BaseShape);t.Picture=n},"./component/presentation.ts":
/*!***********************************!*\
  !*** ./component/presentation.ts ***!
  \***********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Presentation=void 0;var a=o(/*! . */"./component/index.ts"),l=o(/*! ../common/utils */"./common/utils.ts"),s=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),c=i(o(/*! ../common/log-utils */"./common/log-utils.ts")),d=o(/*! ../common/validity-check */"./common/validity-check.ts"),u=i(o(/*! lodash/uniqWith */"../node_modules/lodash/uniqWith.js")),p=i(o(/*! lodash/toLower */"../node_modules/lodash/toLower.js")),h=i(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),f=i(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(e,t){var o=this,r={cloneDeep:t.cloneDeep,genID:!1},n=t.cloneDeep?l.cloneDeep(e):e||{};n.slideList&&(n.slideList=n.slideList.reduce((function(e,t){var n=new a.Slide(t,r);return n.parentNode=o,e.push(n),e}),[])),n.layoutList&&(n.layoutList=n.layoutList.reduce((function(e,t){var n=new a.Layout(t,r);return n.parentNode=o,e.push(n),e}),[])),n.masterList&&(n.masterList=n.masterList.reduce((function(e,t){var n=new a.Master(t,r);return n.parentNode=o,e.push(n),e}),[])),n.themeList&&(n.themeList=n.themeList.reduce((function(e,t){var n=new a.Theme(t,r);return n.parentNode=o,e.push(n),e}),[])),f.default(this,n),!this.slideList&&(this.slideList=[]),!this.layoutList&&(this.layoutList=[]),!this.masterList&&(this.masterList=[]),!this.themeList&&(this.themeList=[]),!this.slideIdList&&(this.slideIdList=[]),Object.defineProperties(this,{editable:{enumerable:!1,writable:!0,value:!0}})},t.prototype.addSlides=function(e,t){var o=this;return void 0===e&&(e=[{}]),void 0===t&&(t=this.slideList.length),this._transaction((function(){var r,i=[];d.checkUndefinedInData(e);var c=e.map((function(e){var t=new a.Slide(e);return t.parentNode=o,t}));return c.forEach((function(e,o){i.push(s.makeOperation({op:"add",path:"/slideList/"+(t+o),value:l.cloneDeep(e)}))})),(r=o.slideList).splice.apply(r,n([t,0],c)),{redo:s.makePatch(i)}}))},t.prototype.moveSlides=function(e,t){var o=this;if(t<0||t>this.slideList.length||Number.isNaN(t))return!1;var r=!0,i=t,a=u.default(e,(function(e,t){return!e||!t||e.id===t.id}));return a.sort((function(e,t){return o.children.indexOf(e)<=o.children.indexOf(t)?-1:1})),a.forEach((function(e){var n=o.slideList.indexOf(e);n<0?r=!1:n<t&&(i-=1)})),r?this._transaction((function(){var e,r={redo:[],undo:[]},l=0;return a.forEach((function(e,n){var i=o.slideList.indexOf(e),a="/slideList/"+(i>=t?i:i-n),c="/slideList/"+(i>=t?t+l++:t-1);if(a!==c){var d=s.makeOperation({op:"move",from:a,path:c,fid:e.id}),u=s.makeOperation({op:"move",from:c,path:a,fid:e.id});r.redo.push(d),r.undo.splice(0,0,u)}})),a.forEach((function(e){var t=o.slideList.indexOf(e);o.slideList.splice(t,1)})),(e=o.slideList).splice.apply(e,n([i,0],a)),r})):(c.default.error("要移动的slide不存在"),!1)},t.prototype.deleteSlides=function(e){var t=this,o=u.default(e,(function(e,t){return!e||!t||e.id===t.id})),r=!0;return o.forEach((function(e){t.slideList.indexOf(e)<0&&(r=!1)})),r?this._transaction((function(){var e=[];return o.forEach((function(o){var r=t.slideList.indexOf(o);t.slideList.splice(r,1),e.push(s.makeOperation({op:"remove",path:"/slideList/"+r}))})),{redo:s.makePatch(e)}})):(c.default.error("未选中Slide或者Slide列表已经为空"),!1)},t.prototype.duplicateSlides=function(e){var t=this,o=u.default(e,(function(e,t){return!e||!t||e.id===t.id}));if(o.sort((function(e,o){return t.children.indexOf(e)<=t.children.indexOf(o)?-1:1})),0===o.length)return{succeed:!1};var r,i=!0,d=0;return o.forEach((function(e){var o=t.slideList.indexOf(e);o<0?i=!1:d=o+1})),i?{succeed:this._transaction((function(){var e,i=[];(r=o.map((function(e){var o=new a.Slide(e);return o.parentNode=t,o}))).forEach((function(e,t){i.push(s.makeOperation({op:"add",path:"/slideList/"+(d+t),value:l.cloneDeep(e)}))})),(e=t.slideList).splice.apply(e,n([d,0],r))})),newValue:r}:(c.default.error("未选中Slide或者Slide列表已经为空"),{succeed:!1})},t.prototype.updateProps=function(e,t){var o=this;return!!e&&this._transaction((function(){d.checkUndefinedInData(e);var r=s.getChangesetByUpdateProps(e,o);return h.default(o,e),{redo:s.makePatch(r),canUndo:!(!0===t)}}))},t.prototype.getSlideByIndex=function(e){return this.slideList[e]},t.prototype.findMasterById=function(e){for(var t=0;t<this.masterList.length;t++)if(this.masterList[t].id===e)return this.masterList[t];return null},t.prototype.findLayoutById=function(e){for(var t=0;t<this.layoutList.length;t++)if(this.layoutList[t].id===e)return this.layoutList[t];return null},t.prototype.findThemeById=function(e){for(var t=0;t<this.themeList.length;t++)if(this.themeList[t].id===e)return this.themeList[t];return null},t.prototype.findThemeBySlide=function(e){var t=this.findLayoutById(e.layoutId),o=t&&this.findMasterById(t.masterId);return o&&this.findThemeById(o.themeId)},t.prototype.getInheritedPlaceHolderByLayoutId=function(e){var t=this.findLayoutById(e);if(t){var o=[];return t.getShapes().forEach((function(e){e.isPlaceholder&&function(e){return["dt","ftr","sldnum"].every((function(t){return p.default(e.props.placeholder.type)!==t}))}(e)&&o.push(e)})),o=l.cloneDeepWith(o,(function(e,t){if("paragraphList"===t)return[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]}))}},t.prototype.applyChangeset=function(e,t){var o=this,r=e.map((function(e){return o.findAndApplyPatch(e)}));return e.reduce((function(e,o,n){var i=t!==a.ChangeCause.Memory,l=r[n];return!(null==l||!l.succeeded)&&(i&&l.target.notifyChange(o,l.oldValue,t),e)}),!0)},t.prototype.applyChangesetByUndoRedo=function(e){var t=this,o=e.map((function(e){return t.findAndApplyPatch(e)})),r=e.map((function(e,t){var r=o[t];if(null!=r&&r.succeeded)return r.target.notifyChange(e,r.oldValue,a.ChangeCause.UndoRedo),s.inversePatch(e,r.oldValue)}));return(r=r.filter((function(e){return void 0!==e&&e.length>0}))).reverse()},t.prototype.findAndApplyPatch=function(e){var t=s.getTargetComponentByPatch(e,this);if(t&&t instanceof a.BaseComponent){var o=e;return e.object&&e.object!==t&&(o.object=t),{target:t,oldValue:l.cloneDeep(t),succeeded:t.applyPatch(e)}}c.default.error("[CS]:应用patch异常",e,this)},t.prototype._checkChildrenAfterApplyPatch=function(){var e=this;this.slideList.forEach((function(t,o){if(t instanceof a.BaseComponent)t._checkChildrenAfterApplyPatch();else{var r=new a.Slide(t,{cloneDeep:!1,genID:!1});r.parentNode=e,e.slideList[o]=r}}))},t.prototype.childNode=function(e){if(!e)return this.slideList;var t=this.layoutList.findIndex((function(t){return t.id===e}));return t>=0?{node:this.layoutList[t],index:t}:(t=this.masterList.findIndex((function(t){return t.id===e})))>=0?{node:this.masterList[t],index:t}:void 0},Object.defineProperty(t.prototype,"children",{get:function(){var e=this.childNode();return Array.isArray(e)?e:[]},enumerable:!1,configurable:!0}),t}(a.BaseComponent);t.Presentation=m},"./component/shape.ts":
/*!****************************!*\
  !*** ./component/shape.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),l=o(/*! ../common/utils */"./common/utils.ts"),s=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),c=o(/*! ../common/validity-check */"./common/validity-check.ts"),d=n(o(/*! lodash/hasIn */"../node_modules/lodash/hasIn.js")),u=n(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),p=n(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),h=n(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),f=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),m=n(o(/*! lodash/set */"../node_modules/lodash/set.js")),y=(window._,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(t,o){e.prototype.initialize.call(this,t,o),this.textBody?this.textBody.paragraphList&&this.textBody.paragraphList.forEach((function(e){var t=f.default(e,"paragraphProps.defaultRunProps");t&&e.paragraphItem&&e.paragraphItem.forEach((function(e){var o=e,r=l.cloneDeep(t);o.props&&u.default(r,o.props),o.props=r,o.text&&-1!==o.text.indexOf("\r")&&(o.text=o.text.replace(/\r(\n)?/gi,"\n"))}))})):(this.textBody={paragraphList:[]},m.default(this,"textBody.dirty",!0))},t.prototype.paragraphArray=function(){return f.default(this,"textBody.paragraphList")},Object.defineProperty(t.prototype,"paragraphTextArray",{get:function(){var e=[];return this.paragraphArray()&&(e=this.paragraphArray().map((function(e){return e.paragraphItem?e.paragraphItem.reduce((function(e,t){return t.text?e+t.text:e}),""):""}))),e},enumerable:!1,configurable:!0}),t.prototype.updateParagraphList=function(e,t){var o=this;return void 0===t&&(t={}),!!t&&this._transaction((function(){var r=[],n=c.checkSrgbColorInData(e);return f.default(o,"textBody.dirty")&&(p.default(o,"textBody.dirty"),r.push(a.makeOperation({op:"add",path:"/textBody",value:{paragraphList:[]}}))),d.default(o,"textBody.paragraphList")?h.default(o.textBody.paragraphList,n)||r.push(a.makeOperation({op:"replace",path:"/textBody/paragraphList",value:e})):r.push(a.makeOperation({op:"add",path:"/textBody/paragraphList",value:e})),o.textBody.paragraphList=n,c.checkUndefinedInData(t),o.textBody.props?r=r.concat(a.getChangesetByUpdateProps(t,o.textBody.props,void 0,"/textBody/props")):r.push(a.makeOperation({op:"add",path:"/textBody/props",value:t})),o.textBody.props?u.default(o.textBody.props,t):o.textBody.props=t,{redo:a.makePatch(r)}}))},t.prototype.updateParagraphContentByIndex=function(e,t,o){var r=this.paragraphArray()[e];return r?(c.checkSrgbColorInData(t),this._transaction((function(){t&&(r.paragraphItem=t),o&&(c.checkUndefinedInData(o),u.default(r.paragraphProps,o))}))):(s.default.error("错误的段落"),!1)},t.prototype._createPatch=function(e,t){return this._createPatchInternal(e,t)},t.prototype._createPatchInternal=function(e,t){var o="textBody.paragraphList",r=f.default(e,o),n=f.default(t,o),i=t;delete e.textBody.paragraphList,delete i.textBody.paragraphList;var l=this.diff(e,t);if(!l)return{undo:[],redo:[]};var s=this.inverse(l);return l=a.filterTestOperationFromPatch(l),s=a.filterTestOperationFromPatch(s),h.default(r,n)||(l.push(a.makeOperation({op:"replace",path:"/textBody/paragraphList",value:n})),s.push(a.makeOperation({op:"replace",path:"/textBody/paragraphList",value:r}))),r&&m.default(e,o,r),n&&m.default(t,o,n),{undo:s,redo:l}},t}(i.BaseShape));t.Shape=y},"./component/slide.ts":
/*!****************************!*\
  !*** ./component/slide.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Slide=void 0;var i=o(/*! ./index */"./component/index.ts"),a=o(/*! shortid */"../node_modules/shortid/index.js"),l=o(/*! ../common/transaction */"./common/transaction.ts"),s=o(/*! . */"./component/index.ts"),c=o(/*! ../common/utils */"./common/utils.ts"),d=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),u=o(/*! ../common/validity-check */"./common/validity-check.ts"),p=o(/*! ./timing */"./component/timing.ts"),h=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),f=o(/*! ./note-data */"./component/note-data.ts"),m=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),y=n(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),g=n(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),v=n(o(/*! lodash/isEqual */"../node_modules/lodash/isEqual.js")),_=n(o(/*! lodash/merge */"../node_modules/lodash/merge.js")),b=n(o(/*! lodash/toLower */"../node_modules/lodash/toLower.js")),T=n(o(/*! lodash/uniqWith */"../node_modules/lodash/uniqWith.js")),S=n(o(/*! lodash/clone */"../node_modules/lodash/clone.js")),C=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),w=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),E=n(o(/*! lodash/set */"../node_modules/lodash/set.js")),I=n(o(/*! lodash/has */"../node_modules/lodash/has.js")),x=(window._,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(e,t){var o=this,r=t.cloneDeep?c.cloneDeep(e):e,n=w.default(r,"slideData.groupShape");n&&n.shapeList?n.shapeList=n.shapeList.reduce((function(e,r){null==r&&(o.dirty=!0);var n=i.createElementByType(r,{cloneDeep:t.cloneDeep,genID:!1});return n?(n.parentNode=o,n&&e.push(n),e):e}),[]):E.default(r,"slideData.groupShape.shapeList",[]);var l=w.default(r,"timing");l&&(r.timing=new p.Timing(l),r.timing.parentNode=this);var s=w.default(r,"noteData");s&&(r.noteData=new f.NoteData(s),r.noteData.parentNode=this),m.default(this,r),this.type=this.getSlideType(),t.genID&&(this.id=a.generate()),void 0===this.id&&(this.id=a.generate())},t.prototype.updateProps=function(e){var t=this;return!!e&&this._transaction((function(){var o;return u.checkUndefinedInData(e),o=h.getChangesetByUpdateProps(e,t),y.default(t,e),{redo:h.makePatch(o)}}))},t.prototype.removeProps=function(e){var t=this,o=c.getAllLeafNodePath(e,null).reverse();return this._transaction((function(){var r=[];return r=r.concat(h.getChangesetByRemoveProps(e,t)),o.forEach((function(e){var o=/\[(\d+)\]$/i.exec(e);if(null!=o){var r=w.default(t,e.substring(0,o.index));r&&r.splice(parseInt(o[1],10),1)}else g.default(t,e)})),{redo:h.makePatch(r)}}))},t.prototype.updateAndRemoveProps=function(e,t){var o=this;return this._transaction((function(){var r=[];e&&(u.checkUndefinedInData(e),r=h.getChangesetByUpdateProps(e,o),y.default(o,e));var n=c.getAllLeafNodePath(t,null).reverse();return n&&(r=r.concat(h.getChangesetByRemoveProps(t,o)),n.forEach((function(e){var t=/\[(\d+)\]$/i.exec(e);if(null!=t){var r=w.default(o,e.substring(0,t.index));r&&r.splice(parseInt(t[1],10),1)}else g.default(o,e)}))),{redo:h.makePatch(r)}}))},t.prototype.addNote=function(e){var t=this;return null!=e&&this._transaction((function(){var o=[];return I.default(e,"note.textBody")||E.default(e,"note.textBody",{}),t.noteData=new f.NoteData(e),t.noteData.parentNode=t,o.push(h.makeOperation({op:"add",path:"/noteData",value:e})),{redo:h.makePatch(o)}}))},t.prototype.addShapes=function(e){return this._addShapes(e)},t.prototype._addShapes=function(e,t,o){var r=this;return void 0===o&&(o={cloneDeep:!0,genID:!0}),this._transaction((function(){var n=[];return u.checkUndefinedInData(e),e.forEach((function(e,a){var l=i.createElementByType(e,o);l&&("graphFrame_Tbl"===l.type&&r.parentNode&&!I.default(l,"graphicData.tbl.tblPr.styleId")&&I.default(r.parentNode,"tblStyleList.def")&&E.default(l,"graphicData.tbl.tblPr.styleId",r.parentNode.tblStyleList.def),l.parentNode=r,null==t?r.getShapes().push(l):r.getShapes().splice(t+a,0,l),n.push(h.makeOperation({op:"add",path:"/slideData/groupShape/shapeList/"+(null==t?r.getShapes().length-1:t+a),value:c.cloneDeep(l)})))})),{redo:h.makePatch(n)}}))},t.prototype._replaceGroupShapeWithChild=function(e,t){var o=this;return this._transaction((function(){var r=[],n=t,i=e.convertFrameToUngrouped(n.props.frame);_.default(n.props.frame,i),e.props.background&&!v.default(e.props.background,{})&&E.default(n,"props.background",e.props.background);var a=o.children.indexOf(e);return o.children.splice(a,1,n),n.parentNode=o,r.push(h.makeOperation({op:"replace",path:"/slideData/groupShape/shapeList/"+a,value:n})),{redo:h.makePatch(r)}}))},t.prototype.moveShapes=function(e,t){var o=this,r=T.default(e,(function(e,t){return!e||!t||e.id===t.id}));r.sort((function(e,t){return o.children.indexOf(e)<=o.children.indexOf(t)?-1:1}));var n,i=!0;if(r.some((function(e){return o.indexOf(e)<0&&(i=!1,!0)})),!i)return d.default.error("要移动的元素不存在"),!1;if(1===t||-1===t){if((n=r.map((function(e){return o.indexOf(e)+t})))[0]<0)for(var a=0;a<n.length;a++)(0===a||n[a]===n[a-1])&&(n[a]=n[a]+1);else if(n[n.length-1]>=this.getShapes().length)for(a=n.length-1;a>=0;a--)(a===n.length-1||n[a]===n[a+1])&&(n[a]=n[a]-1)}else 0===t?n=r.map((function(e,t){return t})):2===t&&(n=r.map((function(e,t){return o.getShapes().length-1+t-(r.length-1)})));return this._moveShapes(r,n,t)},t.prototype._moveShapes=function(e,t,o){var r=this;return e.length!==t.length?(d.default.error("要移动的shape节点数量和位置数量不匹配"),!1):this._transaction((function(){var n,i,a={redo:[],undo:[]};return-1===o||0===o?(n=e,i=t):(n=S.default(e),i=S.default(t),n.reverse(),i.reverse()),n.forEach((function(e,t){var o="/slideData/groupShape/shapeList/"+r.getShapes().indexOf(e),n="/slideData/groupShape/shapeList/"+i[t];if(o!==n){var l=h.makeOperation({op:"move",from:o,path:n,fid:e.id}),s=h.makeOperation({op:"move",from:n,path:o,fid:e.id});a.redo.push(l),a.undo.splice(0,0,s)}})),e.forEach((function(e){var t=r.indexOf(e);r.getShapes().splice(t,1)})),t.forEach((function(t,o){r.getShapes().splice(t,0,e[o])})),{redo:h.makePatch(a.redo),undo:h.makePatch(a.undo)}}))},t.prototype.deleteShapes=function(e){var t=this,o=T.default(e,(function(e,t){return!e||!t||e.id===t.id})),r=!0;return o.some((function(e){return t.indexOf(e)<0&&(r=!1,!0)})),r?this._transaction((function(){var e=[];return o.forEach((function(o){var r=t.indexOf(o);t.getShapes().splice(r,1),e.push(h.makeOperation({op:"remove",path:"/slideData/groupShape/shapeList/"+r}))})),t.removeShapesAnim(o),{redo:h.makePatch(e)}})):(d.default.error("要删除的元素不存在"),!1)},t.prototype.updateShapeProps=function(e,t,o){return!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length||(l.transaction((function(){e.forEach((function(e,r){e&&(o&&o.length===t.length?e.updateAndRemoveProps(t[r],o[r]):e.updateProps(t[r]))}))})),0))},t.prototype.group=function(e){var t=this,o=T.default(e,(function(e,t){return!e||!t||e.id===t.id}));o.sort((function(e,o){return t.children.indexOf(e)<=t.children.indexOf(o)?-1:1}));var r=!0;return o.some((function(e){return t.indexOf(e)<0&&(r=!1,!0)})),r?this._transaction((function(){var e=[],r=0;o.forEach((function(o){var n=t.indexOf(o);t.getShapes().splice(n,1),e.push(h.makeOperation({op:"remove",path:"/slideData/groupShape/shapeList/"+n})),r=Math.max(r,n)}));var n=s.GroupShape.makeGroupShape(o);return n.parentNode=t,t.getShapes().splice(r,0,n),e.push(h.makeOperation({op:"add",path:"/slideData/groupShape/shapeList/"+r,value:C.default(n)})),t.removeShapesAnim(o),{redo:h.makePatch(e)}})):(d.default.error("要组合的元素不存在"),!1)},t.prototype.ungroup=function(e){var t=this;return this._transaction((function(){var o=[],r=t.indexOf(e);return t.getShapes().splice(r,1),o.push(h.makeOperation({op:"remove",path:"/slideData/groupShape/shapeList/"+r})),e.shapeList.forEach((function(n,i){var a=e.convertFrameToUngrouped(n.props.frame);_.default(n.props.frame,a),e.props.background&&!v.default(e.props.background,{})&&E.default(n,"props.background",e.props.background),t.getShapes().splice(r+i,0,n),n.parentNode=t,o.push(h.makeOperation({op:"add",path:"/slideData/groupShape/shapeList/"+(r+i),value:n}))})),t.removeShapesAnim([e]),{redo:h.makePatch(o)}}))},t.prototype.addAnim=function(e,t,o){var r=this;l.transaction((function(){r._transaction((function(){r.timing&&r.timing.tmRoot&&r.timing.tmRoot.hasMainSeqTn()||(r.timing=new p.Timing({}),r.timing.createTmRootIfNecessary(),r.timing.parentNode=r)})),r.timing&&r.timing.createShapesAnimInTransaction(e,t,o)}))},t.prototype.moveAnim=function(e,t){this.timing&&this.timing.moveAnimTnInTransaction(e,t)},t.prototype.removeShapesAnim=function(e){var t=this;this.timing&&l.transaction((function(){0===t.timing.removeShapesAnimInTransaction(e)&&t._transaction((function(){delete t.timing;var e=[];return e.push(h.makeOperation({op:"remove",path:"/timing"})),{redo:h.makePatch(e)}}))}))},t.prototype.removeAnim=function(e){var t=this;this.timing&&l.transaction((function(){0===t.timing.removeAnimInTransaction(e)&&t._transaction((function(){delete t.timing;var e=[];return e.push(h.makeOperation({op:"remove",path:"/timing"})),{redo:h.makePatch(e)}}))}))},t.prototype.modifyAnim=function(e,t){this.timing&&this.timing.modifyAnimInTransaction(e,t)},t.prototype.groupShape=function(){return this.slideData.groupShape},t.prototype.getShapes=function(){return this.slideData.groupShape.shapeList},t.prototype.indexOf=function(e){return this.getShapes().indexOf(e)},t.prototype.findShapeById=function(e){for(var t=this.getShapes(),o=0;o<t.length;o++)if(t[o].id===e)return t[o];return null},t.prototype.getSlideType=function(){return"slide"},t.prototype.getLayout=function(){return this.parentNode&&this.parentNode.findLayoutById(this.layoutId)},t.prototype.getMaster=function(){var e=this.getLayout();return this.parentNode&&e&&this.parentNode.findMasterById(e.masterId)},t.prototype.findShapeByPlaceholder=function(e){for(var t=this.getShapes(),o=0;o<t.length;o++)if(this.comparePlaceholder(t[o].props.placeholder,e))return t[o];return null},t.prototype.comparePlaceholder=function(e,t){var o=function(e){return null==e};return(null!=e||null!=t)&&!(!!e!=!!t||e&&t&&(!o(e.type)&&!o(t.type)&&e.type!==t.type||!o(e.index)&&!o(t.index)&&4294967295!==Math.max(e.index,t.index)&&e.index!==t.index||o(e.type)!==o(t.type)&&o(e.index)!==o(t.index)||o(e.type)!==o(t.type)&&["dt","ftr","sldnum"].some((function(o){return b.default(e.type)===o||b.default(t.type)===o}))))},t.prototype._checkChildrenAfterApplyPatch=function(){for(var e=this.getShapes(),t=0;t<e.length;t++){var o=e[t];if(o instanceof s.BaseComponent)o._checkChildrenAfterApplyPatch();else{var r=i.createElementByType(o,{cloneDeep:!1,genID:!1});if(!r)continue;r.parentNode=this,e[t]=r}}var n=w.default(this,"timing");n instanceof s.BaseComponent?n._checkChildrenAfterApplyPatch():n&&(this.timing=new p.Timing(n),this.timing.parentNode=this);var a=w.default(this,"noteData");a instanceof s.BaseComponent?a._checkChildrenAfterApplyPatch():a&&(this.noteData=new f.NoteData(a),this.noteData.parentNode=this)},t.prototype.childNode=function(e){return e?"path_noteData"===e?{node:this.noteData}:"path_timing"===e?{node:this.timing}:void 0:this.getShapes()},Object.defineProperty(t.prototype,"children",{get:function(){var e=this.childNode();return Array.isArray(e)?e:[]},enumerable:!1,configurable:!0}),t}(s.BaseComponent));t.Slide=x},"./component/table.ts":
/*!****************************!*\
  !*** ./component/table.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TablePartStyle=t.TableStyleEntry=t.Table=void 0;var a=o(/*! . */"./component/index.ts"),l=o(/*! ../common/utils */"./common/utils.ts"),s=o(/*! ../common/validity-check */"./common/validity-check.ts"),c=o(/*! ../common/rules-merge */"./common/rules-merge.ts"),d=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),u=i(o(/*! lodash/inRange */"../node_modules/lodash/inRange.js")),p=i(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),h=i(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),f=i(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),m=i(o(/*! lodash/get */"../node_modules/lodash/get.js")),y=i(o(/*! lodash/set */"../node_modules/lodash/set.js")),g=(window._,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(t,o){var r=t,n=s.checkTableData(t);n.valid||(r=n.table),e.prototype.initialize.call(this,r,o),this.rowList&&this.rowList.forEach((function(e){e.tcList&&e.tcList.forEach((function(e){e.textBody&&e.textBody.paragraphList&&e.textBody.paragraphList.forEach((function(e){e.paragraphItem&&e.paragraphItem.forEach((function(e){var t=e;t.text&&-1!==t.text.indexOf("\r")&&(t.text=t.text.replace(/\r(\n)?/gi,"\n"))}))}))}))})),!n.valid&&(this.dirty=!0)},t.makeTable=function(e,o,r,n){for(var i=new t({type:"graphFrame_Tbl",graphicData:{tbl:{tblPr:{styleId:"{58542034-FE4F-4ADA-92B8-4CA66D0F0DF3}"},tblColList:[],tblRowList:[]}},props:{}},{cloneDeep:!1,genID:!0}),a=0;a<o;a++)i.graphicData.tbl.tblColList.push({w:r});for(a=0;a<e;a++){for(var l={h:n,tcList:[]},s=0;s<o;s++)l.tcList.push({textBody:{paragraphList:[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]}});i.graphicData.tbl.tblRowList.push(l)}return i},t.prototype.updateProps=function(e){var t=this;return!!e&&this._transaction((function(){s.checkUndefinedInData(e);var o=d.getChangesetByUpdateProps(e,t,c.MergeRule.rules(c.MergeRule.FillSet,c.MergeRule.Text));return p.default(t,e,c.MergeRule.rules(c.MergeRule.FillSet,c.MergeRule.Text)),{redo:d.makePatch(o)}}))},t.prototype.insertRowsOrColumns=function(e,t){var o=e.y,r=e.x,n=e.height,i=e.width;return 0===t||1===t?this.insertRows(o,n,t):(2===t||3===t)&&this.insertColumns(r,i,t)},t.prototype.insertRows=function(e,t,o){var r=this;return this._transaction((function(){for(var i,a=[],s=[],c=0===o?e:e+t-1,u=r.rowList[c],p=0;p<t;p++)s.push(l.cloneDeep(u));var f=0===o?e:e+t;s.forEach((function(e){e.tcList.forEach((function(e){m.default(e,"textBody.paragraphList")&&e.textBody.paragraphList.splice(0,e.textBody.paragraphList.length),e.rowSpan&&(h.default(e,"rowSpan"),y.default(e,"vMerge",1))}))}));var g=f===r.rowList.length?void 0:r.rowList[f],v=function(e){if(g&&g.tcList[e].vMerge)for(var o=f;o>=0;o--){var n=r.rowList[o].tcList[e];if(n.rowSpan&&n.rowSpan>0){n.rowSpan+=t,a.push(d.makeOperation({op:"replace",path:r.convertCellPath(o,e,"rowSpan"),value:n.rowSpan}));break}}else s.forEach((function(t){return h.default(t.tcList[e],"vMerge")}))};for(p=0;p<r.colList.length;p++)v(p);return(i=r.rowList).splice.apply(i,n([f,0],s)),a=a.concat(s.map((function(e,t){return d.makeOperation({op:"add",path:"/graphicData/tbl/tblRowList/"+(f+t),value:e})}))),{redo:d.makePatch(a)}}))},t.prototype.insertColumns=function(e,t,o){var r=this;return this._transaction((function(){for(var i,a=[],s=[],c=[],u=2===o?e:e+t-1,p=r.colList[u],f=0;f<t;f++)s.push(l.cloneDeep(p));r.rowList.forEach((function(e){var o=[];c.push(o);for(var r=e.tcList[u],n=0;n<t;n++){var i=l.cloneDeep(r);m.default(i,"textBody.paragraphList")&&i.textBody.paragraphList.splice(0,i.textBody.paragraphList.length),i.gridSpan&&(h.default(i,"gridSpan"),y.default(i,"hMerge",1)),o.push(i)}}));var g=2===o?e:e+t;c.forEach((function(e,o){if(e[0].hMerge&&1===e[0].hMerge){var n=r.colList.length===g?void 0:r.rowList[o].tcList[g];if(n&&n.hMerge)for(var i=g;i>=0;i--){var l=r.rowList[o].tcList[i];if(r.hasGridSpan(l)){l.gridSpan+=t,a.push(d.makeOperation({op:"replace",path:r.convertCellPath(o,i,"gridSpan"),value:l.gridSpan}));break}}else e.forEach((function(e){return h.default(e,"hMerge")}))}})),(i=r.colList).splice.apply(i,n([g,0],s)),r.rowList.forEach((function(e,t){var o,r=c[t];(o=e.tcList).splice.apply(o,n([g,0],r))})),c.forEach((function(e,t){e.forEach((function(e,o){a.push(d.makeOperation({op:"add",path:r.convertCellPath(t,g+o),value:e}))}))})),a=a.concat(s.map((function(e,t){return d.makeOperation({op:"add",path:"/graphicData/tbl/tblColList/"+(g+t),value:e})})));var v=0;r.colList.forEach((function(e){v+=e.w}));var _=r.props.frame.width/v;return r.colList.forEach((function(e,t){var o=e;o.w=o.w*_,a.push(d.makeOperation({op:"replace",path:"/graphicData/tbl/tblColList/"+t+"/w",value:o.w}))})),{redo:d.makePatch(a)}}))},t.prototype.deleteRowsOrColumns=function(e,t){var o=e.y,r=e.x,n=e.height,i=e.width;return 0===t?this.deleteRows(o,n):this.deleteColumns(r,i)},t.prototype.deleteRows=function(e,t){var o=this;return this._transaction((function(){for(var r=[],n=0;n<t;n++)e+t-1-n<o.rowList.length&&r.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblRowList/"+(e+t-1-n)}));for(var i=o.rowList.splice(e,t),a=function(t){if(e<o.rowList.length){var n=o.rowList[e].tcList[t];if(n.vMerge&&1===n.vMerge&&i.some((function(e,r){var n=e.tcList[t];return o.hasRowSpan(n)&&n.rowSpan+r>i.length}))&&(h.default(n,"vMerge"),r.push(d.makeOperation({op:"remove",path:o.convertCellPath(e,t,"vMerge")})),e+1<o.rowList.length)){var a=o.rowList.slice(e+1);(u=o.countVMerge(a,t))>0&&(y.default(n,"rowSpan",u+1),r.push(d.makeOperation({op:"add",path:o.convertCellPath(e,t,"rowSpan"),value:n.rowSpan})))}}for(var l=o.rowList.slice(0,e),s=l.length-1;s>=0;s--){var c=l[s].tcList[t];if(o.hasRowSpan(c)){var u;a=o.rowList.slice(s+1),(u=o.countVMerge(a,t))>0?(y.default(c,"rowSpan",u+1),r.push(d.makeOperation({op:"replace",path:o.convertCellPath(s,t,"rowSpan"),value:u+1}))):(h.default(c,"rowSpan"),r.push(d.makeOperation({op:"remove",path:o.convertCellPath(s,t,"rowSpan")})));break}}},l=0;l<o.colList.length;l++)a(l);return{redo:d.makePatch(r)}}))},t.prototype.deleteColumns=function(e,t){var o=this;return this._transaction((function(){for(var r=[],n=0;n<t;n++)e+t-1-n<o.colList.length&&r.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblColList/"+(e+t-1-n)}));o.colList.splice(e,t),o.rowList.forEach((function(n,i){for(var a=0;a<t;a++)e+t-1-a<n.tcList.length&&r.push(d.makeOperation({op:"remove",path:o.convertCellPath(i,e+t-1-a)}));var l=n.tcList.splice(e,t);if(e<n.tcList.length){var s=n.tcList[e];if(s.hMerge&&1===s.hMerge&&l.some((function(e){return o.hasGridSpan(e)&&e.gridSpan+i>l.length}))&&(h.default(s,"hMerge"),r.push(d.makeOperation({op:"remove",path:o.convertCellPath(i,e,"hMerge")})),e+1<n.tcList.length)){var c=n.tcList.slice(e+1);(f=o.countHMerge(c))>0&&(y.default(s,"gridSpan",f+1),r.push(d.makeOperation({op:"add",path:o.convertCellPath(i,e,"gridSpan"),value:s.gridSpan})))}}var u=n.tcList.slice(0,e);for(a=u.length-1;a>=0;a--){var p=u[a];if(o.hasGridSpan(p)){var f;c=n.tcList.slice(a+1),(f=o.countHMerge(c))>0?(y.default(p,"gridSpan",f+1),r.push(d.makeOperation({op:"replace",path:o.convertCellPath(i,a,"gridSpan"),value:p.gridSpan}))):(h.default(p,"gridSpan"),r.push(d.makeOperation({op:"remove",path:o.convertCellPath(i,a,"gridSpan")})));break}}}));var i=o.colList.reduce((function(e,t){return e+t.w}),0);return y.default(o,"props.frame.width",i),r.push(d.makeOperation({op:"replace",path:"/props/frame/width",value:i})),{redo:d.makePatch(r)}}))},t.prototype.mergeCell=function(e){var t=this;if(!this.canMergeCell(e))return!1;var o=this.rowList.slice(e.y,e.y+e.height),r=(o=o.map((function(t){return{h:t.h,tcList:t.tcList.slice(e.x,e.x+e.width)}})))[0].tcList[0],n=m.default(r,"textBody.paragraphList");n||y.default(r,"textBody.paragraphList",[]);var i=r.textBody.paragraphList;return this._transaction((function(){var a=[];return o.forEach((function(o,r){o.tcList.forEach((function(o,n){var l=o,s=e.y+r,c=e.x+n;0===r&&0===n||(l.textBody&&l.textBody.paragraphList.some((function(e){return(e.paragraphItem?e.paragraphItem.reduce((function(e,t){return t.text?e+t.text:e}),""):"").length>0}))&&(a.push(d.makeOperation({op:"replace",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/textBody/paragraphList",value:[]})),i.push.apply(i,l.textBody.paragraphList),l.textBody.paragraphList=[]),0===n&&e.width>1?(y.default(l,"gridSpan",e.width),a.push(d.makeOperation({op:"add",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/gridSpan",value:e.width}))):t.hasGridSpan(l)&&(h.default(l,"gridSpan"),a.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/gridSpan"}))),0===r&&e.height>1?(y.default(l,"rowSpan",e.height),a.push(d.makeOperation({op:"add",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/rowSpan",value:e.height}))):t.hasRowSpan(l)&&(h.default(l,"rowSpan"),a.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/rowSpan"}))),e.width>1&&0!==n?(a.push(d.makeOperation({op:1===l.hMerge?"replace":"add",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/hMerge",value:1})),l.hMerge=1):1===l.hMerge&&(h.default(l,"hMerge"),a.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/hMerge"}))),e.height>1&&0!==r?(a.push(d.makeOperation({op:1===l.vMerge?"replace":"add",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/vMerge",value:1})),l.vMerge=1):1===l.vMerge&&(h.default(l,"vMerge"),a.push(d.makeOperation({op:"remove",path:"/graphicData/tbl/tblRowList/"+s+"/tcList/"+c+"/vMerge"}))))}))})),e.height>1&&(a.push(d.makeOperation({op:r.rowSpan?"replace":"add",path:"/graphicData/tbl/tblRowList/"+e.y+"/tcList/"+e.x+"/rowSpan",value:e.height})),r.rowSpan=e.height),e.width>1&&(a.push(d.makeOperation({op:r.gridSpan?"replace":"add",path:"/graphicData/tbl/tblRowList/"+e.y+"/tcList/"+e.x+"/gridSpan",value:e.width})),r.gridSpan=e.width),n?a.push(d.makeOperation({op:"replace",path:"/graphicData/tbl/tblRowList/"+e.y+"/tcList/"+e.x+"/textBody/paragraphList",value:i})):a.push(d.makeOperation({op:"replace",path:"/graphicData/tbl/tblRowList/"+e.y+"/tcList/"+e.x+"/textBody",value:{paragraphList:i}})),{redo:d.makePatch(a)}}))},t.prototype.cancelMergedCell=function(e){var t=this;if(e.y+e.height>this.rowList.length||e.x+e.width>this.rowList[0].tcList.length)return!1;var o=this.rowList.slice(e.y),r=-1,n=-1,i=-1,a=-1;if((o=o.map((function(t){return{h:t.h,tcList:t.tcList.slice(e.x)}}))).some((function(o,l){return o.tcList.some((function(o,s){return!(!t.hasRowSpan(o)&&!t.hasGridSpan(o)||(r=e.y+l,n=e.x+s,i=o.rowSpan||1,a=o.gridSpan||1,0))}))})),r>-1){var l=[];return this._transaction((function(){var e=t.rowList.slice(r,r+i);return(e=e.map((function(e){return{h:e.h,tcList:e.tcList.slice(n,n+a)}}))).forEach((function(e,o){e.tcList.forEach((function(e,i){var a=r+o,s=n+i;0===o&&0===i?(t.hasRowSpan(e)&&(h.default(e,"rowSpan"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"rowSpan")}))),t.hasGridSpan(e)&&(h.default(e,"gridSpan"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"gridSpan")})))):(1===e.vMerge&&(h.default(e,"vMerge"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"vMerge")}))),1===e.hMerge&&(h.default(e,"hMerge"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"hMerge")}))),t.hasRowSpan(e)&&(h.default(e,"rowSpan"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"rowSpan")}))),t.hasGridSpan(e)&&(h.default(e,"gridSpan"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"gridSpan")}))),e.tcPr&&(h.default(e,"tcPr"),l.push(d.makeOperation({op:"remove",path:t.convertCellPath(a,s,"tcPr")}))),e.textBody&&e.textBody.paragraphList&&(y.default(e.textBody,"paragraphList",[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]),l.push(d.makeOperation({op:"replace",path:t.convertCellPath(a,s,"textBody/paragraphList"),value:[{paragraphItem:[],endParaRPr:{type:"endParaPPr"}}]}))))}))})),{redo:d.makePatch(l)}}))}return!1},t.prototype.countVMerge=function(e,t){for(var o=0,r=0;r<e.length;r++){var n=e[r].tcList[t];if(!n.vMerge||1!==n.vMerge)break;o+=1}return o},t.prototype.countHMerge=function(e){for(var t=0,o=0;o<e.length&&e[o].hMerge&&1===e[o].hMerge;o++)t+=1;return t},t.prototype.canMergeCell=function(e){var t=this;if(Math.min(e.width,e.height)<=0||Math.max(e.width,e.height)<=1)return!1;if(e.y+e.height>this.rowList.length)return!1;if(e.x+e.width>this.colList.length)return!1;if(this.isFullMergedCell(e))return!1;var o=this.rowList.slice(e.y,e.y+e.height),r=!0,n=!1;return(o=o.map((function(t){return{h:t.h,tcList:t.tcList.slice(e.x,e.x+e.width)}}))).some((function(i,a){return i.tcList.some((function(l,s){if(t.hasRowSpan(l)&&l.rowSpan+a>o.length)n=!0;else if(t.hasGridSpan(l)&&l.gridSpan+s>i.tcList.length)n=!0;else if(1===l.vMerge||1===l.hMerge){var c=t.findFirstCellByMergedCell(s+e.x,a+e.y);c&&t.isPointInRange(c,e)||(n=!0)}return n&&(r=!1),n}))})),r},t.prototype.findFirstCellByMergedCell=function(e,t){if(t<this.rowList.length&&e<this.rowList[t].tcList.length){var o=this.rowList[t].tcList[e];if(!o.vMerge&&!o.hMerge)return{x:e,y:t};for(var r=t;r>=0;r--)for(var n=this.rowList[r],i=e;i>=0;i--){var a=n.tcList[i],l=!1,s=!1;if((!o.vMerge||o.vMerge&&this.hasRowSpan(a)&&t<a.rowSpan+r)&&(l=!0),(!o.hMerge||o.hMerge&&this.hasGridSpan(a)&&e<a.gridSpan+i)&&(s=!0),l&&s)return{x:i,y:r}}}},t.prototype.isPointInRange=function(e,t){return u.default(e.x,t.x,t.x+t.width)&&u.default(e.y,t.y,t.y+t.height)},t.prototype.isFullMergedCell=function(e){var t=this.rowList[e.y].tcList[e.x];return this.hasRowSpan(t)&&this.hasGridSpan(t)?t.rowSpan===e.height&&t.gridSpan===e.width:this.hasRowSpan(t)?t.rowSpan===e.height&&1===e.width:!!this.hasGridSpan(t)&&t.gridSpan===e.width&&1===e.height},t.prototype.hasRowSpan=function(e){return e.rowSpan&&e.rowSpan>1},t.prototype.hasGridSpan=function(e){return e.gridSpan&&e.gridSpan>1},t.prototype.convertCellPath=function(e,t,o){return o?"/graphicData/tbl/tblRowList/"+e+"/tcList/"+t+"/"+o:"/graphicData/tbl/tblRowList/"+e+"/tcList/"+t},Object.defineProperty(t.prototype,"rowList",{get:function(){return this.graphicData.tbl.tblRowList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colList",{get:function(){return this.graphicData.tbl.tblColList},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellTextArray",{get:function(){var e=[];return this.rowList.forEach((function(t,o){t.tcList.forEach((function(t,r){var n=[],i=m.default(t,"textBody.paragraphList");i&&(n=i.map((function(e){return e.paragraphItem?e.paragraphItem.reduce((function(e,t){return t.text?e+t.text:e}),""):""}))),e.push({row:o,col:r,paragraphTextArray:n})}))})),e},enumerable:!1,configurable:!0}),t}(a.BaseShape));t.Table=g;var v=function(e){e&&f.default(this,e)};t.TableStyleEntry=v;var _=function(){};t.TablePartStyle=_},"./component/theme.ts":
/*!****************************!*\
  !*** ./component/theme.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.replaceThemeColor=t.getUniqueKey=t.Theme=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! ../common/utils */"./common/utils.ts"),l=n(o(/*! ../common/log-utils */"./common/log-utils.ts")),s=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),c=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),d=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),u=(window._,function(e){function t(t,o){var r=e.call(this,t,o)||this;return Object.defineProperties(r,{_themeCache:{enumerable:!1,writable:!0}}),r}return r(t,e),t.prototype.initialize=function(e,t){e&&s.default(this,t.cloneDeep?c.default(e):e),this._themeCache=new Map},t.prototype.getSRGBColorFromCache=function(e){return this._themeCache.has(e)?this._themeCache.get(e):null},t.prototype.setSRGBColorToCache=function(e,t){return!(!e||!t||(this._themeCache.set(e,t),0))},t.prototype._checkChildrenAfterApplyPatch=function(){},t.prototype.childNode=function(){},t}(i.BaseComponent));function p(e,t){return null!=e[t]?e[t]:null}function h(e,t){var o=d.default(t,e.colorValue);return p(e,"colorType")+(o||p(e,"colorValue"))+p(e,"lumOff")+p(e,"lumMod")+p(e,"tint")+p(e,"shade")+p(e,"alpha")}function f(e,t){return(Array(t).join("0")+e).slice(-t)}t.Theme=u,t.getUniqueKey=h,t.replaceThemeColor=function(e,t,o){if(function(e,t){return!(null==e||null==t||!e.colorType)}(e,t)){var r,n=e,i=h(n,o),s=t.getSRGBColorFromCache(i);if(s)return n.srgb_color=s,n;if("scheme"===n.colorType){if(!(r=d.default(t,"themeElements.clrScheme."+n.colorValue))){var c=d.default(o,n.colorValue);r=d.default(t,"themeElements.clrScheme."+c)}r||(r="FFFFFF",l.default.error("转换主题color失败，colorValue:"+n.colorValue))}else(r=n.colorValue)||(r="FFFFFF",l.default.error("异常数据，colorValue为空"));var u={R:parseInt(r.substring(0,2),16),G:parseInt(r.substring(2,4),16),B:parseInt(r.substring(4,6),16)};if(null!=n.lumOff||null!=n.lumMod){var p=null!=n.lumOff&&n.lumOff>=0?n.lumOff:0,m=null!=n.lumMod&&n.lumMod>=0?n.lumMod:1e5,y=a.RgbToHsl(u),g=255*p/1e5+y.L*m/1e5;y.L=Math.min(g,255),u=a.HslToRgb(y)}if(null!=n.tint){var v=(n.tint||0)/1e5;u={R:Math.floor(u.R*v+255*(1-v)),G:Math.floor(u.G*v+255*(1-v)),B:Math.floor(u.B*v+255*(1-v))}}if(null!=n.shade){var _=(n.shade||0)/1e5;u={R:Math.floor(u.R*_),G:Math.floor(u.G*_),B:Math.floor(u.B*_)}}return r=f(u.R.toString(16),2)+f(u.G.toString(16),2)+f(u.B.toString(16),2),null!=n.alpha&&(r+=f(Math.floor(255*n.alpha/1e5).toString(16),2)),n.srgb_color="#"+r.toUpperCase(),t.setSRGBColorToCache(i,n.srgb_color),n}}},"./component/timenode.ts":
/*!*******************************!*\
  !*** ./component/timenode.ts ***!
  \*******************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SequenceTimeNodeModel=t.ParallelTimeNode=t.SeqParTnBase=t.TnBase=t.SPTimeNode=t.ClickTimeNode=t.MainSeqTimeNode=t.RootTimeNode=t.TimeNode=t.AnimModel=t.ActionSequence=t.AnimModiyParam=t.NodeType=t.AnimTypes=t.timingTemplate=void 0;var i=o(/*! . */"./component/index.ts"),a=o(/*! shortid */"../node_modules/shortid/index.js"),l=o(/*! assert */"../node_modules/assert/assert.js"),s=o(/*! util */"../node_modules/util/util.js"),c=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),d=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),u=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),p=n(o(/*! lodash/set */"../node_modules/lodash/set.js")),h=n(o(/*! lodash/has */"../node_modules/lodash/has.js"));window._,t.timingTemplate=o(/*! ../common/timingTemplate.json */"./common/timingTemplate.json"),t.AnimTypes={NONE:"none",FADE_IN:"fade_in",FADE_OUT:"fade_out",SCALE:"scale",APPEAR:"appear",DISAPPEAR:"disappear",FLY_IN:"fly_in",FLY_OUT:"fly_out",FLOAT_UP_IN:"float_up_in",FLOAT_UP_OUT:"float_up_out",FLOAT_DOWN_IN:"float_down_in",FLOAT_DOWN_OUT:"float_down_out",CUT_IN:"cut_in",CUT_OUT:"cut_out",ROTATE:"rotate",PLUSE:"pluse"},t.NodeType={NONE:"none",CLICK_EFFECT:"clickEffect",WITH_EFFECT:"withEffect",AFTER_EFFECT:"afterEffect"};var f=function(){};t.AnimModiyParam=f;var m=function(){};t.ActionSequence=m;var y=function(){};t.AnimModel=y;var g=function(e){function o(t,o){return e.call(this,t,o)||this}return r(o,e),o.prototype.initialize=function(e,t){var o=t.cloneDeep?c.default(e):e,r=u.default(o,"childTnLst");if(r){for(var n=new Array,i=0;i<r.length;i++){var l=r[i],s=void 0,p=u.default(l,"type");"tn_par"==p?(s=new w(l)).cTn.parentNode=this:"tn_seq"==p&&((s=new E(l)).cTn.parentNode=this),s?n.push(s):n.push(l)}o.childTnLst=n}t.genID&&void 0===o.id&&(o.id=a.generate()),d.default(this,o)},o.prototype._checkChildrenAfterApplyPatch=function(){var e=u.default(this,"childTnLst");if(e){for(var t=new Array,o=0;o<e.length;o++){var r=e[o],n=void 0;if(r instanceof i.BaseComponent)r._checkChildrenAfterApplyPatch();else{var a=u.default(r,"type");"tn_par"==a?(n=new w(r)).cTn.parentNode=this:"tn_seq"==a&&((n=new E(r)).cTn.parentNode=this)}n?t.push(n):t.push(r)}this.childTnLst=t}},o.prototype.childNode=function(e){if(!e&&this.childTnLst)return this.childTnLst.map((function(e){return e.cTn})).filter((function(e){return null!=e}))},o.prototype.deleteAllProperty=function(){delete this.presetID,delete this.presetClass,delete this.presetSubtype,delete this.dur,delete this.restart,delete this.fill,delete this.nodeType,delete this.stCondLst,delete this.childTnLst},o.prototype.spId=function(){for(var e=this.childTnLst?this.childTnLst:[],t="-1",o=0;o<e.length;o++){var r=e[o];if(h.default(r,"cBhvr.tgtEl.spTgt.spid")){t=u.default(r,"cBhvr.tgtEl.spTgt.spid");break}}return t},o.prototype.setSpId=function(e){(this.childTnLst?this.childTnLst:[]).forEach((function(t){h.default(t,"cBhvr.tgtEl.spTgt.spid")&&p.default(t,"cBhvr.tgtEl.spTgt.spid",e)}))},o.prototype.animType=function(){return 10==this.presetID&&"entr"==this.presetClass&&0==this.presetSubtype?t.AnimTypes.FADE_IN:10==this.presetID&&"exit"==this.presetClass&&0==this.presetSubtype?t.AnimTypes.FADE_OUT:6==this.presetID&&"emph"==this.presetClass&&0==this.presetSubtype?t.AnimTypes.SCALE:t.AnimTypes.NONE},o.prototype.setAnimType=function(e,t){var o=this;t?this._transaction((function(){o._setAnimType(e)})):this._setAnimType(e)},o.prototype._setAnimType=function(e){var t=this.spId(),r=o.createNewAnimType(e,t);r.id=this.id,r.parentNode=this,r.nodeType=this.nodeType,this.deleteAllProperty(),d.default(this,r)},o.prototype.setDur=function(e,t){var o=this;t?this._transaction((function(){o._setDur(e)})):this._setDur(e)},o.prototype._setDur=function(e){var o=this.childTnLst?this.childTnLst:[],r=this.animType();o.forEach((function(o){var n=o.type;"tn_animEffect"!==n&&"tn_animScale"!==n&&"tn_animRot"!==n&&"tn_anim"!==n||p.default(o,"cBhvr.cTn.dur",e),r===t.AnimTypes.FADE_OUT&&"tn_set"===n&&s.isNumber(e)&&p.default(o,"cBhvr.cTn.stCondLst[0].delay",e-1)}))},o.prototype.setSubType=function(e,t){var o=this;t?this._transaction((function(){e&&(o.presetSubtype=e,12!==o.presetID&&2!==o.presetID||o._setTavLstWithSubType(e))})):e&&(this.presetSubtype=e,12!==this.presetID&&2!==this.presetID||this._setTavLstWithSubType(e))},o.prototype._setTavLstWithSubType=function(e){var o=this.childTnLst?this.childTnLst:[],r=!1,n=!1,i=this.presetClass,a=this.presetID,l=this.presetSubtype,s=this;o.forEach((function(o){if("tn_anim"===o.type&&o.tavlst&&2===o.tavlst.length)if(r){if(!n){var c=t.timingTemplate.tavFlagyDict;"entr"!==i&&"exit"!==i||(h=c[i],2===a&&(u=h[""+a][""+l])&&s._setAnimNodeTavLstWithStrings(o,u.first,u.second),p.default(o,"cBhvr.cTn.by",e)),n=!0}}else{var d=t.timingTemplate.tavFlagxDict;if("entr"===i||"exit"===i){var u,h=d[i];2!==a&&12!==a||(u=h[""+a][""+l])&&s._setAnimNodeTavLstWithStrings(o,u.first,u.second),p.default(o,"cBhvr.cTn.by",e)}r=!0}}))},o.prototype._setAnimNodeTavLstWithStrings=function(e,t,o){var r=!1;(e.tavlst?e.tavlst:[]).forEach((function(e){r?p.default(e,"val.strValue.strValue",o):(p.default(e,"val.strValue.strValue",t),r=!0)}))},o.prototype.setBy=function(e,t){var o=this;t?this._transaction((function(){e&&o._setBy(e)})):e&&this._setBy(e)},o.prototype._setBy=function(e){(this.childTnLst?this.childTnLst:[]).forEach((function(t){var o=t.type;"tn_animScale"!==o&&"tn_animRot"!==o||p.default(t,"by",e)}))},o.prototype.subType=function(){return this.presetSubtype},o.prototype.setDelay=function(e,t){var o=this;t?this._transaction((function(){o._setDelay(e)})):this._setDelay(e)},o.prototype._setDelay=function(e){p.default(this,"stCondLst[0].delay",e)},o.prototype.setNodeType=function(e,t){var o=this;t?this._transaction((function(){o._setNodeType(e)})):this._setNodeType(e)},o.prototype._setNodeType=function(e){this.nodeType=e},o.createNewAnimType=function(e,r){var n;switch(e){case t.AnimTypes.FADE_IN:n=new o(c.default(t.timingTemplate.fade_in_tn));break;case t.AnimTypes.FADE_OUT:n=new o(c.default(t.timingTemplate.fade_out_tn));break;case t.AnimTypes.SCALE:n=new o(c.default(t.timingTemplate.scale));break;case t.AnimTypes.APPEAR:n=new o(c.default(t.timingTemplate.appear));break;case t.AnimTypes.DISAPPEAR:(n=new o(c.default(t.timingTemplate.appear))).presetClass="exit";break;case t.AnimTypes.FLY_IN:n=new o(c.default(t.timingTemplate.fly_in));break;case t.AnimTypes.FLY_OUT:(n=new o(c.default(t.timingTemplate.fly_in))).presetClass="exit",n._setTavLstWithSubType(4);break;case t.AnimTypes.FLOAT_UP_IN:n=new o(c.default(t.timingTemplate.float_in));break;case t.AnimTypes.FLOAT_UP_OUT:(n=new o(c.default(t.timingTemplate.float_in))).presetClass="exit",n._setTavLstWithSubType(4);break;case t.AnimTypes.FLOAT_DOWN_IN:n=new o(c.default(t.timingTemplate.float_down_in));break;case t.AnimTypes.FLOAT_DOWN_OUT:(n=new o(c.default(t.timingTemplate.float_down_in))).presetClass="exit",n._setTavLstWithSubType(4);break;case t.AnimTypes.CUT_IN:n=new o(c.default(t.timingTemplate.cut_in));break;case t.AnimTypes.CUT_OUT:(n=new o(c.default(t.timingTemplate.cut_in))).presetClass="exit",n._setTavLstWithSubType(4);break;case t.AnimTypes.PLUSE:n=new o(c.default(t.timingTemplate.pluse));break;case t.AnimTypes.ROTATE:n=new o(c.default(t.timingTemplate.rotate));break;default:l(!1),n=new o({})}return n.setSpId(r),n},o}(i.BaseComponent);t.TimeNode=g;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.mainSeqTn=function(){for(var e=new _({}),t=this.childTnLst?this.childTnLst:[],o=0;o<t.length;o++){var r=t[o];if(r.cTn&&"mainSeq"==r.cTn.nodeType){d.default(e,r.cTn),e.timeNode=r.cTn;break}}return e},t.prototype.hasMainSeqTn=function(){for(var e=this.childTnLst?this.childTnLst:[],t=0;t<e.length;t++){var o=e[t];if(o.cTn&&"mainSeq"==o.cTn.nodeType)return!0}return!1},Object.defineProperty(t.prototype,"id",{get:function(){return"path_rootNode"},enumerable:!1,configurable:!0}),t}(g);t.RootTimeNode=v;var _=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r(o,e),o.prototype.clickTnList=function(){for(var e=new Array,t=this.childTnLst?this.childTnLst:[],o=0;o<t.length;o++){var r=t[o],n=r&&r.cTn;if(n){var i=new b({});d.default(i,n),i.timeNode=n,e.push(i)}}return e},o.prototype.lastClickTn=function(){var e=this.childTnLst?this.childTnLst:[],t=e[e.length-1],o=t&&t.cTn,r=new b({});return o&&(d.default(r,o),r.timeNode=o),r},o.prototype.createNewClickTn=function(){var e=new w(c.default(t.timingTemplate.par_indefinite_tn));e.cTn.parentNode=this.timeNode,this.childTnLst&&this.childTnLst.push(e);var o=e.cTn?e.cTn:{},r=new b({});return d.default(r,o),r.timeNode=e.cTn,r},o}(g);t.MainSeqTimeNode=_;var b=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return r(o,e),o.prototype.startTnList=function(){for(var e=new Array,t=this.childTnLst?this.childTnLst:[],o=0;o<t.length;o++){var r=t[o],n=r&&r.cTn;if(n){var i=new T({});d.default(i,n),i.timeNode=n,e.push(i)}}return e},o.prototype.lastStartTn=function(){var e=this.childTnLst?this.childTnLst:[],t=e[e.length-1],o=t&&t.cTn,r=new T({});return o&&(d.default(r,o),r.timeNode=o),r},o.prototype.createNewStartTn=function(){var e=new w(c.default(t.timingTemplate.par_zero_tn));e.cTn.parentNode=this.timeNode,this.childTnLst&&this.childTnLst.push(e);var o=e.cTn?e.cTn:{},r=new T({});return d.default(r,o),r.timeNode=e.cTn,r},o}(g);t.ClickTimeNode=b;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.animTnList=function(){for(var e=new Array,t=this.childTnLst?this.childTnLst:[],o=0;o<t.length;o++){var r=t[o],n=r&&r.cTn;n&&e.push(n)}return e},t.prototype.pushNewAnimTn=function(e){var t=new w({});return t.cTn=e,t.cTn.parentNode=this.timeNode,this.childTnLst&&this.childTnLst.push(t),e},t}(g);t.SPTimeNode=T;var S=function(){};t.TnBase=S;var C=function(e){function t(t){var o=e.call(this)||this,r=t;return t&&t.cTn&&(r.cTn=new g(t.cTn)),d.default(o,r),o}return r(t,e),Object.defineProperty(t.prototype,"valueId",{get:function(){return this.cTn?this.cTn.id:""},enumerable:!1,configurable:!0}),t}(S);t.SeqParTnBase=C;var w=function(e){function t(t){var o=e.call(this,t)||this;return o.type="tn_par",o}return r(t,e),t}(C);t.ParallelTimeNode=w;var E=function(e){function t(t){var o=e.call(this,t)||this;return o.type="tn_seq",o}return r(t,e),t}(C);t.SequenceTimeNodeModel=E},"./component/timing.ts":
/*!*****************************!*\
  !*** ./component/timing.ts ***!
  \*****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Timing=void 0;var i=o(/*! . */"./component/index.ts"),a=n(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),l=n(o(/*! lodash/assign */"../node_modules/lodash/assign.js")),s=o(/*! ../common/transaction */"./common/transaction.ts"),c=o(/*! assert */"../node_modules/assert/assert.js"),d=o(/*! ./timenode */"./component/timenode.ts"),u=function(e){function t(t,o){return e.call(this,t,o)||this}return r(t,e),t.prototype.initialize=function(e,t){var o=t.cloneDeep?a.default(e):e;e.tmRoot&&(o.tmRoot=new d.RootTimeNode(e.tmRoot),o.tmRoot.parentNode=this),l.default(this,o)},t.prototype._checkChildrenAfterApplyPatch=function(){var e=this.tmRoot;e instanceof i.BaseComponent?e._checkChildrenAfterApplyPatch():(this.tmRoot=new d.RootTimeNode(this.tmRoot),this.tmRoot.parentNode=this)},Object.defineProperty(t.prototype,"id",{get:function(){return"path_timing"},enumerable:!1,configurable:!0}),t.prototype.childNode=function(e){if("path_rootNode"===e)return{node:this.tmRoot}},t.prototype.getMainSequence=function(){var e=performance.now(),t=new Array;if(!this.tmRoot)return t;this.tmRoot.mainSeqTn().clickTnList().forEach((function(e){var o=new d.ActionSequence;e.startTnList().forEach((function(e){e.animTnList().forEach((function(e){o.animList||(o.animList=new Array,o.startCon=e.nodeType?e.nodeType:d.NodeType.CLICK_EFFECT,t.push(o));var r=new d.AnimModel;"function"==typeof e.spId&&(r.spid=e.spId()),r.anim=e,o.animList.push(r)}))}))}));var o=performance.now();return console.debug("getMainSequence:"+(o-e)+"ms"),t},t.prototype.createTmRootIfNecessary=function(){this.tmRoot||(this.tmRoot=new d.RootTimeNode(d.timingTemplate.timing.tmRoot),this.tmRoot.parentNode=this)},t.prototype.createShapesAnimInTransaction=function(e,t,o){var r=this;this._transaction((function(){for(var n=0;n<e.length;n++){var i=e[n];0==n?r._createNewShapeAnim(i,t,d.NodeType.CLICK_EFFECT,o):r._createNewShapeAnim(i,t,d.NodeType.WITH_EFFECT,o)}}))},t.prototype.removeAnimInTransaction=function(e){var t=this;if(!e)return-1;var o=-1;return this._transaction((function(){t._removeSingleAnim(void 0,e),o=t._rebuildAllTn()})),o},t.prototype.removeShapesAnimInTransaction=function(e){var t=this,o=-1;return this._transaction((function(){e.forEach((function(e){t._removeSingleAnim(e,void 0)})),o=t._rebuildAllTn()})),o},t.prototype.moveAnimTnInTransaction=function(e,t){var o=this;this._transaction((function(){var r=o._getTnDescendantsList(),n=r[e];r.splice(e,1),r.splice(t,0,n),o._rebuildTimeRootNode(r)}))},t.prototype.modifyAnimInTransaction=function(e,t){for(var o,r=this,n=this._getTnDescendantsList(),i=0;i<n.length;i++){var a=n[i];if(a===e){o=a;break}}o||c(!1),t.animType&&t.animType!=o.animType()?o.setAnimType(t.animType,!0):void 0!==t.delay?o.setDelay(t.delay,!0):t.duration?o.setDur(t.duration,!0):t.subType?o.setSubType(t.subType,!0):t.by&&o.setBy(t.by,!0),t.nodeType&&t.nodeType!=o.nodeType&&s.transaction((function(){o.setNodeType(t.nodeType,!0),r._transaction((function(){r._rebuildAllTn()}))}))},t.prototype._rebuildAllTn=function(){var e=performance.now(),t=this._getTnDescendantsList();this._rebuildTimeRootNode(t);var o=performance.now();return console.debug("rebuildTimeRoot:"+(o-e)+"ms"),t.length},t.prototype._getTnDescendantsList=function(){var e=new Array;return this.tmRoot.mainSeqTn().clickTnList().forEach((function(t){t.startTnList().forEach((function(t){t.animTnList().forEach((function(t){t&&e.push(t)}))}))})),e},t.prototype._rebuildTimeRootNode=function(e){for(var t=this.tmRoot.mainSeqTn(),o=t.childTnLst?t.childTnLst:[],r=o.length,n=0;n<r;n++)o.pop();for(n=0;n<e.length;n++){var i=e[n];i.nodeType==d.NodeType.CLICK_EFFECT||0==n?t.createNewClickTn().createNewStartTn().pushNewAnimTn(i):i.nodeType==d.NodeType.WITH_EFFECT?t.lastClickTn().lastStartTn().pushNewAnimTn(i):i.nodeType==d.NodeType.AFTER_EFFECT&&t.lastClickTn().createNewStartTn().pushNewAnimTn(i)}},t.prototype._createNewShapeAnim=function(e,t,o,r){var n=e.id,i=d.TimeNode.createNewAnimType(t,n);r&&(i.presetSubtype=r),i.parentNode=this,i.nodeType=o,o==d.NodeType.CLICK_EFFECT?this.tmRoot.mainSeqTn().createNewClickTn().createNewStartTn().pushNewAnimTn(i):o==d.NodeType.WITH_EFFECT?this.tmRoot.mainSeqTn().lastClickTn().lastStartTn().pushNewAnimTn(i):o==d.NodeType.AFTER_EFFECT&&this.tmRoot.mainSeqTn().lastClickTn().createNewStartTn().pushNewAnimTn(i)},t.prototype._removeSingleAnim=function(e,t){this.tmRoot.mainSeqTn().clickTnList().forEach((function(o){o.startTnList().forEach((function(o){for(var r=o.childTnLst?o.childTnLst:[],n=r.length-1;n>=0;n--){var i=r[n]&&r[n].cTn;e?i&&e.id==i.spId()&&r.splice(n,1):t&&i&&t.id==i.id&&r.splice(n,1)}}))}))},t}(i.BaseComponent);t.Timing=u},"./component/uploadAssetManager.ts":
/*!*****************************************!*\
  !*** ./component/uploadAssetManager.ts ***!
  \*****************************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(/*! ../network/services/api */"./network/services/api.ts"),n=function(){function e(e,t,o){this.file=e,this.sucCallback=t,this.errCallback=o}return e.prototype.run=function(){r.uploadImage(this.file,this.sucCallback,this.errCallback)},e}(),i=function(){function e(){this.MAX_RUNING_COUNT=5,this.uploadImageTaskList=new Array,this.runningTaskCount=0}return e.prototype.upload=function(e,t,o){var r=this;try{if(null===e)o&&o("file is null");else{var i=new n(e,(function(e){t&&t(e),r.taskFinish()}),(function(e){o&&o(e),r.taskFinish()}));this.runningTaskCount<this.MAX_RUNING_COUNT?this.runTask(i):this.uploadImageTaskList.push(i)}}catch(e){console.error("UploadAssetManager_upload"+e)}},e.prototype.taskFinish=function(){try{if(this.runningTaskCount--,this.uploadImageTaskList.length>0&&this.runningTaskCount<this.MAX_RUNING_COUNT)for(var e=this.MAX_RUNING_COUNT-this.runningTaskCount,t=0;t<e;t++){var o=this.uploadImageTaskList.shift();o&&this.runTask(o)}}catch(e){console.error("UploadAssetManager_taskFinish"+e)}},e.prototype.runTask=function(e){e&&(e.run(),this.runningTaskCount++)},e}(),a=function(){this.ImageUploader=new i};t.default=a},"./constants/changeset-constants.guard.ts":
/*!************************************************!*\
  !*** ./constants/changeset-constants.guard.ts ***!
  \************************************************/
/*! no static exports found */function(e,t,o){"use strict";function r(e,t){return!("object"!=typeof e||"string"!=typeof e.op||"string"!=typeof e.path||void 0!==e.from&&"string"!=typeof e.from||void 0!==e.target&&"string"!=typeof e.target||void 0!==e.tid&&"string"!=typeof e.tid||void 0!==e.pid&&"string"!=typeof e.pid||void 0!==e.fid&&"string"!=typeof e.fid)}function n(e,t){return Array.isArray(e)&&e.every((function(e){return r(e)}))&&(void 0===e.object||"object"==typeof e.object)}Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeSet=t.isPatch=t.isOperation=void 0,t.isOperation=r,t.isPatch=n,t.isChangeSet=function(e,t){return Array.isArray(e)&&e.every((function(e){return n(e)}))}},"./constants/changeset-constants.ts":
/*!******************************************!*\
  !*** ./constants/changeset-constants.ts ***!
  \******************************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommitErrorCause=t.ChangeSetApplyFailed=t.ChangeSetTerminal=t.ChangeSetProcess=t.ChangeSetSource=t.ChangeSetState=void 0,function(e){e[e.New=0]="New",e[e.Sending=1]="Sending",e[e.Failed=2]="Failed",e[e.Sended=3]="Sended",e[e.Offline=4]="Offline"}(t.ChangeSetState||(t.ChangeSetState={})),function(e){e[e.Unknown=0]="Unknown",e[e.Operation=1]="Operation",e[e.UndoRedo=2]="UndoRedo",e[e.Customize=3]="Customize"}(t.ChangeSetSource||(t.ChangeSetSource={})),function(e){e[e.Unknown=0]="Unknown",e[e.SendFailed=1]="SendFailed",e[e.Conflict=2]="Conflict",e[e.Offline=3]="Offline"}(t.ChangeSetProcess||(t.ChangeSetProcess={})),function(e){e[e.Unknown=0]="Unknown",e[e.ServerAccept=1]="ServerAccept",e[e.ServerRefuse=2]="ServerRefuse",e[e.ConflictRemove=3]="ConflictRemove",e[e.OfflineDuplicate=4]="OfflineDuplicate",e[e.Exception=5]="Exception",e[e.NetworkError=6]="NetworkError"}(t.ChangeSetTerminal||(t.ChangeSetTerminal={})),function(e){e[e.Unknown=0]="Unknown",e[e.ApplyNewChanges=1]="ApplyNewChanges",e[e.ConflictUndo=2]="ConflictUndo",e[e.ConflictApplyRemote=3]="ConflictApplyRemote",e[e.ConflictIndex=4]="ConflictIndex",e[e.ConflictRevert=5]="ConflictRevert",e[e.ConflictRedo=6]="ConflictRedo",e[e.Offline=7]="Offline"}(t.ChangeSetApplyFailed||(t.ChangeSetApplyFailed={})),function(e){e[e.Default=0]="Default",e[e.ServerRefuse=1]="ServerRefuse"}(t.CommitErrorCause||(t.CommitErrorCause={}))},"./event/event.ts":
/*!************************!*\
  !*** ./event/event.ts ***!
  \************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.cache={}}return e.prototype.on=function(e,t){var o=this;return this.cache[e]||(this.cache[e]=[]),this.cache[e].push(t),function(){o.off(e,t)}},e.prototype.off=function(e,t){if(this.cache[e])if(t)for(var o=this.cache[e].length;o>=0;o--)this.cache[e][o]===t&&this.cache[e].splice(o,1);else this.cache[e]=[]},e.prototype.emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var r=[];if(Object.assign(r,this.cache[e]),r&&r.length)for(var n=0;n<r.length;n++)try{r[n].apply(null,t)}catch(e){throw e}},e}();t.default=r},"./index.ts":
/*!******************!*\
  !*** ./index.ts ***!
  \******************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UploadManager=t.Store=t.SlideApp=t.initialize=t.ComponentsType=void 0;var n=r(o(/*! ./app/slide-app */"./app/slide-app.ts")),i=r(o(/*! ./component/uploadAssetManager */"./component/uploadAssetManager.ts")),a=r(o(/*! ./common/log-utils */"./common/log-utils.ts")),l=o(/*! ./component */"./component/index.ts");Object.defineProperty(t,"Presentation",{enumerable:!0,get:function(){return l.Presentation}}),Object.defineProperty(t,"Slide",{enumerable:!0,get:function(){return l.Slide}}),Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return l.Layout}}),Object.defineProperty(t,"Master",{enumerable:!0,get:function(){return l.Master}}),Object.defineProperty(t,"Shape",{enumerable:!0,get:function(){return l.Shape}}),Object.defineProperty(t,"Picture",{enumerable:!0,get:function(){return l.Picture}}),Object.defineProperty(t,"GroupShape",{enumerable:!0,get:function(){return l.GroupShape}}),Object.defineProperty(t,"Connector",{enumerable:!0,get:function(){return l.Connector}}),Object.defineProperty(t,"Table",{enumerable:!0,get:function(){return l.Table}}),t.ComponentsType={SLIDE:"slide",SHAPE:"shape",PICTURE:"pic",GROUPSHAPE:"groupShape",CONNECTOR:"cxnSp",TABLE:"graphFrame_Tbl",MASTER:"master",LAYOUT:"layout"};t.initialize=function(e){t.SlideApp||(e&&(a.default.tdw=e.tdw),t.SlideApp=new n.default,t.SlideApp.initialize(),t.SlideApp.initializeWebSocket(),t.Store=t.SlideApp.presentationStore,t.UploadManager=new i.default)};var s=o(/*! ./app/slide-app */"./app/slide-app.ts");Object.defineProperty(t,"App",{enumerable:!0,get:function(){return s.App}});var c=o(/*! ./common/transaction */"./common/transaction.ts");Object.defineProperty(t,"transaction",{enumerable:!0,get:function(){return c.transaction}})},"./middlebridge/core.ts":
/*!******************************!*\
  !*** ./middlebridge/core.ts ***!
  \******************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=window,n={window:r,document:r.document,clientVars:r.clientVars};t.default=n},"./network/constants/cgiPath.ts":
/*!**************************************!*\
  !*** ./network/constants/cgiPath.ts ***!
  \**************************************/
/*! no static exports found */function(e,t,o){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.PDF_SUPPORTS=t.DOC_HUMTRANS=t.CHECK_THUMBNAIL_STATE=t.UPLOAD_THUMBNAIL=t.DOC_RECOVER=t.DOC_INFO=t.SUPPORT_TOKEN=t.EXPORT_FILE=t.EXPORT_SLIDE_TO_PC=t.EXPORT_SLIDE=t.REVERT=t.GET_VERSION=t.GET_SLIDE=t.GET_HISTORY=t.SAVE_TEMP=t.CREATEDOC_NEW=t.CLEAR_NOTIFY_NUMBERS=t.GET_NOTIFY_NUMBERS=t.GET_AUTH_APPLY_CHECK=t.GET_AUTH_EXP=t.GET_USER_AVATAR_MARKNAME=t.USER_INFO=t.DOC_CHANGE_TITLE=t.SET_AUTH_INFO=t.GET_AUTH_INFO=t.POST_LOCAL=t.GET_CHANGES=t.GET_DATA=void 0;var n="//docs.qq.com/";t.GET_DATA="GET_DATA",t.GET_CHANGES="GET_CHANGES",t.POST_LOCAL="POST_LOCAL",t.GET_AUTH_INFO="GET_AUTH_INFO",t.SET_AUTH_INFO="SET_AUTH_INFO",t.DOC_CHANGE_TITLE="SET_AUTH_INFO",t.USER_INFO="USER_INFO",t.GET_USER_AVATAR_MARKNAME="GET_USER_AVATAR_MARKNAME",t.GET_AUTH_EXP="GET_AUTH_EXP",t.GET_AUTH_APPLY_CHECK="GET_AUTH_APPLY_CHECK",t.GET_NOTIFY_NUMBERS="GET_NOTIFY_NUMBERS",t.CLEAR_NOTIFY_NUMBERS="CLEAR_NOTIFY_NUMBERS",t.CREATEDOC_NEW="CREATEDOC_NEW",t.SAVE_TEMP="SAVE_TEMP",t.GET_HISTORY="GET_HISTORY",t.GET_SLIDE="GET_SLIDE",t.GET_VERSION="GET_VERSION",t.REVERT="REVERT",t.EXPORT_SLIDE="EXPORT_SLIDE",t.EXPORT_SLIDE_TO_PC="EXPORT_SLIDE_TO_PC",t.EXPORT_FILE="EXPORT_FILE",t.SUPPORT_TOKEN="SUPPORT_TOKEN",t.DOC_INFO="DOC_INFO",t.DOC_RECOVER="DOC_RECOVER",t.UPLOAD_THUMBNAIL="UPLOAD_THUMBNAIL",t.CHECK_THUMBNAIL_STATE="CHECK_THUMBNAIL_STATE",t.DOC_HUMTRANS="DOC_HUMTRANS",t.PDF_SUPPORTS="PDF_SUPPORTS";var i=((r={})[t.GET_DATA]=n+"dop-api/slide/data/get",r[t.GET_CHANGES]=n+"dop-api/get/changes",r[t.POST_LOCAL]=n+"ep/api/attach_local",r[t.GET_AUTH_INFO]=n+"cgi-bin/online_docs/auth_info/get",r[t.SET_AUTH_INFO]=n+"cgi-bin/online_docs/auth_info/set",r[t.DOC_CHANGE_TITLE]=n+"cgi-bin/online_docs/doc_changetitle",r[t.USER_INFO]=n+"cgi-bin/online_docs/user_info",r[t.GET_USER_AVATAR_MARKNAME]=n+"sdc/getusermarkname",r[t.GET_AUTH_EXP]=n+"cgi-bin/online_docs/auth_exp/get",r[t.GET_AUTH_APPLY_CHECK]=n+"cgi-bin/online_docs/auth_apply/check",r[t.GET_NOTIFY_NUMBERS]=n+"cgi-bin/online_docs/notify_getnum",r[t.CLEAR_NOTIFY_NUMBERS]=n+"cgi-bin/online_docs/user_flag/setRedDot",r[t.CREATEDOC_NEW]=n+"cgi-bin/online_docs/createdoc_new",r[t.SAVE_TEMP]=n+"cgi-bin/template/mytemplate_add",r[t.GET_HISTORY]=n+"dop-api/get/history",r[t.GET_SLIDE]=n+"dop-api/get/slide",r[t.GET_VERSION]=n+"cgi-go/padinfo/get_version_record",r[t.REVERT]=n+"dop-api/revert",r[t.EXPORT_SLIDE_TO_PC]=n+"cgi-go/common-notify/view",r[t.EXPORT_SLIDE]=n+"cgi-bin/redirect/{creatorDomain}/ep/pad/slide/exportslide/",r[t.EXPORT_FILE]=n+"ep/pad/slide/exportfile/",r[t.SUPPORT_TOKEN]=n+"cgi-bin/online_docs/support_gettoken",r[t.DOC_INFO]=n+"cgi-bin/online_docs/doc_info",r[t.DOC_RECOVER]=n+"cgi-bin/online_docs/doc_recover",r[t.UPLOAD_THUMBNAIL]=n+"sdc/upload_thumbnail",r[t.CHECK_THUMBNAIL_STATE]=n+"sdc/check_thumbnail_status",r[t.DOC_HUMTRANS]=n+"cgi-bin/online_docs/doc_humtrans",r.CREATE_SHOW=n+"dop-api/get/createshow",r.GET_SHOW=n+"dop-api/get/getshow",r.GET_PPT_DATA=n+"dop-api/slide/data/get",r[t.PDF_SUPPORTS]=n+"cgi-bin/banner/banner_get",r);t.default=i},"./network/services/api.ts":
/*!*********************************!*\
  !*** ./network/services/api.ts ***!
  \*********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.hasOwnProperty.call(e,o)&&r(t,e,o);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pdfSupports=t.loadPPTData=t.getShow=t.createShow=t.onResponseError=t.onResponseUse=t.onRequestError=t.onRequestUse=t.transDocVisible=t.checkThumbnailState=t.uploadSlideThumbnail=t.recoverDoc=t.getDocInfo=t.getUserReportToken=t.exportSlideToPC=t.exportSlide=t.loadImage=t.revert=t.getVersion=t.getHistorySlide=t.getHistory=t.saveTemp=t.createDocNew=t.clearNotifyNumbers=t.getNotifyNumbers=t.checkIsApplyIn24H=t.getAuthExpTime=t.getAvatarRemark=t.getUserInfo=t.updateTitle=t.setAuthInfo=t.getAuthInfo=t.uploadImage=t.fetchChanges=t.fetchSlideData=void 0;var l=i(o(/*! ../constants/cgiPath */"./network/constants/cgiPath.ts")),s=a(o(/*! axios */"../node_modules/axios/index.js")),c=o(/*! ./utils */"./network/services/utils.ts"),d=o(/*! ../../ */"./index.ts");t.fetchSlideData=function(e){return s.default.get(l.default.GET_DATA+"?id="+e)},t.fetchChanges=function(e,t,o,r){var n=o?"&to="+o:"";return s.default.get(l.default[l.GET_CHANGES]+"?padId="+e+"&from="+t+n+"&xsrf="+c.getXSRF(),{timeout:r})},t.uploadImage=function(e,t,o){var r=""+l.default[l.POST_LOCAL],n=new FormData;n.append("file",e),s.default.post(r,n,{responseType:"json"}).then((function(e){var o=e.data.url;console.log("uploadImage_url"+o),t&&t(o)})).catch((function(e){console.log(e),o&&o(e)}))},t.getAuthInfo=function(e,t){return s.default.get(l.default[l.GET_AUTH_INFO]+"?localPadId="+e+"&type=1&ver=2&domain="+t+"&xsrf="+c.getXSRF())},t.setAuthInfo=function(e,t,o){return s.default.post(l.default[l.SET_AUTH_INFO]+"?localPadId="+e+"&type=1&ver=2&domain="+t+"&data="+JSON.stringify(o)+"&xsrf="+c.getXSRF())},t.updateTitle=function(e,t,o){return s.default.post(l.default[l.DOC_CHANGE_TITLE]+"?pad_id="+o+"&type=1&ver=2&domain_id="+t+"&xsrf="+c.getXSRF()+"&version=2&auto_change=0&title="+encodeURIComponent(e))},t.getUserInfo=function(e){return e?s.default.get(l.default[l.USER_INFO]+"?xsrf="+c.getXSRF()+"&only_check=1"):s.default.get(l.default[l.USER_INFO]+"?xsrf="+c.getXSRF())},t.getAvatarRemark=function(e,t,o,r){if(!o||o.length<=0||!r||r.length<=0)t&&t(!1);else{for(var n="[",i=0;i<e.length;i++){var a=e.length===i+1?"":",";n=n+e[i]+a,console.log("getRemarkByCGI i = "+i+" uid = "+e[i])}n+="]";var d=l.default[l.GET_USER_AVATAR_MARKNAME]+"?tag="+r+"&bkn="+c.getBkn()+"&domainId="+o+"&localPadId="+r+"&uids="+encodeURIComponent(n)+"&xsrf="+c.getXSRF();s.default.get(d,{responseType:"json",withCredentials:!0}).then((function(e){var o=e.data;0===o.retcode?t&&t(o.result):t&&t(!1)})).catch((function(e){console.log(e),t&&t(!1)}))}},t.getAuthExpTime=function(e,t){return s.default.get(l.default[l.GET_AUTH_EXP]+"?domainId="+e+"&localPadId="+t+"&xsrf="+c.getXSRF())},t.checkIsApplyIn24H=function(e,t){return s.default.get(l.default[l.GET_AUTH_APPLY_CHECK]+"?domainId="+e+"&localPadId="+t+"&xsrf="+c.getXSRF()+"&bkn="+c.getBkn())},t.getNotifyNumbers=function(){return s.default.get(l.default[l.GET_NOTIFY_NUMBERS]+"?&xsrf="+c.getXSRF()+"&bkn="+c.getBkn())},t.clearNotifyNumbers=function(){return s.default.post(l.default[l.CLEAR_NOTIFY_NUMBERS]+"?&xsrf="+c.getXSRF()+"&bkn="+c.getBkn()+"&type=8&flag=0")},t.createDocNew=function(e,t,o,r){var n=new FormData;return n.append("domain_id",e),n.append("title",o),n.append("create_type",""+r),n.append("pad_id",t),n.append("xsrf",c.getXSRF()),s.default.post(""+l.default[l.CREATEDOC_NEW],n,{timeout:3e4})},t.saveTemp=function(e,t,o){var r=new FormData;return r.append("domain_id",e),r.append("title",o),r.append("pad_id",t),r.append("xsrf",c.getXSRF()),s.default.post(""+l.default[l.SAVE_TEMP],r)},t.getHistory=function(e,t){return s.default.get(l.default[l.GET_HISTORY]+"?padId="+e+"&page="+t+"&timestamp="+(new Date).getTime()+"&xsrf="+c.getXSRF())},t.getHistorySlide=function(e,t,o){return s.default.get(l.default[l.GET_SLIDE]+"?padId="+e+"&rev="+t+"&fRev="+o+"&timestamp="+(new Date).getTime()+"&xsrf="+c.getXSRF())},t.getVersion=function(e,t,o){return s.default.get(l.default[l.GET_VERSION]+"?globalPadId="+e+"&page="+t+"&limit="+o+"&xsrf="+c.getXSRF())},t.revert=function(e,t,o,r){return void 0===r&&(r=0),s.default.get(l.default[l.REVERT]+"?padId="+e+"&rev="+t+"&v="+o+"&xsrf="+c.getXSRF(),{timeout:r})},t.loadImage=function(e){return s.default.get(e,{responseType:"blob"})},t.exportSlide=function(e,t){var o=(""+l.default[l.EXPORT_SLIDE]).replace("{creatorDomain}",t)+e,r=new FormData;return r.append("xsrf",c.getXSRF()),r.append("v","2"),s.default.post(o,r)},t.exportSlideToPC=function(e){var t=""+l.default[l.EXPORT_SLIDE_TO_PC],o=new FormData;return o.append("xsrf",c.getXSRF()),o.append("padId",e),s.default.post(t,o)},t.getUserReportToken=function(e,t){var o=new FormData;return o.append("domain_id",e),o.append("pad_id",t),o.append("xsrf",c.getXSRF()),o.append("dataType",d.SlideApp&&"form"===d.SlideApp.docStore.padType?"1":"0"),s.default.post(""+l.default[l.SUPPORT_TOKEN],o)},t.getDocInfo=function(e,t){return s.default.get(l.default[l.DOC_INFO]+"?domainId="+e+"&localPadId="+t+"&getCollected=1&getIsAddedMy=1")},t.recoverDoc=function(e,t){var o=new FormData;return o.append("domain_id",e),o.append("pad_id",t),o.append("xsrf",c.getXSRF()),s.default.post(""+l.default[l.DOC_RECOVER],o)},t.uploadSlideThumbnail=function(e,t,o){var r=""+l.default[l.UPLOAD_THUMBNAIL],n=new FormData;return n.append("file",o),n.append("padId",e),n.append("version",""+t),s.default.post(r,n)},t.checkThumbnailState=function(e,t){var o=l.default[l.CHECK_THUMBNAIL_STATE]+"?padId="+e+"&version="+t;return s.default.post(o,{responseType:"json"})},t.transDocVisible=function(e,t,o){void 0===o&&(o=0);var r=new FormData;return r.append("domain_id",e),r.append("pad_id",t),r.append("xsrf",c.getXSRF()||""),s.default.post(""+l.default[l.DOC_HUMTRANS],r,{timeout:o})},t.onRequestUse=function(e){var t=c.generateUUID();e.data||(e.data=new FormData),e.data.req_tag=t,e.data.req_ts=(new Date).getTime();var o={req:{url:c.getShortUrlPath(e.url,!0),tag:t}},r=JSON.stringify(o);return window.log.info(r),e},t.onRequestError=function(e){return Promise.reject(e)},s.default.interceptors.request.use(t.onRequestUse,t.onRequestError),t.onResponseUse=function(e){var t={res:{cgicode:e.data.cgicode,retcode:e.data.retcode,msg:e.data.msg,status:e.status,tc:(new Date).getTime()-e.config.data.req_ts+"ms",tag:e.config.data.req_tag,user_id:d.SlideApp&&d.SlideApp.docStore&&d.SlideApp.docStore.userId,url:c.getShortUrlPath(e.config.url,!1)}},o=JSON.stringify(t);return void 0!==e.data.cgicode&&void 0!==e.data.retcode?(11e3===e.data.cgicode&&11e3===e.data.retcode&&d.SlideApp&&d.SlideApp.event.emit("pskeyError"),0!==e.data.cgicode||0!==e.data.retcode?window.log.error(o):window.log.info(o)):window.log.info(o),e},t.onResponseError=function(){return function(e){var t={res:{status:e.response?e.response.status:0,tc:(new Date).getTime()-e.config.data.req_ts+"ms",tag:e.config.data.req_tag,user_id:d.SlideApp&&d.SlideApp.docStore&&d.SlideApp.docStore.userId,url:c.getShortUrlPath(e.config.url,!1)}},o=JSON.stringify(t);return window.log.error(o),Promise.reject(e)}},s.default.interceptors.response.use(t.onResponseUse,t.onResponseError),t.createShow=function(e){var t=l.default.CREATE_SHOW+"?id="+e;(new FormData).append("id",e);var o={id:e};return s.default.post(t,o,{responseType:"json"})},t.getShow=function(e){return s.default.get(l.default.GET_SHOW+"?id="+e)},t.loadPPTData=function(e,t){return s.default.get(l.default.GET_PPT_DATA+"?id="+t+"&roomId="+e)},t.pdfSupports=function(e){return s.default.get(l.default[l.PDF_SUPPORTS]+"?act_id="+e+"&page_id=9999")}},"./network/services/utils.ts":
/*!***********************************!*\
  !*** ./network/services/utils.ts ***!
  \***********************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUUID=t.convertFormData2Json=t.getShortUrlPath=t.getBkn=t.getXSRF=void 0;var r=o(/*! steamer-browserutils */"../node_modules/steamer-browserutils/dist/index.umd.js");t.getXSRF=function(){return r.getCookie("TOK")},t.getBkn=function(){var e=r.getCookie("skey"),t=0,o=5381;if(e){for(;0>t;++t)o+=(o<5)+e.charAt(t).charCodeAt(0);return 2147483647&o}},t.getShortUrlPath=function(e,t){if(!e||e.length<=0)return"";var o=0;e.indexOf("docs.qq.com")>=0&&(o=14);var r=e.indexOf("?");return t?e.substring(o,e.length):e.substring(o,r>o?r:e.length)},t.convertFormData2Json=function(e){var t,o={};try{e.forEach&&e.forEach((function(e,t){o[t]=e.length>50?e.substring(.5):e})),t=JSON.stringify(o)}catch(e){}return t},t.generateUUID=function(){var e=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(e+=performance.now());var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)}));return t.substring(0,6)}},"./network/socket/socket.ts":
/*!**********************************!*\
  !*** ./network/socket/socket.ts ***!
  \**********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(o(/*! ../../middlebridge/core */"./middlebridge/core.ts")),i=r(o(/*! ../../common/log-utils */"./common/log-utils.ts")),a=o(/*! @tencent/docs_collabroom */"@tencent/docs_collabroom"),l=function(){function e(e){void 0===e&&(e=null),this.messageHandler=e||null,this.handlers={NEW_CHANGES:this.handleNewChanges.bind(this),USER_NEWINFO:this.handleUserNewInfo.bind(this),USER_LEAVE:this.handleUserLeave.bind(this),CURSOR_MESSAGE:this.handleCursorMessage.bind(this),RIGHT_MESSAGE:this.handleRightMessage.bind(this),TITLE_MESSAGE:this.handleTitleMessage.bind(this),HANDLE_DELETE:this.handleDeletePad.bind(this),COMM_NOTICE:this.handleCommonNotice.bind(this),CODEREV_NEW:this.handleCodeRevNew.bind(this),LAST_REVERSION:this.handleLastRevision.bind(this),REVERT_MESSAGE:this.handleRevertMessage.bind(this),ALL_LOCK_INFO:this.handleLockMessage.bind(this),UNLOCK_INFO:this.handleUnlockMessage.bind(this),LIVE_MESSAGE:this.handleLiveMessage.bind(this),COMMERCIALIZE_MESSAGE:this.handleCommercializeMessage.bind(this),MARK_MESSAGE:this.handleWatermarkMessage.bind(this)},n.default.window.WebSocket&&n.default.window.WebSocket.prototype&&n.default.window.WebSocket.prototype.send}return e.prototype.handleOnRoomClose=function(e){i.default.info("[socket] ICollabRoomCallback - handleOnRoomClose has closed reason:",e)},e.prototype.handleOnRoomOpen=function(){i.default.info("[socket] ICollabRoomCallback - handleOnRoomOpen")},e.prototype.onNetReconnectedFail=function(){i.default.info("[socket] ICollabRoomCallback - onNetReconnectedFail")},e.prototype.report=function(e){i.default.log("[socket] ICollabRoomCallback - report:",e)},e.prototype.handleOnRoomShutDown=function(e){var t=parseInt(e.errCode,10);this.handleSocketShutDown(e.reason,isNaN(t)?0:t)},e.prototype.handleOnRoomStateChange=function(e,t){this.handleRoomStateChange(e,t)},e.prototype.handleOnReceivMsgFromServer=function(e,t){this.handleMessageFromServer(e,t)},e.prototype.getHeaderGeneralPacket=function(){return this.getHeaderGeneralPacketSocket()},e.prototype.getPadRev=function(){return this.getPadRevSocket()},e.prototype.open=function(e,t){var o=this;this.client=new a.CollabRoomChannel({callback:this,serverVars:e,userid:t,moduleTag:"slide"}),n.default.window.addEventListener("unload",(function(){i.default.error("[socket] unload"),o.client&&o.client.shutDown({reason:"unload",shutDown:!0})})),this.client.open()},e.prototype.close=function(e){var t={reason:e,shutDown:!0};this.client&&this.client.shutDown(t)},Object.defineProperty(e.prototype,"opened",{get:function(){return!!this.client&&!!this.client},enumerable:!1,configurable:!0}),e.prototype.sendMessage=function(e,t,o,r,n,i){return void 0===r&&(r={}),this.client&&this.client.sendMessageWaitAcceptCmd(e,t,o,r,n,i)},e.prototype.cancelMessageBySeq=function(e){this.client&&this.client.cancelMessageBySeq(e)},Object.defineProperty(e.prototype,"roomState",{get:function(){return this.client&&this.client.getRoomState()},enumerable:!1,configurable:!0}),e.prototype.handleMessageFromServer=function(e,t){this.messageHandler&&this.messageHandler.handleMessageFromServer&&this.messageHandler.handleMessageFromServer(e,t);var o=this.handlers[e];i.default.info("[socket] handleMessageFromServer. type:",e),o&&o(t)},e.prototype.handleRoomStateChange=function(e,t){i.default.log("[socket] room state change to "+e);var o=e.toUpperCase();"RECONNECTING_IN_CLOSED"===o?this.handleOffline(t):"OPENED"===o&&this.handleOnline(t)},e.prototype.handleSocketOpen=function(){},e.prototype.handleSocketShutDown=function(e,t){var o,r;"unload"!==e?(i.default.info("[socket] shutdown "+e),null===(r=null===(o=this.messageHandler)||void 0===o?void 0:o.handleShutDown)||void 0===r||r.call(o,e,t)):i.default.error("[socket] handleSocketShutDown unload : "+e)},e.prototype.getPadRevSocket=function(){return this.messageHandler&&this.messageHandler.getPadRevision?this.messageHandler.getPadRevision():0},e.prototype.getHeaderGeneralPacketSocket=function(){var e={};window.__globalRavenReleaseVersion&&(e.rel_rev=window.__globalRavenReleaseVersion);var t=this.messageHandler;return e.right_tag=t&&t.privilege.editable?1:0,e},e.prototype.handleOnline=function(e){i.default.info("[socket] online"),this.messageHandler&&this.messageHandler.handleOnline&&this.messageHandler.handleOnline()},e.prototype.handleOffline=function(e){i.default.info("[socket] offline: "+e),this.messageHandler&&this.messageHandler.handleOffline&&this.messageHandler.handleOffline()},e.prototype.handleNewChanges=function(e){i.default.info("[socket] handle new changes"),this.messageHandler&&this.messageHandler.handleNewChanges&&this.messageHandler.handleNewChanges(e)},e.prototype.handleUserNewInfo=function(e){i.default.info("[socket] handle new user info");var t=e&&e.body&&e.body.notice;this.messageHandler&&this.messageHandler.handleUserEnter&&this.messageHandler.handleUserEnter(t)},e.prototype.handleUserLeave=function(e){i.default.info("[socket] handle user leave");var t=e&&e.body&&e.body.notice;this.messageHandler&&this.messageHandler.handleUserLeave&&this.messageHandler.handleUserLeave(t)},e.prototype.handleCursorMessage=function(e){i.default.info("[socket] handle cursor message");var t=e&&e.body&&e.body.notice;this.messageHandler&&this.messageHandler.handleCursorMessage&&this.messageHandler.handleCursorMessage(t)},e.prototype.handleRightMessage=function(e){i.default.info("[socket] handle right message");var t=e&&e.body&&e.body.notice;this.messageHandler&&this.messageHandler.handleRightMessage&&this.messageHandler.handleRightMessage(t)},e.prototype.handleTitleMessage=function(e){i.default.info("[socket] handle title message");var t=e&&e.body&&e.body.notice&&e.body.notice.title;this.messageHandler&&this.messageHandler.handleTitleMessage&&this.messageHandler.handleTitleMessage(t)},e.prototype.handleDeletePad=function(e){i.default.info("[socket] handle delete pad"),this.messageHandler&&this.messageHandler.handleDeletePad&&this.messageHandler.handleDeletePad()},e.prototype.handleCommonNotice=function(e){if(e&&e.body&&e.body.notice){var t=e.body.notice,o=e.body.notice.type;"push_message"===o?this.handlePushMessage(t):"RELOAD"===o&&this.handleReloadMessage(t)}},e.prototype.handlePushMessage=function(e){if(e&&e.message){var t=JSON.parse(e.message),o=t.type;"unbind"===o||"wl"===o&&n.default.window.log&&n.default.window.log.ws&&n.default.window.log.ws(t)}},e.prototype.handleReloadMessage=function(e){},e.prototype.handleCodeRevNew=function(e){if(e&&e.body&&e.body.notice){var t=e.body.notice,o=t.code_ver,r=t.gray;i.default.info("[socket] code rev new. code_ver: "+o+", gray: "+r)}},e.prototype.handleLastRevision=function(e){var t=e&&e.body&&e.body.notice&&e.body.notice.lastRev;i.default.info("[socket] handle last revision: "+t),this.messageHandler&&this.messageHandler.handleLastRevision&&this.messageHandler.handleLastRevision(t)},e.prototype.handleRevertMessage=function(e){i.default.info("[socket] handle revert message"),this.messageHandler&&this.messageHandler.handleRevertMessage&&this.messageHandler.handleRevertMessage(e)},e.prototype.handleLockMessage=function(e){i.default.info("[socket] handle lock"),e&&e.body&&e.body.notice&&this.messageHandler&&this.messageHandler.handleLock&&this.messageHandler.handleLock(e.body.notice)},e.prototype.handleUnlockMessage=function(e){i.default.info("[socket] handle unlock"),e&&e.body&&e.body.notice&&this.messageHandler&&this.messageHandler.handleUnlock&&this.messageHandler.handleUnlock(e.body.notice)},e.prototype.handleLiveMessage=function(e){i.default.info("[socket] handle live message"),e&&this.messageHandler&&this.messageHandler.handleLiveNotice&&this.messageHandler.handleLiveNotice(e)},e.prototype.handleCommercializeMessage=function(e){i.default.info("[socket] handleCommercializeMessage");var t=function(){window.CollaboratorListInit?(document.dispatchEvent(new CustomEvent("commercializeMessage",{detail:e})),i.default.info("[socket] handleCommercializeMessage trigger")):setTimeout((function(){t()}),3e3)};window.CollaboratorListInit?document.dispatchEvent(new CustomEvent("commercializeMessage",{detail:e})):t()},e.prototype.handleWatermarkMessage=function(e){document.dispatchEvent(new CustomEvent("receiveWatermarkMessage",{detail:e}))},e}();t.default=l},"./plugin/compose.ts":
/*!***************************!*\
  !*** ./plugin/compose.ts ***!
  \***************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.composeInPatch=t.composeChangeset=t.composePatchByParent=t.composePatchBySameTarget=t.composePatch=t.compose=t.move=t.replace=t.remove=t.add=t.combine=t.match=t.OPC=t.Relation=void 0;var c,d,u=a(o(/*! ./compose */"./plugin/compose.ts")),p=a(o(/*! ../constants/changeset-constants.guard */"./constants/changeset-constants.guard.ts")),h=s(o(/*! lodash/get */"../node_modules/lodash/get.js"));function f(e,t){if(!e)throw new Error(t)}!function(e){e[e.equal=1]="equal",e[e.parent=2]="parent",e[e.forward=3]="forward",e[e.backward=4]="backward",e[e.none=5]="none"}(c=t.Relation||(t.Relation={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.AA=1]="AA",e[e.AD=2]="AD",e[e.AR=3]="AR",e[e.AM=4]="AM",e[e.DA=5]="DA",e[e.DD=6]="DD",e[e.DR=7]="DR",e[e.DM=8]="DM",e[e.RA=9]="RA",e[e.RD=10]="RD",e[e.RR=11]="RR",e[e.RM=12]="RM",e[e.MA=13]="MA",e[e.MD=14]="MD",e[e.MR=15]="MR",e[e.MM=16]="MM"}(d=t.OPC||(t.OPC={}));var m="add",y="remove",g="replace",v="move";function _(e,t){if(e===t)return c.equal;if(""===e||t.startsWith(e))return c.parent;var o=function(e,t,o){var r=parseInt(e.substring(t,o),10);return isNaN(r)?-1:r},r=e.lastIndexOf("/");if(r>-1){var n=r+1,i=o(e,n);if(i>-1&&t.startsWith(e.substring(0,n))){var a=t.indexOf("/",n),l=o(t,n,a>=0?a:void 0);if(l>-1)return i<=l?c.forward:c.backward}}return c.none}function b(e,t){return d.UNKNOWN,function(e){return e===g?d.RA:e===m?d.AA:e===y?d.DA:e===v?d.MA:(f(!1),d.UNKNOWN)}(t)+function(e){return e===g?2:e===m?0:e===y?1:e===v?3:(f(!1),-1)}(e)}t.match=_,t.combine=b,t.add=function(e,t){var o=_(e.path,t.path),n={merged:!1};switch(b(e.op,t.op)){case d.AR:o===c.equal?(n.merged=!0,n.value=r({},t),n.value.value=e.value):o===c.parent&&(n.merged=!0,n.value=r({},e));break;case d.AD:o===c.equal?n.merged=!1:o===c.parent&&(n.merged=!0,n.value=r({},e))}return n},t.remove=function(e,t){var o=_(e.path,t.path),n={merged:!1};switch(b(e.op,t.op)){case d.DR:o===c.parent&&(n.merged=!0,n.value=r({},e));break;case d.DA:o===c.equal&&(n.merged=!0,n.value=r({},t),n.value.op=g,n.value.value=e.value);break;case d.DD:o===c.parent&&(n.merged=!0,n.value=r({},e))}return n},t.replace=function(e,t){var o=_(e.path,t.path),n={merged:!1};switch(b(e.op,t.op)){case d.RR:o===c.equal?(n.merged=!0,n.value=r({},t),n.value.value=e.value):o===c.parent&&(n.merged=!0,n.value=r({},e));break;case d.RD:o!==c.equal&&o!==c.parent||(n.merged=!0,n.value=r({},e))}return n},t.move=function(e,t){var o=_(e.path,t.path),n={merged:!1};switch(b(e.op,t.op)){case d.MR:case d.MD:o===c.parent&&(n.merged=!0,n.value=r({},e))}return n},t.compose=function(e,t){var o;switch(f(p.isOperation(e),"op1 err"),f(p.isOperation(t),"op2 err"),t.op){case g:o=u.replace(e,t);break;case m:o=u.add(e,t);break;case y:o=u.remove(e,t);break;case v:o=u.move(e,t);break;default:f(!1)}return o.value&&(delete o.value.target,delete o.value.tid),o},t.composePatch=function(e,t){f(p.isPatch(e),JSON.stringify(e)),f(p.isPatch(t),JSON.stringify(e));var o=h.default(e,"[0].target"),r=h.default(t,"[0].target");f(void 0!==o),f(void 0!==r);var n=u.match(o,r),i={merged:!1};return n===c.equal?i=u.composePatchBySameTarget(e,t):n===c.parent&&(i=u.composePatchByParent(e,t)),i},t.composePatchBySameTarget=function(e,t){for(var o={merged:!1},r=h.default(t,"[0].target"),n=h.default(t,"[0].tid"),i=l(e),a=l(t);i.length&&a.length;){var s=i.shift(),c=a.pop(),d=u.compose(s,c);if(!d.merged){i.splice(0,0,s),a.push(c);break}o.merged=!0,d.value&&a.push(d.value)}if(o.merged&&i.length+a.length>0){o.value=a.concat(i);var p=o.value[0];p.tid=n,p.target=r}return o},t.composePatchByParent=function(e,t){var o={merged:!1},r=h.default(e,"[0].tid"),n=h.default(t,"[0].tid");return e.some((function(t){if(t.op===y||t.op===g){var i=r?r+"|"+t.pid:t.pid,a=u.match(i,n);a!==c.equal&&a!==c.parent||(o.merged=!0,o.value=l(e))}return o.merged})),o},t.composeChangeset=function(e,t){f(p.isChangeSet(e),JSON.stringify(e)),f(p.isChangeSet(t),JSON.stringify(t)),f(e.length>0),f(t.length>0);for(var o={merged:!1},r=l(e),n=l(t);r.length&&n.length;){var i=r.shift(),a=n.pop(),s=u.composePatch(i,a);if(!s.merged){r.splice(0,0,i),n.push(a);break}o.merged=!0,s.value&&r.splice(0,0,s.value)}return o.merged&&r.length+n.length>0&&(o.value=n.concat(r)),o},t.composeInPatch=function(e){f(p.isPatch(e));var t=[];return e.forEach((function(e){if(t.length){var o=t.pop(),r=u.compose(e,o);r.merged?r.value&&t.push(r.value):t.push(o,e)}else t.push(e)})),t}},"./report/reporter.ts":
/*!****************************!*\
  !*** ./report/reporter.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(o(/*! ../common/log-utils */"./common/log-utils.ts")),i=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts"),a=null,l={sendCount:0,sucCount:0,rejectCount:0,errorCount:0,records:[]};function s(){l.sendCount+=1}function c(){l.sendCount=0,l.sucCount=0,l.rejectCount=0,l.errorCount=0,l.records=[]}var d={increaseSendCount:s,addRecord:function(e){switch(e.terminal){case i.ChangeSetTerminal.ServerAccept:case i.ChangeSetTerminal.ConflictRemove:case i.ChangeSetTerminal.OfflineDuplicate:l.sucCount+=1;break;case i.ChangeSetTerminal.ServerRefuse:l.rejectCount+=1;break;default:l.errorCount+=1}s(),l.records.push(e)},clearRecords:c,startCommitReport:function e(){a=setTimeout((function(){var t=l.sendCount,o=l.sucCount,r=l.rejectCount,i=l.errorCount;if(0!==t||0!==o||0!==r){var a={opername:"quality_slide",module:"cs",action:"send_count",ver6:JSON.stringify({request:t,send:t,accept:o,reject:r,error:i})};n.default.tdw&&n.default.tdw(a),n.default.info("[report] cs commit count, request:"+t+" send:"+t+" accept:"+o+" reject:"+r+" error:"+i+" records:"+JSON.stringify(function(){var e=l.records.map((function(e){var t={};return t.source=e.source,e.track.length>0&&(t.track=e.track),void 0!==e.terminal&&(t.terminal=e.terminal),t}));return JSON.stringify(e)}())),c()}e()}),1e4)},stopCommitReport:function(){n.default.info("[report] stop cs commit"),clearTimeout(a),a=null},reportChangeSetApplyFailed:function(e){var t={opername:"quality_slide",module:"cs",action:"apply_failed",ver6:e};n.default.tdw&&n.default.tdw(t)}};t.default=d},"./store/changeset-manager.ts":
/*!************************************!*\
  !*** ./store/changeset-manager.ts ***!
  \************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.hasOwnProperty.call(e,o)&&n(t,e,o);return i(t,e),t},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.makeChangesetPack=t.EVENT_COMMIT_CS_SUCCEED=t.EVENT_PERSISTENT_CHANGESET_DID_RECOVER=t.EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID=t.EVENT_PERSISTENT_CHANGESET_ERROR=t.EVENT_PERSISTENT_CHANGESET_RESTORED=t.EVENT_PERSISTENT_CHANGESET_MODIFY=t.EVENT_PERSISTENT_CHANGESET_CHANGE=t.EVENT_PERSISTENT_CHANGESET_DELETION=t.EVENT_PERSISTENT_CHANGESET_ADDITION_OR_UPDATE_SEQ=void 0;var c=o(/*! ../index */"./index.ts"),d=a(o(/*! ./command-manager */"./store/command-manager.ts")),u=o(/*! ../common/utils */"./common/utils.ts"),p=o(/*! ../component */"./component/index.ts"),h=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),f=s(o(/*! ../common/log-utils */"./common/log-utils.ts")),m=s(o(/*! ../event/event */"./event/event.ts")),y=o(/*! shortid */"../node_modules/shortid/index.js"),g=s(o(/*! ../test/test */"./test/test.ts")),v=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts"),_=s(o(/*! ../report/reporter */"./report/reporter.ts")),b=o(/*! ../app/error-code */"./app/error-code.ts"),T=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts");Object.defineProperty(t,"ChangeSetState",{enumerable:!0,get:function(){return T.ChangeSetState}});var S=o(/*! ./offline-editor/persistent-manager */"./store/offline-editor/persistent-manager.ts"),C=s(o(/*! lodash/get */"../node_modules/lodash/get.js")),w=o(/*! ../plugin/compose */"./plugin/compose.ts"),E=(window._,"[ChangeSetManager]");t.EVENT_PERSISTENT_CHANGESET_ADDITION_OR_UPDATE_SEQ="EVENT_PERSISTENT_CHANGESET_ADDITION_OR_UPDATE_SEQ",t.EVENT_PERSISTENT_CHANGESET_DELETION="EVENT_PERSISTENT_CHANGESET_DELETION",t.EVENT_PERSISTENT_CHANGESET_CHANGE="EVENT_PERSISTENT_CHANGESET_CHANGE",t.EVENT_PERSISTENT_CHANGESET_MODIFY="EVENT_PERSISTENT_CHANGESET_MODIFY",t.EVENT_PERSISTENT_CHANGESET_RESTORED="EVENT_PERSISTENT_CHANGESET_RESTORED",t.EVENT_PERSISTENT_CHANGESET_ERROR="EVENT_PERSISTENT_CHANGESET_ERROR",t.EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID="EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID",t.EVENT_PERSISTENT_CHANGESET_DID_RECOVER="EVENT_PERSISTENT_CHANGESET_DID_RECOVER",t.EVENT_COMMIT_CS_SUCCEED="EVENT_COMMIT_CS_SUCCEED";var I=function(){function e(o){var r=this;this.handlerConflictOfflineData4OfflineEdit=function(e,o,n,i){f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.LAUNCH});var a=!1,l=[];if(o&&o.length){f.default.info(E+" handlerConflictOfflineData4OfflineEdit - 原始",o,n);var s=[];r.duplicate(o,n),f.default.info(E+" handlerConflictOfflineData4OfflineEdit - 去重后",o,n),n.forEach((function(e){var t=e;t.state=v.ChangeSetState.Offline,s.push(t)})),r.handleMergeconflictWithChangeSetCache(s,e.presentationStore.presentation),f.default.info(E+" handlerConflictOfflineData4OfflineEdit - merge后",s),r.conflice(n,s),f.default.info(E+" handlerConflictOfflineData4OfflineEdit - 冲突处理后",s);var c=[];s.length>0&&(s.forEach((function(o){var n=o;if(e.presentationStore.applyChangeSet(n.cs,p.ChangeCause.Operation))l.push(n),n.track.push(v.ChangeSetProcess.Offline),c.push({rev:n.revision,seq:n.seq});else{_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.Offline);var i={changeset:n};r.event.emit(t.EVENT_PERSISTENT_CHANGESET_DELETION,i)}})),f.default.info("[PersistentManager] 添加到cache"+c.length+"条 . ",c),a=!0),f.default.info(E+" handlerConflictOfflineData4OfflineEdit - 应用后",l),i&&i(l,a)}else f.default.info("[PersistentManager] 断层数据为空"),i&&i(l,a);r.event.emit(t.EVENT_PERSISTENT_CHANGESET_RESTORED),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.DID_RECOVER})},this.changeSetCache=[],this.conflictCache={copies:[],patches:[]},this._event=new m.default,e.csSeq=this.createMessageSeq(),f.default.info("[CS]:Set csSeq",e.csSeq),o&&this.persistentInit(o)}return e.prototype.createMessageSeq=function(){var e=(new Date).getTime();return Math.ceil(2147483648*Math.random())+e},e.prototype.duplicate=function(e,o){var r=[];if(!e||!o||0===e.length||0===o.length)return r.length;for(var n=[],i=e.length-1;i>=0;i--)for(var a=o.length-1;a>=0;a--)if(e[i].commitId===o[a].combinedSeq){var l=o[a];r.push(l.seq),n.push({rev:l.revision,seq:l.seq}),l.terminal=v.ChangeSetTerminal.OfflineDuplicate,_.default.addRecord(this.makeCommitRecord(l)),o.splice(a,1)}return r.length>0&&(f.default.info("[PersistentManager] 去重处理需删除"+n.length+"条 . ",n),this.event.emit(t.EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID,r)),r.length},e.prototype.conflice=function(e,o){var r=[];if(!e||!o||0===e.length||0===o.length)return r.length;for(var n=[],i=0;i<e.length;i++){for(var a=!1,l=e[i],s=0;s<o.length;s++){var c=o[s];if(l.seq===c.seq){a=!0;break}}!1===a&&(r.push(l.seq),n.push({rev:l.revision,seq:l.seq}))}return r.length>0&&(f.default.info("[PersistentManager] 冲突处理需删除"+n.length+"条 . ",n),this.event.emit(t.EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID,r)),r.length},e.prototype.applyOfflineData4OfflineEdit=function(e){var o=this;f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.LAUNCH}),e&&e.length>0&&(e.forEach((function(e){var t=e;t.state=v.ChangeSetState.Offline,o.changeSetCache.push(t)})),this.changeSetCache.length>0&&this.changeSetCache.forEach((function(e){var r=e;if(r.state!==v.ChangeSetState.Sending)if(c.Store.applyChangeSet(r.cs,p.ChangeCause.Operation))r.track.push(v.ChangeSetProcess.Offline),o.sendChangeset(r);else{_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.Offline);var n={changeset:r};o.event.emit(t.EVENT_PERSISTENT_CHANGESET_DELETION,n)}}))),this.event.emit(t.EVENT_PERSISTENT_CHANGESET_RESTORED,{fetchTime:0,duplicateTime:0,mergeConflictTime:0,duplicateCount:0,confliceCount:0,hasData:!1}),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.DID_RECOVER})},e.prototype.conflictOfflineData4OfflineEdit=function(e,t,o,r,n){var i=this;!1===e.revisionManager.fetchAndApplyMissingChanges(o,o+r,(function(o,r){if(o)try{i.handlerConflictOfflineData4OfflineEdit(e,r,t,n)}catch(e){f.default.error("[PersistentManager] 应用断层错误:",e.message),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.FETCH_FAIL}),n&&n(void 0,!1)}else f.default.info("[PersistentManager] 拉断层失败"),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.FETCH_FAIL}),n&&n(void 0,!1)}))?(f.default.info("[PersistentManager] 正在拉断层"),setTimeout((function(){i.conflictOfflineData4OfflineEdit(e,t,o,r,n)}),2e3)):f.default.info("[PersistentManager] 开始拉断层")},e.prototype.handleInvokeFetch=function(e,o,r){var n=this,i={fetchTime:0,duplicateTime:0,mergeConflictTime:0,duplicateCount:0,confliceCount:0,hasData:!1},a=r;if(a.fetchTime=(new Date).getTime()-a.fetchTime,e&&e.length){i.hasData=!0,i.duplicateTime=(new Date).getTime(),a.duplicateCount=this.duplicate(e,o),i.duplicateTime=(new Date).getTime()-i.duplicateTime,o.forEach((function(e){var t=e;t.state=v.ChangeSetState.Offline,n.changeSetCache.push(t)})),i.mergeConflictTime=(new Date).getTime(),this.mergeconflictWithChangeSetCache(),a.confliceCount=this.conflice(o,this.changeSetCache),i.mergeConflictTime=(new Date).getTime()-i.mergeConflictTime,i.confliceCount=a.confliceCount,f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"launch",ver6:JSON.stringify(a)});var l=[];this.changeSetCache.length>0&&this.changeSetCache.forEach((function(e){var o=e;if(o.state!==v.ChangeSetState.Sending)if(c.Store.applyChangeSet(o.cs,p.ChangeCause.Operation))o.track.push(v.ChangeSetProcess.Offline),n.sendChangeset(o),l.push({rev:o.revision,seq:o.seq});else{_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.Offline);var r={changeset:o};n.event.emit(t.EVENT_PERSISTENT_CHANGESET_DELETION,r)}}))}else f.default.info("[PersistentManager] 断层数据为空");this.event.emit(t.EVENT_PERSISTENT_CHANGESET_RESTORED,i)},e.prototype.invokeFetch=function(e,t,o){var r=this,n={totalCount:0,duplicateCount:0,confliceCount:0,fetchTime:0};!1===c.SlideApp.revisionManager.fetchAndApplyMissingChanges(t,t+o,(function(t,o){if(t)try{r.handleInvokeFetch(o,e,n)}catch(e){f.default.error("[PersistentManager] 应用断层错误:",e.message),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.FETCH_FAIL})}else f.default.info("[PersistentManager] 拉断层失败"),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.FETCH_FAIL})}))?(f.default.info("[PersistentManager] 正在拉断层"),setTimeout((function(){r.invokeFetch(e,t,o)}),2e3)):(f.default.info("[PersistentManager] 开始拉断层"),n.fetchTime=(new Date).getTime())},e.prototype.persistentInit=function(e){var o=this;e.persistentManager.event.on(e.persistentManager.EVENT_PERSISTENT_CHANGESET_GETALL,(function(e){var r=e.changesetPacks,n=void 0===r?[]:r;if(n.length>0){var i=[];n.forEach((function(e){i.push({rev:e.revision,seq:e.seq})})),f.default.info("[PersistentManager] 共"+n.length+"条 . ",i);var a=n[0].revision,l=n.length>50?50:n.length;o.invokeFetch(n,a,l)}else o.event.emit(t.EVENT_PERSISTENT_CHANGESET_DID_RECOVER)}))},e.prototype.clear=function(){this.changeSetCache=[],this.conflictCache={copies:[],patches:[]}},e.prototype.combineChanges=function(e){var t={redo:[],undo:[],canUndo:!0};return e.reduce((function(e,t){return e.redo.push(t.redo),e.undo.splice(0,0,t.undo),e.canUndo=e.canUndo&&t.canUndo,e}),t),t},e.prototype.commitChanges=function(e){var t=this,o=this.combineChanges(e),r=o.redo,n=o.undo;if(o.canUndo){var i=new d.Command(r,n);d.default.addCommand(i)}this.event.emit("undo_redo",r),this.changeSetCache.forEach((function(e){e.state===v.ChangeSetState.Failed&&(e.track.push(v.ChangeSetProcess.SendFailed),t.sendChangeset(e))}));var a=x(r,n,v.ChangeSetSource.Operation);u.isDevelopment()&&g.default.addCommand(a),this.sendChangeset(a)},e.prototype.succeededCallback=function(e,o){var r=e;r.state=v.ChangeSetState.Sended,r.terminal=v.ChangeSetTerminal.ServerAccept;var n={changeset:e};this.event.emit(t.EVENT_PERSISTENT_CHANGESET_DELETION,n),this.changeSetCache.splice(this.changeSetCache.indexOf(e),1),f.default.info("[CS]:Send CS success, seq:"+e.seq),o&&(_.default.addRecord(this.makeCommitRecord(e)),this.event.emit(t.EVENT_COMMIT_CS_SUCCEED))},e.prototype.failedCallback=function(e,o,r){var n=e,i=o.reason,a=o.cause,l=i!==b.ServerErrorCode.COMMIT_ERROR_BASEREV_LIMIT_ERROR&&i!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_SENDING&&i!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_WAITING;if(i===b.ServerErrorCode.COMMIT_ERROR_FOLLOW_FAILED){var s={changeset:e};this.event.emit(t.EVENT_PERSISTENT_CHANGESET_ERROR,s)}else{var c={changeset:e,reason:i||-1};this.event.emit(t.EVENT_PERSISTENT_CHANGESET_MODIFY,c)}if(r&&0===o.index){if(l){var d="文档保存失败，错误码:"+i;this.event.emit("send_failed",d),n.terminal=a===v.CommitErrorCause.ServerRefuse?v.ChangeSetTerminal.ServerRefuse:v.ChangeSetTerminal.NetworkError,_.default.addRecord(this.makeCommitRecord(e))}this.reportSendFailed(i,e.cs)}n.state=v.ChangeSetState.Failed,i!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_SENDING&&i!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_WAITING&&n.track.push(v.ChangeSetProcess.SendFailed),f.default.warn("[CS]:Send CS failed, seq:"+e.seq+", errCode:"+i,o)},e.prototype.sendChangeset=function(e,o){var n=this;if(void 0===o&&(o=!0),!function(e){return e&&e.cs&&e.cs.length>0&&e.cs[0].length>0}(e))return f.default.warn("[CS]:Send Empty CS !!!"),!1;u.isDevelopment()&&h.isValidedChangeset(e.cs),e.state=v.ChangeSetState.Sending,f.default.info("[CS]:Send CS, seq:"+e.seq+", current version:"+c.SlideApp.revisionManager.revision),-1===this.changeSetCache.indexOf(e)&&this.changeSetCache.push(e);var i=u.cloneDeep(e.cs);return c.SlideApp.revisionManager.sendChangeset(i,e.seq,(function(t,r){t?n.succeededCallback(e,o):n.failedCallback(e,r,o)}),(function(o,i){var a=r({},e);a.seq=o,a.cs=i;var l={combinedSeq:o,targetSeq:o,changeset:a};n.event.emit(t.EVENT_PERSISTENT_CHANGESET_ADDITION_OR_UPDATE_SEQ,l)})),!0},e.prototype.sendChangesetWithoutUserOperation=function(e){f.default.info("[CS]:Send CS without user operation"),this.sendChangeset(e,!1)},e.prototype.handleCombineChangeset=function(e,t){var o=w.composeChangeset(e,t);return o.merged?(f.default.info("[CS]:combined cs:",o.value),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"cs",action:"combined",ver5:JSON.stringify(e).length+JSON.stringify(t).length,ver6:o.value?JSON.stringify(o.value).length:0}),o.value?o.value:[]):l(t,e)},e.prototype.handleNewUserChangesets=function(e){var t=e.map((function(e){return e.changeset}));0===this.changeSetCache.length?this.handleApplyChanges(t):this.handleCommitConflict(t)},e.prototype.handleApplyChanges=function(e){e.forEach((function(e){!c.Store.applyChangeSet(e,p.ChangeCause.Recv,"Recv")&&_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.ApplyNewChanges)}))},e.prototype.handleCommitConflict=function(e){var t=this;f.default.info("[CS]:Merge start, unsent cs count:",this.changeSetCache.length),e.every((function(e){return e.every((function(e){return 0===e.length}))}))?f.default.info("[CS]:Merge end, empty array"):(this.undoUnsent(e),e.forEach((function(e){!c.Store.applyChangeSet(e,p.ChangeCause.Recv,"Merge")&&_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.ConflictApplyRemote)})),this.redoUnsent()),this.changeSetCache.forEach((function(e){e.track.push(v.ChangeSetProcess.Conflict),t.sendChangeset(e)}))},e.prototype.undoUnsent=function(e){var t=this;this.changeSetCache.forEach((function(o){t._checkConflictBySameTarget(e,o)}));for(var o=this.changeSetCache.length-1;o>=0;o--){var r=this.changeSetCache[o];!c.Store.applyChangeSet(r.revert,p.ChangeCause.Memory,"")&&_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.ConflictUndo)}this.conflictCache.patches.forEach((function(e){for(var o=0;o<t.changeSetCache.length;o++){for(var r=t.changeSetCache[o],n=0;n<r.cs.length;n++)r.cs[n]===e&&(f.default.info("[CS]:相同节点冲突，移除Patch",r.cs[n],r.revert&&r.revert[r.revert.length-n]),r.cs.splice(n,1),r.revert&&r.revert.splice(-n,1),n--);if(0===r.cs.length){var i=t.changeSetCache.splice(o--,1);r.terminal=v.ChangeSetTerminal.ConflictRemove,_.default.addRecord(t.makeCommitRecord(r)),f.default.info("[CS]:相同节点冲突，移除Changeset",i[0].seq)}}}))},e.prototype._checkConflictBySameTarget=function(e,t){var o=this;return e.forEach((function(e){t.cs.forEach((function(t){e.forEach((function(e){if(h.hasConflictWithPatchByRuleOfSameTarget(t,e)||function(e){return o.conflictCache.patches.some((function(t){return h.belongToSameSlide(e,t)}))}(t)){var r=t[0].target;if(void 0!==r){var n=u.getValueByPointer(c.Store.presentation,r);if(C.default(n,"parentSlideNode")){var i=n.parentSlideNode,a=i.id,l=o.conflictCache.copies.length>0&&o.conflictCache.copies.every((function(e){return e.id===a}));o.conflictCache.patches.push(t),!l&&o.conflictCache.copies.push(u.cloneDeep(i))}else f.default.error("[CS]:查找相同节点冲突时异常")}else f.default.error("[CS]:查找相同节点冲突时异常, target不存在")}}))}))})),this.conflictCache},e.prototype.redoUnsent=function(){var e=this;this.mergeconflictWithChangeSetCache(),this.changeSetCache.forEach((function(e){!c.Store.applyChangeSet(e.cs,p.ChangeCause.Merge,"")&&_.default.reportChangeSetApplyFailed(v.ChangeSetApplyFailed.ConflictRedo)}));var t=this.conflictCache.copies;t.length>0&&this.event.emit("conflict_copy",(function(){c.SlideApp.revisionManager.cancelAllCommit(),t.forEach((function(t){var o=t;c.Store.presentation.slideList.some((function(r,n){if(r.id===t.id){o.id=y.generate();var i=h.makePatch([h.makeOperation({op:"add",path:"/slideList/"+(n+1),value:t,target:""})]);h.addTidForPatch(i,c.Store.presentation),h.addPidForPatch(i,c.Store.presentation),c.Store.applyChangeSet([i],p.ChangeCause.Merge,"Merge|Create copy");var a=h.makePatch([h.makeOperation({op:"remove",path:"/slideList/"+(n+1),target:""})]);h.addTidForPatch(a,c.Store.presentation),h.addPidForPatch(a,c.Store.presentation),f.default.info("[CS]:创建副本");var l=x([i],[a],v.ChangeSetSource.Customize);return e.sendChangeset(l),!0}return!1}))})),t=[]}),(function(){t=[]})),this.conflictCache.copies=[],this.conflictCache.patches=[]},e.prototype.handleMergeconflictWithChangeSetCache=function(e,t){for(var o=u.cloneDeep(t),r=0;r<e.length;r++){var n=u.cloneDeep(o),i=e[r];if(f.default.info("[CS]:Merge conflict start, seq:"+i.seq),h.mergeconflictWithChangeSet(i.cs,o),0!==i.cs.length){var a=h.inverseChangeset(i.cs,n);i.revert=a}else e.splice(r--,1),i.terminal=v.ChangeSetTerminal.ConflictRemove,_.default.addRecord(this.makeCommitRecord(i))}},e.prototype.mergeconflictWithChangeSetCache=function(){this.handleMergeconflictWithChangeSetCache(this.changeSetCache,c.Store.presentation)},e.prototype.reportChangesetInMemery=function(){if(this.changeSetCache&&this.changeSetCache.length>0){var e=this.changeSetCache.length,t={csCount:e};f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"cs",action:"unmount_cs_count",ver5:0,ver6:JSON.stringify(t)}),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:S.PersistentReport.HAS_MEMORY_CS,ver6:JSON.stringify(t)}),f.default.info("[CS]:未发送的CS, seq:"+e)}},e.prototype.reportSendFailed=function(e,t){if(e!==b.ServerErrorCode.COMMIT_ERROR_BASEREV_LIMIT_ERROR&&e!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_SENDING&&e!==b.ServerErrorCode.COMMIT_ERROR_CANCEL_WAITING){var o="",r="";return e===b.ServerErrorCode.COMMIT_ERROR_FOLLOW_FAILED&&(o=null!=C.default(t,"[0][0]")?JSON.stringify(t[0][0]):"",r=function(){var e=Date.now(),t=e-18e5;return window.log.report("USER_REPORT",{query:{startTs:t,endTs:e}})}(),f.default.info("[CS]:Report wl",r)),f.default.tdw&&f.default.tdw({opername:"quality_slide",module:"cs",action:"send",ver5:e,ver6:o,ver7:r}),o}},e.prototype.makeCommitRecord=function(e){return{source:e.source,track:e.track,terminal:e.terminal}},Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e}();function x(e,t,o){var r={cs:e,revert:t,seq:++I.csSeq,revision:c.SlideApp.revisionManager.revision,state:v.ChangeSetState.New,source:o,track:[]};return f.default.info("[CS]:生成CS, seq:"+r.seq+", revision:"+r.revision,{redo:e,undo:t}),r}t.default=I,t.makeChangesetPack=x},"./store/command-manager.ts":
/*!**********************************!*\
  !*** ./store/command-manager.ts ***!
  \**********************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommandManager=t.Command=void 0;var n=r(o(/*! ../common/log-utils */"./common/log-utils.ts")),i=r(o(/*! lodash/clone */"../node_modules/lodash/clone.js")),a=function(){function e(e,t){this.redo=e,this.undo=t}return e.prototype.executeRedo=function(e){this.undo=e&&e.handleChanges(this.redo)},e.prototype.executeUndo=function(e){this.redo=e&&e.handleChanges(this.undo)},e.prototype.isValid=function(){return this.redo&&this.redo.length>0||this.undo&&this.undo.length>0},e}();t.Command=a;var l=function(){function e(){this.commandCache=[],this.currentIndex=0}return e.prototype.clear=function(){this.commandCache=[],this.currentIndex=0,n.default.info("[CS]:Command manager clear")},e.prototype.getAllCommands=function(){return i.default(this.commandCache)},e.prototype.addCommand=function(e){this.canRedo()&&this.commandCache.splice(this.currentIndex),this.commandCache.push(e),this.commandCache.length>100&&this.commandCache.shift(),this.currentIndex=this.commandCache.length},e.prototype.removeCommand=function(e){var t=this.commandCache.indexOf(e);-1!==t&&(this.commandCache.splice(t,1),this.currentIndex>t&&this.currentIndex--),n.default.info("[CS]:Remove["+this.currentIndex+"/"+this.commandCache.length+"]",e)},e.prototype.undo=function(e){if(this.canUndo()){n.default.info("[CS]:undo["+(this.currentIndex-1)+"/"+this.commandCache.length+"]");var t=this.commandCache[this.currentIndex-1];return t.executeUndo(e),t.isValid()?this.currentIndex--:(this.commandCache.splice(this.currentIndex-1,1),this.currentIndex=Math.max(this.currentIndex-1,0)),!0}return!1},e.prototype.redo=function(e){if(this.canRedo()){n.default.info("[CS]:redo["+(this.currentIndex+1)+"/"+this.commandCache.length+"]");var t=this.commandCache[this.currentIndex];return t.executeRedo(e),t.isValid()?this.currentIndex++:(this.commandCache.splice(this.currentIndex,1),this.currentIndex=Math.min(this.currentIndex,this.commandCache.length)),!0}return!1},e.prototype.canUndo=function(){return this.currentIndex>0},e.prototype.canRedo=function(){return this.currentIndex<this.commandCache.length},e}();t.CommandManager=l;var s=new l;t.default=s},"./store/doc-store.ts":
/*!****************************!*\
  !*** ./store/doc-store.ts ***!
  \****************************/
/*! no static exports found */function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._visible=!0}return Object.defineProperty(e.prototype,"info",{get:function(){return this._info},set:function(e){this._info=e,this._visible=12!==e.docStatus},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extra",{get:function(){return{ownerNick:this._extra&&this._extra.owner_nick,creatorNick:this._extra&&this._extra.creator_nick,docURL:this._extra&&this._extra.doc_url}},set:function(e){this._extra=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collected",{get:function(){return this._collected},set:function(e){this._collected=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAddedMy",{get:function(){return this._isAddedMy},set:function(e){this._isAddedMy=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._info&&this._info.title},set:function(e){this._info&&(this._info.title=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padId",{get:function(){return this._info&&this._info.localPadId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domainId",{get:function(){return this._info&&this._info.domainId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creatorDomain",{get:function(){return this._info&&this._info.creatorDomain},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalPadId",{get:function(){return this._info&&this._info.globalPadId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseRevision",{get:function(){return this._info&&this._info.collab_client_vars&&this._info.collab_client_vars.rev},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"subId",{get:function(){return this._info&&this._info.subId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._info&&this._info.userId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOwner",{get:function(){return this._info&&this._info.isOwner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCreator",{get:function(){return this._info&&this._info.isCreator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"policy",{get:function(){return this._info&&this._info.policy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padType",{get:function(){return this._info&&this._info.padType},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return this._info&&this._info.isDeleted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appInfoConfig",{get:function(){return this._info&&this._info.appInfoConfig},enumerable:!1,configurable:!0}),e}();t.default=r},"./store/offline-editor/data/combinePresentation.json":
/*!************************************************************!*\
  !*** ./store/offline-editor/data/combinePresentation.json ***!
  \************************************************************/
/*! exports provided: cs, default */function(e){e.exports=JSON.parse('{"cs":[[{"op":"add","path":"/slideWidth","value":12192000,"target":"","tid":"","pid":""},{"op":"add","path":"/slideHeight","value":6858000,"target":"","tid":"","pid":""},{"op":"add","path":"/version","value":"0.1","target":"","tid":"","pid":""},{"op":"add","path":"/slideList","value":[{"id":"/ppt/slides/slide1.xml","type":"slide","layoutId":"/ppt/slideLayouts/slideLayout1.xml","slideData":{"groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1470233,"left":1524000,"width":9144000,"height":2387600},"placeholder":{"type":"ctrTitle"}},"textBody":{"props":{"anchor":"b"},"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":3949908,"left":1524000,"width":9144000,"height":1655762},"placeholder":{"type":"subTitle","index":1}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"3","name":"副标题 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}}],"target":"","tid":"","pid":""},{"op":"add","path":"/layoutList","value":[{"id":"/ppt/slideLayouts/slideLayout1.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"封面","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1470233,"left":1524000,"width":9144000,"height":2387600},"placeholder":{"type":"ctrTitle"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"alignment":"ctr","level":0,"defaultRunProps":{"font_size":6000}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":3949908,"left":1524000,"width":9144000,"height":1655762},"placeholder":{"type":"subTitle","index":1}},"textBody":{"textStyleList":[{"alignment":"ctr","buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400}},{"alignment":"ctr","buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000}},{"alignment":"ctr","buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800}},{"alignment":"ctr","buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版副标题样式"}]}]},"id":"3","name":"副标题 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout2.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"标题内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout3.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"空白页","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout4.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"节标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1471199,"left":831850,"width":10515600,"height":2852737},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":6000}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":4350924,"left":831850,"width":10515600,"height":1500187},"placeholder":{"type":"body","index":1}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"3","name":"文本占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout5.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"两栏内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":5181600,"height":4351338},"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":1825625,"left":6172200,"width":5181600,"height":4351338},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout6.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"对比内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":839788,"width":10515600,"height":1325563},"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1681163,"left":839788,"width":5157787,"height":823912},"placeholder":{"type":"body","index":1}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"bold":1}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"bold":1}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"bold":1}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"3","name":"文本占位符 2","type":"shape"},{"props":{"frame":{"top":2505075,"left":839788,"width":5157787,"height":3684588},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":1681163,"left":6172200,"width":5183188,"height":823912},"placeholder":{"type":"body","index":3}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"bold":1}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"bold":1}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"bold":1}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"5","name":"文本占位符 4","type":"shape"},{"props":{"frame":{"top":2505075,"left":6172200,"width":5183188,"height":3684588},"placeholder":{"index":4}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"6","name":"内容占位符 5","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout7.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"内容与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":723106,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":723106,"left":5183188,"width":6172200,"height":5411787},"placeholder":{"index":1}},"textBody":{"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}},{"level":1,"defaultRunProps":{"font_size":2800}},{"level":2,"defaultRunProps":{"font_size":2400}},{"level":3,"defaultRunProps":{"font_size":2000}},{"level":4,"defaultRunProps":{"font_size":2000}},{"level":5,"defaultRunProps":{"font_size":2000}},{"level":6,"defaultRunProps":{"font_size":2000}},{"level":7,"defaultRunProps":{"font_size":2000}},{"level":8,"defaultRunProps":{"font_size":2000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":2323306,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"4","name":"文本占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout8.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"图片与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":727074,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":727075,"left":5183188,"width":6172200,"height":5403850},"placeholder":{"type":"pic","index":1}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":3200}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2800}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":2400}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":2000}}],"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"3","name":"图片占位符 2","type":"shape"},{"props":{"frame":{"top":2327274,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"4","name":"文本占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout9.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"表格与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":727074,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"3","name":"标题 1","type":"shape"},{"props":{"frame":{"top":2327274,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"5","name":"文本占位符 3","type":"shape"},{"props":{"frame":{"top":719137,"left":5172891,"width":6179322,"height":5419726},"placeholder":{"type":"tbl","index":10}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"7","name":"表格占位符 6","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout10.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"三栏内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":3299791,"height":4351338},"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":1825625,"left":4446104,"width":3299791,"height":4351338},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":1825625,"left":8054009,"width":3299791,"height":4351338},"placeholder":{"index":10}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"5","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout11.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"两行内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1690688,"left":838200,"width":10515600,"height":2172811},"placeholder":{"index":10}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":3863500,"left":838200,"width":10515600,"height":2241232},"placeholder":{"index":11}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"5","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout12.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"多张图片","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":838200,"width":10515600,"height":1325563},"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"3","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1690689,"left":838200,"width":5257800,"height":2338886},"placeholder":{"type":"pic","index":10}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"7","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":1690689,"left":6096001,"width":5257802,"height":2338886},"placeholder":{"type":"pic","index":11}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"8","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":4029575,"left":838200,"width":5257800,"height":2338886},"placeholder":{"type":"pic","index":12}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"9","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":4029575,"left":6096001,"width":5257802,"height":2338886},"placeholder":{"type":"pic","index":13}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"10","name":"图片占位符 6","type":"shape"}],"id":"1","name":"","type":"groupShape"}}}],"target":"","tid":"","pid":""},{"op":"add","path":"/masterList","value":[{"id":"/ppt/slideMasters/slideMaster1.xml","type":"master","themeId":"/ppt/theme/theme1.xml","themeName":"白色主题​​","slideData":{"background":{"solidFill":{"color":{"colorValue":"bg1","colorType":"scheme"}}},"groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":838200,"width":10515600,"height":1325563},"placeholder":{"type":"title"},"prstGeom":{"prstGeomType":"rect"}},"textBody":{"props":{"vert":"horz","anchor":"ctr","autoFitType":"normAutofit","left_inset":91440,"right_inset":91440,"top_inset":45720,"bottom_inset":45720},"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题占位符 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":10515600,"height":4351338},"placeholder":{"type":"body","index":1},"prstGeom":{"prstGeomType":"rect"}},"textBody":{"props":{"vert":"horz","autoFitType":"normAutofit","left_inset":91440,"right_inset":91440,"top_inset":45720,"bottom_inset":45720},"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"文本占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}},"titleTextStyleList":[{"alignment":"l","buNone":1,"level":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":4400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPct":0}}],"bodyTextStyleList":[{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":0,"marginLeft":228600,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":1000}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":1,"marginLeft":685800,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":2,"marginLeft":1143000,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2000,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":3,"marginLeft":1600200,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":4,"marginLeft":2057400,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":5,"marginLeft":2514600,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":6,"marginLeft":2971800,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":7,"marginLeft":3429000,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":8,"marginLeft":3886200,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}}],"clrMap":{"bg1":"lt1","tx1":"dk1","bg2":"lt2","tx2":"dk2","accent1":"accent1","accent2":"accent2","accent3":"accent3","accent4":"accent4","accent5":"accent5","accent6":"accent6","hlink":"hlink","folHlink":"folHlink"},"otherTextStyleList":[{"alignment":"l","level":0,"marginLeft":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":1,"marginLeft":457200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":2,"marginLeft":914400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":3,"marginLeft":1371600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":4,"marginLeft":1828800,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":5,"marginLeft":2286000,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":6,"marginLeft":2743200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":7,"marginLeft":3200400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":8,"marginLeft":3657600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}}]}],"target":"","tid":"","pid":""},{"op":"add","path":"/themeList","value":[{"id":"/ppt/theme/theme1.xml","themeElements":{"clrScheme":{"dk1":"000000","lt1":"FFFFFF","dk2":"44546A","lt2":"E7E6E6","accent1":"4472C4","accent2":"ED7D31","accent3":"A5A5A5","accent4":"FFC000","accent5":"5B9BD5","accent6":"70AD47","hlink":"0563C1","folHlink":"954F72"}}}],"target":"","tid":"","pid":""},{"op":"add","path":"/tblStyleList","value":{"def":"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}","tableStyleEntryList":[]},"target":"","tid":"","pid":""},{"op":"add","path":"/defaultTextStyleList","value":[{"alignment":"l","level":0,"marginLeft":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":1,"marginLeft":457200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":2,"marginLeft":914400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":3,"marginLeft":1371600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":4,"marginLeft":1828800,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":5,"marginLeft":2286000,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":6,"marginLeft":2743200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":7,"marginLeft":3200400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":8,"marginLeft":3657600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}}],"target":"","tid":"","pid":""},{"op":"add","path":"/firstSlideContent","value":"<div class=\\"scale-slide-slide-3-B7E\\" id=\\"previewSlide\\" style=\\"overflow: hidden;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1920px; height: 1080px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"#FFFFFF\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1920 0 L 1920 1080 L 0 1080 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg><div id=\\"list-MqjzrKYH5E\\" style=\\"position: absolute;\\"><div class=\\"slide-slideItem-1JG-R ppt-editor-cursor-global-move-2Ur9s\\" id=\\"slide-div\\" style=\\"top: 231.533px; left: 240px; width: 1440px; height: 376px; pointer-events: auto; position: absolute;\\"><div style=\\"width: 1440px; height: 376px; position: absolute;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1440px; height: 376px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"none\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1440 0 L 1440 376 L 0 376 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg></div></div></div><div id=\\"list-623liq-Rgs\\" style=\\"position: absolute;\\"><div class=\\"slide-slideItem-1JG-R ppt-editor-cursor-global-move-2Ur9s\\" id=\\"slide-div\\" style=\\"top: 622.033px; left: 240px; width: 1440px; height: 260.75px; pointer-events: auto; position: absolute;\\"><div style=\\"width: 1440px; height: 260.75px; position: absolute;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1440px; height: 261px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"none\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1440 0 L 1440 260.7499212598425 L 0 260.7499212598425 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg></div></div></div></div>","target":"","tid":"","pid":""}]]}')},"./store/offline-editor/data/newSlideTemplate.json":
/*!*********************************************************!*\
  !*** ./store/offline-editor/data/newSlideTemplate.json ***!
  \*********************************************************/
/*! exports provided: slideWidth, slideHeight, version, slideList, layoutList, masterList, themeList, tblStyleList, defaultTextStyleList, firstSlideContent, default */function(e){e.exports=JSON.parse('{"slideWidth":12192000,"slideHeight":6858000,"version":"0.1","slideList":[{"id":"/ppt/slides/slide1.xml","type":"slide","layoutId":"/ppt/slideLayouts/slideLayout1.xml","slideData":{"groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1470233,"left":1524000,"width":9144000,"height":2387600},"placeholder":{"type":"ctrTitle"}},"textBody":{"props":{"anchor":"b"},"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":3949908,"left":1524000,"width":9144000,"height":1655762},"placeholder":{"type":"subTitle","index":1}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"3","name":"副标题 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}}],"layoutList":[{"id":"/ppt/slideLayouts/slideLayout1.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"封面","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1470233,"left":1524000,"width":9144000,"height":2387600},"placeholder":{"type":"ctrTitle"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"alignment":"ctr","level":0,"defaultRunProps":{"font_size":6000}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":3949908,"left":1524000,"width":9144000,"height":1655762},"placeholder":{"type":"subTitle","index":1}},"textBody":{"textStyleList":[{"alignment":"ctr","buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400}},{"alignment":"ctr","buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000}},{"alignment":"ctr","buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800}},{"alignment":"ctr","buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600}},{"alignment":"ctr","buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版副标题样式"}]}]},"id":"3","name":"副标题 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout2.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"标题内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout3.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"空白页","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout4.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"节标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":1471199,"left":831850,"width":10515600,"height":2852737},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":6000}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":4350924,"left":831850,"width":10515600,"height":1500187},"placeholder":{"type":"body","index":1}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme","tint":75000}}}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"3","name":"文本占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout5.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"两栏内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":5181600,"height":4351338},"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":1825625,"left":6172200,"width":5181600,"height":4351338},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout6.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"对比内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":839788,"width":10515600,"height":1325563},"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1681163,"left":839788,"width":5157787,"height":823912},"placeholder":{"type":"body","index":1}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"bold":1}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"bold":1}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"bold":1}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"3","name":"文本占位符 2","type":"shape"},{"props":{"frame":{"top":2505075,"left":839788,"width":5157787,"height":3684588},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":1681163,"left":6172200,"width":5183188,"height":823912},"placeholder":{"type":"body","index":3}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":2400,"bold":1}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2000,"bold":1}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1800,"bold":1}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1600,"bold":1}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"5","name":"文本占位符 4","type":"shape"},{"props":{"frame":{"top":2505075,"left":6172200,"width":5183188,"height":3684588},"placeholder":{"index":4}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"6","name":"内容占位符 5","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout7.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"内容与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":723106,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":723106,"left":5183188,"width":6172200,"height":5411787},"placeholder":{"index":1}},"textBody":{"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}},{"level":1,"defaultRunProps":{"font_size":2800}},{"level":2,"defaultRunProps":{"font_size":2400}},{"level":3,"defaultRunProps":{"font_size":2000}},{"level":4,"defaultRunProps":{"font_size":2000}},{"level":5,"defaultRunProps":{"font_size":2000}},{"level":6,"defaultRunProps":{"font_size":2000}},{"level":7,"defaultRunProps":{"font_size":2000}},{"level":8,"defaultRunProps":{"font_size":2000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":2323306,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"4","name":"文本占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout8.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"图片与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":727074,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":727075,"left":5183188,"width":6172200,"height":5403850},"placeholder":{"type":"pic","index":1}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":3200}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":2800}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":2400}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":2000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":2000}}],"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"3","name":"图片占位符 2","type":"shape"},{"props":{"frame":{"top":2327274,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"4","name":"文本占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout9.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"表格与标题","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":727074,"left":839788,"width":3932237,"height":1600200},"placeholder":{"type":"title"}},"textBody":{"props":{"anchor":"b"},"textStyleList":[{"level":0,"defaultRunProps":{"font_size":3200}}],"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"3","name":"标题 1","type":"shape"},{"props":{"frame":{"top":2327274,"left":839788,"width":3932237,"height":3811588},"placeholder":{"type":"body","index":2}},"textBody":{"textStyleList":[{"buNone":1,"level":0,"marginLeft":0,"indent":0,"defaultRunProps":{"font_size":1600}},{"buNone":1,"level":1,"marginLeft":457200,"indent":0,"defaultRunProps":{"font_size":1400}},{"buNone":1,"level":2,"marginLeft":914400,"indent":0,"defaultRunProps":{"font_size":1200}},{"buNone":1,"level":3,"marginLeft":1371600,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":4,"marginLeft":1828800,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":5,"marginLeft":2286000,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":6,"marginLeft":2743200,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":7,"marginLeft":3200400,"indent":0,"defaultRunProps":{"font_size":1000}},{"buNone":1,"level":8,"marginLeft":3657600,"indent":0,"defaultRunProps":{"font_size":1000}}],"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]}]},"id":"5","name":"文本占位符 3","type":"shape"},{"props":{"frame":{"top":719137,"left":5172891,"width":6179322,"height":5419726},"placeholder":{"type":"tbl","index":10}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"7","name":"表格占位符 6","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout10.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"三栏内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":3299791,"height":4351338},"placeholder":{"index":1}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"内容占位符 2","type":"shape"},{"props":{"frame":{"top":1825625,"left":4446104,"width":3299791,"height":4351338},"placeholder":{"index":2}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":1825625,"left":8054009,"width":3299791,"height":4351338},"placeholder":{"index":10}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"5","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout11.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"两行内容","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1690688,"left":838200,"width":10515600,"height":2172811},"placeholder":{"index":10}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"4","name":"内容占位符 3","type":"shape"},{"props":{"frame":{"top":3863500,"left":838200,"width":10515600,"height":2241232},"placeholder":{"index":11}},"textBody":{"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"5","name":"内容占位符 3","type":"shape"}],"id":"1","name":"","type":"groupShape"}}},{"id":"/ppt/slideLayouts/slideLayout12.xml","type":"layout","masterId":"/ppt/slideMasters/slideMaster1.xml","slideData":{"name":"多张图片","groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":838200,"width":10515600,"height":1325563},"placeholder":{"type":"title"}},"textBody":{"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"3","name":"标题 1","type":"shape"},{"props":{"frame":{"top":1690689,"left":838200,"width":5257800,"height":2338886},"placeholder":{"type":"pic","index":10}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"7","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":1690689,"left":6096001,"width":5257802,"height":2338886},"placeholder":{"type":"pic","index":11}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"8","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":4029575,"left":838200,"width":5257800,"height":2338886},"placeholder":{"type":"pic","index":12}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"9","name":"图片占位符 6","type":"shape"},{"props":{"frame":{"top":4029575,"left":6096001,"width":5257802,"height":2338886},"placeholder":{"type":"pic","index":13}},"textBody":{"paragraphList":[{"paragraphItem":[],"endParaRPr":{"lang":"zh-CN"}}]},"id":"10","name":"图片占位符 6","type":"shape"}],"id":"1","name":"","type":"groupShape"}}}],"masterList":[{"id":"/ppt/slideMasters/slideMaster1.xml","type":"master","themeId":"/ppt/theme/theme1.xml","themeName":"白色主题​​","slideData":{"background":{"solidFill":{"color":{"colorValue":"bg1","colorType":"scheme"}}},"groupShape":{"props":{"frame":{"top":0,"left":0,"width":0,"height":0,"childOffsetLeft":0,"childOffsetTop":0,"childWidth":0,"childHeight":0}},"shapeList":[{"props":{"frame":{"top":365125,"left":838200,"width":10515600,"height":1325563},"placeholder":{"type":"title"},"prstGeom":{"prstGeomType":"rect"}},"textBody":{"props":{"vert":"horz","anchor":"ctr","autoFitType":"normAutofit","left_inset":91440,"right_inset":91440,"top_inset":45720,"bottom_inset":45720},"paragraphList":[{"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版标题样式"}]}]},"id":"2","name":"标题占位符 1","type":"shape"},{"props":{"frame":{"top":1825625,"left":838200,"width":10515600,"height":4351338},"placeholder":{"type":"body","index":1},"prstGeom":{"prstGeomType":"rect"}},"textBody":{"props":{"vert":"horz","autoFitType":"normAutofit","left_inset":91440,"right_inset":91440,"top_inset":45720,"bottom_inset":45720},"paragraphList":[{"paragraphProps":{"level":0},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"单击此处编辑母版文本样式"}]},{"paragraphProps":{"level":1},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"二级"}]},{"paragraphProps":{"level":2},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"三级"}]},{"paragraphProps":{"level":3},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"四级"}]},{"paragraphProps":{"level":4},"paragraphItem":[{"props":{"lang":"zh-CN"},"type":"run","text":"五级"}]}]},"id":"3","name":"文本占位符 2","type":"shape"}],"id":"1","name":"","type":"groupShape"}},"titleTextStyleList":[{"alignment":"l","buNone":1,"level":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":4400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPct":0}}],"bodyTextStyleList":[{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":0,"marginLeft":228600,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":1000}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":1,"marginLeft":685800,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2400,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":2,"marginLeft":1143000,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":2000,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":3,"marginLeft":1600200,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":4,"marginLeft":2057400,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":5,"marginLeft":2514600,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":6,"marginLeft":2971800,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":7,"marginLeft":3429000,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}},{"alignment":"l","character_bullet_char":"•","buFont":{"typeface":"默认字体"},"level":8,"marginLeft":3886200,"indent":-228600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000},"spcBef":{"spcPts":500}}],"clrMap":{"bg1":"lt1","tx1":"dk1","bg2":"lt2","tx2":"dk2","accent1":"accent1","accent2":"accent2","accent3":"accent3","accent4":"accent4","accent5":"accent5","accent6":"accent6","hlink":"hlink","folHlink":"folHlink"},"otherTextStyleList":[{"alignment":"l","level":0,"marginLeft":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":1,"marginLeft":457200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":2,"marginLeft":914400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":3,"marginLeft":1371600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":4,"marginLeft":1828800,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":5,"marginLeft":2286000,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":6,"marginLeft":2743200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":7,"marginLeft":3200400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":8,"marginLeft":3657600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}}]}],"themeList":[{"id":"/ppt/theme/theme1.xml","themeElements":{"clrScheme":{"dk1":"000000","lt1":"FFFFFF","dk2":"44546A","lt2":"E7E6E6","accent1":"4472C4","accent2":"ED7D31","accent3":"A5A5A5","accent4":"FFC000","accent5":"5B9BD5","accent6":"70AD47","hlink":"0563C1","folHlink":"954F72"}}}],"tblStyleList":{"def":"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}","tableStyleEntryList":[]},"defaultTextStyleList":[{"alignment":"l","level":0,"marginLeft":0,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":1,"marginLeft":457200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":2,"marginLeft":914400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":3,"marginLeft":1371600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":4,"marginLeft":1828800,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":5,"marginLeft":2286000,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":6,"marginLeft":2743200,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":7,"marginLeft":3200400,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}},{"alignment":"l","level":8,"marginLeft":3657600,"defTablSz":914400,"defaultRunProps":{"font":{"latin":{"typeface":"默认字体"},"ea":{"typeface":"默认字体"}},"font_size":1800,"solidFill":{"color":{"colorValue":"tx1","colorType":"scheme"}},"kern":1200},"lnSpc":{"spcPct":130000}}],"firstSlideContent":"<div class=\\"scale-slide-slide-3-B7E\\" id=\\"previewSlide\\" style=\\"overflow: hidden;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1920px; height: 1080px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"#FFFFFF\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1920 0 L 1920 1080 L 0 1080 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg><div id=\\"list-MqjzrKYH5E\\" style=\\"position: absolute;\\"><div class=\\"slide-slideItem-1JG-R ppt-editor-cursor-global-move-2Ur9s\\" id=\\"slide-div\\" style=\\"top: 231.533px; left: 240px; width: 1440px; height: 376px; pointer-events: auto; position: absolute;\\"><div style=\\"width: 1440px; height: 376px; position: absolute;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1440px; height: 376px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"none\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1440 0 L 1440 376 L 0 376 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg></div></div></div><div id=\\"list-623liq-Rgs\\" style=\\"position: absolute;\\"><div class=\\"slide-slideItem-1JG-R ppt-editor-cursor-global-move-2Ur9s\\" id=\\"slide-div\\" style=\\"top: 622.033px; left: 240px; width: 1440px; height: 260.75px; pointer-events: auto; position: absolute;\\"><div style=\\"width: 1440px; height: 260.75px; position: absolute;\\"><svg xmlns=\\"http://www.w3.org/2000/svg\\" version=\\"1.1\\" style=\\"left: 0px; top: 0px; width: 1440px; height: 261px; position: absolute; overflow: visible;\\"><g><path class=\\"fill_stroke ppt-editor-cursor-global-auto-3GgYO\\" stroke=\\"none\\" stroke-width=\\"1.5\\" stroke-dasharray=\\"0\\" stroke-linejoin=\\"miter\\" stroke-linecap=\\"butt\\" stroke-opacity=\\"1\\" fill=\\"none\\" fill-opacity=\\"1\\" d=\\"M 0 0 L 1440 0 L 1440 260.7499212598425 L 0 260.7499212598425 Z\\" pointer-events=\\"auto\\" style=\\"user-select: text;\\"></path></g></svg></div></div></div></div>"}')},"./store/offline-editor/persistent-manager.ts":
/*!****************************************************!*\
  !*** ./store/offline-editor/persistent-manager.ts ***!
  \****************************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,n++)r[n]=i[a];return r},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentOperation=t.PersistentReport=void 0;var i,a=n(o(/*! ../../common/log-utils */"./common/log-utils.ts")),l=o(/*! ../../network/services/api */"./network/services/api.ts"),s=n(o(/*! ../../event/event */"./event/event.ts")),c=n(o(/*! lodash/get */"../node_modules/lodash/get.js")),d=o(/*! ../changeset-manager */"./store/changeset-manager.ts"),u=o(/*! ../../app/revision-manager */"./app/revision-manager.ts"),p="[PersistentManager]",h="TencentDocs-PPT-ChangesetPacks",f="objectStore_Changeset";window._,function(e){e[e.UNKNOWN=-1]="UNKNOWN",e[e.LAUNCH=0]="LAUNCH",e[e.DID_RECOVER=1]="DID_RECOVER",e[e.REMOVE_HANGED_ITEMS=2]="REMOVE_HANGED_ITEMS",e[e.HAS_MEMORY_CS=3]="HAS_MEMORY_CS",e[e.VALID_CS_EMPTY=4]="VALID_CS_EMPTY",e[e.HANGED=10001]="HANGED",e[e.FETCH_FAIL=10002]="FETCH_FAIL"}(i=t.PersistentReport||(t.PersistentReport={})),function(e){e.DELETION="2",e.CHANGE="3",e.REMOVE="4",e.ERROR="5",e.GETALL="6",e.ADDTION_OR_UPDATE_SEQ="7",e.UPDATE_VERSION="8"}(t.PersistentOperation||(t.PersistentOperation={}));var m=function(){function e(e,t){var o=this;this.EVENT_WILL_RECOVER_PER_DATA="EVENT_WILL_RECOVER_PER_DATA",this.EVENT_DID_RECOVER_PER_DATA="EVENT_DID_RECOVER_PER_DATA",this.EVENT_PERSISTENT_CHANGESET_GETALL="EVENT_PERSISTENT_CHANGESET_GETALL",this.EVENT_ONLINE_2_OFFLINE="EVENT_ONLINE_2_OFFLINE",this.EVENT_OFFLINE_2_ONLINE="EVENT_OFFLINE_2_ONLINE",this._isDidRecover=!1,this._didRecoverCheckCount=0,this._isWork=!1,this._indexedbInited=!1,this._isMobile=!1,this.pullChangesetPacksJsonString=function(e){var t=e,r=[];return"string"==typeof t&&t.length>0&&((r=JSON.parse(t))&&Array.isArray(r)?(o._log("jsonObject",r),o._changesetPackCaches.splice(0),r&&r.forEach((function(e){var t=e;o._changesetPackCaches.push(t)})),o.saveCacheImmediately()):(o._log("jsonObject === null"),r=[])),r},this.onbeforeUnload=function(){0===o._changesetPackCaches.length?!0===o._indexedbInited&&o.openDatabaseAndDeletion():o.saveCacheImmediately()},this.saveCacheImmediately=function(){var e={changeSetPacks:o._changesetPackCaches,id:o._objectStoreName};o.updateToDatabase(f,e,(function(e,t){if(t){var r=[];e&&e.changeSetPacks.forEach((function(e){r.push({rev:e.revision,seq:e.seq})}))}else o._log(p+"更新数据库数据 - 失败")}))},this.initialize=function(e){o.openDatabase(h,2,(function(t){if(t){o.setBusinessListener(e);var r=e&&e.revisionManager.revision;o.getAllData(o._objectStoreName,r)}else o._log(p+"数据库创建或打开失败")}))},this.checkInvalidFlag=function(e){l.pdfSupports("218").then((function(t){var r=t.data;o._isWork=o.parseCgiData(r),o._isWork?o.initialize(e):o.openDatabaseAndDeletion()}))},this.parseCgiData=function(e){var t=!1;if(e){var r=e.retcode,n=e.infos;0===r&&n&&n.length?t=n[0].is_open:(o._log(p+"cgi调用失败"),a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"cgi_error"}))}else t=!1;return t},this._log=function(e,t){t?a.default.info(e,t):a.default.info(e)},this.openDatabaseAndDeletion=function(){o.openDatabase(h,2,(function(e){e?o.deleteToDatabase(f,o._objectStoreName,(function(e){e||o._log(p+"openDatabaseAndClear 更新数据库数据 - 失败")})):o._log(p+"数据库创建或打开失败")}))},this.willRecoverPersistentData=function(){o._event.emit(o.EVENT_WILL_RECOVER_PER_DATA),a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:i.LAUNCH}),o._didRecoverChecker=setInterval((function(){o._didRecoverCheckCount<3?o._didRecoverCheckCount+=1:(a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:i.HANGED}),clearInterval(o._didRecoverChecker))}),3e3)},this.didRecoverPersistentData=function(){o._isDidRecover=!0,o._event.emit(o.EVENT_DID_RECOVER_PER_DATA),clearInterval(o._didRecoverChecker),a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:i.DID_RECOVER})},this.handleGetAll=function(e,t){if(e&&e.changeSetPacks&&e.changeSetPacks.length>0){o._reportTimesObj.getDataFromDBTime=(new Date).getTime()-o._reportTimesObj.getDataFromDBTime,o.willRecoverPersistentData();for(var r=[],n=0;n<e.changeSetPacks.length;n++){var l=e.changeSetPacks[n];if(l.sendedCount>=1&&o.reportSendFailedDetail(l),!(l.sendedCount<3)){o.saveCacheImmediately(),a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:i.REMOVE_HANGED_ITEMS});break}r.push(l),o._changesetPackCaches.push(l),l.sendedCount=l.sendedCount+1}if(r.length>0){var s={changesetPacks:r};o._event.emit(o.EVENT_PERSISTENT_CHANGESET_GETALL,s),o.updateBaseRevision(t)}else o.didRecoverPersistentData(),a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:i.VALID_CS_EMPTY})}},this.getAllData=function(e,t){o._reportTimesObj.getDataFromDBTime=(new Date).getTime(),o.getAllChangeset(f,e,(function(e,r){r?o.handleGetAll(e,t):(o._log(p+"getAll获取数据失败"),o.didRecoverPersistentData())}))},this.setSlideAppReadyEventListener=function(e,t){if(e){var r="ready";t&&(r="firstPageDisplay"),e.event.on(r,(function(){o._objectStoreName=e.docStore.globalPadId+"_"+e.docStore.userId,e.editable?o.checkInvalidFlag(e):o.openDatabaseAndDeletion()}))}},this.createNewChangesetPack=function(e){var t=[];e.cs.forEach((function(e){t.push(r(e))}));var o=[];e.revert&&e.revert.forEach((function(e){o.push(r(e))}));var n={cs:t,revert:o,revision:e.revision,seq:e.seq,state:e.state,combinedSeq:0,sendedCount:0,source:e.source,track:e.track};return e.terminal&&(n.terminal=e.terminal),n},this.onOffline=function(){o.saveCacheImmediately()},this.online2Offline=function(){o.event.emit(o.EVENT_ONLINE_2_OFFLINE)},this.offline2Online=function(){o.event.emit(o.EVENT_OFFLINE_2_ONLINE)},this.setBusinessListener=function(e){return e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_ADDITION_OR_UPDATE_SEQ,o.additionOrUpdate),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_DELETION,o.deletionSingle),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_REMOVE_INVALID,o.deletionMutiple),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_ERROR,o.error),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_MODIFY,o.modify),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_RESTORED,o.restored),e.presentationStore.changeSetManager.event.on(d.EVENT_PERSISTENT_CHANGESET_DID_RECOVER,o.didRecoverPersistentData),e.revisionManager.event.on(u.RevisionUpdateBaseRevison,o.updateBaseRevision),e.revisionManager.event.on(u.RevisionOnline2Offline,o.online2Offline),e.revisionManager.event.on(u.RevisionOffline2Online,o.offline2Online),window.addEventListener("offline",o.onOffline),!0},this.restored=function(e){if(e){var t=e.duplicateTime,r=e.mergeConflictTime;if(e.hasData){o._reportTimesObj.duplicateTime=t,o._reportTimesObj.mergeConflictTime=r;var n=JSON.stringify(o._reportTimesObj);a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"times",ver6:n})}}o.didRecoverPersistentData()},this.additionOrUpdate=function(e){if(e){var t=e.targetSeq,r=e.combinedSeq,n=e.changeset;if(t&&r&&n){var i=o.createNewChangesetPack(n);o.handleAddtionOrUpdate(t,r,i,o._changesetPackCaches),o.saveCacheImmediately()}else o._log(p+"additionOrUpdateSeq arg invalid,targetSeq:"+(t||-1)+",combinedSeq:"+(r||-1))}else o._log(p+"additionOrUpdateSeq arg invalid")},this.handleAddtionOrUpdate=function(e,t,r,n){for(var i=!1,a=r,l=0;l<n.length;l++){var s=n[l];s.seq===e&&(i=!0,s.combinedSeq=t,s.cs=a.cs,o._log(p+"handleAddtionOrUpdate 更新combineSeq:",{rev:s.revision,seq:s.seq,combinedSeq:s.combinedSeq}))}!1===i&&(a.combinedSeq=t,n.push(r),o._log(p+"handleAddtionOrUpdate 新增Item:",{rev:r.revision,seq:r.seq,combinedSeq:r.combinedSeq}))},this.deletionSingle=function(e){if(e){var t=e.changeset;t?(o.handleDeletion([t.seq],o._changesetPackCaches),o.saveCacheImmediately()):o._log(p+" deletionSingle param:changese is invalid")}},this.deletionMutiple=function(e){if(e){var t=e;o.handleDeletion(t,o._changesetPackCaches),o.saveCacheImmediately()}},this.handleDeletion=function(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)e[r]===t[n].seq&&(o._log(p+"handleDeletion 删除item:",{rev:t[n].revision,seq:t[n].seq,combinedSeq:t[n].combinedSeq}),t.splice(n,1),n-=1)},this.error=function(e){if(e){var t=e.changeset;t?(o.handleError(t.seq,o._changesetPackCaches),o.saveCacheImmediately()):o._log(p+" error param:changese is invalid")}},this.handleError=function(e,t){for(var r=!1,n=0;n<t.length;n++)t[n].seq===e&&(r=!0),r&&(o._log(p+"handleError 删除Item:",{rev:t[n].revision,seq:t[n].seq,combinedSeq:t[n].combinedSeq}),t.splice(n,1),n-=1)},this.modify=function(e){if(e){var t=e.changeset,r=e.reason;t&&void 0!==r?o._changesetPackCaches.forEach((function(e){var o=e;o.seq===t.seq&&(o.reason=r)})):o._log(p+" modify param is invalid")}},this.updateBaseRevision=function(e){e&&(o.handleUpdateBaseRevision(e,o._changesetPackCaches),o.saveCacheImmediately())},this.handleUpdateBaseRevision=function(e,t){for(var o=0;o<t.length;o++)t[o].revision=e},this.openDatabase=function(e,t,r){var n=window.indexedDB.open(e,t);n.onerror=function(){o._log(p+"数据库打开 - 失败"),r&&r(!1);var e={error:n.error||{},action:"openDatabase"};a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"indexedb_error",ver6:JSON.stringify(e),ver7:n.error&&n.error.name})},n.onsuccess=function(){o._db=n.result,o._indexedbInited=!0,r&&r(!0),n.result.objectStoreNames.contains(f)||a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"object_store_invalid"})},n.onupgradeneeded=function(){n.result.objectStoreNames.contains(f)||(n.result.createObjectStore(f,{keyPath:"id"}).transaction.oncomplete=function(){o._indexedbInited=!0})}},this.getAllChangeset=function(e,t,r){if(o._db){var n=o._db.transaction([e]).objectStore(e).get(t);n.onsuccess=function(){var e=n.result;e||(e={changeSetPacks:[],id:t}),r&&r(e,!0)},n.onerror=function(){o._log(p+"getAllChangeset - 失败 - 原因:"+n.error),r&&r({changeSetPacks:[],id:t},!1);var e={error:n.error||{},action:"getAllChangeset"};a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"indexedb_error",ver6:JSON.stringify(e),ver7:n.error&&n.error.name})}}else r&&r(null,!1)},this.updateToDatabase=function(e,t,r){if(o._db){var n=o._db.transaction([e],"readwrite").objectStore(e).put(t);n.onsuccess=function(){r&&r(t,!0)},n.onerror=function(){o._log(p+"updateToDatabase 更新数据库的数据 - 失败 - 原因:"+n.error),r&&r(t,!1);var e={error:n.error||{},action:"updateToDatabase"};a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"indexedb_error",ver6:JSON.stringify(e),ver7:n.error&&n.error.name})}}else r&&r(null,!1)},this.deleteToDatabase=function(e,t,r){if(o._db){var n=o._db.transaction([e],"readwrite").objectStore(e).delete(t);n.onsuccess=function(){r&&r(!0)},n.onerror=function(){o._log(p+"deleteToDatabase 更新数据库的数据 - 失败 - 原因:"+n.error),r&&r(!1);var e={error:n.error||{},action:"deleteToDatabase"};a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"indexedb_error",ver6:JSON.stringify(e),ver7:n.error&&n.error.name})}}else r&&r(!1)},this._event=new s.default,this._changesetPackCaches=[],this._reportTimesObj={getDataFromDBTime:0,duplicateTime:0,mergeConflictTime:0},t&&(this._isMobile=/(mobile)/i.test(t));var n=/TDAppDesktop/i.test(t);!1===/TencentDocs/i.test(t)&&!1===n&&(window.indexedDB||this._log(p+"不支持indexdb"),this._log(p+"对象初始化成功"))}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.reportSendFailedDetail=function(e){var t=e.cs,o=null!=c.default(t,"[0][0]")?JSON.stringify(t[0][0]):"",r=e.reason?e.reason:i.UNKNOWN,n={revision:e.revision,state:e.state,seq:e.seq,combinedSeq:e.combinedSeq,sendedCount:e.sendedCount};return a.default.tdw({opername:"quality_slide",module:"offline-edit",action:"offline-edit-error-reason",ver5:r,ver6:JSON.stringify(n),ver7:o}),{firstOperationStr:o,reportString:JSON.stringify(n),reason:r}},e}();t.default=m},"./store/presentation-store.ts":
/*!*************************************!*\
  !*** ./store/presentation-store.ts ***!
  \*************************************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.hasOwnProperty.call(e,o)&&r(t,e,o);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PresentationStore=void 0;var l=o(/*! ../component */"./component/index.ts"),s=a(o(/*! ./command-manager */"./store/command-manager.ts")),c=o(/*! ../common/transaction */"./common/transaction.ts"),d=o(/*! ../common/tableUtils */"./common/tableUtils.ts"),u=i(o(/*! ./changeset-manager */"./store/changeset-manager.ts")),p=o(/*! ../common/utils */"./common/utils.ts"),h=a(o(/*! ../common/log-utils */"./common/log-utils.ts")),f=a(o(/*! ../test/test */"./test/test.ts")),m=o(/*! ../common/rules-merge */"./common/rules-merge.ts"),y=a(o(/*! ../event/event */"./event/event.ts")),g=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),v=o(/*! ../component/note */"./component/note.ts"),_=a(o(/*! ../app/search-manager */"./app/search-manager.ts")),b=o(/*! ../common/validity-check */"./common/validity-check.ts"),T=o(/*! ../constants/changeset-constants */"./constants/changeset-constants.ts"),S=a(o(/*! lodash/cloneDeep */"../node_modules/lodash/cloneDeep.js")),C=a(o(/*! lodash/unset */"../node_modules/lodash/unset.js")),w=a(o(/*! lodash/mergeWith */"../node_modules/lodash/mergeWith.js")),E=a(o(/*! lodash/create */"../node_modules/lodash/create.js")),I=a(o(/*! lodash/get */"../node_modules/lodash/get.js")),x=a(o(/*! lodash/set */"../node_modules/lodash/set.js")),R=(window._,{}),O=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),P=function(){function e(e){var t=this;this.selectedSlidesInfo=[];var o=R;p.isLocalDebug()&&(localStorage.ppt&&(o=JSON.parse(localStorage.ppt)),this.presentation=new l.Presentation(o,{cloneDeep:!1})),this._event=new y.default,this.changeSetManager=new u.default(e),this.changeSetManager.event.on("undo_redo",(function(e){t.event.emit("undo_redo_change",t.canUndo(),t.canRedo()),t.event.emit("apply_changeset",e,l.ChangeCause.Operation)})),(p.isDevelopment()||p.isLocalDebug())&&(window._&&(window._.cloneDeep=S.default),window.presentation=this.presentation,window.csmgr=this.changeSetManager,window.store=this,window.cs=O,window.test=f.default,window.search=_.default)}return Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.loadNewPresentation=function(e,t){void 0===t&&(t=!1),(new Date).getTime(),window.PAMarkLog&&window.PAMarkLog("PresentationStore loadNewPresentation begin");try{var o=(new Date).getTime(),r=JSON.parse(e),n=(new Date).getTime();this.presentation=new l.Presentation(r,{cloneDeep:!1});var i=(new Date).getTime();s.default.clear(),(p.isDevelopment()||p.isLocalDebug())&&(window.presentation=this.presentation),this.loadDataStatistics={succeeded:!0,json_costs:n-o,init_costs:i-n,text_len:e.length},t&&this.dispatchEvent("loadNewPresentation",this.loadDataStatistics),p.isLocalDebug()&&(localStorage.ppt=e),this.autoRepair()}catch(o){this.loadDataStatistics={succeeded:!1,text_len:e?e.length:"",error:o.name},t&&this.dispatchEvent("loadNewPresentation",this.loadDataStatistics),p.isLocalDebug()&&(localStorage.ppt=""),window.PALog&&window.PALog("PresentationStore loadNewPresentation error!")}window.PAMarkLog&&window.PAMarkLog("PresentationStore loadNewPresentation end"),this.onDidChange&&this.onDidChange({type:"data_change"},t)},e.prototype.autoRepair=function(){var e=this,t=setTimeout((function(){!function(){try{e.presentation.children.forEach((function(t,o){if(t.dirty){C.default(t,"dirty"),h.default.warn("[CS]:自动修复Slide的数据问题，位于"+o);var r=g.makePatch([g.makeOperation({op:"replace",path:"/slideList/"+o,value:p.cloneDeep(t),target:""})]);g.addTidForPatch(r,e.presentation),g.addPidForPatch(r,e.presentation);var n=u.makeChangesetPack([r],[r],T.ChangeSetSource.Customize);e.changeSetManager.sendChangesetWithoutUserOperation(n)}t.children.forEach((function(r,n){if(r instanceof l.Table&&r.dirty){C.default(t,"dirty"),h.default.warn("[CS]:自动修复错误的表格数据，位于"+o+"/"+n);var i=g.makePatch([g.makeOperation({op:"replace",path:"/slideData/groupShape/shapeList/"+n,value:p.cloneDeep(r),target:"/slideList/"+o})]);g.addTidForPatch(i,t),g.addPidForPatch(i,t);var a=u.makeChangesetPack([i],[i],T.ChangeSetSource.Customize);e.changeSetManager.sendChangesetWithoutUserOperation(a)}}))}))}catch(e){}}(),clearTimeout(t)}),1e3)},e.prototype.commitAdditionalPropsToPresentation=function(e){if(e){b.checkUndefinedInData(e);var t=g.getChangesetByUpdateProps(e,this);if(t&&t.length>0){t[0].target="";var o=g.makePatch(t);g.addTidForPatch(o,this.presentation),g.addPidForPatch(o,this.presentation);var r=g.inversePatch(o,this.presentation);if(r&&r.length>0){var n=u.makeChangesetPack([o],[r],T.ChangeSetSource.Customize);this.changeSetManager.sendChangesetWithoutUserOperation(n),w.default(this.presentation,e)}}}},e.prototype.getAllShapesBySlide=function(e){if(!e)return h.default.warn("slide不存在"),[];var t=e.getLayout(),o=e.getMaster(),r=Array();return 0!==e.showMasterSp&&t&&(0!==t.showMasterSp&&o&&r.push.apply(r,o.getShapes().filter((function(e){return!e.isPlaceholder}))),r.push.apply(r,t.getShapes().filter((function(e){return!e.isPlaceholder})))),r.push.apply(r,e.getShapes()),r},e.prototype.getLayoutList=function(){var e=this;if(!this.presentation)throw new Error("presentation不存在");var t=Array();return this.presentation.layoutList.forEach((function(o){var r=e.getInheritPropertiesByComponent(o);r&&t.push(r)})),t},e.prototype.getHlinkSchemaColor=function(e){var t={colorType:"scheme",colorValue:"hlink"};return this.replaceThemeInfo({color:t},e),t},e.prototype.getInheritPropertiesByComponent=function(e){var t,o;if(e){try{if(e instanceof l.Layout||e instanceof l.Slide)t=this.getAllPropertiesBySlide(e),o=e;else if(e instanceof l.Table)t=this.getAllPropertiesByTable(e),o=e.parentSlideNode;else if(e instanceof l.BaseShape)t=e.isPlaceholder?this.getAllPropertiesByPlaceholder(e):p.cloneDeepWith(e,(function(e,t,o){if(void 0!==o&&e instanceof l.BaseComponent)return e})),o=e.parentSlideNode;else{if(!(e instanceof v.Note))return;t=S.default(e),o=e.parentSlideNode}}catch(r){t=p.cloneDeep(e),o=e instanceof l.Slide?e:e.parentSlideNode,h.default.error("getInheritPropertiesByComponent error",r)}return this.replaceThemeInfo(t,o),t}},e.prototype.getAllPropertiesByTableWithoutTextStyleList=function(e){if(e&&e.parentSlideNode){var t=e.parentSlideNode,o=p.cloneDeep(e);return d.TableStyleMergeHelper.applyTableSytleToTableCell(o,this.presentation.tblStyleList),this.replaceThemeInfo(o,t),o}},e.prototype.getAllPropertiesByPlaceholder=function(e){if(e&&e.parentSlideNode){var t=e.parentSlideNode.getLayout(),o=e.parentSlideNode.getMaster(),r=t&&t.findShapeByPlaceholder(e.props.placeholder),n=o&&o.findShapeByPlaceholder(e.props.placeholder),i=E.default(e.__proto__);return n&&w.default(i,n,m.MergeRule.rules(m.MergeRule.Text,m.MergeRule.FillGet,m.MergeRule.Placeholder)),r&&w.default(i,r,m.MergeRule.rules(m.MergeRule.Text,m.MergeRule.FillGet,m.MergeRule.Placeholder)),w.default(i,e,m.MergeRule.rules(m.MergeRule.Text,m.MergeRule.FillGet,m.MergeRule.Placeholder)),e.isCustomPlaceholder||(I.default(r,"props.placeholder.hasCustomPrompt")?x.default(i,"textBody.paragraphList[0]",I.default(r,"textBody.paragraphList[0]")):I.default(n,"props.placeholder.hasCustomPrompt")&&x.default(i,"textBody.paragraphList[0]",I.default(n,"textBody.paragraphList[0]"))),i}h.default.error("异常节点")},e.prototype.getAllPropertiesBySlide=function(e){if(e){var t=e.getLayout(),o=e.getMaster(),r=p.cloneDeep(e),n={},i=function(e){return I.default(e,"slideData.background.solidFill")||I.default(e,"slideData.background.image")||I.default(e,"slideData.background.gradFill")?I.default(e,"slideData.background"):null};return e instanceof l.Layout?n=i(t)||i(o):e instanceof l.Slide&&(n=i(e)||i(t)||i(o)),r.slideData.background=n||{},r}},e.prototype.getAllPropertiesByTable=function(e){if(!e||!e.parentSlideNode)return null;var t=e.parentSlideNode,o=(t.getLayout(),t.getMaster());if(!o)return null;var r=p.cloneDeep(e);d.TableStyleMergeHelper.applyTableSytleToTableCell(r,this.presentation.tblStyleList);var n=function(e,t){var o=e.find((function(e){return e.level===t.level}));return o||(o=E.default(t.__proto__),e.push(o)),w.default(o,t,(function(e,t,o){if("color"===o)return t||e})),e},i=p.cloneDeep(o.otherTextStyleList),a=this.presentation.tblStyleList&&this.presentation.tblStyleList.tableStyleEntryList.find((function(t){return t.styleId==I.default(e,"graphicData.tbl.tblPr.styleId")}));return a&&i.forEach((function(e){x.default(e,"defaultRunProps.solidFill.color",I.default(a,"wholeTbl.tcTxStyle.color"))})),r.rowList.forEach((function(e){e.tcList.forEach((function(e){var t;if(e.textBody){var o=e.textBody.textStyleList;o||e.textBody?(t=p.cloneDeep(i),o&&o.reduce(n,t),t.forEach((function(t){t.defaultRunProps&&e.tcPr&&(e.tcPr.temp_tx_b&&(t.defaultRunProps.bold=e.tcPr.temp_tx_b),e.tcPr.temp_tx_color&&x.default(t,"defaultRunProps.solidFill.color",e.tcPr.temp_tx_color),e.tcPr.temp_tx_i&&(t.defaultRunProps.italic=e.tcPr.temp_tx_i))}))):t=i,e.textBody.textStyleList=t}}))})),r},e.prototype.getStyleListByShape=function(e){if(!(e instanceof l.Shape&&e.parentSlideNode))return null;var t=e.parentSlideNode,o=Array(),r=t.getLayout(),n=t.getMaster(),i=function(e,t){var o=e.find((function(e){return e.level===t.level}));return o||(o=E.default(t.__proto__),e.push(o)),w.default(o,t,(function(e,t,o){if("color"===o)return t||e})),e};if(e.isPlaceholder){var a=r&&r.findShapeByPlaceholder(e.props.placeholder),s=void 0;switch(e.props.placeholder.type){case"title":case"ctrTitle":s=n&&n.titleTextStyleList;break;case"dt":case"ftr":case"sldNum":s=this.presentation.defaultTextStyleList;break;default:s=n&&n.bodyTextStyleList}var c=a&&a.textBody.textStyleList;u=e.textBody.textStyleList,s&&s.reduce(i,o),c&&c.reduce(i,o),u&&u.reduce(i,o)}else{var d=this.presentation.defaultTextStyleList,u=e.textBody.textStyleList;d&&d.reduce(i,o),u&&u.reduce(i,o)}var p=e.parentSlideNode;return p&&this.replaceThemeInfo(o,p),o.forEach((function(e){var t=e.defaultRunProps;t&&null==t.font_size&&(t.font_size=1800)})),o},e.prototype.replaceThemeInfo=function(e,t){var o=t.getLayout(),r=t.getMaster(),n=r&&this.presentation.findThemeById(r.themeId);return n?(function e(t,o,r){for(var n in t)if(t.hasOwnProperty(n))if("color"===n){var i=t[n];l.replaceThemeColor(i,o,r)}else t[n]instanceof l.BaseComponent||"object"==typeof t[n]&&e(t[n],o,r)}(e,n,I.default(o,"clrMapOvr.overrideClrMapping")||I.default(r,"clrMap")),e):e},e.prototype.batchUpdateShapeProps=function(e,t){return!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length||(c.transaction((function(){e.forEach((function(e,o){e.updateProps(t[o])}))})),0))},e.prototype.undo=function(){s.default.undo(this)&&this.event.emit("undo_redo_change",this.canUndo(),this.canRedo())},e.prototype.redo=function(){s.default.redo(this)&&this.event.emit("undo_redo_change",this.canUndo(),this.canRedo())},e.prototype.canUndo=function(){return s.default.canUndo()},e.prototype.canRedo=function(){return s.default.canRedo()},e.prototype.applyChangeSet=function(e,t,o){o&&h.default.info("[CS]:Apply changeset, "+o,e);var r=this.presentation.applyChangeset(e,t);return t!==l.ChangeCause.Memory&&this.event.emit("apply_changeset",e,t),r},e.prototype.handleChanges=function(e){h.default.info("[CS]:Undo|Redo, Apply changeset",e);var t=p.cloneDeep(this.presentation);if(g.mergeconflictWithChangeSet(e,t),0===e.length)return h.default.info("[CS]:Undo|Redo, Merge conflict end, changes empty"),[];var o=this.presentation.applyChangesetByUndoRedo(e),r=u.makeChangesetPack(e,o,T.ChangeSetSource.UndoRedo);return this.changeSetManager.sendChangeset(r),this.event.emit("apply_changeset",e,l.ChangeCause.UndoRedo),o},e.prototype.dispatchEvent=function(e,t,o){var r=this;void 0===o&&(o=!0);var n=function(){r.event.emit(e,t)};o?n():setTimeout((function(){n()}),0)},e.prototype.magic=function(){window.presentation=this.presentation,window.csmgr=this.changeSetManager,window.store=this,window.cs=O},e}();t.PresentationStore=P},"./test/test.ts":
/*!**********************!*\
  !*** ./test/test.ts ***!
  \**********************/
/*! no static exports found */function(e,t,o){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var n=r(o(/*! ../store/command-manager */"./store/command-manager.ts")),i=o(/*! ../common/utils */"./common/utils.ts"),a=o(/*! .. */"./index.ts"),l=o(/*! ../common/changeset-utils */"./common/changeset-utils.ts"),s=new(function(){function e(){this._snaptshot={}}return e.prototype.addCommand=function(e){this._changeset1?this._changeset2?(this._changeset1=this._changeset2,this._changeset2=e.cs,this._command1=this._command2,this._command2=e):(this._changeset2=e.cs,this._command2=e):(this._changeset1=e.cs,this._command1=e)},e.prototype.clearChangeSetCache=function(){this._changeset1=void 0,this._changeset2=void 0},e.prototype.snapshot=function(){this._snaptshot.undo=n.default.getAllCommands(),this._snaptshot.undoIndex=n.default.currentIndex,this._snaptshot.presentation=i.cloneDeep(a.Store.presentation)},e.prototype.revert=function(){var e;a.Store.presentation=new a.Presentation(this._snaptshot.presentation),a.Store._testOnDidChange&&a.Store._testOnDidChange({type:"data_change"}),window.presentation=a.Store.presentation,n.default.commandCache.splice(0),(e=n.default.commandCache).push.apply(e,this._snaptshot.undo),n.default.currentIndex=this._snaptshot.undoIndex},e.prototype.testHasConflictWithPatchByRuleOfSameTarget=function(){var e=this;if(this._changeset1)return this._changeset1.map((function(t){return!!e._changeset2&&e._changeset2.some((function(e){return l.hasConflictWithPatchByRuleOfSameTarget(t,e)}))}))},e.prototype.testBelongToSameSlide=function(){var e=this;if(this._changeset1)return this._changeset1.map((function(t){return!!e._changeset2&&e._changeset2.some((function(e){return l.belongToSameSlide(t,e)}))}))},e.prototype.testMergeConflictWithChangeSet=function(){this._changeset1&&(l.mergeconflictWithChangeSet(this._changeset1,a.Store.presentation),a.Store._testOnDidChange({type:"data_change"}))},e.prototype.testHandleCommitConflict=function(){window.csmgr.changeSetCache.splice(0),window.csmgr.changeSetCache.push(this._command1),window.csmgr.handleCommitConflict([this._command2.cs])},e.prototype.makeTable=function(e,t,o,r){return a.Table.makeTable(e,t,o,r)},e}());t.default=s},"@tencent/docs_collabroom":
/*!********************************************************************************************************************************!*\
  !*** external {"commonjs":"@tencent/docs_collabroom","commonjs2":"@tencent/docs_collabroom","amd":"@tencent/docs_collabroom"} ***!
  \********************************************************************************************************************************/
/*! no static exports found */function(e,t){e.exports=o(6)}})},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n=o(41);!function(e){e.rename="rename",e.delete="delete"}(r=t.actionName||(t.actionName={})),t.renameAction={name:r.rename,path:"doc_changetitle"},t.deleteAction={name:r.delete,path:"doc_delete"};var i=function(e,t,o,r,i){this.uid=n.getCookie("uid"),this.key=e+t.name,this.globalId=e,this.action=t,this.from=o,this.to=r,this.retries=0,this.padInfo=i};t.Change=i,t.default=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,o,r,n){this.isMydoc=!1,this.isRencent=!1,this.isStar=!1,this.isDelete=!1,this.id=e,void 0!==t&&(this.isMydoc=t),void 0!==o&&(this.isRencent=o),void 0!==n&&(this.isDelete=n),void 0!==r&&(this.isStar=r)};t.ListType=r,t.default=r},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1,n=function(){function e(){}return e.setForceRefresh=function(e){r=e},e.isForceRefresh=function(){return r},e}();t.DebugUtils=n},function(e,t,o){"use strict";var r=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,l=o(119),s=o(92),c=o(41),d=o(40),u=i(o(39)),p=o(14),h=o(45),f=o(57);!function(e){e.SNAP_SHOT="SNAP_SHOT",e.CHUNK="CHUNK",e.VERSION_DATA="VERSION_DATA"}(a||(a={})),t.DATA_TYPE=a;var m={data:{startRow:-1,endRow:-1,data:[[]]}},y=function(){function e(){}return e.getDatabaseInstance=function(){return r(this,void 0,void 0,(function(){var e,t,o;return n(this,(function(r){switch(r.label){case 0:if(this.dbInstance)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(e=new l.OfflineDataManager({businessType:d.FILE_TYPE.EXCEL,user:new s.UserInfo({uid:this.uid})})).init()];case 2:return(t=r.sent()).error?(u.default.error("getDatabaseInstance() init error",t.error),this._offlineDataManager=null,this.dbInstance=null,[2,null]):(this._offlineDataManager=e,this.dbInstance=e.database,[3,4]);case 3:return o=r.sent(),u.default.error("getDatabaseInstance",o),[3,4];case 4:return[2,this.dbInstance]}}))}))},Object.defineProperty(e,"offlineDataManager",{get:function(){return e._offlineDataManager||null},enumerable:!0,configurable:!0}),e.loadDocumentData=function(e){var t,o;return r(this,void 0,void 0,(function(){var r,i,l,s,c,d,y,g,v,_,b,T,S,C,w,E,I,x,R,O,P,D,N,k,L,F,A,V,j,B=this;return n(this,(function(n){switch(n.label){case 0:return r=Date.now(),i=e.id,l=e.subId,s=e.onSuccess,c=e.onFail,[4,this.getDatabaseInstance()];case 1:return d=n.sent(),y=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.DOCUMENT,"ducument"]).orderby("version",p.IorderType.DECREASE).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,i),[4,d.get(h.TableName.DOCUMENT_DATA,y)];case 2:return(g=n.sent()).error?(c&&c(new Error("获取document信息失败 "+g.error)),[2]):(v=g.data,_=Date.now(),b=l&&v&&v.data&&v.data.collab_client_vars.header[0].d.filter((function(e){return e.id===l}))||[],l&&0!==b.length||(l=v&&v.data&&v.data.collab_client_vars.header[0].d[0].id||""),(T=v.data).collab_client_vars.padSubId=l,S=T.collab_client_vars.rev||0,"new"===T.padStatus?[3,5]:(E=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.ACCEPTED,f.OFFLINE_ITEM_TYPE.MISS_CHANGE,f.OFFLINE_ITEM_TYPE.NEW_CHANGE]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,i).orderby("version",p.IorderType.DECREASE).limit(0,1),[4,d.get(h.TableName.DOCUMENT_DATA,E)]));case 3:return(I=n.sent()).error&&!p.isNoResultError(I.error)?(u.default.error("获取增量版本数据失败",I.error),c&&c(new Error("获取增量版本数据错误")),[2]):(!I.error&&I.data&&(x=Math.max(S,I.data.version),T.collab_client_vars.rev=x),R=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.WORKBOOK,f.OFFLINE_ITEM_TYPE.CHUNK]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("subSheetId",p.QUERY_CONDITION_TYPE.IN,["workbook",l]).addCondition("chunkId",p.QUERY_CONDITION_TYPE.ONLY,0).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,i),[4,d.getAll(h.TableName.DOCUMENT_DATA,R)]);case 4:if((O=n.sent()).error)return c&&c(new Error("获取documentData信息失败 "+O.error)),[2];C=O.data.filter((function(e){return"workbook"===e.type}))[0],w=O.data.filter((function(e){return"chunk"===e.type}))[0],n.label=5;case 5:return w&&0!==(null===(t=w.data)||void 0===t?void 0:t.length)||(w={data:{startRow:0,endRow:200,data:null===(o=T.collab_client_vars)||void 0===o?void 0:o.initialAttributedText.text[0]}}),P=Date.now(),u.default.log("数据加载完成. document:"+(_-r)+"ms  workbook&subDocument: "+(P-_)+"ms"),s&&s({dataType:a.SNAP_SHOT,subId:l,clientVars:T,workbookData:C&&C.data||m.data,chunkData:w&&w.data||m.data}),D=Date.now(),u.default.log("首屏数据渲染完成:"+(D-r)+"ms"),N=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.ONLY,f.OFFLINE_ITEM_TYPE.CHUNK).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("subSheetId",p.QUERY_CONDITION_TYPE.ONLY,l).addCondition("version",p.QUERY_CONDITION_TYPE.ONLY,S).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,i).orderby("chunkId",p.IorderType.INCREASE),[4,d.getAll(h.TableName.DOCUMENT_DATA,N)];case 6:return(k=n.sent()).error?(c&&c(new Error("获取otherSubDocumentData信息失败 "+k.error)),[2]):(k.data.filter((function(e){return e.chunkId>=1})).forEach((function(e){s&&s({subId:l,dataType:a.CHUNK,chunkData:e.data})})),L=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.ACCEPTED,f.OFFLINE_ITEM_TYPE.MISS_CHANGE,f.OFFLINE_ITEM_TYPE.NEW_CHANGE]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,i).orderby("version",p.IorderType.INCREASE),[4,d.getAll(h.TableName.DOCUMENT_DATA,L)]);case 7:return(F=n.sent()).error?(c&&c(new Error("获取breakVersionData信息失败 "+F.error)),[2]):(A=F.data,V=A.map((function(e){return B.breakVersionDataParse(e)})).filter((function(e){return e.version>S})).sort((function(e,t){return e.version-t.version})),s&&s({subId:l,dataType:a.VERSION_DATA,chunkData:V,isFinished:!0}),j=Date.now(),u.default.log("所有分片渲染完成:"+(Date.now()-r)+"ms   breakVersion: "+(j-D)+"ms"),[2])}}))}))},e.loadBreakVersions=function(e,t,o){return r(this,void 0,void 0,(function(){var r,i,a,l,s,c=this;return n(this,(function(n){switch(n.label){case 0:return console.time("loadBreakVersions"),[4,this.getDatabaseInstance()];case 1:return r=n.sent(),i=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.ACCEPTED,f.OFFLINE_ITEM_TYPE.MISS_CHANGE,f.OFFLINE_ITEM_TYPE.NEW_CHANGE]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,e).orderby("version",p.IorderType.INCREASE),[4,r.getAll(h.TableName.DOCUMENT_DATA,i)];case 2:return(a=n.sent()).error?(Promise.reject(new Error("获取breakVersionData信息失败 "+a.error)),[2]):(l=a.data,s=l.map((function(e){return c.breakVersionDataParse(e)})).filter((function(e){return e.version>=t&&(void 0===o||e.version<=o)})),console.timeEnd("loadBreakVersions"),[2,Promise.resolve(s)])}}))}))},e.loadSubDocumentData=function(e){return r(this,void 0,void 0,(function(){var t,o,r,i,l,s,c,d,y,g,v,_,b,T,S,C,w,E,I,x,R,O,P,D,N=this;return n(this,(function(n){switch(n.label){case 0:return t=Date.now(),o=e.id,r=e.subId,i=e.baseVersion,l=e.onSuccess,s=e.onFail,void 0===o||void 0===r||void 0===i?(s&&s(new Error("loadSubDocumentData参数错误"+JSON.stringify(e))),[2]):[4,this.getDatabaseInstance()];case 1:return c=n.sent(),d=p.QueryCondition.newInstance().addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,o).orderby("version",p.IorderType.DECREASE).limit(0,1),[4,c.get(h.TableName.DOCUMENT_DATA,d)];case 2:return(y=n.sent()).error?(s&&s(new Error("获取文档最大本地缓存版本号错误 "+y.error)),[2]):(g=y.data.version)<i?(s&&s(new Error("本地缓存的数据版本号小于"+i+" 没办法返回所需的数据。 maxVersion="+g)),[2]):(v=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.ONLY,f.OFFLINE_ITEM_TYPE.CHUNK).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("subSheetId",p.QUERY_CONDITION_TYPE.ONLY,r).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,o).orderby("chunkId",p.IorderType.INCREASE),[4,c.getAll(h.TableName.DOCUMENT_DATA,v)]);case 3:return(_=n.sent()).error?(s&&s(new Error("获取subDocumentData信息失败 "+_.error)),[2]):(b=_.data,T=[],S=0,b.filter((function(e){return e.version<=i})).forEach((function(e){T.push(e),S=Math.max(S,e.version)})),0!==(T=T.filter((function(e){return e.version===S}))).length?[3,5]:(C=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.DOCUMENT,"ducument"]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,o),[4,c.get(h.TableName.DOCUMENT_DATA,C)]));case 4:if((w=n.sent()).error)return s&&s(new Error("检验是否本地有该文档缓存失败 "+w.error)),[2];T=[m],n.label=5;case 5:return E=Date.now(),u.default.log("子表主keyfrme数据读取完成:"+(E-t)+"ms"),l&&l({dataType:a.SNAP_SHOT,subId:r,chunkData:T}),I=Date.now(),u.default.log("子表keyframe渲染耗时:"+(I-E)+"ms"),x=p.QueryCondition.newInstance().addCondition("type",p.QUERY_CONDITION_TYPE.IN,[f.OFFLINE_ITEM_TYPE.ACCEPTED,f.OFFLINE_ITEM_TYPE.MISS_CHANGE,f.OFFLINE_ITEM_TYPE.NEW_CHANGE]).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,this.uid).addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,o).addCondition("subSheetId",p.QUERY_CONDITION_TYPE.ONLY,r).orderby("version",p.IorderType.INCREASE),[4,c.getAll(h.TableName.DOCUMENT_DATA,x)];case 6:return(R=n.sent()).error?(s&&s(new Error("获取breakVersionData信息失败 "+R.error)),[2]):(O=R.data,P=O.map((function(e){return N.breakVersionDataParse(e)})).filter((function(e){return e.version>S&&e.version<=i})).sort((function(e,t){return e.version-t.version})),D=Date.now(),u.default.log("子表增量版本数据读取耗时:"+(D-I)+"ms"),l&&l({dataType:a.VERSION_DATA,subId:r,chunkData:P,isFinished:!0}),u.default.log("子表增量版本数据应用耗时:"+(Date.now()-D)+"ms"),[2])}}))}))},e.clearDocumentCache=function(e,t){return r(this,void 0,void 0,(function(){var o,r,i;return n(this,(function(n){switch(n.label){case 0:return[4,this.getDatabaseInstance()];case 1:return o=n.sent(),r=p.QueryCondition.newInstance().addCondition("secretId",p.QUERY_CONDITION_TYPE.ONLY,e).addCondition("uid",p.QUERY_CONDITION_TYPE.ONLY,t),[4,o.delete(h.TableName.DOCUMENT_DATA,r)];case 2:return i=n.sent(),!i.error?[4,o.delete(h.TableName.DOCUMENT_STATUS,r)]:[3,4];case 3:i=n.sent(),n.label=4;case 4:return!i.error?[4,o.updateField(h.TableName.PAD_INFO,r,{isOfflineCache:!1})]:[3,6];case 5:i=n.sent(),n.label=6;case 6:return[2,i]}}))}))},e.breakVersionDataParse=function(e){return e.type===f.OFFLINE_ITEM_TYPE.ACCEPTED?{version:e.data.baseVersion,subId:e.data.data.subId,keyframe:e.data.data.keyData||void 0,data:e.data.data.mutations||e.data.data.changeData}:{version:e.data.newVersion,subId:e.data.sheetId,data:JSON.parse(e.data.changeset)}},e.uid=c.getCookie("uid"),e}();t.OfflineAPI=y},function(e,t,o){"use strict";function r(e){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}Object.defineProperty(t,"__esModule",{value:!0}),r(o(65)),r(o(128))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";o.d(t,"a",(function(){return b})),o.d(t,"b",(function(){return T}));var r,n=o(78),i=o(243),a=o(101),l=o.n(a),s=o(14),c=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},d=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=window.WebLog?new window.WebLog("flow"):{info:function(){},warn:function(){},error:function(){}},p="QuickLookDB";!function(e){e.QUICK_LOOK_WORD="QuickLookWord"}(r||(r={}));var h=function(){function e(){this.uid=l.a.get("uin")||l.a.get("uid")}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getSnapShotStyleKey=function(e){return e?"snapshot-iframe-style-pub":"snapshot-iframe-style"},e.prototype.getSnapShotBodyKey=function(e,t){return t?"snapshot-iframe-"+e+"-"+this.uid+"-pub":"snapshot-iframe-"+e+"-"+this.uid},e.prototype.deleteOldDB=function(){var e=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;e&&e.deleteDatabase&&e.deleteDatabase("docs_word_snapshot_db")},e.prototype.initDataBase=function(){return c(this,void 0,void 0,(function(){var e,t;return d(this,(function(o){switch(o.label){case 0:return this.database?[2,!0]:(this.deleteOldDB(),[4,(e=new s.default("docs_word_quicklook_db",[{tableName:r.QUICK_LOOK_WORD,keyName:"key"}],this.isSupportClientDB()?s.DBDriver.ClientDB:s.DBDriver.IndexDB,1)).init()]);case 1:return(t=o.sent()).error?(u.error(p,"初始化db失败",t.error),[2,!1]):(this.database=e.database,[2,!0])}}))}))},e.prototype.isSupportClientDB=function(){var e=navigator.userAgent.match(/_tdocFlag\/(\d+)/);return!(!e||!e[1])&&2&parseInt(e[1],10)},e.prototype.getSnapshotData=function(e,t,o){return void 0===o&&(o=!0),c(this,void 0,void 0,(function(){var n,i,a,l,c,h,f;return d(this,(function(d){switch(d.label){case 0:return this.database?(n=this.getSnapShotStyleKey(t),i=this.getSnapShotBodyKey(e,t),a="",o?[3,2]:(l=s.QueryCondition.newInstance().addCondition("key",s.QUERY_CONDITION_TYPE.ONLY,n),[4,this.database.get(r.QUICK_LOOK_WORD,l)])):(u.error(p,"获取数据失败，数据库未初始化"),[2,void 0]);case 1:if((c=d.sent()).error)return u.warn(p,"no such snapshot style",i),[2,void 0];a=c.data.data,d.label=2;case 2:return h=s.QueryCondition.newInstance().addCondition("key",s.QUERY_CONDITION_TYPE.ONLY,i),[4,this.database.get(r.QUICK_LOOK_WORD,h)];case 3:return(f=d.sent()).error?(u.warn(p,"no such snapshot body",i),[2,void 0]):[2,{style:a,body:f.data.data,time:f.data.time}]}}))}))},e.prototype.saveSnapshotData=function(e,t,o){return c(this,void 0,void 0,(function(){var n,i,a,l;return d(this,(function(s){switch(s.label){case 0:return this.database?(n=this.getSnapShotStyleKey(t),i=this.getSnapShotBodyKey(e,t),[4,this.database.update(r.QUICK_LOOK_WORD,{key:n,data:o.style,time:+new Date})]):(u.error(p,"保存数据失败，数据库未初始化"),[2,!1]);case 1:return a=s.sent(),[4,this.database.update(r.QUICK_LOOK_WORD,{key:i,data:o.body,time:+new Date})];case 2:return l=s.sent(),a.error||!a.data||l.error||!l.data?(u.error(p,"保存数据失败"),[2,!1]):[2,!0]}}))}))},e}(),f=o(3),m=o(15),y=o(49),g=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},v=function(e,t){var o,r,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(n=2&i[0]?r.return:i[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){a.label=i[1];break}if(6===i[0]&&a.label<n[1]){a.label=n[1],n=i;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(i);break}n[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{o=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},_=window.WebLog?new window.WebLog("flow"):{info:function(){},warn:function(){},error:function(){}},b=function(){function e(t,o){void 0===o&&(o=!0),this.secretId=t,this.hideNativeLoading=o,this.snapshotId="snap-shot-page",this.isPublish=!!e.getUrlParameter("pub")}return e.getUrlParameter=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=window.location.search.substr(1).match(t);return null!==o?unescape(o[2]):null},e.prototype.doQuickLook=function(){return g(this,void 0,void 0,(function(){var e;return v(this,(function(t){switch(t.label){case 0:return[4,h.getInstance().initDataBase()];case 1:return t.sent()?[4,this.getSnapshotData()]:[2,!1];case 2:return(e=t.sent())?[2,this.showSnapShot(e)]:(_.warn("QuickLook","获取snapshot失败"),[2,!1])}}))}))},e.prototype.hasSnapShotStyle=function(){var e=document.getElementById(this.snapshotId);if(e){var t=e&&(e.contentDocument||e.contentWindow&&e.contentWindow.document);if(t&&t.head.innerHTML.length>0)return!0}return!1},e.prototype.getSnapshotData=function(){return g(this,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return[4,h.getInstance().getSnapshotData(this.secretId,this.isPublish,this.hasSnapShotStyle())];case 1:return[2,e.sent()]}}))}))},e.prototype.showSnapShot=function(e){if(i.a.getInstance(this.secretId).docRendered||!document.getElementById(this.snapshotId)||i.a.getInstance(this.secretId).docRenderFailed)return!1;var t=document.getElementById(this.snapshotId);if(t){t.style.display="block",t.style.top="0";var o=t&&(t.contentDocument||t.contentWindow&&t.contentWindow.document);o&&(e.style.length&&!o.head.innerHTML.length&&(o.head.innerHTML=e.style),o.body.innerHTML=e.body,_.info("QuickLook","showSnapShot time",+new Date),window.setTimeout((function(){var e=o.getElementById("snap-shot-page-view");e&&(e.style.opacity="1")})))}return!0},e.prototype.hideFirsScreenLoading=function(){window.fisrtScreenLoading&&window.fisrtScreenLoading.hide(),this.hideNativeLoading&&window.jsApi&&window.jsApi.invokeNative&&window.jsApi.invokeNative("docx","firstLoadFinished",{},(function(){_.info("QuickLook","firstLoadFinished",(new Date).toString())}))},e.prototype.saveSnapshotData=function(e){return g(this,void 0,void 0,(function(){return v(this,(function(t){switch(t.label){case 0:return[4,h.getInstance().saveSnapshotData(this.secretId,this.isPublish,e)];case 1:return[2,t.sent()]}}))}))},e.prototype.hideSnapshot=function(){var e=document.getElementById(this.snapshotId);if(e){e.style.display="none";var t=e&&(e.contentDocument||e.contentWindow&&e.contentWindow.document);t&&(t.body.innerHTML="")}_.info("QuickLook","snapshotPage remove time",(new Date).toString())},e}(),T=function(){function e(){this.secretId=Object(n.a)(),this.url=window.location.href,this.quickLook=new b(this.secretId)}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.syncQuickLook=function(e){return this.quickLook.showSnapShot(e)},e.prototype.asyncQuickLook=function(){return g(this,void 0,void 0,(function(){var e;return v(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.quickLook.doQuickLook()];case 1:return[2,t.sent()];case 2:return e=t.sent(),_.warn("QuickLook","quickLook error",e),[2,!1];case 3:return[2]}}))}))},e.now=function(){return window.performance&&window.performance.timing&&window.performance.now?performance.timing.navigationStart+window.performance.now():Date.now()},e.prototype.start=function(t,o){return g(this,void 0,void 0,(function(){var r,n;return v(this,(function(a){switch(a.label){case 0:return r=!0,i.a.getInstance(this.secretId).quickLookShowTime=0,i.a.getInstance(this.secretId).docRendered=!1,i.a.getInstance(this.secretId).docRenderFailed=!1,this.quickLook=new b(this.secretId,!1),t&&o?(r=this.syncQuickLook({style:t.data,body:o.data,time:0}),[3,3]):[3,1];case 1:return[4,this.asyncQuickLook()];case 2:r=a.sent(),a.label=3;case 3:return r&&(n=e.now(),i.a.getInstance(this.secretId).quickLookShowTime=n,_.info("QuickLook","quickLook show result "+r,"show time: "+(n-i.a.getInstance(this.secretId).replaceUrlTime)),this.quickLook.hideFirsScreenLoading()),[2]}}))}))},e.prototype.onReset=function(e,t,o,r){return g(this,void 0,void 0,(function(){return v(this,(function(n){switch(n.label){case 0:return this.hide(!1),this.secretId=e,this.url=t,[4,this.start(o,r)];case 1:return n.sent(),[2]}}))}))},e.prototype.save=function(e,t){return void 0===t&&(t=!1),g(this,void 0,void 0,(function(){var o,r;return v(this,(function(n){switch(n.label){case 0:return[4,this.quickLook.saveSnapshotData(e)];case 1:return(o=n.sent())?[4,this.updateSnapshotPadInfo()]:[3,3];case 2:n.sent(),t&&b.getUrlParameter("prerender")&&window.mqq&&(r=window.clientVars?window.clientVars.collab_client_vars.dver:"0.0.0",window.mqq.invoke("docx","sendToParent",{func:"window&&window.preloadManager&&window.preloadManager.onPrerenderFinish",args:[this.url,r,"saveSnapshotData"]})),n.label=3;case 3:return[2,o]}}))}))},e.prototype.hide=function(e){if(void 0===e&&(e=!0),e){var t=document.getElementById("editor-mask");t&&(t.style.visibility="hidden",_.info("QuickLook","hideEditorMask",(new Date).toString()))}this.quickLook.hideSnapshot()},e.prototype.updateSnapshotPadInfo=function(){return g(this,void 0,void 0,(function(){var e,t,o,r;return v(this,(function(n){switch(n.label){case 0:e=y.a.get("uid"),t=f.QueryCondition.newInstance().addCondition("secretId",f.QUERY_CONDITION_TYPE.ONLY,this.secretId).addCondition("uid",f.QUERY_CONDITION_TYPE.ONLY,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m.c.getDataBase().get(f.TableName.PAD_INFO,t)];case 2:if((o=n.sent()).error)throw o.error;return o&&o.data&&(((r=o.data)&&r.status===f.PadStatus.LOCAL||r.status===f.PadStatus.NORMAL)&&(r.isSnapShot=!0),m.c.getDataBase().update(f.TableName.PAD_INFO,r)),[3,4];case 3:return n.sent(),_.warn("QuickLook","updateSnapshotPadInfo error"),[3,4];case 4:return[2]}}))}))},e}()},,,,,,,,,,,,function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var r=o(12),n=function(){function e(e){this.secretId=e,this.quickLookShowTime=0,this.replaceUrlTime=0,this.docRendered=!1,this.docRenderFailed=!1}return e.getInstance=function(t){var o=e.instanceMap.get(t);return o||(o=new e(t),e.instanceMap.set(t,o)),o},e.prototype.setClientVars=function(e){this.clientVars=e},e.prototype.getClientVars=function(){return this.clientVars||r.b},e.prototype.onDestroy=function(){e.instanceMap.delete(this.secretId)},e.instanceMap=new Map,e.replaceCount=0,e}()}]]);
//# sourceMappingURL=quicklooklib-pc.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{171:function(n,e,s){"use strict";s.r(e);var a,c,t=s(231);location.search.indexOf("pub")>-1&&(a=new RegExp("(^|&)"+"pub"+"=([^&]*)(&|$)","i"),null!==(c=window.location.search.substr(1).match(a))&&unescape(c[2]))||t.b.getInstance().start()}},[[171,7,6]]]);
//# sourceMappingURL=quicklook-pc.js.map