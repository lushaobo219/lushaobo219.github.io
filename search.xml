<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Nginx介绍-安装-启停管理</title>
    <url>/2020/09/23/Nginx%E4%BB%8B%E7%BB%8D-%E5%AE%89%E8%A3%85-%E5%90%AF%E5%81%9C%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<h2 id="Nginx介绍-安装-启停管理"><a href="#Nginx介绍-安装-启停管理" class="headerlink" title="Nginx介绍   安装  启停管理"></a><strong>Nginx介绍   安装  启停管理</strong></h2><h3 id="1-官网："><a href="#1-官网：" class="headerlink" title="1:    官网："></a><strong>1:    官网：</strong></h3><p><a href="http://nginx.org/" target="_blank" rel="noopener">http://nginx.org/</a></p>
<h3 id="2-下载地址："><a href="#2-下载地址：" class="headerlink" title="2:    下载地址："></a><strong>2:    下载地址：</strong></h3><p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">http://nginx.org/en/download.html</a></p>
<h3 id="3-文档地址："><a href="#3-文档地址：" class="headerlink" title="3:    文档地址："></a><strong>3:    文档地址：</strong></h3><p><a href="http://nginx.org/en/docs/" target="_blank" rel="noopener">http://nginx.org/en/docs/</a></p>
<h3 id="4-介绍："><a href="#4-介绍：" class="headerlink" title="4:    介绍："></a><strong>4:    介绍：</strong></h3><p>nginx[engine x]  是一个HTTP(web)服务器和代理(HTTP)服务器，邮件代理服务器，通用的TCP/UDP代理服务器，最初由俄罗斯的程序设计师Igor Sysoev开发。</p>
<p>在高连接并发的情况下，Nginx是Apache服务器不错的替代品</p>
<p>基本功能：</p>
<ol>
<li>静态资源的web服务器</li>
<li>可作为http协议的反向代理服务器</li>
<li>pop3/imap4协议反向代理服务器</li>
<li>支持FastCGI（lnmp）、uWSGI等协议</li>
<li>模块化（非DSO机制）机制，著名模块zip，SSL，…</li>
</ol>
<a id="more"></a>

<h3 id="5-安装："><a href="#5-安装：" class="headerlink" title="5:    安装："></a><strong>5:    安装</strong>：</h3><h4 id="5-1-docker-方式安装nginx"><a href="#5-1-docker-方式安装nginx" class="headerlink" title="5.1 docker 方式安装nginx:"></a><strong>5.1 docker 方式安装nginx:</strong></h4><h5 id="5-1-1-拉取镜像"><a href="#5-1-1-拉取镜像" class="headerlink" title="5.1.1 拉取镜像"></a>5.1.1 拉取镜像</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$ docker pull nginx</span><br></pre></td></tr></table></figure>

<h5 id="5-2-2-将配置文件挂载到宿主机，方便后续修改"><a href="#5-2-2-将配置文件挂载到宿主机，方便后续修改" class="headerlink" title="5.2.2 将配置文件挂载到宿主机，方便后续修改"></a>5.2.2 将配置文件挂载到宿主机，方便后续修改</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker run --name my-nginx -v /host/path/nginx.conf:/etc/nginx/nginx.conf -d nginx:<span class="number">1.19</span><span class="number">.2</span></span><br></pre></td></tr></table></figure>

<h4 id="5-2-包方式安装-根据操作系统不同，安装方式不同-："><a href="#5-2-包方式安装-根据操作系统不同，安装方式不同-：" class="headerlink" title="5.2 包方式安装(根据操作系统不同，安装方式不同)："></a><strong>5.2 包方式安装(根据操作系统不同，安装方式不同)：</strong></h4><p>参考地址：</p>
<p><a href="http://nginx.org/en/linux_packages.html#Ubuntu" target="_blank" rel="noopener">http://nginx.org/en/linux_packages.html#Ubuntu</a></p>
<p>ubuntu：</p>
<h5 id="5-2-1：安装依赖"><a href="#5-2-1：安装依赖" class="headerlink" title="5.2.1：安装依赖"></a>5.2.1：安装依赖</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo apt install curl gnupg2 ca-certificates lsb-release</span><br></pre></td></tr></table></figure>

<h5 id="5-2-2：添加nginx的源地址"><a href="#5-2-2：添加nginx的源地址" class="headerlink" title="5.2.2：添加nginx的源地址"></a>5.2.2：添加nginx的源地址</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">echo <span class="string">"deb http://nginx.org/packages/ubuntu `lsb_release -cs` nginx"</span> | sudo tee /etc/apt/sources.list.d/nginx.list</span><br></pre></td></tr></table></figure>

<h5 id="5-2-3：下载nginx的官方签名key"><a href="#5-2-3：下载nginx的官方签名key" class="headerlink" title="5.2.3：下载nginx的官方签名key"></a>5.2.3：下载nginx的官方签名key</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -</span><br></pre></td></tr></table></figure>

<h5 id="5-2-4：安装nginx"><a href="#5-2-4：安装nginx" class="headerlink" title="5.2.4：安装nginx"></a>5.2.4：安装nginx</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动nginx</span></span><br><span class="line">sudo service nginx start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证启动成功与否</span></span><br><span class="line">ps -ef |grep nginx</span><br></pre></td></tr></table></figure>

<h4 id="5-3-源码方式安装："><a href="#5-3-源码方式安装：" class="headerlink" title="5.3    源码方式安装："></a><strong>5.3    源码方式安装</strong>：</h4><p>参考地址：</p>
<p><a href="https://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="noopener">https://www.runoob.com/linux/nginx-install-setup.html</a></p>
<h5 id="5-3-1-下载依赖及相关包"><a href="#5-3-1-下载依赖及相关包" class="headerlink" title="5.3.1:下载依赖及相关包"></a>5.3.1:下载依赖及相关包</h5><h5 id="5-3-2-下载nginx源码包并与解压缩"><a href="#5-3-2-下载nginx源码包并与解压缩" class="headerlink" title="5.3.2:下载nginx源码包并与解压缩"></a>5.3.2:下载nginx源码包并与解压缩</h5><h5 id="5-3-3-编译安装："><a href="#5-3-3-编译安装：" class="headerlink" title="5.3.3:编译安装："></a>5.3.3:编译安装：</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># configure后面具体有哪些参数与参数意义参考#http://nginx.org/en/docs/configure.html</span></span><br><span class="line">./configure --sbin-path=/usr/local/nginx/nginx</span><br><span class="line">            --conf-path=/usr/local/nginx/nginx.conf</span><br><span class="line">             --pid-path=/usr/local/nginx/nginx.pid</span><br><span class="line">             --<span class="keyword">with</span>-http_ssl_module</span><br><span class="line">             --<span class="keyword">with</span>-pcre=../pcre<span class="number">-8.44</span></span><br><span class="line">             --<span class="keyword">with</span>-zlib=../zlib<span class="number">-1.2</span><span class="number">.11</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译安装</span></span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<h3 id="6：Nginx的程序架构"><a href="#6：Nginx的程序架构" class="headerlink" title="6：Nginx的程序架构"></a><strong>6：Nginx的程序架构</strong></h3><h4 id="6-1-：C10K问题"><a href="#6-1-：C10K问题" class="headerlink" title="6.1 ：C10K问题"></a><strong>6.1 ：C10K问题</strong></h4><p>面对较高并发请求时，由于prefork机制上限并发请求最多为1024个，超过1024个连接请求时，不一定会有压力，因为，有些请求的响应速度非常快，例如一个请求在5毫秒ms内就能完成，1秒钟内可完成500个请求，此时并发请求可能会不止1024个；但再多请求上万个时就无法满足了，就有了C10k问题；nginx就能解决C10k的问题；能支持较大并发的服务器程序，突破了1万个请求；</p>
<h4 id="6-2-nginx架构概览"><a href="#6-2-nginx架构概览" class="headerlink" title="6.2 nginx架构概览"></a><strong>6.2 nginx架构概览</strong></h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Nginx%E4%BB%8B%E7%BB%8D-%E5%AE%89%E8%A3%85-%E5%90%AF%E5%81%9C%E7%AE%A1%E7%90%86/image%20(3).png" alt=""></p>
<p>一个master进程，可生成一个或多个worker进程</p>
<ul>
<li><p>master：负责加载分析配置文件、管理worker进程、平滑升级、…</p>
</li>
<li><p>worker：处理并响应用户请求</p>
</li>
</ul>
<h3 id="7-启停管理"><a href="#7-启停管理" class="headerlink" title="7:启停管理"></a><strong>7:启停管理</strong></h3><h4 id="7-1-命令格式："><a href="#7-1-命令格式：" class="headerlink" title="7.1 命令格式："></a><strong>7.1 命令格式：</strong></h4><p><strong>nginx  -s  signal   （向nginx发送信号，信号如下）</strong></p>
<p>stop — fast shutdown      快速关闭，不管进程有没有正在处理客户端请求都把进程关闭</p>
<p>quit  — graceful shutdown 优雅的关闭，等正在处理的客户端请求完成才关闭进程</p>
<p>reload — reloading the configuration file 重新加载配置文件</p>
<p>reopen — reopening the log files 再次打开日志文件</p>
<h3 id="8：发送linux命令控制nginx操作"><a href="#8：发送linux命令控制nginx操作" class="headerlink" title="8：发送linux命令控制nginx操作"></a><strong>8：发送linux命令控制nginx操作</strong></h3><h4 id="8-1-命令格式"><a href="#8-1-命令格式" class="headerlink" title="8.1 命令格式"></a><strong>8.1 命令格式</strong></h4><p><strong>kill    -s    signal   PID</strong></p>
<h4 id="8-2-nginx主进程可接受的信号"><a href="#8-2-nginx主进程可接受的信号" class="headerlink" title="8.2 nginx主进程可接受的信号"></a><strong>8.2</strong> <strong>nginx主进程可接受的信号</strong></h4><p><strong>TERM, INT</strong>    快速关闭，正在处理的连接也会被关闭掉</p>
<p><strong>QUIT</strong>              优雅关闭，等待正在处理的连接完成关闭nginx</p>
<p><strong>HUP</strong>               向主进程发送HUP信号，工作进程会受主进程控制也会更新</p>
<p><strong>USR1</strong>             重新打开日志文件</p>
<p><strong>USR2</strong>          （升级可执行文件，认为是升级主程序）</p>
<p><strong>USR2注意事项：</strong> </p>
<p>只需要向主进程发送USR2信号，主进程会一次升级所有的工作进程。</p>
<p><strong>升级后现象：</strong>新，旧主进程同时存在， 新旧工作进程也同时存在</p>
<p><strong>如果升级后认为没问题：</strong>发送WINCH信号关闭旧的工作进程， 发送QUIT关闭旧的主进程</p>
<p><strong>如果升级后认为有问题：</strong></p>
<p>1：（旧工作进程未关闭情况）发送HUP信号到旧主进程，旧主进程会启动旧的工作进程</p>
<p>2：（旧工作进程被关闭情况）发送TERM信号到新主进程，新主进程会告诉新的工作进程退出，旧主进程还在的话，会自动启动旧的工作进程</p>
<p>WINCH        优雅的关闭工作进程</p>
<h4 id="8-3-nginx工作进程可接受的信号"><a href="#8-3-nginx工作进程可接受的信号" class="headerlink" title="8.3 nginx工作进程可接受的信号"></a><strong>8.3 nginx工作进程可接受的信号</strong></h4><table>
<thead>
<tr>
<th>TERM, INT    fast shutdown</th>
<th>快速关闭</th>
</tr>
</thead>
<tbody><tr>
<td>QUIT             graceful shutdown</td>
<td>优雅的关闭</td>
</tr>
<tr>
<td>HUP</td>
<td>更新配置，使用新的配置启动新的工作进程，优雅的关闭旧的工作进程</td>
</tr>
<tr>
<td>USR1</td>
<td>重新打开配置文件</td>
</tr>
<tr>
<td>WINCH</td>
<td>优雅的关闭工作进程</td>
</tr>
</tbody></table>
]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>redis数据类型与命令</title>
    <url>/2020/09/23/redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="redis-数据类型与命令"><a href="#redis-数据类型与命令" class="headerlink" title="redis 数据类型与命令"></a><strong>redis 数据类型与命令</strong></h1><h1 id="redis常用地址："><a href="#redis常用地址：" class="headerlink" title="redis常用地址："></a><strong>redis常用地址：</strong></h1><p>redis官方地址：<a href="https://redis.io/" target="_blank" rel="noopener">https://redis.io/</a></p>
<p>redis官方文档地址：<a href="https://redis.io/documentation" target="_blank" rel="noopener">https://redis.io/documentation</a></p>
<p>redis在线测试地址： <a href="https://try.redis.io/" target="_blank" rel="noopener">https://try.redis.io/</a></p>
<p>redis 命令参考地址： <a href="http://doc.redisfans.com/" target="_blank" rel="noopener">http://doc.redisfans.com/</a></p>
<h2 id="0-切换数据库"><a href="#0-切换数据库" class="headerlink" title="0: 切换数据库"></a><strong>0: 切换数据库</strong></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis&gt;select <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h2 id="1：redis数据类型"><a href="#1：redis数据类型" class="headerlink" title="1：redis数据类型"></a><strong>1：redis数据类型</strong></h2><h3 id="1-1-Redis支持五种数据类型："><a href="#1-1-Redis支持五种数据类型：" class="headerlink" title="1.1  Redis支持五种数据类型："></a><strong>1.1  Redis支持五种数据类型：</strong></h3><p>string（字符串），</p>
<p>hash（哈希），</p>
<p>list（列表），</p>
<p>set（集合）</p>
<p>及zset(sorted set：有序集合)</p>
<a id="more"></a>

<h3 id="1-2-数据类型应用场景"><a href="#1-2-数据类型应用场景" class="headerlink" title="1.2 数据类型应用场景"></a><strong>1.2 数据类型应用场景</strong></h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%91%BD%E4%BB%A4/Snipaste_2020-09-23_11-57-13.png" alt=""></p>
<h3 id="1-3-redis命令："><a href="#1-3-redis命令：" class="headerlink" title="1.3 redis命令："></a><strong>1.3 redis命令：</strong></h3><p>Redis 命令用于在 redis 服务上执行操作。</p>
<p>要在 redis 服务上执行命令需要一个 redis 客户端。Redis 客户端在我们之前下载的的 redis 的安装包中。</p>
<h4 id="1-3-1-连接本地redis服务执行命令："><a href="#1-3-1-连接本地redis服务执行命令：" class="headerlink" title="1.3.1    连接本地redis服务执行命令："></a><strong>1.3.1    连接本地redis服务执行命令：</strong></h4><h5 id="语法"><a href="#语法" class="headerlink" title="语法"></a><strong>语法</strong></h5><p>Redis 客户端的基本语法为：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$ redis-cli</span><br></pre></td></tr></table></figure>

<h5 id="实例"><a href="#实例" class="headerlink" title="实例"></a><strong>实例</strong></h5><p>以下实例讲解了如何启动 redis 客户端：</p>
<p>启动 redis 服务器，打开终端并输入命令 <strong>redis-cli</strong>，该命令会连接本地的 redis 服务。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$ redis-cli  </span><br><span class="line"></span><br><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行 PING 命令，该命令用于检测 redis 服务是否启动</span></span><br><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; PING</span><br><span class="line">PONG</span><br></pre></td></tr></table></figure>

<h4 id="1-3-2：在远程服务上执行命令"><a href="#1-3-2：在远程服务上执行命令" class="headerlink" title="1.3.2：在远程服务上执行命令"></a><strong>1.3.2：在远程服务上执行命令</strong></h4><p>如果需要在远程 redis 服务上执行命令，同样我们使用的也是 <strong>redis-cli</strong> 命令。</p>
<h5 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a><strong>语法</strong></h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$ redis-cli -h host -p port -a password</span><br></pre></td></tr></table></figure>

<h5 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a><strong>实例</strong></h5><p>以下实例演示了如何连接到主机为 192.168.106.131，端口为 6379 ，密码为 mypass 的 redis 服务上。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">$redis-cli -h <span class="number">192.168</span><span class="number">.106</span> -p <span class="number">6379</span> -a <span class="string">"mypass"</span></span><br><span class="line"> redis <span class="number">192.168</span><span class="number">.106</span>:<span class="number">6379</span>&gt;</span><br><span class="line"> redis <span class="number">192.168</span><span class="number">.106</span>:<span class="number">6379</span>&gt; PING</span><br><span class="line"> PONG</span><br></pre></td></tr></table></figure>

<h4 id="1-4：-key-value示意与解释："><a href="#1-4：-key-value示意与解释：" class="headerlink" title="1.4： key value示意与解释："></a><strong>1.4： key value示意与解释：</strong></h4><table>
<thead>
<tr>
<th><strong>key</strong></th>
<th><strong>value</strong></th>
<th>备注数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>fsfsafs</td>
<td>‘tretertretetrt’</td>
<td>value是字符串</td>
</tr>
<tr>
<td>gdsgdfgfdg</td>
<td>[dada, ‘313’, ‘dadsada’]</td>
<td>value是list</td>
</tr>
<tr>
<td>gdgds</td>
<td>{“username”:”xfsf”, “tel”:12345}</td>
<td>value是哈希(hash)</td>
</tr>
<tr>
<td>ggdgdfg</td>
<td>(“dadsafsf”, 7 ,4, “fdfdsf”, “dsds”)</td>
<td>value是集合（set）</td>
</tr>
<tr>
<td>ggfdgfds</td>
<td>(1, ,4, “afdfdsf”, “ddsds”,)</td>
<td>value是有序集合（sorted set）</td>
</tr>
</tbody></table>
<h4 id="1-5-：针对key-键-的常用命令"><a href="#1-5-：针对key-键-的常用命令" class="headerlink" title="1.5 ：针对key(键)的常用命令"></a><strong>1.5 ：针对key(键)的常用命令</strong></h4><p>语法：命令   key名</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; COMMAND KEY_NAME</span><br></pre></td></tr></table></figure>

<p>常见KEY操作：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#  设置key的值</span></span><br><span class="line">redis&gt; set example  <span class="string">'fafafafsaf'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  删除存在的key</span></span><br><span class="line">redis&gt; DEL example </span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查key是否存在，返回数量</span></span><br><span class="line">redis&gt;EXISTS example</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查多个key是否存在，返回存在的数量</span></span><br><span class="line">redis&gt;EXISTS example  example2</span><br><span class="line"></span><br><span class="line"><span class="comment">#  给key设置过期时间, 单位为秒，过期被删除</span></span><br><span class="line">redis&gt; EXPIRE example <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置 key 的过期时间以毫秒计</span></span><br><span class="line">redis&gt; PEXPIRE example  <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找所有符合给定模式( pattern)的 key </span></span><br><span class="line"><span class="comment">#  查找所有key</span></span><br><span class="line">redis&gt; KEYS  *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找ex开头的key</span></span><br><span class="line">redis&gt; KEYS ex*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找包含a的key</span></span><br><span class="line">redis&gt; KEYS *a*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移动key到其他数据库</span></span><br><span class="line">redis&gt; MOVE example  <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除key的过期时间，就不会被删除了</span></span><br><span class="line">redis&gt; PERSIST example</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以毫秒为单位返回key还有多长时间过期</span></span><br><span class="line">redis&gt;PTTL example</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以秒为单位返回key还有多长时间过期</span></span><br><span class="line">redis&gt;TTL example</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从当前数据库中随机返回一个key</span></span><br><span class="line">redis&gt; RANDOMKEY</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改key的名称</span></span><br><span class="line">redis&gt; RENAME example  newexample</span><br><span class="line"></span><br><span class="line"><span class="comment"># 仅当 newkey 不存在时，将 key 改名为 newkey</span></span><br><span class="line">redis&gt;RENAMENX example  newexample</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回 key 所储存的值的类型</span></span><br><span class="line">redis&gt;TYPE example</span><br></pre></td></tr></table></figure>

<h4 id="1-6-：-key-对应value是字符串常用命令"><a href="#1-6-：-key-对应value是字符串常用命令" class="headerlink" title="1.6 ： key 对应value是字符串常用命令"></a><strong>1.6 ： key 对应value是字符串常用命令</strong></h4><p>语法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; COMMAND KEY_NAME</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; SET runoobkey redis</span><br><span class="line">OK</span><br><span class="line">redis <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; GET runoobkey</span><br><span class="line"><span class="string">"redis"</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>SET key value</td>
<td>设置指定 key 的值</td>
</tr>
<tr>
<td>2</td>
<td>GET key</td>
<td>获取指定 key 的值。</td>
</tr>
<tr>
<td>3</td>
<td>GETRANGE key start end</td>
<td>返回 key 中字符串值的子字符</td>
</tr>
<tr>
<td>4</td>
<td>GETSET key value</td>
<td>将给定 key 的值设为 value ，并返回 key 的旧值(old value)。</td>
</tr>
<tr>
<td>5</td>
<td>GETBIT key offset</td>
<td>对 key 所储存的字符串值，获取指定偏移量上的位(bit)。</td>
</tr>
<tr>
<td>6</td>
<td>MGET key1 [key2..]</td>
<td>获取所有(一个或多个)给定 key 的值。</td>
</tr>
<tr>
<td>7</td>
<td>SETBIT key offset value</td>
<td>对 key 所储存的字符串值，设置或清除指定偏移量上的位(bit)。</td>
</tr>
<tr>
<td>8</td>
<td>SETEX key seconds value</td>
<td>将值 value 关联到 key ，并将 key 的过期时间设为 seconds (以秒为单位)。</td>
</tr>
<tr>
<td>9</td>
<td>SETNX key value</td>
<td>只有在 key 不存在时设置 key 的值。</td>
</tr>
<tr>
<td>10</td>
<td>SETRANGE key offset value</td>
<td>用 value 参数覆写给定 key 所储存的字符串值，从偏移量 offset 开始。</td>
</tr>
<tr>
<td>11</td>
<td>STRLEN key</td>
<td>返回 key 所储存的字符串值的长度。</td>
</tr>
<tr>
<td>12</td>
<td>MSET key value [key value …]</td>
<td>同时设置一个或多个 key-value 对。</td>
</tr>
<tr>
<td>13</td>
<td>MSETNX key value [key value …]</td>
<td>同时设置一个或多个 key-value 对，当且仅当所有给定 key 都不存在。</td>
</tr>
<tr>
<td>14</td>
<td>PSETEX key milliseconds value</td>
<td>这个命令和 SETEX 命令相似，但它以毫秒为单位设置 key 的生存时间，而不是像 SETEX 命令那样，以秒为单位。</td>
</tr>
<tr>
<td>15</td>
<td>INCR key</td>
<td>将 key 中储存的数字值增一。</td>
</tr>
<tr>
<td>16</td>
<td>INCRBY key increment</td>
<td>将 key 所储存的值加上给定的增量值（increment） 。</td>
</tr>
<tr>
<td>17</td>
<td>INCRBYFLOAT key increment</td>
<td>将 key 所储存的值加上给定的浮点增量值（increment） 。</td>
</tr>
<tr>
<td>18</td>
<td>DECR key</td>
<td>将 key 中储存的数字值减一。</td>
</tr>
<tr>
<td>19</td>
<td>DECRBY key decrement</td>
<td>key 所储存的值减去给定的减量值（decrement） 。</td>
</tr>
<tr>
<td>20</td>
<td>APPEND key value</td>
<td>如果 key 已经存在并且是一个字符串， APPEND 命令将指定的 value 追加到该 key 原来值（value）的末尾。</td>
</tr>
</tbody></table>
<h4 id="1-6-：-key-对应value是哈希-Hash-常用命令"><a href="#1-6-：-key-对应value是哈希-Hash-常用命令" class="headerlink" title="1.6 ： key 对应value是哈希(Hash)常用命令"></a><strong>1.6 ： key 对应value是哈希(Hash)常用命令</strong></h4><p>Redis hash 是一个 string 类型的 field（字段） 和 value（值） 的映射表，hash 特别适合用于存储对象。</p>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis&gt;HMSET user name <span class="string">"redis"</span> description <span class="string">"redis basic commands"</span> likes <span class="number">20</span> visitors <span class="number">23000</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"><span class="comment"># 获取key所有字段和对应值</span></span><br><span class="line">redis&gt;HGETALL runoobkey</span><br><span class="line"><span class="number">1</span>) <span class="string">"name"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"redis"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"description"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"redis basic commands"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"likes"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"20"</span></span><br><span class="line"><span class="number">7</span>) <span class="string">"visitors"</span></span><br><span class="line"><span class="number">8</span>) <span class="string">"23000"</span></span><br></pre></td></tr></table></figure>

<p><strong>redis hash 基本的相关命令：</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>HDEL key   field1         [field2]</td>
<td>删除一个或多个哈希表字段</td>
</tr>
<tr>
<td>2</td>
<td>HEXISTS key field</td>
<td>查看哈希表 key 中，指定的字段是否存在。</td>
</tr>
<tr>
<td>3</td>
<td>HGET key field</td>
<td>获取存储在哈希表中指定字段的值。</td>
</tr>
<tr>
<td>4</td>
<td>HGETALL key</td>
<td>获取在哈希表中指定 key 的所有字段和值</td>
</tr>
<tr>
<td>5</td>
<td>HINCRBY key field increment</td>
<td>为哈希表 key 中的指定字段的整数值加上增量 increment 。</td>
</tr>
<tr>
<td>6</td>
<td>HINCRBYFLOAT key field increment</td>
<td>为哈希表 key 中的指定字段的浮点数值加上增量 increment 。</td>
</tr>
<tr>
<td>7</td>
<td>HKEYS key</td>
<td>获取所有哈希表中的字段</td>
</tr>
<tr>
<td>8</td>
<td>HLEN key</td>
<td>获取哈希表中字段的数量</td>
</tr>
<tr>
<td>9</td>
<td>HMGET key field1 [field2]</td>
<td>获取所有给定字段的值</td>
</tr>
<tr>
<td>10</td>
<td>HMSET key field1 value1 [field2 value2 ]</td>
<td>同时将多个 field-value (域-值)对设置到哈希表 key 中。</td>
</tr>
<tr>
<td>11</td>
<td>HSET key field value</td>
<td>将哈希表 key 中的字段 field 的值设为 value 。</td>
</tr>
<tr>
<td>12</td>
<td>HSETNX key field value</td>
<td>只有在字段 field 不存在时，设置哈希表字段的值。</td>
</tr>
<tr>
<td>13</td>
<td>HVALS key</td>
<td>获取哈希表中所有值。</td>
</tr>
<tr>
<td>14</td>
<td>HSCAN key cursor [MATCH pattern] [COUNT count]</td>
<td>迭代哈希表中的键值对。</td>
</tr>
</tbody></table>
<h4 id="1-7：-key-对应value是列表List-常用命令"><a href="#1-7：-key-对应value是列表List-常用命令" class="headerlink" title="1.7： key 对应value是列表List)常用命令"></a><strong>1.7： key 对应value是列表List)常用命令</strong></h4><p>Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）</p>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis&gt;LPUSH example redis</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line">redis&gt;LPUSH example mongodb</span><br><span class="line">(integer) <span class="number">2</span></span><br><span class="line">redis&gt;LPUSH example mysql</span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line">redis&gt;LRANGE example <span class="number">0</span> <span class="number">10</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"mysql"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"mongodb"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"redis"</span></span><br></pre></td></tr></table></figure>

<p><strong>列表相关的基本命令</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>BLPOP key1 [key2 ] timeout</td>
<td>移出并获取列表的第一个元素， 如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</td>
</tr>
<tr>
<td>2</td>
<td>BRPOP key1 [key2 ] timeout</td>
<td>移出并获取列表的最后一个元素， 如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</td>
</tr>
<tr>
<td>3</td>
<td>BRPOPLPUSH source destination timeout</td>
<td>从列表中弹出一个值，将弹出的元素插入到另外一个列表中并返回它； 如果列表没有元素会阻塞列表直到等待超时或发现可弹出元素为止。</td>
</tr>
<tr>
<td>4</td>
<td>LINDEX key index</td>
<td>通过索引获取列表中的元素</td>
</tr>
<tr>
<td>5</td>
<td>LINSERT key BEFORE|AFTER pivot value</td>
<td>在列表的元素前或者后插入元素</td>
</tr>
<tr>
<td>6</td>
<td>LLEN key</td>
<td>获取列表长度</td>
</tr>
<tr>
<td>7</td>
<td>LPOP key</td>
<td>移出并获取列表的第一个元素</td>
</tr>
<tr>
<td>8</td>
<td>LPUSH key value1 [value2]</td>
<td>将一个或多个值插入到列表头部</td>
</tr>
<tr>
<td>9</td>
<td>LPUSHX key value</td>
<td>将一个值插入到已存在的列表头部</td>
</tr>
<tr>
<td>10</td>
<td>LRANGE key start stop</td>
<td>获取列表指定范围内的元素</td>
</tr>
<tr>
<td>11</td>
<td>LREM key count value</td>
<td>移除列表元素</td>
</tr>
<tr>
<td>12</td>
<td>LSET key index value</td>
<td>通过索引设置列表元素的值</td>
</tr>
<tr>
<td>13</td>
<td>LTRIM key start stop</td>
<td>对一个列表进行修剪(trim)，就是说，让列表只保留指定区间内的元素，不在指定区间之内的元素都将被删除。</td>
</tr>
<tr>
<td>14</td>
<td>RPOP key</td>
<td>移除列表的最后一个元素，返回值为移除的元素。</td>
</tr>
<tr>
<td>15</td>
<td>RPOPLPUSH source destination</td>
<td>移除列表的最后一个元素，并将该元素添加到另一个列表并返回</td>
</tr>
<tr>
<td>16</td>
<td>RPUSH key value1 [value2]</td>
<td>在列表中添加一个或多个值</td>
</tr>
<tr>
<td>17</td>
<td>RPUSHX key value</td>
<td>为已存在的列表添加值</td>
</tr>
</tbody></table>
<h4 id="1-8：-key-对应value是集合-set-常用命令"><a href="#1-8：-key-对应value是集合-set-常用命令" class="headerlink" title="1.8： key 对应value是集合(set)常用命令"></a><strong>1.8： key 对应value是集合(set)常用命令</strong></h4><p>Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据。</p>
<p>Redis 中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</p>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis&gt; SADD example redis</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line">redis&gt; SADD example mongodb</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line">redis&gt; SADD example mysql</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 值重复所以加不进去</span></span><br><span class="line">redis&gt; SADD example mysql</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看集合内的值</span></span><br><span class="line">redis &gt; SMEMBERS example</span><br><span class="line"><span class="number">1</span>) <span class="string">"mysql"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"mongodb"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"redis"</span></span><br></pre></td></tr></table></figure>

<p><strong>Redis 集合基本命令：</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>SADD key member1 [member2]</td>
<td>向集合添加一个或多个成员</td>
</tr>
<tr>
<td>2</td>
<td>SCARD key</td>
<td>获取集合的成员数</td>
</tr>
<tr>
<td>3</td>
<td>SDIFF key1 [key2]</td>
<td>返回第一个集合与其他集合之间的差异。</td>
</tr>
<tr>
<td>4</td>
<td>SDIFFSTORE destination key1 [key2]</td>
<td>返回给定所有集合的差集并存储在 destination 中</td>
</tr>
<tr>
<td>5</td>
<td>SINTER key1 [key2]</td>
<td>返回给定所有集合的交集</td>
</tr>
<tr>
<td>6</td>
<td>SINTERSTORE destination key1 [key2]</td>
<td>返回给定所有集合的交集并存储在 destination 中</td>
</tr>
<tr>
<td>7</td>
<td>SISMEMBER key member</td>
<td>判断 member 元素是否是集合 key 的成员</td>
</tr>
<tr>
<td>8</td>
<td>SMEMBERS key</td>
<td>返回集合中的所有成员</td>
</tr>
<tr>
<td>9</td>
<td>SMOVE source destination member</td>
<td>将 member 元素从 source 集合移动到 destination 集合</td>
</tr>
<tr>
<td>10</td>
<td>SPOP key</td>
<td>移除并返回集合中的一个随机元素</td>
</tr>
<tr>
<td>11</td>
<td>SRANDMEMBER key [count]</td>
<td>返回集合中一个或多个随机数</td>
</tr>
<tr>
<td>12</td>
<td>SREM key member1 [member2]</td>
<td>移除集合中一个或多个成员</td>
</tr>
<tr>
<td>13</td>
<td>SUNION key1 [key2]</td>
<td>返回所有给定集合的并集</td>
</tr>
<tr>
<td>14</td>
<td>SUNIONSTORE destination key1 [key2]</td>
<td>所有给定集合的并集存储在 destination 集合中</td>
</tr>
<tr>
<td>15</td>
<td>SSCAN key cursor [MATCH pattern] [COUNT count]</td>
<td>迭代集合中的元素</td>
</tr>
</tbody></table>
<h4 id="1-9：-key-对应value是有序集合-set-常用命令"><a href="#1-9：-key-对应value是有序集合-set-常用命令" class="headerlink" title="1.9： key 对应value是有序集合(set)常用命令"></a><strong>1.9： key 对应value是有序集合(set)常用命令</strong></h4><p>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。</p>
<p>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>
<p>有序集合的成员是唯一的,但分数(score)却可以重复。</p>
<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p>
<p><strong>示例：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">redis&gt; ZADD example <span class="number">1</span> redis</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line">redis&gt; ZADD example <span class="number">2</span> mongodb</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line">redis&gt; ZADD example <span class="number">3</span> mysql</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"></span><br><span class="line">redis&gt; ZADD example <span class="number">3</span> mysql</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"></span><br><span class="line">redis&gt; ZADD example <span class="number">4</span> mysql</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"></span><br><span class="line">redis&gt; ZRANGE example <span class="number">0</span> <span class="number">10</span> WITHSCORES</span><br><span class="line"><span class="number">1</span>) <span class="string">"redis"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"1"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"mongodb"</span></span><br><span class="line"><span class="number">4</span>) <span class="string">"2"</span></span><br><span class="line"><span class="number">5</span>) <span class="string">"mysql"</span></span><br><span class="line"><span class="number">6</span>) <span class="string">"4"</span></span><br></pre></td></tr></table></figure>

<p><strong>redis 有序集合的基本命令:</strong></p>
<table>
<thead>
<tr>
<th>序号</th>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>ZADD key score1 member1 [score2 member2]</td>
<td>向有序集合添加一个或多个成员，或者更新已存在成员的分数</td>
</tr>
<tr>
<td>2</td>
<td>ZCARD key</td>
<td>获取有序集合的成员数</td>
</tr>
<tr>
<td>3</td>
<td>ZCOUNT key min max</td>
<td>计算在有序集合中指定区间分数的成员数</td>
</tr>
<tr>
<td>4</td>
<td>ZINCRBY key increment member</td>
<td>有序集合中对指定成员的分数加上增量 increment</td>
</tr>
<tr>
<td>5</td>
<td>ZINTERSTORE destination numkeys key [key …]</td>
<td>算给定的一个或多个有序集的交集并将结果集存储在新的有序集合 destination 中</td>
</tr>
<tr>
<td>6</td>
<td>ZLEXCOUNT key min max</td>
<td>在有序集合中计算指定字典区间内成员数量</td>
</tr>
<tr>
<td>7</td>
<td>ZRANGE key start stop [WITHSCORES]</td>
<td>通过索引区间返回有序集合指定区间内的成员</td>
</tr>
<tr>
<td>8</td>
<td>ZRANGEBYLEX key min max [LIMIT offset count]</td>
<td>通过字典区间返回有序集合的成员</td>
</tr>
<tr>
<td>9</td>
<td>ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT]</td>
<td>通过分数返回有序集合指定区间内的成员</td>
</tr>
<tr>
<td>10</td>
<td>ZRANK key member</td>
<td>返回有序集合中指定成员的索引</td>
</tr>
<tr>
<td>11</td>
<td>ZREM key member [member …]</td>
<td>移除有序集合中的一个或多个成员</td>
</tr>
<tr>
<td>12</td>
<td>ZREMRANGEBYLEX key min max</td>
<td>移除有序集合中给定的字典区间的所有成员</td>
</tr>
<tr>
<td>13</td>
<td>ZREMRANGEBYRANK key start stop</td>
<td>移除有序集合中给定的排名区间的所有成员</td>
</tr>
<tr>
<td>14</td>
<td>ZREMRANGEBYSCORE key min max</td>
<td>移除有序集合中给定的分数区间的所有成员</td>
</tr>
<tr>
<td>15</td>
<td>ZREVRANGE key start stop [WITHSCORES]</td>
<td>返回有序集中指定区间内的成员，通过索引，分数从高到低</td>
</tr>
<tr>
<td>16</td>
<td>ZREVRANGEBYSCORE key max min [WITHSCORES]</td>
<td>返回有序集中指定分数区间内的成员，分数从高到低排序</td>
</tr>
<tr>
<td>17</td>
<td>ZREVRANK key member</td>
<td>返回有序集合中指定成员的排名，有序集成员按分数值递减(从大到小)排序</td>
</tr>
<tr>
<td>18</td>
<td>ZSCORE key member</td>
<td>返回有序集中，成员的分数值</td>
</tr>
<tr>
<td>19</td>
<td>ZUNIONSTORE destination numkeys key [key …]</td>
<td>计算给定的一个或多个有序集的并集，并存储在新的 key 中</td>
</tr>
<tr>
<td>20</td>
<td>ZSCAN key cursor [MATCH pattern] [COUNT count]</td>
<td>迭代有序集合中的元素（包括元素成员和元素分值）</td>
</tr>
</tbody></table>
]]></content>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title>&#39;Dockerfile的介绍与创建&#39;</title>
    <url>/2020/09/23/Dockerfile%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%88%9B%E5%BB%BA/</url>
    <content><![CDATA[<h2 id="1-Dockerfile介绍"><a href="#1-Dockerfile介绍" class="headerlink" title="1:Dockerfile介绍"></a><strong>1:Dockerfile介绍</strong></h2><h3 id="Dockerfile概念："><a href="#Dockerfile概念：" class="headerlink" title="Dockerfile概念："></a><strong>Dockerfile概念：</strong></h3><p>Dockerfile用来构建镜像，对镜像描述，安装了哪些软件，执行了哪些操作，使用了哪个父镜像</p>
<p>简单理解为镜像如何被创建出来的。</p>
<p>Dockerfile是一个文件，按照一定格式编写：</p>
<p>Dockerfile结构大致分为四个部分：</p>
<p>　　（1）基础镜像信息</p>
<p>　　（2）维护者信息</p>
<p>　　（3）镜像操作指令</p>
<p>　　（4）容器启动时执行指令。</p>
<p>Dockerfile每行支持一条指令，每条指令可带多个参数，支持使用以#号开头的注释。下面会对上面使用到的一些常用指令做一些介绍。</p>
<a id="more"></a>

<h3 id="Dockerfile-长什么样子："><a href="#Dockerfile-长什么样子：" class="headerlink" title="Dockerfile  长什么样子："></a><strong>Dockerfile  长什么样子：</strong></h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Dockerfile%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%88%9B%E5%BB%BA/image%20(1).png" alt=""></p>
<h2 id="2-常用命令解释："><a href="#2-常用命令解释：" class="headerlink" title="2:常用命令解释："></a><strong>2:常用命令解释：</strong></h2><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Dockerfile%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%88%9B%E5%BB%BA/docker1.png" alt=""></p>
<h3 id="2-1-FROM"><a href="#2-1-FROM" class="headerlink" title="2.1 FROM"></a><strong>2.1 FROM</strong></h3><p>指明构建的新镜像是来自于哪个基础镜像，例如：</p>
<p>FROM centos:6</p>
<h3 id="2-2-MAINTAINER"><a href="#2-2-MAINTAINER" class="headerlink" title="2.2 MAINTAINER"></a><strong>2.2 MAINTAINER</strong></h3><p>指明镜像维护着及其联系方式（一般是邮箱地址），例如：</p>
<p>MAINTAINER Edison Zhou &lt;<a href="edisonchou@hotmail.com">edisonchou@hotmail.com</a>&gt; </p>
<p>不过，MAINTAINER并不推荐使用，更推荐使用LABEL来指定镜像作者，例如：</p>
<p>LABEL maintainer=”edisonzhou.cn”</p>
<h3 id="2-3-RUN"><a href="#2-3-RUN" class="headerlink" title="2.3 RUN"></a><strong>2.3 RUN</strong></h3><p>构建镜像时运行的Shell命令，例如：</p>
<p>RUN [“yum”, “install”, “httpd”]</p>
<p>RUN yum install httpd</p>
<h3 id="2-4-CMD"><a href="#2-4-CMD" class="headerlink" title="2.4 CMD"></a><strong>2.4 CMD</strong></h3><p>启动容器时执行的Shell命令，如果写了多个执行最后一个例如：</p>
<p>CMD [“-C”, “/start.sh”] </p>
<p>CMD [“/usr/sbin/sshd”, “-D”] </p>
<p>CMD /usr/sbin/sshd -D</p>
<h3 id="2-5-EXPOSE"><a href="#2-5-EXPOSE" class="headerlink" title="2.5 EXPOSE"></a><strong>2.5 EXPOSE</strong></h3><p>声明容器运行的服务端口，例如：</p>
<p>EXPOSE 80 443 </p>
<h3 id="2-6-ENV"><a href="#2-6-ENV" class="headerlink" title="2.6 ENV"></a><strong>2.6 ENV</strong></h3><p>设置环境内环境变量，例如：</p>
<p>ENV MYSQL_ROOT_PASSWORD 123456</p>
<p>ENV JAVA_HOME /usr/local/jdk1.8.0_45</p>
<h3 id="2-7-ADD"><a href="#2-7-ADD" class="headerlink" title="2.7 ADD"></a><strong>2.7 ADD</strong></h3><p>拷贝文件或目录到镜像中，例如：</p>
<p>ADD <src>…<dest></p>
<p>ADD html.tar.gz  /var/www/html</p>
<p>ADD <a href="https://xxx.com/html.tar.gz" target="_blank" rel="noopener">https://xxx.com/html.tar.gz</a>  /var/www/html</p>
<p>PS：如果是URL或压缩包，会自动下载或自动解压。</p>
<h3 id="2-8-COPY"><a href="#2-8-COPY" class="headerlink" title="2.8 COPY"></a><strong>2.8 COPY</strong></h3><p>拷贝文件或目录到镜像中，用法同ADD，只是不支持自动下载和解压，例如：</p>
<p>COPY ./start.sh /start.sh</p>
<h3 id="2-9-ENTRYPOINT"><a href="#2-9-ENTRYPOINT" class="headerlink" title="2.9 ENTRYPOINT"></a><strong>2.9 ENTRYPOINT</strong></h3><p>启动容器时执行的Shell命令，同CMD类似，只是由ENTRYPOINT启动的程序不会被docker run命令行指定的参数所覆盖，而且，这些命令行参数会被当作参数传递给ENTRYPOINT指定指定的程序，例如：</p>
<p>ENTRYPOINT [“/bin/bash”, “-C”, “/start.sh”]</p>
<p>ENTRYPOINT /bin/bash -C ‘/start.sh’</p>
<p>PS：Dockerfile文件中也可以存在多个ENTRYPOINT指令，但仅有最后一个会生效。</p>
<h3 id="2-10-VOLUME"><a href="#2-10-VOLUME" class="headerlink" title="2.10 VOLUME"></a><strong>2.10 VOLUME</strong></h3><p>指定容器挂载点到宿主机自动生成的目录或其他容器，例如：</p>
<p>VOLUME [“/var/lib/mysql”]</p>
<p>PS：一般不会在Dockerfile中用到，更常见的还是在docker run的时候指定-v数据卷。</p>
<h3 id="2-11-USER"><a href="#2-11-USER" class="headerlink" title="2.11 USER"></a><strong>2.11 USER</strong></h3><p>为RUN、CMD和ENTRYPOINT执行Shell命令指定运行用户，例如：</p>
<p>USER <user>[:<usergroup>]</p>
<p>USER <UID>[:<UID>]</p>
<p>USER edisonzhou</p>
<h3 id="2-12-WORKDIR"><a href="#2-12-WORKDIR" class="headerlink" title="2.12 WORKDIR"></a><strong>2.12 WORKDIR</strong></h3><p>为RUN、CMD、ENTRYPOINT以及COPY和ADD设置工作目录，例如：</p>
<p>WORKDIR /data</p>
<h3 id="2-13-ARG"><a href="#2-13-ARG" class="headerlink" title="2.13 ARG"></a><strong>2.13 ARG</strong></h3><p>在构建镜像时，指定一些参数，例如：</p>
<p>FROM centos:6</p>
<p>ARG user   USER $user</p>
<p>这时，我们在docker build时可以带上自定义参数user了，如下所示：</p>
<p>docker build –build-arg user=edisonzhou Dockerfile .</p>
<h2 id="3-制作自己的Docker镜像"><a href="#3-制作自己的Docker镜像" class="headerlink" title="3:制作自己的Docker镜像"></a><strong>3:制作自己的Docker镜像</strong></h2><h4 id="1-创建一个run-sh文件"><a href="#1-创建一个run-sh文件" class="headerlink" title="1:   创建一个run.sh文件"></a><strong>1:   创建一个run.sh文件</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#清空httpd缓存文件</span></span><br><span class="line">rm -rf /run/httpd/*</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动httpd服务</span></span><br><span class="line"><span class="keyword">exec</span> /usr/sbin/apachectl -D FOREGROUND</span><br></pre></td></tr></table></figure>

<h4 id="2-创建一个index-html"><a href="#2-创建一个index-html" class="headerlink" title="2: 创建一个index.html"></a><strong>2: 创建一个index.html</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">echo <span class="string">"Thiss is Nginx webapp."</span> &gt; index.html</span><br></pre></td></tr></table></figure>

<h4 id="3：创建并编写Dockerfile"><a href="#3：创建并编写Dockerfile" class="headerlink" title="3：创建并编写Dockerfile"></a><strong>3：创建并编写Dockerfile</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#基于centos镜像</span></span><br><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line"><span class="comment">#维护人的信息</span></span><br><span class="line">MAINTAINER The CentOS Project &lt;<span class="number">303323496</span>@qq.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装httpd软件包</span></span><br><span class="line">RUN yum -y update</span><br><span class="line">RUN yum -y install httpd</span><br><span class="line"></span><br><span class="line"><span class="comment">#开启80端口</span></span><br><span class="line">EXPOSE <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#复制网站首页文件至镜像中web站点下</span></span><br><span class="line">ADD index.html /var/www/html/index.html</span><br><span class="line"></span><br><span class="line"><span class="comment">#复制该脚本至镜像中，并修改其权限</span></span><br><span class="line">ADD run.sh /run.sh</span><br><span class="line">RUN chmod <span class="number">775</span> /run.sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#当启动容器时执行的脚本文件</span></span><br><span class="line">CMD [<span class="string">"/run.sh"</span>]</span><br></pre></td></tr></table></figure>

<h4 id="4：查看当前目录下文件："><a href="#4：查看当前目录下文件：" class="headerlink" title="4：查看当前目录下文件："></a><strong>4：查看当前目录下文件：</strong></h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Dockerfile%E7%9A%84%E4%BB%8B%E7%BB%8D%E4%B8%8E%E5%88%9B%E5%BB%BA/docker2.png" alt=""></p>
<h4 id="5：通过dockerfile生成镜像："><a href="#5：通过dockerfile生成镜像：" class="headerlink" title="5：通过dockerfile生成镜像："></a><strong>5：通过dockerfile生成镜像：</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker build -t httpd:centos .</span><br></pre></td></tr></table></figure>

<h4 id="6：基于创建的镜像运行一个容器："><a href="#6：基于创建的镜像运行一个容器：" class="headerlink" title="6：基于创建的镜像运行一个容器："></a><strong>6：基于创建的镜像运行一个容器：</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker run -d -p <span class="number">80</span>:<span class="number">80</span> --name=httpd httpd:centos</span><br></pre></td></tr></table></figure>

<h4 id="7：查看容器是否运行"><a href="#7：查看容器是否运行" class="headerlink" title="7：查看容器是否运行"></a><strong>7：查看容器是否运行</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker  ps</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>&#39;Mysql-基于Docker的主从复制&#39;</title>
    <url>/2020/09/23/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/</url>
    <content><![CDATA[<h1 id="MySQL-基于Docker的主从复制"><a href="#MySQL-基于Docker的主从复制" class="headerlink" title="MySQL-基于Docker的主从复制"></a><strong>MySQL-基于Docker的主从复制</strong></h1><h2 id="整个主从复制的流程可以通过以下图示理解："><a href="#整个主从复制的流程可以通过以下图示理解：" class="headerlink" title="整个主从复制的流程可以通过以下图示理解："></a>整个主从复制的流程可以通过以下图示理解：</h2><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/docker_mysql.png" alt=""></p>
<a id="more"></a>

<h2 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境**"></a>搭建环境**</h2><h5 id="MySQL-5-7-31"><a href="#MySQL-5-7-31" class="headerlink" title="MySQL 5.7.31"></a>MySQL 5.7.31</h5><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql_version.png" alt=""></p>
<h5 id="docker-版本"><a href="#docker-版本" class="headerlink" title="docker 版本"></a>docker 版本</h5><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/docker_version.png" alt=""></p>
<h2 id="1-拉取mysql-镜像"><a href="#1-拉取mysql-镜像" class="headerlink" title="1:   拉取mysql  镜像"></a><strong>1:   拉取mysql  镜像</strong></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker pull mysql:<span class="number">5.7</span><span class="number">.31</span></span><br></pre></td></tr></table></figure>

<h2 id="2：基于下载的镜像启动两个mysql容器，默认启动的用户名是root"><a href="#2：基于下载的镜像启动两个mysql容器，默认启动的用户名是root" class="headerlink" title="2：基于下载的镜像启动两个mysql容器，默认启动的用户名是root"></a><strong>2：基于下载的镜像启动两个mysql容器，默认启动的用户名是root</strong></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 启动第一个</span></span><br><span class="line">docker run -p <span class="number">3307</span>:<span class="number">3306</span> --name mastermysql -e MYSQL_ROOT_PASSWORD=<span class="number">123456</span> -d mysql:<span class="number">5.7</span><span class="number">.31</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动第二个，两个mysql的端口不要一样</span></span><br><span class="line">docker run -p <span class="number">3308</span>:<span class="number">3306</span> --name secondmysql -e MYSQL_ROOT_PASSWORD=<span class="number">123456</span> -d mysql:<span class="number">5.7</span><span class="number">.31</span></span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql2.png" alt=""></p>
<h2 id="3：配置主从"><a href="#3：配置主从" class="headerlink" title="3：配置主从"></a><strong>3：配置主从</strong></h2><h3 id="3-1-配置主库"><a href="#3-1-配置主库" class="headerlink" title="3.1 配置主库"></a><strong>3.1 配置主库</strong></h3><h4 id="3-1-1-进入第一个mysql容器"><a href="#3-1-1-进入第一个mysql容器" class="headerlink" title="3.1.1  进入第一个mysql容器"></a><strong>3.1.1  进入第一个mysql容器</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker <span class="keyword">exec</span> -it  mastermysql  /bin/bash </span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入容器后安装vim编辑器，这是为了修改配置文件安装编辑器</span></span><br><span class="line">apt-get update</span><br><span class="line">apt-get install vim </span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接mysql数据库, 并输入密码</span></span><br><span class="line">mysql  -u root  -h localhost -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个叫backup的用户，并且不显示来源地址</span></span><br><span class="line">CREATE USER <span class="string">'backup'</span>@<span class="string">'%'</span> IDENTIFIED BY <span class="string">'123456'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 授权找个用户具有复制同步权限</span></span><br><span class="line">GRANT REPLICATION SLAVE ON *.* TO <span class="string">'backup'</span>@<span class="string">'%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#  刷新权限,一定要刷新权限</span></span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行如下语句验证是否授权成功，如果没问题得到下图所示</span></span><br><span class="line">show grants <span class="keyword">for</span> <span class="string">'backup'</span>@<span class="string">'%'</span>;</span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql6.png" alt=""></p>
<h4 id="3-1-2-修改第一个mysql容器的配置文件"><a href="#3-1-2-修改第一个mysql容器的配置文件" class="headerlink" title="3.1.2 修改第一个mysql容器的配置文件"></a><strong>3.1.2 修改第一个mysql容器的配置文件</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 切换到配置文件目录</span></span><br><span class="line">cd  /etc/mysql/mysql.conf.d/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改并编辑mysql.cnf</span></span><br><span class="line">vim mysql.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改或添加如下,并保存，然后重启容器</span></span><br><span class="line">[mysqld]</span><br><span class="line">log-bin=mysql-bin      <span class="comment">#开启二进制日志</span></span><br><span class="line">server-id=<span class="number">1</span>            <span class="comment">#设置server-id，不要和slave重复</span></span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql8.png" alt=""></p>
<h3 id="3-2-配从容器"><a href="#3-2-配从容器" class="headerlink" title="3.2 配从容器"></a><strong>3.2 配从容器</strong></h3><h4 id="3-2-1-进入从容器并修改配置文件"><a href="#3-2-1-进入从容器并修改配置文件" class="headerlink" title="3.2.1 进入从容器并修改配置文件"></a><strong>3.2.1 进入从容器并修改配置文件</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">docker <span class="keyword">exec</span> -it  secondmysql  /bin/bash </span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入容器后安装vim编辑器，这是为了修改配置文件安装编辑器</span></span><br><span class="line">apt-get update</span><br><span class="line">apt-get install vim</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到配置文件目录</span></span><br><span class="line">cd  /etc/mysql/mysql.conf.d/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改并编辑mysql.cnf</span></span><br><span class="line">vim mysql.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改或添加如下,并保存，然后重启容器</span></span><br><span class="line">[mysqld]</span><br><span class="line">server-id=<span class="number">2</span>        <span class="comment">#设置server-id，必须唯一，不能和其他重复</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-设置同步主-并-启动同步线程"><a href="#3-2-2-设置同步主-并-启动同步线程" class="headerlink" title="3.2.2 设置同步主 并 启动同步线程"></a><strong>3.2.2 设置同步主 并 启动同步线程</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 设置如何同步主</span></span><br><span class="line">mysql&gt; CHANGE MASTER TO   </span><br><span class="line">         -&gt;  MASTER_HOST='192.168.106.131',    </span><br><span class="line">         -&gt;  MASTER_USER='backup',    </span><br><span class="line">         -&gt;  MASTER_PASSWORD='123456',</span><br><span class="line">         -&gt;  MASTER_PORT=3307;</span><br><span class="line">         </span><br><span class="line"><span class="comment">#  启动同步线程</span></span><br><span class="line">mysql&gt;start slave;</span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql10.png" alt=""></p>
<h4 id="3-2-3-查看同步状态"><a href="#3-2-3-查看同步状态" class="headerlink" title="3.2.3  查看同步状态"></a><strong>3.2.3  查看同步状态</strong></h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mysql&gt; show slave status\G;</span><br></pre></td></tr></table></figure>

<h6 id="下图-slave-IO-Running-和-Slave-SQL-Running-都为YES说明配置成功"><a href="#下图-slave-IO-Running-和-Slave-SQL-Running-都为YES说明配置成功" class="headerlink" title="下图 slave_IO_Running 和 Slave_SQL_Running 都为YES说明配置成功"></a>下图 slave_IO_Running 和 Slave_SQL_Running 都为YES说明配置成功</h6><h6 id="Slave-IO-State-可以作为参考说明"><a href="#Slave-IO-State-可以作为参考说明" class="headerlink" title="Slave_IO_State: 可以作为参考说明"></a>Slave_IO_State: 可以作为参考说明</h6><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Mysql-%E5%9F%BA%E4%BA%8EDocker%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/mysql.png" alt=""></p>
<h2 id="4：配置Django实现数据库读写分离"><a href="#4：配置Django实现数据库读写分离" class="headerlink" title="4：配置Django实现数据库读写分离"></a>4：配置Django实现数据库读写分离</h2><p>django在进行数据库操作的时候，读取数据与写数据（增、删、改）可以分别从不同的数据库进行操作。</p>
<h4 id="4-1-在配置文件中增加slave数据库的配置"><a href="#4-1-在配置文件中增加slave数据库的配置" class="headerlink" title="4.1. 在配置文件中增加slave数据库的配置"></a>4.1. 在配置文件中增加slave数据库的配置</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>: <span class="string">'10.211.55.5'</span>,</span><br><span class="line">        <span class="string">'PORT'</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">'USER'</span>: <span class="string">'meiduo'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>: <span class="string">'meiduo'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'meiduo_mall'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'slave'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'HOST'</span>: <span class="string">'10.211.55.5'</span>,</span><br><span class="line">        <span class="string">'PORT'</span>: <span class="number">8306</span>,</span><br><span class="line">        <span class="string">'USER'</span>: <span class="string">'root'</span>,</span><br><span class="line">        <span class="string">'PASSWORD'</span>: <span class="string">'mysql'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">'meiduo_mall'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-创建数据库操作的路由分发类"><a href="#4-2-创建数据库操作的路由分发类" class="headerlink" title="4.2. 创建数据库操作的路由分发类"></a>4.2. 创建数据库操作的路由分发类</h4><p>在syl/utils中创建db_router.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MasterSlaveDBRouter</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""数据库主从读写分离路由"""</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_read</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="string">"""读数据库"""</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"slave"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">db_for_write</span><span class="params">(self, model, **hints)</span>:</span></span><br><span class="line">        <span class="string">"""写数据库"""</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"default"</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">allow_relation</span><span class="params">(self, obj1, obj2, **hints)</span>:</span></span><br><span class="line">        <span class="string">"""是否运行关联操作"""</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h4 id="4-3-配置读写分离路由"><a href="#4-3-配置读写分离路由" class="headerlink" title="4.3. 配置读写分离路由"></a>4.3. 配置读写分离路由</h4><p>在配置文件中增加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 配置读写分离</span><br><span class="line">DATABASE_ROUTERS &#x3D; [&#39;meiduo_mall.utils.db_router.MasterSlaveDBRouter&#39;]</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title>Django2.0.4 配置全文检索</title>
    <url>/2020/09/17/Django2-0-4-%E9%85%8D%E7%BD%AE%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/</url>
    <content><![CDATA[<h3 id="Django全文检索"><a href="#Django全文检索" class="headerlink" title="Django全文检索"></a>Django全文检索</h3><p>1:haystack是django的开源搜索框架，该框架支持Solr，Elasticsearch，Whoosh，<em>Xapian</em>搜索引擎，不用更改代码，直接切换引擎，减少代码量。</p>
<p>2：搜索引擎使用Whoosh，这是一个由纯Python实现的全文搜索引擎，没有二进制文件等，比较小巧，配置比较简单，当然性能自然略低。</p>
<p>3：中文分词Jieba，由于Whoosh自带的是英文分词，对中文的分词支持不是太好，故用jieba替换whoosh的分词组件。</p>
<h4 id="1-Django中实现全文索引的组件"><a href="#1-Django中实现全文索引的组件" class="headerlink" title="1.Django中实现全文索引的组件"></a>1.Django中实现全文索引的组件</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install django-haystack~=<span class="number">2.8</span><span class="number">.0</span></span><br><span class="line">pip install Whoosh==<span class="number">2.7</span><span class="number">.4</span></span><br><span class="line">pip install  jieba (自己配置)</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="2-在配置文件settings-py中添加应用"><a href="#2-在配置文件settings-py中添加应用" class="headerlink" title="2.在配置文件settings.py中添加应用"></a>2.在配置文件settings.py中添加应用</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line">    <span class="string">'haystack'</span>,  <span class="comment">#haystack要放在自建应用的上面</span></span><br><span class="line">    <span class="string">'extra_apps.xadmin'</span>,</span><br><span class="line">    <span class="string">'crispy_forms'</span>,</span><br><span class="line">    <span class="string">'apps.course'</span>,  <span class="comment"># 课程模块</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">'BACKEND'</span>: <span class="string">'django.template.backends.django.DjangoTemplates'</span>,</span><br><span class="line">        <span class="string">'DIRS'</span>: [os.path.join(BASE_DIR, <span class="string">'templates'</span>)],</span><br><span class="line">        <span class="string">'APP_DIRS'</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">'OPTIONS'</span>: &#123;</span><br><span class="line">            <span class="string">'context_processors'</span>: [</span><br><span class="line">                <span class="string">'django.template.context_processors.debug'</span>,</span><br><span class="line">                <span class="string">'django.template.context_processors.request'</span>,</span><br><span class="line">                <span class="string">'django.contrib.auth.context_processors.auth'</span>,</span><br><span class="line">                <span class="string">'django.contrib.messages.context_processors.messages'</span>,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>



<h4 id="3-在配置文件settings-py中配置全文搜索框架"><a href="#3-在配置文件settings-py中配置全文搜索框架" class="headerlink" title="3.在配置文件settings.py中配置全文搜索框架"></a>3.在配置文件settings.py中配置全文搜索框架</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 配置全文检索</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置全文检索引擎</span></span><br><span class="line">HAYSTACK_CONNECTIONS = &#123;</span><br><span class="line">    <span class="string">'default'</span>:&#123;</span><br><span class="line">        <span class="comment"># 配置搜索引擎</span></span><br><span class="line">        <span class="string">'ENGINE'</span>:<span class="string">'haystack.backends.whoosh_cn_backend.WhooshEngine'</span>,</span><br><span class="line">        <span class="comment"># 配置索引文件目录</span></span><br><span class="line">        <span class="string">'PATH'</span>:os.path.join(BASE_DIR,<span class="string">'whoosh_index'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 全文检索结果每次返回数量</span></span><br><span class="line">HAYSTACK_SEARCH_RESULTS_PER_PAGE = <span class="number">20</span></span><br><span class="line"><span class="comment">#添加此项，当数据库改变时，会自动更新索引，非常方便</span></span><br><span class="line">HAYSTACK_SIGNAL_PROCESSOR = <span class="string">'haystack.signals.RealtimeSignalProcessor'</span></span><br></pre></td></tr></table></figure>

<h4 id="4-在课程应用下创建search-indexes-py名字不能动"><a href="#4-在课程应用下创建search-indexes-py名字不能动" class="headerlink" title="4.在课程应用下创建search_indexes.py名字不能动"></a>4.在课程应用下创建search_indexes.py名字不能动</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导包</span></span><br><span class="line"><span class="keyword">from</span> haystack <span class="keyword">import</span> indexes</span><br><span class="line"><span class="keyword">from</span> apps.course.models <span class="keyword">import</span> Course</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CourseIndex</span><span class="params">(indexes.SearchIndex, indexes.Indexable)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Course索引类</span></span><br><span class="line"><span class="string">    text 为索引字段</span></span><br><span class="line"><span class="string">    document=True ，代表haystack和搜索引擎将使用此字段的内容作为索引进行检索</span></span><br><span class="line"><span class="string">    use_template=True ，指根据表中的字段建立索引文件的说明放在一个文件中</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    text = indexes.CharField(document=<span class="literal">True</span>, use_template=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_model</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""建立返回索引模型类"""</span></span><br><span class="line">        <span class="keyword">return</span> Course</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">index_queryset</span><span class="params">(self, using=None)</span>:</span></span><br><span class="line">        <span class="string">"""返回要建立索引的数据查询集"""</span></span><br><span class="line">        <span class="keyword">return</span> self.get_model().objects.all()</span><br></pre></td></tr></table></figure>

<h4 id="5-指定索引模板文件"><a href="#5-指定索引模板文件" class="headerlink" title="5.指定索引模板文件"></a>5.指定索引模板文件</h4><h5 id="创建文件路径命名必须这个规范：templates-search-indexes-应用名称-模型类名称-text-txt"><a href="#创建文件路径命名必须这个规范：templates-search-indexes-应用名称-模型类名称-text-txt" class="headerlink" title="创建文件路径命名必须这个规范：templates / search / indexes /应用名称/模型类名称_text.txt"></a>创建文件路径命名必须这个规范：templates / search / indexes /应用名称/模型类名称_text.txt</h5><h5 id="例：template-search-indexes-courses-course-text-txt-课程对应的是app-名称course-text-txt-课程的对应的是模型名称"><a href="#例：template-search-indexes-courses-course-text-txt-课程对应的是app-名称course-text-txt-课程的对应的是模型名称" class="headerlink" title="例：template / search / indexes / courses / course_text.txt  课程对应的是app     名称course_text.txt     课程的对应的是模型名称"></a>例：template / search / indexes / courses / course_text.txt  课程对应的是app     名称course_text.txt     课程的对应的是模型名称</h5><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Django2-0-4-%E9%85%8D%E7%BD%AE%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/temp.png" alt=""></p>
<h5 id="在course-text-txt中定义需要检索的字段"><a href="#在course-text-txt中定义需要检索的字段" class="headerlink" title="在course_text.txt中定义需要检索的字段"></a>在course_text.txt中定义需要检索的字段</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 定义要创建索引的字段</span></span><br><span class="line">&#123;&#123; object.name &#125;&#125;</span><br><span class="line">&#123;&#123; object.desc &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-然后执行命令创建需要的全文索引"><a href="#6-然后执行命令创建需要的全文索引" class="headerlink" title="6.然后执行命令创建需要的全文索引"></a>6.然后执行命令创建需要的全文索引</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py rebuild_index</span><br></pre></td></tr></table></figure>

<h4 id="7-搜索函数，仅供参考，在课程app中view中创建搜索函数"><a href="#7-搜索函数，仅供参考，在课程app中view中创建搜索函数" class="headerlink" title="7.搜索函数，仅供参考，在课程app中view中创建搜索函数"></a>7.搜索函数，仅供参考，在课程app中view中创建搜索函数</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br><span class="line"><span class="keyword">from</span> django.core.paginator <span class="keyword">import</span> InvalidPage, Paginator</span><br><span class="line"><span class="keyword">from</span> haystack.forms <span class="keyword">import</span> ModelSearchForm</span><br><span class="line"><span class="keyword">from</span> haystack.query <span class="keyword">import</span> EmptySearchQuerySet</span><br><span class="line"><span class="keyword">from</span> syl_django.settings <span class="keyword">import</span> HAYSTACK_SEARCH_RESULTS_PER_PAGE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">course_index_search</span><span class="params">(request,load_all=True,form_class=ModelSearchForm,searchqueryset=None,results_per_page=None,extra_context=None)</span></span></span><br><span class="line">    query = ''</span><br><span class="line">    results = EmptySearchQuerySet()</span><br><span class="line">    <span class="comment"># 获取前端传的参数</span></span><br><span class="line">    <span class="keyword">if</span> request.GET.get(<span class="string">'q'</span>):</span><br><span class="line">      form=form_class(request.GET,searchqueryset=searchqueryset,load_all=load_all)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> form.is_valid():</span><br><span class="line">            query = form.cleaned_data[<span class="string">'q'</span>]</span><br><span class="line">            results = form.search()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            form = form_class(searchqueryset=searchqueryset,load_all=load_all)</span><br><span class="line"></span><br><span class="line">        paginator = Paginator(results,results_per_page <span class="keyword">or</span> 													HAYSTACK_SEARCH_RESULTS_PER_PAGE)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            page = paginator.page(int(request.GET.get(<span class="string">'page'</span>,<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> InvalidPage:</span><br><span class="line">            result = (&#123;<span class="string">'code'</span>:<span class="number">404</span>,<span class="string">'msg'</span>:<span class="string">'NO file found'</span>,<span class="string">'data'</span>:<span class="string">''</span>&#125;)</span><br><span class="line">            <span class="keyword">return</span> RecoCourse(result)</span><br><span class="line"></span><br><span class="line">        context = &#123;</span><br><span class="line">            <span class="string">'form'</span>:form,</span><br><span class="line">            <span class="string">'page'</span>:page,</span><br><span class="line">            <span class="string">'paginator'</span>:paginator,</span><br><span class="line">            <span class="string">'query'</span>:query,</span><br><span class="line">            <span class="string">'suggestion'</span>:<span class="literal">None</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> results.query.backend.include_spelling:</span><br><span class="line">            context[<span class="string">'suggestion'</span>] = form.get_suggestion()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> extra_context:</span><br><span class="line">            context.update(extra_context)</span><br><span class="line">		<span class="comment"># 要返回的结果</span></span><br><span class="line">        jsondata=[]</span><br><span class="line">        <span class="keyword">for</span>  result <span class="keyword">in</span> page.object_list:</span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">'pk'</span>:result.object.id,</span><br><span class="line">            &#125;</span><br><span class="line">            jsondata.append(data)</span><br><span class="line">        <span class="keyword">if</span> jsondata:</span><br><span class="line">            result = &#123;</span><br><span class="line">                <span class="string">'data'</span>:jsondata</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = &#123;<span class="string">'data'</span>:<span class="string">''</span>&#125;</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(result,content_type = <span class="string">'application/json'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="8-替换jieba分词"><a href="#8-替换jieba分词" class="headerlink" title="8.替换jieba分词"></a>8.替换jieba分词</h4><p>​    1）将haystack源代码复制到项目中并改名</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Django2-0-4-%E9%85%8D%E7%BD%AE%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/Snipaste_2020-09-17_09-06-23.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span><span class="string">'''复制源码中文件并改名'''</span></span><br><span class="line">将 C:\python37\lib\site-packages\haystack\backends\whoosh_backend.py文件复制到项目中并将  whoosh_backend.py 改名为 whoosh_cn_backend.py 放在APP中如：sourse\whoosh_cn_backend.py</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span><span class="string">'''修改源码中文件'''</span></span><br><span class="line"><span class="comment"># 在全局引入的最后一行加入jieba分词器</span></span><br><span class="line"><span class="keyword">from</span> jieba.analyse <span class="keyword">import</span> ChineseAnalyzer</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="string">'''修改为中文分词'''</span></span><br><span class="line"><span class="comment"># 查找</span></span><br><span class="line">analyzer=StemmingAnalyzer()</span><br><span class="line"><span class="comment"># 改为</span></span><br><span class="line">analyzer=ChineseAnalyzer()</span><br></pre></td></tr></table></figure>

<p>​    2) Django内settings内修改相应的haystack后台文件名</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#配置全文检索引擎</span></span><br><span class="line">HAYSTACK_CONNECTIONS = &#123;</span><br><span class="line">    <span class="string">'default'</span>:&#123;</span><br><span class="line">        <span class="comment"># 配置搜索引擎</span></span><br><span class="line">        <span class="comment"># 'ENGINE':'haystack.backends.whoosh_cn_backend.WhooshEngine',</span></span><br><span class="line">        <span class="comment"># 中文分词 使用jieba的whoosh引擎，刚才复制源码到app中的位置</span></span><br><span class="line">        <span class="string">'ENGINE'</span>:<span class="string">'apps.course.whoosh_cn_backend.WhooshEngine'</span>,</span><br><span class="line">        <span class="string">'PATH'</span>:os.path.join(BASE_DIR,<span class="string">'whoosh_index'</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    3）重新生成索引</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python manage.py rebuild_index</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>Djanog</tag>
      </tags>
  </entry>
  <entry>
    <title>Django自定义随机验证码</title>
    <url>/2020/09/15/Django%E8%87%AA%E5%AE%9A%E4%B9%89%E9%9A%8F%E6%9C%BA%E9%AA%8C%E8%AF%81%E7%A0%81/</url>
    <content><![CDATA[<h3 id="django自定义随机数字验证码"><a href="#django自定义随机数字验证码" class="headerlink" title="django自定义随机数字验证码"></a>django自定义随机数字验证码</h3><h4 id="1-在view中定义视图函数"><a href="#1-在view中定义视图函数" class="headerlink" title="1,在view中定义视图函数"></a>1,在view中定义视图函数</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,HttpResponse</span><br><span class="line"><span class="comment"># 导入图片库</span></span><br><span class="line"><span class="comment"># 绘画库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageDraw</span><br><span class="line"><span class="comment"># 字体库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> ImageFont</span><br><span class="line"><span class="comment"># 图片库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="comment"># 随机库</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 文件流</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入redis数据库</span></span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义连接对象和端口</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">6379</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义连接对象</span></span><br><span class="line">r = redis.Redis(host=host, port=port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义验证码类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyCode</span><span class="params">(View)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义随机颜色</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_random_color</span><span class="params">(self)</span>:</span></span><br><span class="line">        R = random.randrange(<span class="number">255</span>)</span><br><span class="line">        G = random.randrange(<span class="number">255</span>)</span><br><span class="line">        B = random.randrange(<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (R, G, B)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取验证码试图</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, request)</span>:</span></span><br><span class="line">        <span class="comment"># 画布</span></span><br><span class="line">        img_size = (<span class="number">120</span>, <span class="number">50</span>)</span><br><span class="line">        <span class="comment"># 定义画图对象</span></span><br><span class="line">        image = Image.new(<span class="string">'RGB'</span>, img_size, <span class="string">'white'</span>)</span><br><span class="line">        <span class="comment"># 定义画笔对象</span></span><br><span class="line">        draw = ImageDraw.Draw(image, <span class="string">'RGB'</span>)</span><br><span class="line">        <span class="comment"># 定义随机字符串</span></span><br><span class="line">        source = <span class="string">'123456789'</span></span><br><span class="line">        <span class="comment"># 容器</span></span><br><span class="line">        code_str = <span class="string">''</span></span><br><span class="line">        <span class="comment"># 定义字体</span></span><br><span class="line">        my_font = ImageFont.truetype(font=<span class="string">"C:\\Windows\\Fonts\\Arial.ttf"</span>,size=<span class="number">15</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">            <span class="comment"># 获取随机颜色</span></span><br><span class="line">            text_color = self.get_random_color()</span><br><span class="line">            <span class="comment"># 获取随机字符串长度下标</span></span><br><span class="line">            tmp_num = random.randrange(len(source))</span><br><span class="line">            <span class="comment"># 获取字符集</span></span><br><span class="line">            random_str = source[tmp_num]</span><br><span class="line">            <span class="comment"># 添加到容器中</span></span><br><span class="line">            code_str += random_str</span><br><span class="line">            <span class="comment"># 将字符串添加到画布中</span></span><br><span class="line">            draw.text((<span class="number">10</span> + <span class="number">30</span> * i, <span class="number">20</span>), random_str, text_color, font=my_font)</span><br><span class="line">        <span class="comment"># 建立缓存区</span></span><br><span class="line">        buf = io.BytesIO()</span><br><span class="line">        <span class="comment"># 将验证码存储到redis</span></span><br><span class="line">        r.set(<span class="string">'code'</span>, code_str)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 保存图片</span></span><br><span class="line">        image.save(buf, <span class="string">'png'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将验证码存到session中</span></span><br><span class="line">        <span class="comment"># request.session['code'] = code_str</span></span><br><span class="line">        <span class="keyword">return</span> HttpResponse(buf.getvalue(), <span class="string">'image/png'</span>)</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h4 id="2，在自定义app中urls中添加路由"><a href="#2，在自定义app中urls中添加路由" class="headerlink" title="2，在自定义app中urls中添加路由"></a>2，在自定义app中urls中添加路由</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> .views <span class="keyword">import</span> MyCode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app_name = <span class="string">'myapp'</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'mycode/'</span>,MyCode.as_view()), </span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="3-运行项目"><a href="#3-运行项目" class="headerlink" title="3,运行项目"></a>3,运行项目</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="../images/Django%E8%87%AA%E5%AE%9A%E4%B9%89%E9%9A%8F%E6%9C%BA%E9%AA%8C%E8%AF%81%E7%A0%81/code.png" alt=""></p>
]]></content>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>在windows平台，运行celery报错</title>
    <url>/2020/09/15/%E5%9C%A8windows%E5%B9%B3%E5%8F%B0%EF%BC%8C%E8%BF%90%E8%A1%8Ccelery%E6%8A%A5%E9%94%99/</url>
    <content><![CDATA[<h3 id="windows平台上，在django项目中，使用celery做异步任务时报错"><a href="#windows平台上，在django项目中，使用celery做异步任务时报错" class="headerlink" title="windows平台上，在django项目中，使用celery做异步任务时报错!"></a>windows平台上，在django项目中，使用celery做异步任务时报错!</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="/images/%E5%9C%A8windows%E5%B9%B3%E5%8F%B0%EF%BC%8C%E8%BF%90%E8%A1%8Ccelery%E6%8A%A5%E9%94%99/celery.png" alt=""></p>
<h3 id="个人解决方法，不一定全部适用，在启动celery命令加上-–pool-solo"><a href="#个人解决方法，不一定全部适用，在启动celery命令加上-–pool-solo" class="headerlink" title="个人解决方法，不一定全部适用，在启动celery命令加上 –pool=solo"></a>个人解决方法，不一定全部适用，在启动celery命令加上 –pool=solo</h3><p><code>celery -A celery_tasks worker --poll=solo -l info</code></p>
]]></content>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
</search>
